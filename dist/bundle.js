/*! For license information please see bundle.js.LICENSE.txt */
(()=>{var t={224:(t,e,n)=>{"use strict";var r=n(983),i=n(886),o=n(695),a=n(448),s=n(594);function u(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var c,l=u(r),h=((c={})["already-activated"]="You are trying to activate AppCheck for FirebaseApp {$appName}, while it is already activated. AppCheck can only be activated once.",c["use-before-activation"]="AppCheck is being used before activate() is called for FirebaseApp {$appName}. Please make sure you call activate() before instantiating other Firebase services.",c["fetch-network-error"]="Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.",c["fetch-parse-error"]="Fetch client could not parse response. Original error: {$originalErrorMessage}.",c["fetch-status-error"]="Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.",c["storage-open"]="Error thrown when opening storage. Original error: {$originalErrorMessage}.",c["storage-get"]="Error thrown when reading from storage. Original error: {$originalErrorMessage}.",c["storage-set"]="Error thrown when writing to storage. Original error: {$originalErrorMessage}.",c["recaptcha-error"]="ReCAPTCHA error.",c),f=new a.ErrorFactory("appCheck","AppCheck",h),p=new Map,d={activated:!1,tokenListeners:[]},v={enabled:!1};function g(t){return p.get(t)||d}function y(t,e){p.set(t,e)}function m(){return v}function b(){return self.grecaptcha}function _(t){if(!g(t).activated)throw f.create("use-before-activation",{appName:t.name})}function w(t){return o.__awaiter(this,void 0,void 0,(function(){var e;return o.__generator(this,(function(n){switch(n.label){case 0:return _(t),[4,g(t).reCAPTCHAState.initialized.promise];case 1:return e=n.sent(),[2,new Promise((function(n,r){var i=g(t).reCAPTCHAState;e.ready((function(){n(e.execute(i.widgetId,{action:"fire_app_check"}))}))}))]}}))}))}function I(t,e,n,r){var i=n.render(r,{sitekey:e,size:"invisible"}),a=g(t);y(t,o.__assign(o.__assign({},a),{reCAPTCHAState:o.__assign(o.__assign({},a.reCAPTCHAState),{widgetId:i})}))}var T="https://content-firebaseappcheck.googleapis.com/v1beta",E=function(){function t(t,e,n,r,i){if(this.operation=t,this.retryPolicy=e,this.getWaitDuration=n,this.lowerBound=r,this.upperBound=i,this.pending=null,this.nextErrorWaitInterval=r,r>i)throw new Error("Proactive refresh lower bound greater than upper bound!")}return t.prototype.start=function(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch((function(){}))},t.prototype.stop=function(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)},t.prototype.isRunning=function(){return!!this.pending},t.prototype.process=function(t){return o.__awaiter(this,void 0,void 0,(function(){var e;return o.__generator(this,(function(n){switch(n.label){case 0:this.stop(),n.label=1;case 1:return n.trys.push([1,6,,7]),this.pending=new a.Deferred,[4,(r=this.getNextRun(t),new Promise((function(t){setTimeout(t,r)})))];case 2:return n.sent(),this.pending.resolve(),[4,this.pending.promise];case 3:return n.sent(),this.pending=new a.Deferred,[4,this.operation()];case 4:return n.sent(),this.pending.resolve(),[4,this.pending.promise];case 5:return n.sent(),this.process(!0).catch((function(){})),[3,7];case 6:return e=n.sent(),this.retryPolicy(e)?this.process(!1).catch((function(){})):this.stop(),[3,7];case 7:return[2]}var r}))}))},t.prototype.getNextRun=function(t){if(t)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();var e=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),e},t}();function S(t,e){var n=t.url,r=t.body;return o.__awaiter(this,void 0,void 0,(function(){var t,i,a,s,u,c,l,h,p,d;return o.__generator(this,(function(o){switch(o.label){case 0:t={"Content-Type":"application/json"},(i=e.getImmediate({optional:!0}))&&(t["X-Firebase-Client"]=i.getPlatformInfoString()),a={method:"POST",body:JSON.stringify(r),headers:t},o.label=1;case 1:return o.trys.push([1,3,,4]),[4,fetch(n,a)];case 2:return s=o.sent(),[3,4];case 3:throw u=o.sent(),f.create("fetch-network-error",{originalErrorMessage:u.message});case 4:if(200!==s.status)throw f.create("fetch-status-error",{httpStatus:s.status});o.label=5;case 5:return o.trys.push([5,7,,8]),[4,s.json()];case 6:return c=o.sent(),[3,8];case 7:throw l=o.sent(),f.create("fetch-parse-error",{originalErrorMessage:l.message});case 8:if(!(h=c.ttl.match(/^([\d.]+)(s)$/))||!h[2]||isNaN(Number(h[1])))throw f.create("fetch-parse-error",{originalErrorMessage:"ttl field (timeToLive) is not in standard Protobuf Duration format: "+c.ttl});return p=1e3*Number(h[1]),d=Date.now(),[2,{token:c.attestationToken,expireTimeMillis:d+p,issuedAtTimeMillis:d}]}}))}))}function C(t,e){var n=t.options,r=n.projectId,i=n.appId,o=n.apiKey;return{url:T+"/projects/"+r+"/apps/"+i+":exchangeRecaptchaToken?key="+o,body:{recaptcha_token:e}}}function k(t,e){var n=t.options,r=n.projectId,i=n.appId,o=n.apiKey;return{url:T+"/projects/"+r+"/apps/"+i+":exchangeDebugToken?key="+o,body:{debug_token:e}}}var A="firebase-app-check-store",N="debug-token",P=null;function O(){return P||(P=new Promise((function(t,e){try{var n=indexedDB.open("firebase-app-check-database",1);n.onsuccess=function(e){t(e.target.result)},n.onerror=function(t){var n;e(f.create("storage-open",{originalErrorMessage:null===(n=t.target.error)||void 0===n?void 0:n.message}))},n.onupgradeneeded=function(t){var e=t.target.result;switch(t.oldVersion){case 0:e.createObjectStore(A,{keyPath:"compositeKey"})}}}catch(t){e(f.create("storage-open",{originalErrorMessage:t.message}))}})))}function R(t){return D(L(t))}function x(t,e){return o.__awaiter(this,void 0,void 0,(function(){var n,r,i,a;return o.__generator(this,(function(o){switch(o.label){case 0:return[4,O()];case 1:return n=o.sent(),r=n.transaction(A,"readwrite"),i=r.objectStore(A),a=i.put({compositeKey:t,value:e}),[2,new Promise((function(t,e){a.onsuccess=function(e){t()},r.onerror=function(t){var n;e(f.create("storage-set",{originalErrorMessage:null===(n=t.target.error)||void 0===n?void 0:n.message}))}}))]}}))}))}function D(t){return o.__awaiter(this,void 0,void 0,(function(){var e,n,r,i;return o.__generator(this,(function(o){switch(o.label){case 0:return[4,O()];case 1:return e=o.sent(),n=e.transaction(A,"readonly"),r=n.objectStore(A),i=r.get(t),[2,new Promise((function(t,e){i.onsuccess=function(e){var n=e.target.result;t(n?n.value:void 0)},n.onerror=function(t){var n;e(f.create("storage-get",{originalErrorMessage:null===(n=t.target.error)||void 0===n?void 0:n.message}))}}))]}}))}))}function L(t){return t.options.appId+"-"+t.name}var M=new s.Logger("@firebase/app-check");function F(t){return o.__awaiter(this,void 0,void 0,(function(){var e,n;return o.__generator(this,(function(r){switch(r.label){case 0:if(!a.isIndexedDBAvailable())return[3,5];e=void 0,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,R(t)];case 2:return e=r.sent(),[3,4];case 3:return n=r.sent(),M.warn("Failed to read token from indexeddb. Error: "+n),[3,4];case 4:return[2,e];case 5:return[2,void 0]}}))}))}function U(t,e){return a.isIndexedDBAvailable()?function(t,e){return x(L(t),e)}(t,e).catch((function(t){M.warn("Failed to write token to indexeddb. Error: "+t)})):Promise.resolve()}function j(){return m().enabled}function q(){return o.__awaiter(this,void 0,void 0,(function(){var t;return o.__generator(this,(function(e){if((t=m()).enabled&&t.token)return[2,t.token.promise];throw Error("\n            Can't get debug token in production mode.\n        ")}))}))}var V={error:"UNKNOWN_ERROR"};function B(t,e,n){return void 0===n&&(n=!1),o.__awaiter(this,void 0,void 0,(function(){var r,i,s,u,c,l,h,p,d,v,m,b,I;return o.__generator(this,(function(T){switch(T.label){case 0:return _(t),j()?(r=S,i=k,s=[t],[4,q()]):[3,3];case 1:return[4,r.apply(void 0,[i.apply(void 0,s.concat([T.sent()])),e])];case 2:return[2,{token:T.sent().token}];case 3:return u=g(t),c=u.token,l=void 0,c?[3,5]:[4,F(t)];case 4:(h=T.sent())&&W(h)&&(c=h,y(t,o.__assign(o.__assign({},u),{token:c})),K(t,{token:c.token})),T.label=5;case 5:if(!n&&c&&W(c))return[2,{token:c.token}];T.label=6;case 6:return T.trys.push([6,12,,13]),u.customProvider?[4,u.customProvider.getToken()]:[3,8];case 7:return p=T.sent(),d=a.issuedAtTime(p.token),v=null!==d&&d<Date.now()&&d>0?1e3*d:Date.now(),c=o.__assign(o.__assign({},p),{issuedAtTimeMillis:v}),[3,11];case 8:return[4,w(t).catch((function(t){throw f.create("recaptcha-error")}))];case 9:return m=T.sent(),[4,S(C(t,m),e)];case 10:c=T.sent(),T.label=11;case 11:return[3,13];case 12:return b=T.sent(),M.error(b),l=b,[3,13];case 13:return c?[3,14]:(I=function(t){return{token:(e=V,a.base64.encodeString(JSON.stringify(e),!1)),error:t};var e}(l),[3,16]);case 14:return I={token:c.token},y(t,o.__assign(o.__assign({},u),{token:c})),[4,U(t,c)];case 15:T.sent(),T.label=16;case 16:return K(t,I),[2,I]}}))}))}function K(t,e){for(var n=0,r=g(t).tokenListeners;n<r.length;n++){var i=r[n];try{i(e)}catch(t){}}}function W(t){return t.expireTimeMillis-Date.now()>0}function G(t){return{activate:function(e,n){return function(t,e,n){var r=g(t);if(r.activated)throw f.create("already-activated",{appName:t.name});var i=o.__assign(o.__assign({},r),{activated:!0});"string"==typeof e?i.siteKey=e:i.customProvider=e,i.isTokenAutoRefreshEnabled=void 0===n?t.automaticDataCollectionEnabled:n,y(t,i),i.siteKey&&function(t,e){var n=g(t),r=new a.Deferred;y(t,o.__assign(o.__assign({},n),{reCAPTCHAState:{initialized:r}}));var i="fire_app_check_"+t.name,s=document.createElement("div");s.id=i,s.style.display="none",document.body.appendChild(s);var u,c,l=b();return l?l.ready((function(){I(t,e,l,i),r.resolve(l)})):(u=function(){var n=b();if(!n)throw new Error("no recaptcha");n.ready((function(){I(t,e,n,i),r.resolve(n)}))},(c=document.createElement("script")).src="https://www.google.com/recaptcha/api.js",c.onload=u,document.head.appendChild(c)),r.promise}(t,i.siteKey).catch((function(){}))}(t,e,n)},setTokenAutoRefreshEnabled:function(e){return function(t,e){var n=g(t);n.tokenRefresher&&(!0===e?n.tokenRefresher.start():n.tokenRefresher.stop()),y(t,o.__assign(o.__assign({},n),{isTokenAutoRefreshEnabled:e}))}(t,e)}}}function H(t,e){return{getToken:function(n){return B(t,e,n)},addTokenListener:function(n){return function(t,e,n){var r=g(t),i=o.__assign(o.__assign({},r),{tokenListeners:o.__spreadArray(o.__spreadArray([],r.tokenListeners),[n])});if(j()){var a=m();a.enabled&&a.token&&a.token.promise.then((function(t){return n({token:t})})).catch((function(){}))}else{if(!i.tokenRefresher){var s=function(t,e){var n=this;return new E((function(){return o.__awaiter(n,void 0,void 0,(function(){var n;return o.__generator(this,(function(r){switch(r.label){case 0:return g(t).token?[3,2]:[4,B(t,e)];case 1:return n=r.sent(),[3,4];case 2:return[4,B(t,e,!0)];case 3:n=r.sent(),r.label=4;case 4:if(n.error)throw n.error;return[2]}}))}))}),(function(){return!0}),(function(){var e=g(t);if(e.token){var n=e.token.issuedAtTimeMillis+.5*(e.token.expireTimeMillis-e.token.issuedAtTimeMillis)+3e5,r=e.token.expireTimeMillis-3e5;return n=Math.min(n,r),Math.max(0,n-Date.now())}return 0}),3e4,96e4)}(t,e);i.tokenRefresher=s}if(i.tokenRefresher.isRunning()||!0!==r.isTokenAutoRefreshEnabled||i.tokenRefresher.start(),r.token&&W(r.token)){var u=r.token;Promise.resolve().then((function(){return n({token:u.token})})).catch((function(){}))}}y(t,i)}(t,e,n)},removeTokenListener:function(e){return function(t,e){var n=g(t),r=n.tokenListeners.filter((function(t){return t!==e}));0===r.length&&n.tokenRefresher&&n.tokenRefresher.isRunning()&&n.tokenRefresher.stop(),y(t,o.__assign(o.__assign({},n),{tokenListeners:r}))}(t,e)}}}var z="app-check-internal";!function(t){t.INTERNAL.registerComponent(new i.Component("appCheck",(function(t){return G(t.getProvider("app").getImmediate())}),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((function(t,e,n){t.getProvider(z).initialize()}))),t.INTERNAL.registerComponent(new i.Component(z,(function(t){return H(t.getProvider("app").getImmediate(),t.getProvider("platform-logger"))}),"PUBLIC").setInstantiationMode("EXPLICIT")),t.registerVersion("@firebase/app-check","0.1.1")}(l.default),function(){var t=a.getGlobal();if("string"==typeof t.FIREBASE_APPCHECK_DEBUG_TOKEN||!0===t.FIREBASE_APPCHECK_DEBUG_TOKEN){var e=m();e.enabled=!0;var n=new a.Deferred;e.token=n,"string"==typeof t.FIREBASE_APPCHECK_DEBUG_TOKEN?n.resolve(t.FIREBASE_APPCHECK_DEBUG_TOKEN):n.resolve(function(){return o.__awaiter(this,void 0,void 0,(function(){var t,e;return o.__generator(this,(function(n){switch(n.label){case 0:t=void 0,n.label=1;case 1:return n.trys.push([1,3,,4]),[4,D(N)];case 2:return t=n.sent(),[3,4];case 3:return n.sent(),[3,4];case 4:return t?[2,t]:((r=e="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)})),x(N,r)).catch((function(t){return M.warn("Failed to persist debug token to indexeddb. Error: "+t)})),console.log("AppCheck debug token: "+e+". You will need to whitelist it in the Firebase console for it to work"),[2,e])}var r}))}))}())}}()},695:(t,e,n)=>{"use strict";n.r(e),n.d(e,{__extends:()=>i,__assign:()=>o,__rest:()=>a,__decorate:()=>s,__param:()=>u,__metadata:()=>c,__awaiter:()=>l,__generator:()=>h,__createBinding:()=>f,__exportStar:()=>p,__values:()=>d,__read:()=>v,__spread:()=>g,__spreadArrays:()=>y,__spreadArray:()=>m,__await:()=>b,__asyncGenerator:()=>_,__asyncDelegator:()=>w,__asyncValues:()=>I,__makeTemplateObject:()=>T,__importStar:()=>S,__importDefault:()=>C,__classPrivateFieldGet:()=>k,__classPrivateFieldSet:()=>A});var r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var o=function(){return(o=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function a(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n}function s(t,e,n,r){var i,o=arguments.length,a=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(o<3?i(a):o>3?i(e,n,a):i(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a}function u(t,e){return function(n,r){e(n,r,t)}}function c(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}function l(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))}function h(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}var f=Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]};function p(t,e){for(var n in t)"default"===n||Object.prototype.hasOwnProperty.call(e,n)||f(e,t,n)}function d(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function v(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a}function g(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(v(arguments[e]));return t}function y(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],a=0,s=o.length;a<s;a++,i++)r[i]=o[a];return r}function m(t,e){for(var n=0,r=e.length,i=t.length;n<r;n++,i++)t[i]=e[n];return t}function b(t){return this instanceof b?(this.v=t,this):new b(t)}function _(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=n.apply(t,e||[]),o=[];return r={},a("next"),a("throw"),a("return"),r[Symbol.asyncIterator]=function(){return this},r;function a(t){i[t]&&(r[t]=function(e){return new Promise((function(n,r){o.push([t,e,n,r])>1||s(t,e)}))})}function s(t,e){try{(n=i[t](e)).value instanceof b?Promise.resolve(n.value.v).then(u,c):l(o[0][2],n)}catch(t){l(o[0][3],t)}var n}function u(t){s("next",t)}function c(t){s("throw",t)}function l(t,e){t(e),o.shift(),o.length&&s(o[0][0],o[0][1])}}function w(t){var e,n;return e={},r("next"),r("throw",(function(t){throw t})),r("return"),e[Symbol.iterator]=function(){return this},e;function r(r,i){e[r]=t[r]?function(e){return(n=!n)?{value:b(t[r](e)),done:"return"===r}:i?i(e):e}:i}}function I(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,n=t[Symbol.asyncIterator];return n?n.call(t):(t=d(t),e={},r("next"),r("throw"),r("return"),e[Symbol.asyncIterator]=function(){return this},e);function r(n){e[n]=t[n]&&function(e){return new Promise((function(r,i){!function(t,e,n,r){Promise.resolve(r).then((function(e){t({value:e,done:n})}),e)}(r,i,(e=t[n](e)).done,e.value)}))}}}function T(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}var E=Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e};function S(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&f(e,t,n);return E(e,t),e}function C(t){return t&&t.__esModule?t:{default:t}}function k(t,e,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(t):r?r.value:e.get(t)}function A(t,e,n,r,i){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?i.call(t,n):i?i.value=n:e.set(t,n),n}},983:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>w,firebase:()=>_});var r=function(){return(r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};Object.create,Object.create;var i,o,a=n(448),s=n(886),u=n(594),c=((i={})["no-app"]="No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",i["bad-app-name"]="Illegal App name: '{$appName}",i["duplicate-app"]="Firebase App named '{$appName}' already exists",i["app-deleted"]="Firebase App named '{$appName}' already deleted",i["invalid-app-argument"]="firebase.{$appName}() takes either no argument or a Firebase App instance.",i["invalid-log-argument"]="First argument to `onLog` must be null or a function.",i),l=new a.ErrorFactory("app","Firebase",c),h="@firebase/app",f="[DEFAULT]",p=((o={})[h]="fire-core",o["@firebase/analytics"]="fire-analytics",o["@firebase/app-check"]="fire-app-check",o["@firebase/auth"]="fire-auth",o["@firebase/database"]="fire-rtdb",o["@firebase/functions"]="fire-fn",o["@firebase/installations"]="fire-iid",o["@firebase/messaging"]="fire-fcm",o["@firebase/performance"]="fire-perf",o["@firebase/remote-config"]="fire-rc",o["@firebase/storage"]="fire-gcs",o["@firebase/firestore"]="fire-fst",o["fire-js"]="fire-js",o["firebase-wrapper"]="fire-js-all",o),d=new u.Logger("@firebase/app"),v=function(){function t(t,e,n){var r=this;this.firebase_=n,this.isDeleted_=!1,this.name_=e.name,this.automaticDataCollectionEnabled_=e.automaticDataCollectionEnabled||!1,this.options_=(0,a.deepCopy)(t),this.container=new s.ComponentContainer(e.name),this._addComponent(new s.Component("app",(function(){return r}),"PUBLIC")),this.firebase_.INTERNAL.components.forEach((function(t){return r._addComponent(t)}))}return Object.defineProperty(t.prototype,"automaticDataCollectionEnabled",{get:function(){return this.checkDestroyed_(),this.automaticDataCollectionEnabled_},set:function(t){this.checkDestroyed_(),this.automaticDataCollectionEnabled_=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this.checkDestroyed_(),this.name_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"options",{get:function(){return this.checkDestroyed_(),this.options_},enumerable:!1,configurable:!0}),t.prototype.delete=function(){var t=this;return new Promise((function(e){t.checkDestroyed_(),e()})).then((function(){return t.firebase_.INTERNAL.removeApp(t.name_),Promise.all(t.container.getProviders().map((function(t){return t.delete()})))})).then((function(){t.isDeleted_=!0}))},t.prototype._getService=function(t,e){var n;void 0===e&&(e=f),this.checkDestroyed_();var r=this.container.getProvider(t);return r.isInitialized()||"EXPLICIT"!==(null===(n=r.getComponent())||void 0===n?void 0:n.instantiationMode)||r.initialize(),r.getImmediate({identifier:e})},t.prototype._removeServiceInstance=function(t,e){void 0===e&&(e=f),this.container.getProvider(t).clearInstance(e)},t.prototype._addComponent=function(t){try{this.container.addComponent(t)}catch(e){d.debug("Component "+t.name+" failed to register with FirebaseApp "+this.name,e)}},t.prototype._addOrOverwriteComponent=function(t){this.container.addOrOverwriteComponent(t)},t.prototype.toJSON=function(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}},t.prototype.checkDestroyed_=function(){if(this.isDeleted_)throw l.create("app-deleted",{appName:this.name_})},t}();v.prototype.name&&v.prototype.options||v.prototype.delete||console.log("dc");var g=function t(){var e=function(t){var e={},n=new Map,r={__esModule:!0,initializeApp:function(n,i){void 0===i&&(i={}),"object"==typeof i&&null!==i||(i={name:i});var o=i;void 0===o.name&&(o.name=f);var s=o.name;if("string"!=typeof s||!s)throw l.create("bad-app-name",{appName:String(s)});if((0,a.contains)(e,s))throw l.create("duplicate-app",{appName:s});var u=new t(n,o,r);return e[s]=u,u},app:i,registerVersion:function(t,e,n){var r,i=null!==(r=p[t])&&void 0!==r?r:t;n&&(i+="-"+n);var a=i.match(/\s|\//),u=e.match(/\s|\//);if(a||u){var c=['Unable to register library "'+i+'" with version "'+e+'":'];return a&&c.push('library name "'+i+'" contains illegal characters (whitespace or "/")'),a&&u&&c.push("and"),u&&c.push('version name "'+e+'" contains illegal characters (whitespace or "/")'),void d.warn(c.join(" "))}o(new s.Component(i+"-version",(function(){return{library:i,version:e}}),"VERSION"))},setLogLevel:u.setLogLevel,onLog:function(t,e){if(null!==t&&"function"!=typeof t)throw l.create("invalid-log-argument");(0,u.setUserLogHandler)(t,e)},apps:null,SDK_VERSION:"8.6.1",INTERNAL:{registerComponent:o,removeApp:function(t){delete e[t]},components:n,useAsService:function(t,e){return"serverAuth"===e?null:e}}};function i(t){if(t=t||f,!(0,a.contains)(e,t))throw l.create("no-app",{appName:t});return e[t]}function o(o){var s=o.name;if(n.has(s))return d.debug("There were multiple attempts to register component "+s+"."),"PUBLIC"===o.type?r[s]:null;if(n.set(s,o),"PUBLIC"===o.type){var u=function(t){if(void 0===t&&(t=i()),"function"!=typeof t[s])throw l.create("invalid-app-argument",{appName:s});return t[s]()};void 0!==o.serviceProps&&(0,a.deepExtend)(u,o.serviceProps),r[s]=u,t.prototype[s]=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return this._getService.bind(this,s).apply(this,o.multipleInstances?t:[])}}for(var c=0,h=Object.keys(e);c<h.length;c++){var f=h[c];e[f]._addComponent(o)}return"PUBLIC"===o.type?r[s]:null}return r.default=r,Object.defineProperty(r,"apps",{get:function(){return Object.keys(e).map((function(t){return e[t]}))}}),i.App=t,r}(v);return e.INTERNAL=r(r({},e.INTERNAL),{createFirebaseNamespace:t,extendNamespace:function(t){(0,a.deepExtend)(e,t)},createSubscribe:a.createSubscribe,ErrorFactory:a.ErrorFactory,deepExtend:a.deepExtend}),e}(),y=function(){function t(t){this.container=t}return t.prototype.getPlatformInfoString=function(){return this.container.getProviders().map((function(t){if(function(t){var e=t.getComponent();return"VERSION"===(null==e?void 0:e.type)}(t)){var e=t.getImmediate();return e.library+"/"+e.version}return null})).filter((function(t){return t})).join(" ")},t}();if((0,a.isBrowser)()&&void 0!==self.firebase){d.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");var m=self.firebase.SDK_VERSION;m&&m.indexOf("LITE")>=0&&d.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}var b=g.initializeApp;g.initializeApp=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return(0,a.isNode)()&&d.warn('\n      Warning: This is a browser-targeted Firebase bundle but it appears it is being\n      run in a Node environment.  If running in a Node environment, make sure you\n      are using the bundle specified by the "main" field in package.json.\n      \n      If you are using Webpack, you can specify "main" as the first item in\n      "resolve.mainFields":\n      https://webpack.js.org/configuration/resolve/#resolvemainfields\n      \n      If using Rollup, use the @rollup/plugin-node-resolve plugin and specify "main"\n      as the first item in "mainFields", e.g. [\'main\', \'module\'].\n      https://github.com/rollup/@rollup/plugin-node-resolve\n      '),b.apply(void 0,t)};var _=g;!function(t,e){t.INTERNAL.registerComponent(new s.Component("platform-logger",(function(t){return new y(t)}),"PRIVATE")),t.registerVersion(h,"0.6.22",void 0),t.registerVersion("fire-js","")}(_);const w=_},886:(t,e,n)=>{"use strict";n.r(e),n.d(e,{Component:()=>u,ComponentContainer:()=>h,Provider:()=>l});var r=function(){return(r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function i(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function o(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a}function a(t,e){for(var n=0,r=e.length,i=t.length;n<r;n++,i++)t[i]=e[n];return t}Object.create,Object.create;var s=n(448),u=function(){function t(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}return t.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},t.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},t.prototype.setServiceProps=function(t){return this.serviceProps=t,this},t.prototype.setInstanceCreatedCallback=function(t){return this.onInstanceCreated=t,this},t}(),c="[DEFAULT]",l=function(){function t(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.onInitCallbacks=new Set}return t.prototype.get=function(t){void 0===t&&(t=c);var e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){var n=new s.Deferred;if(this.instancesDeferred.set(e,n),this.isInitialized(e)||this.shouldAutoInitialize())try{var r=this.getOrInitializeService({instanceIdentifier:e});r&&n.resolve(r)}catch(t){}}return this.instancesDeferred.get(e).promise},t.prototype.getImmediate=function(t){var e=r({identifier:c,optional:!1},t),n=e.identifier,i=e.optional,o=this.normalizeInstanceIdentifier(n);if(!this.isInitialized(o)&&!this.shouldAutoInitialize()){if(i)return null;throw Error("Service "+this.name+" is not available")}try{return this.getOrInitializeService({instanceIdentifier:o})}catch(t){if(i)return null;throw t}},t.prototype.getComponent=function(){return this.component},t.prototype.setComponent=function(t){var e,n;if(t.name!==this.name)throw Error("Mismatching Component "+t.name+" for Provider "+this.name+".");if(this.component)throw Error("Component for "+this.name+" has already been provided");if(this.component=t,this.shouldAutoInitialize()){if(function(t){return"EAGER"===t.instantiationMode}(t))try{this.getOrInitializeService({instanceIdentifier:c})}catch(t){}try{for(var r=i(this.instancesDeferred.entries()),a=r.next();!a.done;a=r.next()){var s=o(a.value,2),u=s[0],l=s[1],h=this.normalizeInstanceIdentifier(u);try{var f=this.getOrInitializeService({instanceIdentifier:h});l.resolve(f)}catch(t){}}}catch(t){e={error:t}}finally{try{a&&!a.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}}},t.prototype.clearInstance=function(t){void 0===t&&(t=c),this.instancesDeferred.delete(t),this.instances.delete(t)},t.prototype.delete=function(){return t=this,e=void 0,r=function(){var t;return function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}(this,(function(e){switch(e.label){case 0:return t=Array.from(this.instances.values()),[4,Promise.all(a(a([],o(t.filter((function(t){return"INTERNAL"in t})).map((function(t){return t.INTERNAL.delete()})))),o(t.filter((function(t){return"_delete"in t})).map((function(t){return t._delete()})))))];case 1:return e.sent(),[2]}}))},new((n=void 0)||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}));var t,e,n,r},t.prototype.isComponentSet=function(){return null!=this.component},t.prototype.isInitialized=function(t){return void 0===t&&(t=c),this.instances.has(t)},t.prototype.initialize=function(t){var e,n;void 0===t&&(t={});var r=t.instanceIdentifier,a=void 0===r?c:r,s=t.options,u=void 0===s?{}:s,l=this.normalizeInstanceIdentifier(a);if(this.isInitialized(l))throw Error(this.name+"("+l+") has already been initialized");if(!this.isComponentSet())throw Error("Component "+this.name+" has not been registered yet");var h=this.getOrInitializeService({instanceIdentifier:l,options:u});try{for(var f=i(this.instancesDeferred.entries()),p=f.next();!p.done;p=f.next()){var d=o(p.value,2),v=d[0],g=d[1];l===this.normalizeInstanceIdentifier(v)&&g.resolve(h)}}catch(t){e={error:t}}finally{try{p&&!p.done&&(n=f.return)&&n.call(f)}finally{if(e)throw e.error}}return this.invokeOnInitCallbacks(h,l),h},t.prototype.onInit=function(t){var e=this;return this.onInitCallbacks.add(t),function(){e.onInitCallbacks.delete(t)}},t.prototype.invokeOnInitCallbacks=function(t,e){var n,r;try{for(var o=i(this.onInitCallbacks),a=o.next();!a.done;a=o.next()){var s=a.value;try{s(t,e)}catch(t){}}}catch(t){n={error:t}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}},t.prototype.getOrInitializeService=function(t){var e,n=t.instanceIdentifier,r=t.options,i=void 0===r?{}:r,o=this.instances.get(n);if(!o&&this.component&&(o=this.component.instanceFactory(this.container,{instanceIdentifier:(e=n,e===c?void 0:e),options:i}),this.instances.set(n,o),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,n,o)}catch(t){}return o||null},t.prototype.normalizeInstanceIdentifier=function(t){return this.component?this.component.multipleInstances?t:c:t},t.prototype.shouldAutoInitialize=function(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode},t}(),h=function(){function t(t){this.name=t,this.providers=new Map}return t.prototype.addComponent=function(t){var e=this.getProvider(t.name);if(e.isComponentSet())throw new Error("Component "+t.name+" has already been registered with "+this.name);e.setComponent(t)},t.prototype.addOrOverwriteComponent=function(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)},t.prototype.getProvider=function(t){if(this.providers.has(t))return this.providers.get(t);var e=new l(t,this);return this.providers.set(t,e),e},t.prototype.getProviders=function(){return Array.from(this.providers.values())},t}()},790:(t,e,n)=>{"use strict";var r=n(983),i=n(886),o=n(448),a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var u=function(){return(u=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function c(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function l(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a}function h(t,e){for(var n=0,r=e.length,i=t.length;n<r;n++,i++)t[i]=e[n];return t}Object.create,Object.create;var f=n(594);t=n.hmd(t);var p="";function d(t){p=t}var v,g=function(){function t(t){this.domStorage_=t,this.prefix_="firebase:"}return t.prototype.set=function(t,e){null==e?this.domStorage_.removeItem(this.prefixedName_(t)):this.domStorage_.setItem(this.prefixedName_(t),(0,o.stringify)(e))},t.prototype.get=function(t){var e=this.domStorage_.getItem(this.prefixedName_(t));return null==e?null:(0,o.jsonEval)(e)},t.prototype.remove=function(t){this.domStorage_.removeItem(this.prefixedName_(t))},t.prototype.prefixedName_=function(t){return this.prefix_+t},t.prototype.toString=function(){return this.domStorage_.toString()},t}(),y=function(){function t(){this.cache_={},this.isInMemoryStorage=!0}return t.prototype.set=function(t,e){null==e?delete this.cache_[t]:this.cache_[t]=e},t.prototype.get=function(t){return(0,o.contains)(this.cache_,t)?this.cache_[t]:null},t.prototype.remove=function(t){delete this.cache_[t]},t}(),m=function(t){try{if("undefined"!=typeof window&&void 0!==window[t]){var e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new g(e)}}catch(t){}return new y},b=m("localStorage"),_=m("sessionStorage"),w=new f.Logger("@firebase/database"),I=(v=1,function(){return v++}),T=function(t){var e=(0,o.stringToByteArray)(t),n=new o.Sha1;n.update(e);var r=n.digest();return o.base64.encodeByteArray(r)},E=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n="",r=0;r<t.length;r++){var i=t[r];Array.isArray(i)||i&&"object"==typeof i&&"number"==typeof i.length?n+=E.apply(null,i):n+="object"==typeof i?(0,o.stringify)(i):i,n+=" "}return n},S=null,C=!0,k=function(t,e){(0,o.assert)(!e||!0===t||!1===t,"Can't turn on custom loggers persistently."),!0===t?(w.logLevel=f.LogLevel.VERBOSE,S=w.log.bind(w),e&&_.set("logging_enabled",!0)):"function"==typeof t?S=t:(S=null,_.remove("logging_enabled"))},A=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(!0===C&&(C=!1,null===S&&!0===_.get("logging_enabled")&&k(!0)),S){var n=E.apply(null,t);S(n)}},N=function(t){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];A.apply(void 0,h([t],l(e)))}},P=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n="FIREBASE INTERNAL ERROR: "+E.apply(void 0,h([],l(t)));w.error(n)},O=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n="FIREBASE FATAL ERROR: "+E.apply(void 0,h([],l(t)));throw w.error(n),new Error(n)},R=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n="FIREBASE WARNING: "+E.apply(void 0,h([],l(t)));w.warn(n)},x=function(t){return"number"==typeof t&&(t!=t||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY)},D="[MIN_NAME]",L="[MAX_NAME]",M=function(t,e){if(t===e)return 0;if(t===D||e===L)return-1;if(e===D||t===L)return 1;var n=W(t),r=W(e);return null!==n?null!==r?n-r==0?t.length-e.length:n-r:-1:null!==r?1:t<e?-1:1},F=function(t,e){return t===e?0:t<e?-1:1},U=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+(0,o.stringify)(e))},j=function(t){if("object"!=typeof t||null===t)return(0,o.stringify)(t);var e=[];for(var n in t)e.push(n);e.sort();for(var r="{",i=0;i<e.length;i++)0!==i&&(r+=","),r+=(0,o.stringify)(e[i]),r+=":",r+=j(t[e[i]]);return r+"}"},q=function(t,e){var n=t.length;if(n<=e)return[t];for(var r=[],i=0;i<n;i+=e)i+e>n?r.push(t.substring(i,n)):r.push(t.substring(i,i+e));return r};function V(t,e){for(var n in t)t.hasOwnProperty(n)&&e(n,t[n])}var B=function(t){(0,o.assert)(!x(t),"Invalid JSON number");var e,n,r,i,a;0===t?(n=0,r=0,e=1/t==-1/0?1:0):(e=t<0,(t=Math.abs(t))>=Math.pow(2,-1022)?(n=(i=Math.min(Math.floor(Math.log(t)/Math.LN2),1023))+1023,r=Math.round(t*Math.pow(2,52-i)-Math.pow(2,52))):(n=0,r=Math.round(t/Math.pow(2,-1074))));var s=[];for(a=52;a;a-=1)s.push(r%2?1:0),r=Math.floor(r/2);for(a=11;a;a-=1)s.push(n%2?1:0),n=Math.floor(n/2);s.push(e?1:0),s.reverse();var u=s.join(""),c="";for(a=0;a<64;a+=8){var l=parseInt(u.substr(a,8),2).toString(16);1===l.length&&(l="0"+l),c+=l}return c.toLowerCase()},K=new RegExp("^-?(0*)\\d{1,10}$"),W=function(t){if(K.test(t)){var e=Number(t);if(e>=-2147483648&&e<=2147483647)return e}return null},G=function(t){try{t()}catch(t){setTimeout((function(){var e=t.stack||"";throw R("Exception was thrown by user callback.",e),t}),Math.floor(0))}},H=function(t,e){var n=setTimeout(t,e);return"object"==typeof n&&n.unref&&n.unref(),n},z=function(){function t(t,e){var n=this;this.appName_=t,this.appCheckProvider=e,this.appCheck=null==e?void 0:e.getImmediate({optional:!0}),this.appCheck||null==e||e.get().then((function(t){return n.appCheck=t}))}return t.prototype.getToken=function(t){var e=this;return this.appCheck?this.appCheck.getToken(t):new Promise((function(n,r){setTimeout((function(){e.appCheck?e.getToken(t).then(n,r):n(null)}),0)}))},t.prototype.addTokenChangeListener=function(t){var e;null===(e=this.appCheckProvider)||void 0===e||e.get().then((function(e){return e.addTokenListener(t)}))},t.prototype.notifyForInvalidToken=function(){R('Provided AppCheck credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly.')},t}(),Q=function(){function t(t,e,n){var r=this;this.appName_=t,this.firebaseOptions_=e,this.authProvider_=n,this.auth_=null,this.auth_=n.getImmediate({optional:!0}),this.auth_||n.onInit((function(t){return r.auth_=t}))}return t.prototype.getToken=function(t){var e=this;return this.auth_?this.auth_.getToken(t).catch((function(t){return t&&"auth/token-not-initialized"===t.code?(A("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)})):new Promise((function(n,r){setTimeout((function(){e.auth_?e.getToken(t).then(n,r):n(null)}),0)}))},t.prototype.addTokenChangeListener=function(t){this.auth_?this.auth_.addAuthTokenListener(t):this.authProvider_.get().then((function(e){return e.addAuthTokenListener(t)}))},t.prototype.removeTokenChangeListener=function(t){this.authProvider_.get().then((function(e){return e.removeAuthTokenListener(t)}))},t.prototype.notifyForInvalidToken=function(){var t='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?t+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?t+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':t+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',R(t)},t}(),Y=function(){function t(t){this.accessToken=t}return t.prototype.getToken=function(t){return Promise.resolve({accessToken:this.accessToken})},t.prototype.addTokenChangeListener=function(t){t(this.accessToken)},t.prototype.removeTokenChangeListener=function(t){},t.prototype.notifyForInvalidToken=function(){},t.OWNER="owner",t}(),X=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,J="websocket",$="long_polling",Z=function(){function t(t,e,n,r,i,o,a){void 0===i&&(i=!1),void 0===o&&(o=""),void 0===a&&(a=!1),this.secure=e,this.namespace=n,this.webSocketOnly=r,this.nodeAdmin=i,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this._host=t.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=b.get("host:"+t)||this._host}return t.prototype.isCacheableHost=function(){return"s-"===this.internalHost.substr(0,2)},t.prototype.isCustomHost=function(){return"firebaseio.com"!==this._domain&&"firebaseio-demo.com"!==this._domain},Object.defineProperty(t.prototype,"host",{get:function(){return this._host},set:function(t){t!==this.internalHost&&(this.internalHost=t,this.isCacheableHost()&&b.set("host:"+this._host,this.internalHost))},enumerable:!1,configurable:!0}),t.prototype.toString=function(){var t=this.toURLString();return this.persistenceKey&&(t+="<"+this.persistenceKey+">"),t},t.prototype.toURLString=function(){var t=this.secure?"https://":"http://",e=this.includeNamespaceInQueryParams?"?ns="+this.namespace:"";return""+t+this.host+"/"+e},t}();function tt(t,e,n){var r;if((0,o.assert)("string"==typeof e,"typeof type must == string"),(0,o.assert)("object"==typeof n,"typeof params must == object"),e===J)r=(t.secure?"wss://":"ws://")+t.internalHost+"/.ws?";else{if(e!==$)throw new Error("Unknown connection type: "+e);r=(t.secure?"https://":"http://")+t.internalHost+"/.lp?"}(function(t){return t.host!==t.internalHost||t.isCustomHost()||t.includeNamespaceInQueryParams})(t)&&(n.ns=t.namespace);var i=[];return V(n,(function(t,e){i.push(t+"="+e)})),r+i.join("&")}var et=function(){function t(){this.counters_={}}return t.prototype.incrementCounter=function(t,e){void 0===e&&(e=1),(0,o.contains)(this.counters_,t)||(this.counters_[t]=0),this.counters_[t]+=e},t.prototype.get=function(){return(0,o.deepCopy)(this.counters_)},t}(),nt={},rt={};function it(t){var e=t.toString();return nt[e]||(nt[e]=new et),nt[e]}var ot=function(){function t(t){this.onMessage_=t,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}return t.prototype.closeAfter=function(t,e){this.closeAfterResponse=t,this.onClose=e,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)},t.prototype.handleResponse=function(t,e){var n=this;this.pendingResponses[t]=e;for(var r=function(){var t=i.pendingResponses[i.currentResponseNum];delete i.pendingResponses[i.currentResponseNum];for(var e=function(e){t[e]&&G((function(){n.onMessage_(t[e])}))},r=0;r<t.length;++r)e(r);if(i.currentResponseNum===i.closeAfterResponse)return i.onClose&&(i.onClose(),i.onClose=null),"break";i.currentResponseNum++},i=this;this.pendingResponses[this.currentResponseNum]&&"break"!==r(););},t}(),at="start",st="close",ut=function(){function t(t,e,n,r,i,o,a){var s=this;this.connId=t,this.repoInfo=e,this.applicationId=n,this.appCheckToken=r,this.authToken=i,this.transportSessionId=o,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=N(t),this.stats_=it(e),this.urlFn=function(t){return s.appCheckToken&&(t.ac=s.appCheckToken),tt(e,$,t)}}return t.prototype.open=function(t,e){var n=this;this.curSegmentNum=0,this.onDisconnect_=e,this.myPacketOrderer=new ot(t),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout((function(){n.log_("Timed out trying to connect."),n.onClosed_(),n.connectTimeoutTimer_=null}),Math.floor(3e4)),function(t){if((0,o.isNodeSdk)()||"complete"===document.readyState)t();else{var e=!1,n=function(){document.body?e||(e=!0,t()):setTimeout(n,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",(function(){"complete"===document.readyState&&n()})),window.attachEvent("onload",n))}}((function(){if(!n.isClosed_){n.scriptTagHolder=new ct((function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=l(t,5),i=r[0],o=r[1],a=r[2];if(r[3],r[4],n.incrementIncomingBytes_(t),n.scriptTagHolder)if(n.connectTimeoutTimer_&&(clearTimeout(n.connectTimeoutTimer_),n.connectTimeoutTimer_=null),n.everConnected_=!0,i===at)n.id=o,n.password=a;else{if(i!==st)throw new Error("Unrecognized command received: "+i);o?(n.scriptTagHolder.sendNewPolls=!1,n.myPacketOrderer.closeAfter(o,(function(){n.onClosed_()}))):n.onClosed_()}}),(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=l(t,2),i=r[0],o=r[1];n.incrementIncomingBytes_(t),n.myPacketOrderer.handleResponse(i,o)}),(function(){n.onClosed_()}),n.urlFn);var t={start:"t"};t.ser=Math.floor(1e8*Math.random()),n.scriptTagHolder.uniqueCallbackIdentifier&&(t.cb=n.scriptTagHolder.uniqueCallbackIdentifier),t.v="5",n.transportSessionId&&(t.s=n.transportSessionId),n.lastSessionId&&(t.ls=n.lastSessionId),n.applicationId&&(t.p=n.applicationId),n.appCheckToken&&(t.ac=n.appCheckToken),"undefined"!=typeof location&&location.hostname&&X.test(location.hostname)&&(t.r="f");var e=n.urlFn(t);n.log_("Connecting via long-poll to "+e),n.scriptTagHolder.addTag(e,(function(){}))}}))},t.prototype.start=function(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)},t.forceAllow=function(){t.forceAllow_=!0},t.forceDisallow=function(){t.forceDisallow_=!0},t.isAvailable=function(){return!((0,o.isNodeSdk)()||!t.forceAllow_&&(t.forceDisallow_||"undefined"==typeof document||null==document.createElement||"object"==typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href)||"object"==typeof Windows&&"object"==typeof Windows.UI))},t.prototype.markConnectionHealthy=function(){},t.prototype.shutdown_=function(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)},t.prototype.onClosed_=function(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))},t.prototype.close=function(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())},t.prototype.send=function(t){var e=(0,o.stringify)(t);this.bytesSent+=e.length,this.stats_.incrementCounter("bytes_sent",e.length);for(var n=(0,o.base64Encode)(e),r=q(n,1840),i=0;i<r.length;i++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,r.length,r[i]),this.curSegmentNum++},t.prototype.addDisconnectPingFrame=function(t,e){if(!(0,o.isNodeSdk)()){this.myDisconnFrame=document.createElement("iframe");var n={dframe:"t"};n.id=t,n.pw=e,this.myDisconnFrame.src=this.urlFn(n),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}},t.prototype.incrementIncomingBytes_=function(t){var e=(0,o.stringify)(t).length;this.bytesReceived+=e,this.stats_.incrementCounter("bytes_received",e)},t}(),ct=function(){function t(e,n,r,i){if(this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,(0,o.isNodeSdk)())this.commandCB=e,this.onMessageCB=n;else{this.uniqueCallbackIdentifier=I(),window["pLPCommand"+this.uniqueCallbackIdentifier]=e,window["pRTLPCB"+this.uniqueCallbackIdentifier]=n,this.myIFrame=t.createIFrame_();var a="";this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,"javascript:".length)&&(a='<script>document.domain="'+document.domain+'";<\/script>');var s="<html><body>"+a+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(s),this.myIFrame.doc.close()}catch(t){A("frame writing exception"),t.stack&&A(t.stack),A(t)}}}return t.createIFrame_=function(){var t=document.createElement("iframe");if(t.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(t);try{t.contentWindow.document||A("No IE domain setting required")}catch(n){var e=document.domain;t.src="javascript:void((function(){document.open();document.domain='"+e+"';document.close();})())"}return t.contentDocument?t.doc=t.contentDocument:t.contentWindow?t.doc=t.contentWindow.document:t.document&&(t.doc=t.document),t},t.prototype.close=function(){var t=this;this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.innerHTML="",setTimeout((function(){null!==t.myIFrame&&(document.body.removeChild(t.myIFrame),t.myIFrame=null)}),Math.floor(0)));var e=this.onDisconnect;e&&(this.onDisconnect=null,e())},t.prototype.startLongPoll=function(t,e){for(this.myID=t,this.myPW=e,this.alive=!0;this.newRequest_(););},t.prototype.newRequest_=function(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;var t={};t.id=this.myID,t.pw=this.myPW,t.ser=this.currentSerial;for(var e=this.urlFn(t),n="",r=0;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+30+n.length<=1870;){var i=this.pendingSegs.shift();n=n+"&seg"+r+"="+i.seg+"&ts"+r+"="+i.ts+"&d"+r+"="+i.d,r++}return e+=n,this.addLongPollTag_(e,this.currentSerial),!0}return!1},t.prototype.enqueueSegment=function(t,e,n){this.pendingSegs.push({seg:t,ts:e,d:n}),this.alive&&this.newRequest_()},t.prototype.addLongPollTag_=function(t,e){var n=this;this.outstandingRequests.add(e);var r=function(){n.outstandingRequests.delete(e),n.newRequest_()},i=setTimeout(r,Math.floor(25e3));this.addTag(t,(function(){clearTimeout(i),r()}))},t.prototype.addTag=function(t,e){var n=this;(0,o.isNodeSdk)()?this.doNodeLongPoll(t,e):setTimeout((function(){try{if(!n.sendNewPolls)return;var r=n.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=t,r.onload=r.onreadystatechange=function(){var t=r.readyState;t&&"loaded"!==t&&"complete"!==t||(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),e())},r.onerror=function(){A("Long-poll script failed to load: "+t),n.sendNewPolls=!1,n.close()},n.myIFrame.doc.body.appendChild(r)}catch(t){}}),Math.floor(1))},t}(),lt=null;"undefined"!=typeof MozWebSocket?lt=MozWebSocket:"undefined"!=typeof WebSocket&&(lt=WebSocket);var ht=function(){function t(e,n,r,i,o,a,s){this.connId=e,this.applicationId=r,this.appCheckToken=i,this.authToken=o,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=N(this.connId),this.stats_=it(n),this.connURL=t.connectionURL_(n,a,s,i),this.nodeAdmin=n.nodeAdmin}return t.connectionURL_=function(t,e,n,r){var i={v:"5"};return!(0,o.isNodeSdk)()&&"undefined"!=typeof location&&location.hostname&&X.test(location.hostname)&&(i.r="f"),e&&(i.s=e),n&&(i.ls=n),r&&(i.ac=r),tt(t,J,i)},t.prototype.open=function(t,e){var n=this;this.onDisconnect=e,this.onMessage=t,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,b.set("previous_websocket_failure",!0);try{if((0,o.isNodeSdk)()){var r=this.nodeAdmin?"AdminNode":"Node",i={headers:{"User-Agent":"Firebase/5/"+p+"/"+process.platform+"/"+r,"X-Firebase-GMPID":this.applicationId||""}};this.nodeAdmin?i.headers.Authorization=this.authToken||"":i.headers["X-Firebase-AppCheck"]=this.appCheckToken||"";var a=process.env,s=0===this.connURL.indexOf("wss://")?a.HTTPS_PROXY||a.https_proxy:a.HTTP_PROXY||a.http_proxy;s&&(i.proxy={origin:s}),this.mySock=new lt(this.connURL,[],i)}else i={headers:{"X-Firebase-GMPID":this.applicationId||"","X-Firebase-AppCheck":this.appCheckToken||""}},this.mySock=new lt(this.connURL,[],i)}catch(t){this.log_("Error instantiating WebSocket.");var u=t.message||t.data;return u&&this.log_(u),void this.onClosed_()}this.mySock.onopen=function(){n.log_("Websocket connected."),n.everConnected_=!0},this.mySock.onclose=function(){n.log_("Websocket connection was disconnected."),n.mySock=null,n.onClosed_()},this.mySock.onmessage=function(t){n.handleIncomingFrame(t)},this.mySock.onerror=function(t){n.log_("WebSocket error.  Closing connection.");var e=t.message||t.data;e&&n.log_(e),n.onClosed_()}},t.prototype.start=function(){},t.forceDisallow=function(){t.forceDisallow_=!0},t.isAvailable=function(){var e=!1;if("undefined"!=typeof navigator&&navigator.userAgent){var n=navigator.userAgent.match(/Android ([0-9]{0,}\.[0-9]{0,})/);n&&n.length>1&&parseFloat(n[1])<4.4&&(e=!0)}return!e&&null!==lt&&!t.forceDisallow_},t.previouslyFailed=function(){return b.isInMemoryStorage||!0===b.get("previous_websocket_failure")},t.prototype.markConnectionHealthy=function(){b.remove("previous_websocket_failure")},t.prototype.appendFrame_=function(t){if(this.frames.push(t),this.frames.length===this.totalFrames){var e=this.frames.join("");this.frames=null;var n=(0,o.jsonEval)(e);this.onMessage(n)}},t.prototype.handleNewFrameCount_=function(t){this.totalFrames=t,this.frames=[]},t.prototype.extractFrameCount_=function(t){if((0,o.assert)(null===this.frames,"We already have a frame buffer"),t.length<=6){var e=Number(t);if(!isNaN(e))return this.handleNewFrameCount_(e),null}return this.handleNewFrameCount_(1),t},t.prototype.handleIncomingFrame=function(t){if(null!==this.mySock){var e=t.data;if(this.bytesReceived+=e.length,this.stats_.incrementCounter("bytes_received",e.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(e);else{var n=this.extractFrameCount_(e);null!==n&&this.appendFrame_(n)}}},t.prototype.send=function(t){this.resetKeepAlive();var e=(0,o.stringify)(t);this.bytesSent+=e.length,this.stats_.incrementCounter("bytes_sent",e.length);var n=q(e,16384);n.length>1&&this.sendString_(String(n.length));for(var r=0;r<n.length;r++)this.sendString_(n[r])},t.prototype.shutdown_=function(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)},t.prototype.onClosed_=function(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))},t.prototype.close=function(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())},t.prototype.resetKeepAlive=function(){var t=this;clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval((function(){t.mySock&&t.sendString_("0"),t.resetKeepAlive()}),Math.floor(45e3))},t.prototype.sendString_=function(t){try{this.mySock.send(t)}catch(t){this.log_("Exception thrown from WebSocket.send():",t.message||t.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}},t.responsesRequiredToBeHealthy=2,t.healthyTimeout=3e4,t}(),ft=function(){function t(t){this.initTransports_(t)}return Object.defineProperty(t,"ALL_TRANSPORTS",{get:function(){return[ut,ht]},enumerable:!1,configurable:!0}),t.prototype.initTransports_=function(e){var n,r,i=ht&&ht.isAvailable(),o=i&&!ht.previouslyFailed();if(e.webSocketOnly&&(i||R("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),o=!0),o)this.transports_=[ht];else{var a=this.transports_=[];try{for(var s=c(t.ALL_TRANSPORTS),u=s.next();!u.done;u=s.next()){var l=u.value;l&&l.isAvailable()&&a.push(l)}}catch(t){n={error:t}}finally{try{u&&!u.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}}},t.prototype.initialTransport=function(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")},t.prototype.upgradeTransport=function(){return this.transports_.length>1?this.transports_[1]:null},t}(),pt=function(){function t(t,e,n,r,i,o,a,s,u,c){this.id=t,this.repoInfo_=e,this.applicationId_=n,this.appCheckToken_=r,this.authToken_=i,this.onMessage_=o,this.onReady_=a,this.onDisconnect_=s,this.onKill_=u,this.lastSessionId=c,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=N("c:"+this.id+":"),this.transportManager_=new ft(e),this.log_("Connection created"),this.start_()}return t.prototype.start_=function(){var t=this,e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;var n=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout((function(){t.conn_&&t.conn_.open(n,r)}),Math.floor(0));var i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=H((function(){t.healthyTimeout_=null,t.isHealthy_||(t.conn_&&t.conn_.bytesReceived>102400?(t.log_("Connection exceeded healthy timeout but has received "+t.conn_.bytesReceived+" bytes.  Marking connection healthy."),t.isHealthy_=!0,t.conn_.markConnectionHealthy()):t.conn_&&t.conn_.bytesSent>10240?t.log_("Connection exceeded healthy timeout but has sent "+t.conn_.bytesSent+" bytes.  Leaving connection alive."):(t.log_("Closing unhealthy connection after timeout."),t.close()))}),Math.floor(i)))},t.prototype.nextTransportId_=function(){return"c:"+this.id+":"+this.connectionCount++},t.prototype.disconnReceiver_=function(t){var e=this;return function(n){t===e.conn_?e.onConnectionLost_(n):t===e.secondaryConn_?(e.log_("Secondary connection lost."),e.onSecondaryConnectionLost_()):e.log_("closing an old connection")}},t.prototype.connReceiver_=function(t){var e=this;return function(n){2!==e.state_&&(t===e.rx_?e.onPrimaryMessageReceived_(n):t===e.secondaryConn_?e.onSecondaryMessageReceived_(n):e.log_("message on old connection"))}},t.prototype.sendRequest=function(t){var e={t:"d",d:t};this.sendData_(e)},t.prototype.tryCleanupConnection=function(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)},t.prototype.onSecondaryControl_=function(t){if("t"in t){var e=t.t;"a"===e?this.upgradeIfSecondaryHealthy_():"r"===e?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),this.tx_!==this.secondaryConn_&&this.rx_!==this.secondaryConn_||this.close()):"o"===e&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}},t.prototype.onSecondaryMessageReceived_=function(t){var e=U("t",t),n=U("d",t);if("c"===e)this.onSecondaryControl_(n);else{if("d"!==e)throw new Error("Unknown protocol layer: "+e);this.pendingDataMessages.push(n)}},t.prototype.upgradeIfSecondaryHealthy_=function(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))},t.prototype.proceedWithUpgrade_=function(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()},t.prototype.onPrimaryMessageReceived_=function(t){var e=U("t",t),n=U("d",t);"c"===e?this.onControl_(n):"d"===e&&this.onDataMessage_(n)},t.prototype.onDataMessage_=function(t){this.onPrimaryResponse_(),this.onMessage_(t)},t.prototype.onPrimaryResponse_=function(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))},t.prototype.onControl_=function(t){var e=U("t",t);if("d"in t){var n=t.d;if("h"===e)this.onHandshake_(n);else if("n"===e){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(var r=0;r<this.pendingDataMessages.length;++r)this.onDataMessage_(this.pendingDataMessages[r]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===e?this.onConnectionShutdown_(n):"r"===e?this.onReset_(n):"e"===e?P("Server Error: "+n):"o"===e?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):P("Unknown control packet command: "+e)}},t.prototype.onHandshake_=function(t){var e=t.ts,n=t.v,r=t.h;this.sessionId=t.s,this.repoInfo_.host=r,0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,e),"5"!==n&&R("Protocol version mismatch detected"),this.tryStartUpgrade_())},t.prototype.tryStartUpgrade_=function(){var t=this.transportManager_.upgradeTransport();t&&this.startUpgrade_(t)},t.prototype.startUpgrade_=function(t){var e=this;this.secondaryConn_=new t(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=t.responsesRequiredToBeHealthy||0;var n=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,r),H((function(){e.secondaryConn_&&(e.log_("Timed out trying to upgrade."),e.secondaryConn_.close())}),Math.floor(6e4))},t.prototype.onReset_=function(t){this.log_("Reset packet received.  New host: "+t),this.repoInfo_.host=t,1===this.state_?this.close():(this.closeConnections_(),this.start_())},t.prototype.onConnectionEstablished_=function(t,e){var n=this;this.log_("Realtime connection established."),this.conn_=t,this.state_=1,this.onReady_&&(this.onReady_(e,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):H((function(){n.sendPingOnPrimaryIfNecessary_()}),Math.floor(5e3))},t.prototype.sendPingOnPrimaryIfNecessary_=function(){this.isHealthy_||1!==this.state_||(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))},t.prototype.onSecondaryConnectionLost_=function(){var t=this.secondaryConn_;this.secondaryConn_=null,this.tx_!==t&&this.rx_!==t||this.close()},t.prototype.onConnectionLost_=function(t){this.conn_=null,t||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(b.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()},t.prototype.onConnectionShutdown_=function(t){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(t),this.onKill_=null),this.onDisconnect_=null,this.close()},t.prototype.sendData_=function(t){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(t)},t.prototype.close=function(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))},t.prototype.closeConnections_=function(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)},t}(),dt=function(){function t(){}return t.prototype.put=function(t,e,n,r){},t.prototype.merge=function(t,e,n,r){},t.prototype.refreshAuthToken=function(t){},t.prototype.refreshAppCheckToken=function(t){},t.prototype.onDisconnectPut=function(t,e,n){},t.prototype.onDisconnectMerge=function(t,e,n){},t.prototype.onDisconnectCancel=function(t,e){},t.prototype.reportStats=function(t){},t}(),vt=function(){function t(t){this.allowedEvents_=t,this.listeners_={},(0,o.assert)(Array.isArray(t)&&t.length>0,"Requires a non-empty array")}return t.prototype.trigger=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Array.isArray(this.listeners_[t]))for(var r=h([],l(this.listeners_[t])),i=0;i<r.length;i++)r[i].callback.apply(r[i].context,e)},t.prototype.on=function(t,e,n){this.validateEventType_(t),this.listeners_[t]=this.listeners_[t]||[],this.listeners_[t].push({callback:e,context:n});var r=this.getInitialEvent(t);r&&e.apply(n,r)},t.prototype.off=function(t,e,n){this.validateEventType_(t);for(var r=this.listeners_[t]||[],i=0;i<r.length;i++)if(r[i].callback===e&&(!n||n===r[i].context))return void r.splice(i,1)},t.prototype.validateEventType_=function(t){(0,o.assert)(this.allowedEvents_.find((function(e){return e===t})),"Unknown event: "+t)},t}(),gt=function(t){function e(){var e=t.call(this,["online"])||this;return e.online_=!0,"undefined"==typeof window||void 0===window.addEventListener||(0,o.isMobileCordova)()||(window.addEventListener("online",(function(){e.online_||(e.online_=!0,e.trigger("online",!0))}),!1),window.addEventListener("offline",(function(){e.online_&&(e.online_=!1,e.trigger("online",!1))}),!1)),e}return s(e,t),e.getInstance=function(){return new e},e.prototype.getInitialEvent=function(t){return(0,o.assert)("online"===t,"Unknown event type: "+t),[this.online_]},e.prototype.currentlyOnline=function(){return this.online_},e}(vt),yt=function(){function t(t,e){if(void 0===e){this.pieces_=t.split("/");for(var n=0,r=0;r<this.pieces_.length;r++)this.pieces_[r].length>0&&(this.pieces_[n]=this.pieces_[r],n++);this.pieces_.length=n,this.pieceNum_=0}else this.pieces_=t,this.pieceNum_=e}return t.prototype.toString=function(){for(var t="",e=this.pieceNum_;e<this.pieces_.length;e++)""!==this.pieces_[e]&&(t+="/"+this.pieces_[e]);return t||"/"},t}();function mt(){return new yt("")}function bt(t){return t.pieceNum_>=t.pieces_.length?null:t.pieces_[t.pieceNum_]}function _t(t){return t.pieces_.length-t.pieceNum_}function wt(t){var e=t.pieceNum_;return e<t.pieces_.length&&e++,new yt(t.pieces_,e)}function It(t){return t.pieceNum_<t.pieces_.length?t.pieces_[t.pieces_.length-1]:null}function Tt(t,e){return void 0===e&&(e=0),t.pieces_.slice(t.pieceNum_+e)}function Et(t){if(t.pieceNum_>=t.pieces_.length)return null;for(var e=[],n=t.pieceNum_;n<t.pieces_.length-1;n++)e.push(t.pieces_[n]);return new yt(e,0)}function St(t,e){for(var n=[],r=t.pieceNum_;r<t.pieces_.length;r++)n.push(t.pieces_[r]);if(e instanceof yt)for(r=e.pieceNum_;r<e.pieces_.length;r++)n.push(e.pieces_[r]);else{var i=e.split("/");for(r=0;r<i.length;r++)i[r].length>0&&n.push(i[r])}return new yt(n,0)}function Ct(t){return t.pieceNum_>=t.pieces_.length}function kt(t,e){var n=bt(t),r=bt(e);if(null===n)return e;if(n===r)return kt(wt(t),wt(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+t+")")}function At(t,e){for(var n=Tt(t,0),r=Tt(e,0),i=0;i<n.length&&i<r.length;i++){var o=M(n[i],r[i]);if(0!==o)return o}return n.length===r.length?0:n.length<r.length?-1:1}function Nt(t,e){if(_t(t)!==_t(e))return!1;for(var n=t.pieceNum_,r=e.pieceNum_;n<=t.pieces_.length;n++,r++)if(t.pieces_[n]!==e.pieces_[r])return!1;return!0}function Pt(t,e){var n=t.pieceNum_,r=e.pieceNum_;if(_t(t)>_t(e))return!1;for(;n<t.pieces_.length;){if(t.pieces_[n]!==e.pieces_[r])return!1;++n,++r}return!0}var Ot=function(t,e){this.errorPrefix_=e,this.parts_=Tt(t,0),this.byteLength_=Math.max(1,this.parts_.length);for(var n=0;n<this.parts_.length;n++)this.byteLength_+=(0,o.stringLength)(this.parts_[n]);Rt(this)};function Rt(t){if(t.byteLength_>768)throw new Error(t.errorPrefix_+"has a key path longer than 768 bytes ("+t.byteLength_+").");if(t.parts_.length>32)throw new Error(t.errorPrefix_+"path specified exceeds the maximum depth that can be written (32) or object contains a cycle "+xt(t))}function xt(t){return 0===t.parts_.length?"":"in property '"+t.parts_.join(".")+"'"}var Dt,Lt,Mt=function(t){function e(){var e,n,r=t.call(this,["visible"])||this;return"undefined"!=typeof document&&void 0!==document.addEventListener&&(void 0!==document.hidden?(n="visibilitychange",e="hidden"):void 0!==document.mozHidden?(n="mozvisibilitychange",e="mozHidden"):void 0!==document.msHidden?(n="msvisibilitychange",e="msHidden"):void 0!==document.webkitHidden&&(n="webkitvisibilitychange",e="webkitHidden")),r.visible_=!0,n&&document.addEventListener(n,(function(){var t=!document[e];t!==r.visible_&&(r.visible_=t,r.trigger("visible",t))}),!1),r}return s(e,t),e.getInstance=function(){return new e},e.prototype.getInitialEvent=function(t){return(0,o.assert)("visible"===t,"Unknown event type: "+t),[this.visible_]},e}(vt),Ft=1e3,Ut=function(t){function e(n,r,i,a,s,u,c,l){var h=t.call(this)||this;if(h.repoInfo_=n,h.applicationId_=r,h.onDataUpdate_=i,h.onConnectStatus_=a,h.onServerInfoUpdate_=s,h.authTokenProvider_=u,h.appCheckTokenProvider_=c,h.authOverride_=l,h.id=e.nextPersistentConnectionId_++,h.log_=N("p:"+h.id+":"),h.interruptReasons_={},h.listens=new Map,h.outstandingPuts_=[],h.outstandingGets_=[],h.outstandingPutCount_=0,h.outstandingGetCount_=0,h.onDisconnectRequestQueue_=[],h.connected_=!1,h.reconnectDelay_=Ft,h.maxReconnectDelay_=3e5,h.securityDebugCallback_=null,h.lastSessionId=null,h.establishConnectionTimer_=null,h.visible_=!1,h.requestCBHash_={},h.requestNumber_=0,h.realtime_=null,h.authToken_=null,h.appCheckToken_=null,h.forceTokenRefresh_=!1,h.invalidAuthTokenCount_=0,h.invalidAppCheckTokenCount_=0,h.firstConnection_=!0,h.lastConnectionAttemptTime_=null,h.lastConnectionEstablishedTime_=null,l&&!(0,o.isNodeSdk)())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");return Mt.getInstance().on("visible",h.onVisible_,h),-1===n.host.indexOf("fblocal")&&gt.getInstance().on("online",h.onOnline_,h),h}return s(e,t),e.prototype.sendRequest=function(t,e,n){var r=++this.requestNumber_,i={r,a:t,b:e};this.log_((0,o.stringify)(i)),(0,o.assert)(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(i),n&&(this.requestCBHash_[r]=n)},e.prototype.get=function(t){var e=this;this.initConnection_();var n=new o.Deferred,r={p:t._path.toString(),q:t._queryObject},i={action:"g",request:r,onComplete:function(t){var i=t.d;"ok"===t.s?(e.onDataUpdate_(r.p,i,!1,null),n.resolve(i)):n.reject(i)}};this.outstandingGets_.push(i),this.outstandingGetCount_++;var a=this.outstandingGets_.length-1;return this.connected_||setTimeout((function(){var t=e.outstandingGets_[a];void 0!==t&&i===t&&(delete e.outstandingGets_[a],e.outstandingGetCount_--,0===e.outstandingGetCount_&&(e.outstandingGets_=[]),e.log_("get "+a+" timed out on connection"),n.reject(new Error("Client is offline.")))}),3e3),this.connected_&&this.sendGet_(a),n.promise},e.prototype.listen=function(t,e,n,r){this.initConnection_();var i=t._queryIdentifier,a=t._path.toString();this.log_("Listen called for "+a+" "+i),this.listens.has(a)||this.listens.set(a,new Map),(0,o.assert)(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"listen() called for non-default but complete query"),(0,o.assert)(!this.listens.get(a).has(i),"listen() called twice for same path/queryId.");var s={onComplete:r,hashFn:e,query:t,tag:n};this.listens.get(a).set(i,s),this.connected_&&this.sendListen_(s)},e.prototype.sendGet_=function(t){var e=this,n=this.outstandingGets_[t];this.sendRequest("g",n.request,(function(r){delete e.outstandingGets_[t],e.outstandingGetCount_--,0===e.outstandingGetCount_&&(e.outstandingGets_=[]),n.onComplete&&n.onComplete(r)}))},e.prototype.sendListen_=function(t){var n=this,r=t.query,i=r._path.toString(),o=r._queryIdentifier;this.log_("Listen on "+i+" for "+o);var a={p:i};t.tag&&(a.q=r._queryObject,a.t=t.tag),a.h=t.hashFn(),this.sendRequest("q",a,(function(a){var s=a.d,u=a.s;e.warnOnListenWarnings_(s,r),(n.listens.get(i)&&n.listens.get(i).get(o))===t&&(n.log_("listen response",a),"ok"!==u&&n.removeListen_(i,o),t.onComplete&&t.onComplete(u,s))}))},e.warnOnListenWarnings_=function(t,e){if(t&&"object"==typeof t&&(0,o.contains)(t,"w")){var n=(0,o.safeGet)(t,"w");if(Array.isArray(n)&&~n.indexOf("no_index")){var r='".indexOn": "'+e._queryParams.getIndex().toString()+'"',i=e._path.toString();R("Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding "+r+" at "+i+" to your security rules for better performance.")}}},e.prototype.refreshAuthToken=function(t){this.authToken_=t,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},(function(){})),this.reduceReconnectDelayIfAdminCredential_(t)},e.prototype.reduceReconnectDelayIfAdminCredential_=function(t){(t&&40===t.length||(0,o.isAdmin)(t))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)},e.prototype.refreshAppCheckToken=function(t){this.appCheckToken_=t,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},(function(){}))},e.prototype.tryAuth=function(){var t=this;if(this.connected_&&this.authToken_){var e=this.authToken_,n=(0,o.isValidFormat)(e)?"auth":"gauth",r={cred:e};null===this.authOverride_?r.noauth=!0:"object"==typeof this.authOverride_&&(r.authvar=this.authOverride_),this.sendRequest(n,r,(function(n){var r=n.s,i=n.d||"error";t.authToken_===e&&("ok"===r?t.invalidAuthTokenCount_=0:t.onAuthRevoked_(r,i))}))}},e.prototype.tryAppCheck=function(){var t=this;this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},(function(e){var n=e.s,r=e.d||"error";"ok"===n?t.invalidAppCheckTokenCount_=0:t.onAppCheckRevoked_(n,r)}))},e.prototype.unlisten=function(t,e){var n=t._path.toString(),r=t._queryIdentifier;this.log_("Unlisten called for "+n+" "+r),(0,o.assert)(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(n,r)&&this.connected_&&this.sendUnlisten_(n,r,t._queryObject,e)},e.prototype.sendUnlisten_=function(t,e,n,r){this.log_("Unlisten on "+t+" for "+e);var i={p:t};r&&(i.q=n,i.t=r),this.sendRequest("n",i)},e.prototype.onDisconnectPut=function(t,e,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",t,e,n):this.onDisconnectRequestQueue_.push({pathString:t,action:"o",data:e,onComplete:n})},e.prototype.onDisconnectMerge=function(t,e,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",t,e,n):this.onDisconnectRequestQueue_.push({pathString:t,action:"om",data:e,onComplete:n})},e.prototype.onDisconnectCancel=function(t,e){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",t,null,e):this.onDisconnectRequestQueue_.push({pathString:t,action:"oc",data:null,onComplete:e})},e.prototype.sendOnDisconnect_=function(t,e,n,r){var i={p:e,d:n};this.log_("onDisconnect "+t,i),this.sendRequest(t,i,(function(t){r&&setTimeout((function(){r(t.s,t.d)}),Math.floor(0))}))},e.prototype.put=function(t,e,n,r){this.putInternal("p",t,e,n,r)},e.prototype.merge=function(t,e,n,r){this.putInternal("m",t,e,n,r)},e.prototype.putInternal=function(t,e,n,r,i){this.initConnection_();var o={p:e,d:n};void 0!==i&&(o.h=i),this.outstandingPuts_.push({action:t,request:o,onComplete:r}),this.outstandingPutCount_++;var a=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(a):this.log_("Buffering put: "+e)},e.prototype.sendPut_=function(t){var e=this,n=this.outstandingPuts_[t].action,r=this.outstandingPuts_[t].request,i=this.outstandingPuts_[t].onComplete;this.outstandingPuts_[t].queued=this.connected_,this.sendRequest(n,r,(function(r){e.log_(n+" response",r),delete e.outstandingPuts_[t],e.outstandingPutCount_--,0===e.outstandingPutCount_&&(e.outstandingPuts_=[]),i&&i(r.s,r.d)}))},e.prototype.reportStats=function(t){var e=this;if(this.connected_){var n={c:t};this.log_("reportStats",n),this.sendRequest("s",n,(function(t){if("ok"!==t.s){var n=t.d;e.log_("reportStats","Error sending stats: "+n)}}))}},e.prototype.onDataMessage_=function(t){if("r"in t){this.log_("from server: "+(0,o.stringify)(t));var e=t.r,n=this.requestCBHash_[e];n&&(delete this.requestCBHash_[e],n(t.b))}else{if("error"in t)throw"A server-side error has occurred: "+t.error;"a"in t&&this.onDataPush_(t.a,t.b)}},e.prototype.onDataPush_=function(t,e){this.log_("handleServerMessage",t,e),"d"===t?this.onDataUpdate_(e.p,e.d,!1,e.t):"m"===t?this.onDataUpdate_(e.p,e.d,!0,e.t):"c"===t?this.onListenRevoked_(e.p,e.q):"ac"===t?this.onAuthRevoked_(e.s,e.d):"apc"===t?this.onAppCheckRevoked_(e.s,e.d):"sd"===t?this.onSecurityDebugPacket_(e):P("Unrecognized action received from server: "+(0,o.stringify)(t)+"\nAre you using the latest client?")},e.prototype.onReady_=function(t,e){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(t),this.lastSessionId=e,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)},e.prototype.scheduleConnect_=function(t){var e=this;(0,o.assert)(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout((function(){e.establishConnectionTimer_=null,e.establishConnection_()}),Math.floor(t))},e.prototype.initConnection_=function(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)},e.prototype.onVisible_=function(t){t&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Ft,this.realtime_||this.scheduleConnect_(0)),this.visible_=t},e.prototype.onOnline_=function(t){t?(this.log_("Browser went online."),this.reconnectDelay_=Ft,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())},e.prototype.onRealtimeDisconnect_=function(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&((new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=Ft),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime());var t=(new Date).getTime()-this.lastConnectionAttemptTime_,e=Math.max(0,this.reconnectDelay_-t);e=Math.random()*e,this.log_("Trying to reconnect in "+e+"ms"),this.scheduleConnect_(e),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)},e.prototype.establishConnection_=function(){return t=this,n=void 0,i=function(){var t,n,r,i,a,s,u,c,h,f,p,d,v,g,y=this;return function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}(this,(function(m){switch(m.label){case 0:if(!this.shouldReconnect_())return[3,4];this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=(new Date).getTime(),this.lastConnectionEstablishedTime_=null,t=this.onDataMessage_.bind(this),n=this.onReady_.bind(this),r=this.onRealtimeDisconnect_.bind(this),i=this.id+":"+e.nextConnectionId_++,a=this.lastSessionId,s=!1,u=null,c=function(){u?u.close():(s=!0,r())},h=function(t){(0,o.assert)(u,"sendRequest call when we're not connected not allowed."),u.sendRequest(t)},this.realtime_={close:c,sendRequest:h},f=this.forceTokenRefresh_,this.forceTokenRefresh_=!1,m.label=1;case 1:return m.trys.push([1,3,,4]),[4,Promise.all([this.authTokenProvider_.getToken(f),this.appCheckTokenProvider_.getToken(f)])];case 2:return p=l.apply(void 0,[m.sent(),2]),d=p[0],v=p[1],s?A("getToken() completed but was canceled"):(A("getToken() completed. Creating connection."),this.authToken_=d&&d.accessToken,this.appCheckToken_=v&&v.token,u=new pt(i,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,t,n,r,(function(t){R(t+" ("+y.repoInfo_.toString()+")"),y.interrupt("server_kill")}),a)),[3,4];case 3:return g=m.sent(),this.log_("Failed to get token: "+g),s||(this.repoInfo_.nodeAdmin&&R(g),c()),[3,4];case 4:return[2]}}))},new((r=void 0)||(r=Promise))((function(e,o){function a(t){try{u(i.next(t))}catch(t){o(t)}}function s(t){try{u(i.throw(t))}catch(t){o(t)}}function u(t){var n;t.done?e(t.value):(n=t.value,n instanceof r?n:new r((function(t){t(n)}))).then(a,s)}u((i=i.apply(t,n||[])).next())}));var t,n,r,i},e.prototype.interrupt=function(t){A("Interrupting connection for reason: "+t),this.interruptReasons_[t]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())},e.prototype.resume=function(t){A("Resuming connection for reason: "+t),delete this.interruptReasons_[t],(0,o.isEmpty)(this.interruptReasons_)&&(this.reconnectDelay_=Ft,this.realtime_||this.scheduleConnect_(0))},e.prototype.handleTimestamp_=function(t){var e=t-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:e})},e.prototype.cancelSentTransactions_=function(){for(var t=0;t<this.outstandingPuts_.length;t++){var e=this.outstandingPuts_[t];e&&"h"in e.request&&e.queued&&(e.onComplete&&e.onComplete("disconnect"),delete this.outstandingPuts_[t],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])},e.prototype.onListenRevoked_=function(t,e){var n;n=e?e.map((function(t){return j(t)})).join("$"):"default";var r=this.removeListen_(t,n);r&&r.onComplete&&r.onComplete("permission_denied")},e.prototype.removeListen_=function(t,e){var n,r=new yt(t).toString();if(this.listens.has(r)){var i=this.listens.get(r);n=i.get(e),i.delete(e),0===i.size&&this.listens.delete(r)}else n=void 0;return n},e.prototype.onAuthRevoked_=function(t,e){A("Auth token revoked: "+t+"/"+e),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),"invalid_token"!==t&&"permission_denied"!==t||(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))},e.prototype.onAppCheckRevoked_=function(t,e){A("App check token revoked: "+t+"/"+e),this.appCheckToken_=null,this.forceTokenRefresh_=!0,"invalid_token"!==t&&"permission_denied"!==t||(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=3&&this.appCheckTokenProvider_.notifyForInvalidToken())},e.prototype.onSecurityDebugPacket_=function(t){this.securityDebugCallback_?this.securityDebugCallback_(t):"msg"in t&&console.log("FIREBASE: "+t.msg.replace("\n","\nFIREBASE: "))},e.prototype.restoreState_=function(){var t,e,n,r;this.tryAuth(),this.tryAppCheck();try{for(var i=c(this.listens.values()),o=i.next();!o.done;o=i.next()){var a=o.value;try{for(var s=(n=void 0,c(a.values())),u=s.next();!u.done;u=s.next()){var l=u.value;this.sendListen_(l)}}catch(t){n={error:t}}finally{try{u&&!u.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}}}catch(e){t={error:e}}finally{try{o&&!o.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}for(var h=0;h<this.outstandingPuts_.length;h++)this.outstandingPuts_[h]&&this.sendPut_(h);for(;this.onDisconnectRequestQueue_.length;){var f=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(f.action,f.pathString,f.data,f.onComplete)}for(h=0;h<this.outstandingGets_.length;h++)this.outstandingGets_[h]&&this.sendGet_(h)},e.prototype.sendConnectStats_=function(){var t={},e="js";(0,o.isNodeSdk)()&&(e=this.repoInfo_.nodeAdmin?"admin_node":"node"),t["sdk."+e+"."+p.replace(/\./g,"-")]=1,(0,o.isMobileCordova)()?t["framework.cordova"]=1:(0,o.isReactNative)()&&(t["framework.reactnative"]=1),this.reportStats(t)},e.prototype.shouldReconnect_=function(){var t=gt.getInstance().currentlyOnline();return(0,o.isEmpty)(this.interruptReasons_)&&t},e.nextPersistentConnectionId_=0,e.nextConnectionId_=0,e}(dt),jt=function(){function t(t,e){this.name=t,this.node=e}return t.Wrap=function(e,n){return new t(e,n)},t}(),qt=function(){function t(){}return t.prototype.getCompare=function(){return this.compare.bind(this)},t.prototype.indexedValueChanged=function(t,e){var n=new jt(D,t),r=new jt(D,e);return 0!==this.compare(n,r)},t.prototype.minPost=function(){return jt.MIN},t}(),Vt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),Object.defineProperty(e,"__EMPTY_NODE",{get:function(){return Dt},set:function(t){Dt=t},enumerable:!1,configurable:!0}),e.prototype.compare=function(t,e){return M(t.name,e.name)},e.prototype.isDefinedOn=function(t){throw(0,o.assertionError)("KeyIndex.isDefinedOn not expected to be called.")},e.prototype.indexedValueChanged=function(t,e){return!1},e.prototype.minPost=function(){return jt.MIN},e.prototype.maxPost=function(){return new jt(L,Dt)},e.prototype.makePost=function(t,e){return(0,o.assert)("string"==typeof t,"KeyIndex indexValue must always be a string."),new jt(t,Dt)},e.prototype.toString=function(){return".key"},e}(qt),Bt=new Vt,Kt=function(){function t(t,e,n,r,i){void 0===i&&(i=null),this.isReverse_=r,this.resultGenerator_=i,this.nodeStack_=[];for(var o=1;!t.isEmpty();)if(t=t,o=e?n(t.key,e):1,r&&(o*=-1),o<0)t=this.isReverse_?t.left:t.right;else{if(0===o){this.nodeStack_.push(t);break}this.nodeStack_.push(t),t=this.isReverse_?t.right:t.left}}return t.prototype.getNext=function(){if(0===this.nodeStack_.length)return null;var t,e=this.nodeStack_.pop();if(t=this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t},t.prototype.hasNext=function(){return this.nodeStack_.length>0},t.prototype.peek=function(){if(0===this.nodeStack_.length)return null;var t=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value}},t}(),Wt=function(){function t(e,n,r,i,o){this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:Ht.EMPTY_NODE,this.right=null!=o?o:Ht.EMPTY_NODE}return t.prototype.copy=function(e,n,r,i,o){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},t.prototype.count=function(){return this.left.count()+1+this.right.count()},t.prototype.isEmpty=function(){return!1},t.prototype.inorderTraversal=function(t){return this.left.inorderTraversal(t)||!!t(this.key,this.value)||this.right.inorderTraversal(t)},t.prototype.reverseTraversal=function(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)},t.prototype.min_=function(){return this.left.isEmpty()?this:this.left.min_()},t.prototype.minKey=function(){return this.min_().key},t.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},t.prototype.insert=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.insert(t,e,n))).fixUp_()},t.prototype.removeMin_=function(){if(this.left.isEmpty())return Ht.EMPTY_NODE;var t=this;return t.left.isRed_()||t.left.left.isRed_()||(t=t.moveRedLeft_()),(t=t.copy(null,null,null,t.left.removeMin_(),null)).fixUp_()},t.prototype.remove=function(t,e){var n,r;if(e(t,(n=this).key)<0)n.left.isEmpty()||n.left.isRed_()||n.left.left.isRed_()||(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.remove(t,e),null);else{if(n.left.isRed_()&&(n=n.rotateRight_()),n.right.isEmpty()||n.right.isRed_()||n.right.left.isRed_()||(n=n.moveRedRight_()),0===e(t,n.key)){if(n.right.isEmpty())return Ht.EMPTY_NODE;r=n.right.min_(),n=n.copy(r.key,r.value,null,null,n.right.removeMin_())}n=n.copy(null,null,null,null,n.right.remove(t,e))}return n.fixUp_()},t.prototype.isRed_=function(){return this.color},t.prototype.fixUp_=function(){var t=this;return t.right.isRed_()&&!t.left.isRed_()&&(t=t.rotateLeft_()),t.left.isRed_()&&t.left.left.isRed_()&&(t=t.rotateRight_()),t.left.isRed_()&&t.right.isRed_()&&(t=t.colorFlip_()),t},t.prototype.moveRedLeft_=function(){var t=this.colorFlip_();return t.right.left.isRed_()&&(t=(t=(t=t.copy(null,null,null,null,t.right.rotateRight_())).rotateLeft_()).colorFlip_()),t},t.prototype.moveRedRight_=function(){var t=this.colorFlip_();return t.left.left.isRed_()&&(t=(t=t.rotateRight_()).colorFlip_()),t},t.prototype.rotateLeft_=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.rotateRight_=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.colorFlip_=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},t.prototype.checkMaxDepth_=function(){var t=this.check_();return Math.pow(2,t)<=this.count()+1},t.prototype.check_=function(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");var t=this.left.check_();if(t!==this.right.check_())throw new Error("Black depths differ");return t+(this.isRed_()?0:1)},t.RED=!0,t.BLACK=!1,t}(),Gt=function(){function t(){}return t.prototype.copy=function(t,e,n,r,i){return this},t.prototype.insert=function(t,e,n){return new Wt(t,e,null)},t.prototype.remove=function(t,e){return this},t.prototype.count=function(){return 0},t.prototype.isEmpty=function(){return!0},t.prototype.inorderTraversal=function(t){return!1},t.prototype.reverseTraversal=function(t){return!1},t.prototype.minKey=function(){return null},t.prototype.maxKey=function(){return null},t.prototype.check_=function(){return 0},t.prototype.isRed_=function(){return!1},t}(),Ht=function(){function t(e,n){void 0===n&&(n=t.EMPTY_NODE),this.comparator_=e,this.root_=n}return t.prototype.insert=function(e,n){return new t(this.comparator_,this.root_.insert(e,n,this.comparator_).copy(null,null,Wt.BLACK,null,null))},t.prototype.remove=function(e){return new t(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Wt.BLACK,null,null))},t.prototype.get=function(t){for(var e,n=this.root_;!n.isEmpty();){if(0===(e=this.comparator_(t,n.key)))return n.value;e<0?n=n.left:e>0&&(n=n.right)}return null},t.prototype.getPredecessorKey=function(t){for(var e,n=this.root_,r=null;!n.isEmpty();){if(0===(e=this.comparator_(t,n.key))){if(n.left.isEmpty())return r?r.key:null;for(n=n.left;!n.right.isEmpty();)n=n.right;return n.key}e<0?n=n.left:e>0&&(r=n,n=n.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")},t.prototype.isEmpty=function(){return this.root_.isEmpty()},t.prototype.count=function(){return this.root_.count()},t.prototype.minKey=function(){return this.root_.minKey()},t.prototype.maxKey=function(){return this.root_.maxKey()},t.prototype.inorderTraversal=function(t){return this.root_.inorderTraversal(t)},t.prototype.reverseTraversal=function(t){return this.root_.reverseTraversal(t)},t.prototype.getIterator=function(t){return new Kt(this.root_,null,this.comparator_,!1,t)},t.prototype.getIteratorFrom=function(t,e){return new Kt(this.root_,t,this.comparator_,!1,e)},t.prototype.getReverseIteratorFrom=function(t,e){return new Kt(this.root_,t,this.comparator_,!0,e)},t.prototype.getReverseIterator=function(t){return new Kt(this.root_,null,this.comparator_,!0,t)},t.EMPTY_NODE=new Gt,t}();function zt(t,e){return M(t.name,e.name)}function Qt(t,e){return M(t,e)}var Yt,Xt,Jt,$t,Zt,te=function(t){return"number"==typeof t?"number:"+B(t):"string:"+t},ee=function(t){if(t.isLeafNode()){var e=t.val();(0,o.assert)("string"==typeof e||"number"==typeof e||"object"==typeof e&&(0,o.contains)(e,".sv"),"Priority must be a string or number.")}else(0,o.assert)(t===Lt||t.isEmpty(),"priority of unexpected type.");(0,o.assert)(t===Lt||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")},ne=function(){function t(e,n){void 0===n&&(n=t.__childrenNodeConstructor.EMPTY_NODE),this.value_=e,this.priorityNode_=n,this.lazyHash_=null,(0,o.assert)(void 0!==this.value_&&null!==this.value_,"LeafNode shouldn't be created with null/undefined value."),ee(this.priorityNode_)}return Object.defineProperty(t,"__childrenNodeConstructor",{get:function(){return Yt},set:function(t){Yt=t},enumerable:!1,configurable:!0}),t.prototype.isLeafNode=function(){return!0},t.prototype.getPriority=function(){return this.priorityNode_},t.prototype.updatePriority=function(e){return new t(this.value_,e)},t.prototype.getImmediateChild=function(e){return".priority"===e?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE},t.prototype.getChild=function(e){return Ct(e)?this:".priority"===bt(e)?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE},t.prototype.hasChild=function(){return!1},t.prototype.getPredecessorChildName=function(t,e){return null},t.prototype.updateImmediateChild=function(e,n){return".priority"===e?this.updatePriority(n):n.isEmpty()&&".priority"!==e?this:t.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,n).updatePriority(this.priorityNode_)},t.prototype.updateChild=function(e,n){var r=bt(e);return null===r?n:n.isEmpty()&&".priority"!==r?this:((0,o.assert)(".priority"!==r||1===_t(e),".priority must be the last token in a path"),this.updateImmediateChild(r,t.__childrenNodeConstructor.EMPTY_NODE.updateChild(wt(e),n)))},t.prototype.isEmpty=function(){return!1},t.prototype.numChildren=function(){return 0},t.prototype.forEachChild=function(t,e){return!1},t.prototype.val=function(t){return t&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()},t.prototype.hash=function(){if(null===this.lazyHash_){var t="";this.priorityNode_.isEmpty()||(t+="priority:"+te(this.priorityNode_.val())+":");var e=typeof this.value_;t+=e+":",t+="number"===e?B(this.value_):this.value_,this.lazyHash_=T(t)}return this.lazyHash_},t.prototype.getValue=function(){return this.value_},t.prototype.compareTo=function(e){return e===t.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof t.__childrenNodeConstructor?-1:((0,o.assert)(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))},t.prototype.compareToLeafNode_=function(e){var n=typeof e.value_,r=typeof this.value_,i=t.VALUE_TYPE_ORDER.indexOf(n),a=t.VALUE_TYPE_ORDER.indexOf(r);return(0,o.assert)(i>=0,"Unknown leaf type: "+n),(0,o.assert)(a>=0,"Unknown leaf type: "+r),i===a?"object"===r?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:a-i},t.prototype.withIndex=function(){return this},t.prototype.isIndexed=function(){return!0},t.prototype.equals=function(t){if(t===this)return!0;if(t.isLeafNode()){var e=t;return this.value_===e.value_&&this.priorityNode_.equals(e.priorityNode_)}return!1},t.VALUE_TYPE_ORDER=["object","boolean","number","string"],t}(),re=new(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.prototype.compare=function(t,e){var n=t.node.getPriority(),r=e.node.getPriority(),i=n.compareTo(r);return 0===i?M(t.name,e.name):i},e.prototype.isDefinedOn=function(t){return!t.getPriority().isEmpty()},e.prototype.indexedValueChanged=function(t,e){return!t.getPriority().equals(e.getPriority())},e.prototype.minPost=function(){return jt.MIN},e.prototype.maxPost=function(){return new jt(L,new ne("[PRIORITY-POST]",Jt))},e.prototype.makePost=function(t,e){var n=Xt(t);return new jt(e,new ne("[PRIORITY-POST]",n))},e.prototype.toString=function(){return".priority"},e}(qt)),ie=Math.log(2),oe=function(){function t(t){var e;this.count=(e=t+1,parseInt(Math.log(e)/ie,10)),this.current_=this.count-1;var n,r=(n=this.count,parseInt(Array(n+1).join("1"),2));this.bits_=t+1&r}return t.prototype.nextBitIsOne=function(){var t=!(this.bits_&1<<this.current_);return this.current_--,t},t}(),ae=function(t,e,n,r){t.sort(e);var i=function(e,r){var o,a,s=r-e;if(0===s)return null;if(1===s)return o=t[e],a=n?n(o):o,new Wt(a,o.node,Wt.BLACK,null,null);var u=parseInt(s/2,10)+e,c=i(e,u),l=i(u+1,r);return o=t[u],a=n?n(o):o,new Wt(a,o.node,Wt.BLACK,c,l)},o=function(e){for(var r=null,o=null,a=t.length,s=function(e,r){var o=a-e,s=a;a-=e;var c=i(o+1,s),l=t[o],h=n?n(l):l;u(new Wt(h,l.node,r,null,c))},u=function(t){r?(r.left=t,r=t):(o=t,r=t)},c=0;c<e.count;++c){var l=e.nextBitIsOne(),h=Math.pow(2,e.count-(c+1));l?s(h,Wt.BLACK):(s(h,Wt.BLACK),s(h,Wt.RED))}return o}(new oe(t.length));return new Ht(r||e,o)},se={},ue=function(){function t(t,e){this.indexes_=t,this.indexSet_=e}return Object.defineProperty(t,"Default",{get:function(){return(0,o.assert)(se&&re,"ChildrenNode.ts has not been loaded"),$t=$t||new t({".priority":se},{".priority":re})},enumerable:!1,configurable:!0}),t.prototype.get=function(t){var e=(0,o.safeGet)(this.indexes_,t);if(!e)throw new Error("No index defined for "+t);return e instanceof Ht?e:null},t.prototype.hasIndex=function(t){return(0,o.contains)(this.indexSet_,t.toString())},t.prototype.addIndex=function(e,n){(0,o.assert)(e!==Bt,"KeyIndex always exists and isn't meant to be added to the IndexMap.");for(var r,i=[],a=!1,s=n.getIterator(jt.Wrap),c=s.getNext();c;)a=a||e.isDefinedOn(c.node),i.push(c),c=s.getNext();r=a?ae(i,e.getCompare()):se;var l=e.toString(),h=u({},this.indexSet_);h[l]=e;var f=u({},this.indexes_);return f[l]=r,new t(f,h)},t.prototype.addToIndexes=function(e,n){var r=this;return new t((0,o.map)(this.indexes_,(function(t,i){var a=(0,o.safeGet)(r.indexSet_,i);if((0,o.assert)(a,"Missing index implementation for "+i),t===se){if(a.isDefinedOn(e.node)){for(var s=[],u=n.getIterator(jt.Wrap),c=u.getNext();c;)c.name!==e.name&&s.push(c),c=u.getNext();return s.push(e),ae(s,a.getCompare())}return se}var l=n.get(e.name),h=t;return l&&(h=h.remove(new jt(e.name,l))),h.insert(e,e.node)})),this.indexSet_)},t.prototype.removeFromIndexes=function(e,n){return new t((0,o.map)(this.indexes_,(function(t){if(t===se)return t;var r=n.get(e.name);return r?t.remove(new jt(e.name,r)):t})),this.indexSet_)},t}(),ce=function(){function t(t,e,n){this.children_=t,this.priorityNode_=e,this.indexMap_=n,this.lazyHash_=null,this.priorityNode_&&ee(this.priorityNode_),this.children_.isEmpty()&&(0,o.assert)(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}return Object.defineProperty(t,"EMPTY_NODE",{get:function(){return Zt||(Zt=new t(new Ht(Qt),null,ue.Default))},enumerable:!1,configurable:!0}),t.prototype.isLeafNode=function(){return!1},t.prototype.getPriority=function(){return this.priorityNode_||Zt},t.prototype.updatePriority=function(e){return this.children_.isEmpty()?this:new t(this.children_,e,this.indexMap_)},t.prototype.getImmediateChild=function(t){if(".priority"===t)return this.getPriority();var e=this.children_.get(t);return null===e?Zt:e},t.prototype.getChild=function(t){var e=bt(t);return null===e?this:this.getImmediateChild(e).getChild(wt(t))},t.prototype.hasChild=function(t){return null!==this.children_.get(t)},t.prototype.updateImmediateChild=function(e,n){if((0,o.assert)(n,"We should always be passing snapshot nodes"),".priority"===e)return this.updatePriority(n);var r=new jt(e,n),i=void 0,a=void 0;n.isEmpty()?(i=this.children_.remove(e),a=this.indexMap_.removeFromIndexes(r,this.children_)):(i=this.children_.insert(e,n),a=this.indexMap_.addToIndexes(r,this.children_));var s=i.isEmpty()?Zt:this.priorityNode_;return new t(i,s,a)},t.prototype.updateChild=function(t,e){var n=bt(t);if(null===n)return e;(0,o.assert)(".priority"!==bt(t)||1===_t(t),".priority must be the last token in a path");var r=this.getImmediateChild(n).updateChild(wt(t),e);return this.updateImmediateChild(n,r)},t.prototype.isEmpty=function(){return this.children_.isEmpty()},t.prototype.numChildren=function(){return this.children_.count()},t.prototype.val=function(e){if(this.isEmpty())return null;var n={},r=0,i=0,o=!0;if(this.forEachChild(re,(function(a,s){n[a]=s.val(e),r++,o&&t.INTEGER_REGEXP_.test(a)?i=Math.max(i,Number(a)):o=!1})),!e&&o&&i<2*r){var a=[];for(var s in n)a[s]=n[s];return a}return e&&!this.getPriority().isEmpty()&&(n[".priority"]=this.getPriority().val()),n},t.prototype.hash=function(){if(null===this.lazyHash_){var t="";this.getPriority().isEmpty()||(t+="priority:"+te(this.getPriority().val())+":"),this.forEachChild(re,(function(e,n){var r=n.hash();""!==r&&(t+=":"+e+":"+r)})),this.lazyHash_=""===t?"":T(t)}return this.lazyHash_},t.prototype.getPredecessorChildName=function(t,e,n){var r=this.resolveIndex_(n);if(r){var i=r.getPredecessorKey(new jt(t,e));return i?i.name:null}return this.children_.getPredecessorKey(t)},t.prototype.getFirstChildName=function(t){var e=this.resolveIndex_(t);if(e){var n=e.minKey();return n&&n.name}return this.children_.minKey()},t.prototype.getFirstChild=function(t){var e=this.getFirstChildName(t);return e?new jt(e,this.children_.get(e)):null},t.prototype.getLastChildName=function(t){var e=this.resolveIndex_(t);if(e){var n=e.maxKey();return n&&n.name}return this.children_.maxKey()},t.prototype.getLastChild=function(t){var e=this.getLastChildName(t);return e?new jt(e,this.children_.get(e)):null},t.prototype.forEachChild=function(t,e){var n=this.resolveIndex_(t);return n?n.inorderTraversal((function(t){return e(t.name,t.node)})):this.children_.inorderTraversal(e)},t.prototype.getIterator=function(t){return this.getIteratorFrom(t.minPost(),t)},t.prototype.getIteratorFrom=function(t,e){var n=this.resolveIndex_(e);if(n)return n.getIteratorFrom(t,(function(t){return t}));for(var r=this.children_.getIteratorFrom(t.name,jt.Wrap),i=r.peek();null!=i&&e.compare(i,t)<0;)r.getNext(),i=r.peek();return r},t.prototype.getReverseIterator=function(t){return this.getReverseIteratorFrom(t.maxPost(),t)},t.prototype.getReverseIteratorFrom=function(t,e){var n=this.resolveIndex_(e);if(n)return n.getReverseIteratorFrom(t,(function(t){return t}));for(var r=this.children_.getReverseIteratorFrom(t.name,jt.Wrap),i=r.peek();null!=i&&e.compare(i,t)>0;)r.getNext(),i=r.peek();return r},t.prototype.compareTo=function(t){return this.isEmpty()?t.isEmpty()?0:-1:t.isLeafNode()||t.isEmpty()?1:t===le?-1:0},t.prototype.withIndex=function(e){if(e===Bt||this.indexMap_.hasIndex(e))return this;var n=this.indexMap_.addIndex(e,this.children_);return new t(this.children_,this.priorityNode_,n)},t.prototype.isIndexed=function(t){return t===Bt||this.indexMap_.hasIndex(t)},t.prototype.equals=function(t){if(t===this)return!0;if(t.isLeafNode())return!1;var e=t;if(this.getPriority().equals(e.getPriority())){if(this.children_.count()===e.children_.count()){for(var n=this.getIterator(re),r=e.getIterator(re),i=n.getNext(),o=r.getNext();i&&o;){if(i.name!==o.name||!i.node.equals(o.node))return!1;i=n.getNext(),o=r.getNext()}return null===i&&null===o}return!1}return!1},t.prototype.resolveIndex_=function(t){return t===Bt?null:this.indexMap_.get(t.toString())},t.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,t}(),le=new(function(t){function e(){return t.call(this,new Ht(Qt),ce.EMPTY_NODE,ue.Default)||this}return s(e,t),e.prototype.compareTo=function(t){return t===this?0:1},e.prototype.equals=function(t){return t===this},e.prototype.getPriority=function(){return this},e.prototype.getImmediateChild=function(t){return ce.EMPTY_NODE},e.prototype.isEmpty=function(){return!1},e}(ce));function he(t,e){if(void 0===e&&(e=null),null===t)return ce.EMPTY_NODE;if("object"==typeof t&&".priority"in t&&(e=t[".priority"]),(0,o.assert)(null===e||"string"==typeof e||"number"==typeof e||"object"==typeof e&&".sv"in e,"Invalid priority type found: "+typeof e),"object"==typeof t&&".value"in t&&null!==t[".value"]&&(t=t[".value"]),"object"!=typeof t||".sv"in t)return new ne(t,he(e));if(t instanceof Array){var n=ce.EMPTY_NODE;return V(t,(function(e,r){if((0,o.contains)(t,e)&&"."!==e.substring(0,1)){var i=he(r);!i.isLeafNode()&&i.isEmpty()||(n=n.updateImmediateChild(e,i))}})),n.updatePriority(he(e))}var r=[],i=!1;if(V(t,(function(t,e){if("."!==t.substring(0,1)){var n=he(e);n.isEmpty()||(i=i||!n.getPriority().isEmpty(),r.push(new jt(t,n)))}})),0===r.length)return ce.EMPTY_NODE;var a=ae(r,zt,(function(t){return t.name}),Qt);if(i){var s=ae(r,re.getCompare());return new ce(a,he(e),new ue({".priority":s},{".priority":re}))}return new ce(a,he(e),ue.Default)}Object.defineProperties(jt,{MIN:{value:new jt(D,ce.EMPTY_NODE)},MAX:{value:new jt(L,le)}}),Vt.__EMPTY_NODE=ce.EMPTY_NODE,ne.__childrenNodeConstructor=ce,Lt=le,Jt=le,function(t){Xt=t}(he);var fe,pe,de=function(t){function e(e){var n=t.call(this)||this;return n.indexPath_=e,(0,o.assert)(!Ct(e)&&".priority"!==bt(e),"Can't create PathIndex with empty path or .priority key"),n}return s(e,t),e.prototype.extractChild=function(t){return t.getChild(this.indexPath_)},e.prototype.isDefinedOn=function(t){return!t.getChild(this.indexPath_).isEmpty()},e.prototype.compare=function(t,e){var n=this.extractChild(t.node),r=this.extractChild(e.node),i=n.compareTo(r);return 0===i?M(t.name,e.name):i},e.prototype.makePost=function(t,e){var n=he(t),r=ce.EMPTY_NODE.updateChild(this.indexPath_,n);return new jt(e,r)},e.prototype.maxPost=function(){var t=ce.EMPTY_NODE.updateChild(this.indexPath_,le);return new jt(L,t)},e.prototype.toString=function(){return Tt(this.indexPath_,0).join("/")},e}(qt),ve=new(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.prototype.compare=function(t,e){var n=t.node.compareTo(e.node);return 0===n?M(t.name,e.name):n},e.prototype.isDefinedOn=function(t){return!0},e.prototype.indexedValueChanged=function(t,e){return!t.equals(e)},e.prototype.minPost=function(){return jt.MIN},e.prototype.maxPost=function(){return jt.MAX},e.prototype.makePost=function(t,e){var n=he(t);return new jt(e,n)},e.prototype.toString=function(){return".value"},e}(qt)),ge="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",ye=(fe=0,pe=[],function(t){var e,n=t===fe;fe=t;var r=new Array(8);for(e=7;e>=0;e--)r[e]=ge.charAt(t%64),t=Math.floor(t/64);(0,o.assert)(0===t,"Cannot push at time == 0");var i=r.join("");if(n){for(e=11;e>=0&&63===pe[e];e--)pe[e]=0;pe[e]++}else for(e=0;e<12;e++)pe[e]=Math.floor(64*Math.random());for(e=0;e<12;e++)i+=ge.charAt(pe[e]);return(0,o.assert)(20===i.length,"nextPushId: Length should be 20."),i}),me=function(t){if("2147483647"===t)return"-";var e=W(t);if(null!=e)return""+(e+1);for(var n=new Array(t.length),r=0;r<n.length;r++)n[r]=t.charAt(r);if(n.length<786)return n.push("-"),n.join("");for(var i=n.length-1;i>=0&&"z"===n[i];)i--;if(-1===i)return L;var o=n[i],a=ge.charAt(ge.indexOf(o)+1);return n[i]=a,n.slice(0,i+1).join("")},be=function(t){if("-2147483648"===t)return D;var e=W(t);if(null!=e)return""+(e-1);for(var n=new Array(t.length),r=0;r<n.length;r++)n[r]=t.charAt(r);return"-"===n[n.length-1]?1===n.length?"2147483647":(delete n[n.length-1],n.join("")):(n[n.length-1]=ge.charAt(ge.indexOf(n[n.length-1])-1),n.join("")+"z".repeat(786-n.length))};function _e(t){return{type:"value",snapshotNode:t}}function we(t,e){return{type:"child_added",snapshotNode:e,childName:t}}function Ie(t,e){return{type:"child_removed",snapshotNode:e,childName:t}}function Te(t,e,n){return{type:"child_changed",snapshotNode:e,childName:t,oldSnap:n}}var Ee=function(){function t(t){this.index_=t}return t.prototype.updateChild=function(t,e,n,r,i,a){(0,o.assert)(t.isIndexed(this.index_),"A node must be indexed if only a child is updated");var s=t.getImmediateChild(e);return s.getChild(r).equals(n.getChild(r))&&s.isEmpty()===n.isEmpty()?t:(null!=a&&(n.isEmpty()?t.hasChild(e)?a.trackChildChange(Ie(e,s)):(0,o.assert)(t.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):s.isEmpty()?a.trackChildChange(we(e,n)):a.trackChildChange(Te(e,n,s))),t.isLeafNode()&&n.isEmpty()?t:t.updateImmediateChild(e,n).withIndex(this.index_))},t.prototype.updateFullNode=function(t,e,n){return null!=n&&(t.isLeafNode()||t.forEachChild(re,(function(t,r){e.hasChild(t)||n.trackChildChange(Ie(t,r))})),e.isLeafNode()||e.forEachChild(re,(function(e,r){if(t.hasChild(e)){var i=t.getImmediateChild(e);i.equals(r)||n.trackChildChange(Te(e,r,i))}else n.trackChildChange(we(e,r))}))),e.withIndex(this.index_)},t.prototype.updatePriority=function(t,e){return t.isEmpty()?ce.EMPTY_NODE:t.updatePriority(e)},t.prototype.filtersNodes=function(){return!1},t.prototype.getIndexedFilter=function(){return this},t.prototype.getIndex=function(){return this.index_},t}(),Se=function(){function t(e){this.indexedFilter_=new Ee(e.getIndex()),this.index_=e.getIndex(),this.startPost_=t.getStartPost_(e),this.endPost_=t.getEndPost_(e)}return t.prototype.getStartPost=function(){return this.startPost_},t.prototype.getEndPost=function(){return this.endPost_},t.prototype.matches=function(t){return this.index_.compare(this.getStartPost(),t)<=0&&this.index_.compare(t,this.getEndPost())<=0},t.prototype.updateChild=function(t,e,n,r,i,o){return this.matches(new jt(e,n))||(n=ce.EMPTY_NODE),this.indexedFilter_.updateChild(t,e,n,r,i,o)},t.prototype.updateFullNode=function(t,e,n){e.isLeafNode()&&(e=ce.EMPTY_NODE);var r=e.withIndex(this.index_);r=r.updatePriority(ce.EMPTY_NODE);var i=this;return e.forEachChild(re,(function(t,e){i.matches(new jt(t,e))||(r=r.updateImmediateChild(t,ce.EMPTY_NODE))})),this.indexedFilter_.updateFullNode(t,r,n)},t.prototype.updatePriority=function(t,e){return t},t.prototype.filtersNodes=function(){return!0},t.prototype.getIndexedFilter=function(){return this.indexedFilter_},t.prototype.getIndex=function(){return this.index_},t.getStartPost_=function(t){if(t.hasStart()){var e=t.getIndexStartName();return t.getIndex().makePost(t.getIndexStartValue(),e)}return t.getIndex().minPost()},t.getEndPost_=function(t){if(t.hasEnd()){var e=t.getIndexEndName();return t.getIndex().makePost(t.getIndexEndValue(),e)}return t.getIndex().maxPost()},t}(),Ce=function(){function t(t){this.rangedFilter_=new Se(t),this.index_=t.getIndex(),this.limit_=t.getLimit(),this.reverse_=!t.isViewFromLeft()}return t.prototype.updateChild=function(t,e,n,r,i,o){return this.rangedFilter_.matches(new jt(e,n))||(n=ce.EMPTY_NODE),t.getImmediateChild(e).equals(n)?t:t.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(t,e,n,r,i,o):this.fullLimitUpdateChild_(t,e,n,i,o)},t.prototype.updateFullNode=function(t,e,n){var r;if(e.isLeafNode()||e.isEmpty())r=ce.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<e.numChildren()&&e.isIndexed(this.index_)){r=ce.EMPTY_NODE.withIndex(this.index_);var i=void 0;i=this.reverse_?e.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):e.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);for(var o=0;i.hasNext()&&o<this.limit_;){var a=i.getNext();if(!(this.reverse_?this.index_.compare(this.rangedFilter_.getStartPost(),a)<=0:this.index_.compare(a,this.rangedFilter_.getEndPost())<=0))break;r=r.updateImmediateChild(a.name,a.node),o++}}else{r=(r=e.withIndex(this.index_)).updatePriority(ce.EMPTY_NODE);var s=void 0,u=void 0,c=void 0;if(i=void 0,this.reverse_){i=r.getReverseIterator(this.index_),s=this.rangedFilter_.getEndPost(),u=this.rangedFilter_.getStartPost();var l=this.index_.getCompare();c=function(t,e){return l(e,t)}}else i=r.getIterator(this.index_),s=this.rangedFilter_.getStartPost(),u=this.rangedFilter_.getEndPost(),c=this.index_.getCompare();o=0;for(var h=!1;i.hasNext();)a=i.getNext(),!h&&c(s,a)<=0&&(h=!0),h&&o<this.limit_&&c(a,u)<=0?o++:r=r.updateImmediateChild(a.name,ce.EMPTY_NODE)}return this.rangedFilter_.getIndexedFilter().updateFullNode(t,r,n)},t.prototype.updatePriority=function(t,e){return t},t.prototype.filtersNodes=function(){return!0},t.prototype.getIndexedFilter=function(){return this.rangedFilter_.getIndexedFilter()},t.prototype.getIndex=function(){return this.index_},t.prototype.fullLimitUpdateChild_=function(t,e,n,r,i){var a;if(this.reverse_){var s=this.index_.getCompare();a=function(t,e){return s(e,t)}}else a=this.index_.getCompare();var u=t;(0,o.assert)(u.numChildren()===this.limit_,"");var c=new jt(e,n),l=this.reverse_?u.getFirstChild(this.index_):u.getLastChild(this.index_),h=this.rangedFilter_.matches(c);if(u.hasChild(e)){for(var f=u.getImmediateChild(e),p=r.getChildAfterChild(this.index_,l,this.reverse_);null!=p&&(p.name===e||u.hasChild(p.name));)p=r.getChildAfterChild(this.index_,p,this.reverse_);var d=null==p?1:a(p,c);if(h&&!n.isEmpty()&&d>=0)return null!=i&&i.trackChildChange(Te(e,n,f)),u.updateImmediateChild(e,n);null!=i&&i.trackChildChange(Ie(e,f));var v=u.updateImmediateChild(e,ce.EMPTY_NODE);return null!=p&&this.rangedFilter_.matches(p)?(null!=i&&i.trackChildChange(we(p.name,p.node)),v.updateImmediateChild(p.name,p.node)):v}return n.isEmpty()?t:h&&a(l,c)>=0?(null!=i&&(i.trackChildChange(Ie(l.name,l.node)),i.trackChildChange(we(e,n))),u.updateImmediateChild(e,n).updateImmediateChild(l.name,ce.EMPTY_NODE)):t},t}(),ke=function(){function t(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=re}return t.prototype.hasStart=function(){return this.startSet_},t.prototype.hasStartAfter=function(){return this.startAfterSet_},t.prototype.hasEndBefore=function(){return this.endBeforeSet_},t.prototype.isViewFromLeft=function(){return""===this.viewFrom_?this.startSet_:"l"===this.viewFrom_},t.prototype.getIndexStartValue=function(){return(0,o.assert)(this.startSet_,"Only valid if start has been set"),this.indexStartValue_},t.prototype.getIndexStartName=function(){return(0,o.assert)(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:D},t.prototype.hasEnd=function(){return this.endSet_},t.prototype.getIndexEndValue=function(){return(0,o.assert)(this.endSet_,"Only valid if end has been set"),this.indexEndValue_},t.prototype.getIndexEndName=function(){return(0,o.assert)(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:L},t.prototype.hasLimit=function(){return this.limitSet_},t.prototype.hasAnchoredLimit=function(){return this.limitSet_&&""!==this.viewFrom_},t.prototype.getLimit=function(){return(0,o.assert)(this.limitSet_,"Only valid if limit has been set"),this.limit_},t.prototype.getIndex=function(){return this.index_},t.prototype.loadsAllData=function(){return!(this.startSet_||this.endSet_||this.limitSet_)},t.prototype.isDefault=function(){return this.loadsAllData()&&this.index_===re},t.prototype.copy=function(){var e=new t;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e},t}();function Ae(t,e,n){var r=t.copy();return r.startSet_=!0,void 0===e&&(e=null),r.indexStartValue_=e,null!=n?(r.startNameSet_=!0,r.indexStartName_=n):(r.startNameSet_=!1,r.indexStartName_=""),r}function Ne(t,e,n){var r=t.copy();return r.endSet_=!0,void 0===e&&(e=null),r.indexEndValue_=e,void 0!==n?(r.endNameSet_=!0,r.indexEndName_=n):(r.endNameSet_=!1,r.indexEndName_=""),r}function Pe(t,e){var n=t.copy();return n.index_=e,n}function Oe(t){var e,n={};return t.isDefault()||(t.index_===re?e="$priority":t.index_===ve?e="$value":t.index_===Bt?e="$key":((0,o.assert)(t.index_ instanceof de,"Unrecognized index type!"),e=t.index_.toString()),n.orderBy=(0,o.stringify)(e),t.startSet_&&(n.startAt=(0,o.stringify)(t.indexStartValue_),t.startNameSet_&&(n.startAt+=","+(0,o.stringify)(t.indexStartName_))),t.endSet_&&(n.endAt=(0,o.stringify)(t.indexEndValue_),t.endNameSet_&&(n.endAt+=","+(0,o.stringify)(t.indexEndName_))),t.limitSet_&&(t.isViewFromLeft()?n.limitToFirst=t.limit_:n.limitToLast=t.limit_)),n}function Re(t){var e={};if(t.startSet_&&(e.sp=t.indexStartValue_,t.startNameSet_&&(e.sn=t.indexStartName_)),t.endSet_&&(e.ep=t.indexEndValue_,t.endNameSet_&&(e.en=t.indexEndName_)),t.limitSet_){e.l=t.limit_;var n=t.viewFrom_;""===n&&(n=t.isViewFromLeft()?"l":"r"),e.vf=n}return t.index_!==re&&(e.i=t.index_.toString()),e}var xe=function(t){function e(e,n,r,i){var o=t.call(this)||this;return o.repoInfo_=e,o.onDataUpdate_=n,o.authTokenProvider_=r,o.appCheckTokenProvider_=i,o.log_=N("p:rest:"),o.listens_={},o}return s(e,t),e.prototype.reportStats=function(t){throw new Error("Method not implemented.")},e.getListenId_=function(t,e){return void 0!==e?"tag$"+e:((0,o.assert)(t._queryParams.isDefault(),"should have a tag if it's not a default query."),t._path.toString())},e.prototype.listen=function(t,n,r,i){var a=this,s=t._path.toString();this.log_("Listen called for "+s+" "+t._queryIdentifier);var u=e.getListenId_(t,r),c={};this.listens_[u]=c;var l=Oe(t._queryParams);this.restRequest_(s+".json",l,(function(t,e){var n=e;404===t&&(n=null,t=null),null===t&&a.onDataUpdate_(s,n,!1,r),(0,o.safeGet)(a.listens_,u)===c&&i(t?401===t?"permission_denied":"rest_error:"+t:"ok",null)}))},e.prototype.unlisten=function(t,n){var r=e.getListenId_(t,n);delete this.listens_[r]},e.prototype.get=function(t){var e=this,n=Oe(t._queryParams),r=t._path.toString(),i=new o.Deferred;return this.restRequest_(r+".json",n,(function(t,n){var o=n;404===t&&(o=null,t=null),null===t?(e.onDataUpdate_(r,o,!1,null),i.resolve(o)):i.reject(new Error(o))})),i.promise},e.prototype.refreshAuthToken=function(t){},e.prototype.restRequest_=function(t,e,n){var r=this;return void 0===e&&(e={}),e.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then((function(i){var a=l(i,2),s=a[0],u=a[1];s&&s.accessToken&&(e.auth=s.accessToken),u&&u.token&&(e.ac=u.token);var c=(r.repoInfo_.secure?"https://":"http://")+r.repoInfo_.host+t+"?ns="+r.repoInfo_.namespace+(0,o.querystring)(e);r.log_("Sending REST request for "+c);var h=new XMLHttpRequest;h.onreadystatechange=function(){if(n&&4===h.readyState){r.log_("REST Response for "+c+" received. status:",h.status,"response:",h.responseText);var t=null;if(h.status>=200&&h.status<300){try{t=(0,o.jsonEval)(h.responseText)}catch(t){R("Failed to parse JSON response for "+c+": "+h.responseText)}n(null,t)}else 401!==h.status&&404!==h.status&&R("Got unsuccessful REST response for "+c+" Status: "+h.status),n(h.status);n=null}},h.open("GET",c,!0),h.send()}))},e}(dt),De=function(){function t(){this.rootNode_=ce.EMPTY_NODE}return t.prototype.getNode=function(t){return this.rootNode_.getChild(t)},t.prototype.updateSnapshot=function(t,e){this.rootNode_=this.rootNode_.updateChild(t,e)},t}();function Le(){return{value:null,children:new Map}}function Me(t,e,n){if(Ct(e))t.value=n,t.children.clear();else if(null!==t.value)t.value=t.value.updateChild(e,n);else{var r=bt(e);t.children.has(r)||t.children.set(r,Le()),Me(t.children.get(r),e=wt(e),n)}}function Fe(t,e){if(Ct(e))return t.value=null,t.children.clear(),!0;if(null!==t.value){if(t.value.isLeafNode())return!1;var n=t.value;return t.value=null,n.forEachChild(re,(function(e,n){Me(t,new yt(e),n)})),Fe(t,e)}if(t.children.size>0){var r=bt(e);return e=wt(e),t.children.has(r)&&Fe(t.children.get(r),e)&&t.children.delete(r),0===t.children.size}return!0}function Ue(t,e,n){null!==t.value?n(e,t.value):function(t,e){t.children.forEach((function(t,n){e(n,t)}))}(t,(function(t,r){Ue(r,new yt(e.toString()+"/"+t),n)}))}var je,qe=function(){function t(t){this.collection_=t,this.last_=null}return t.prototype.get=function(){var t=this.collection_.get(),e=u({},t);return this.last_&&V(this.last_,(function(t,n){e[t]=e[t]-n})),this.last_=t,e},t}(),Ve=function(){function t(t,e){this.server_=e,this.statsToReport_={},this.statsListener_=new qe(t);var n=1e4+2e4*Math.random();H(this.reportStats_.bind(this),Math.floor(n))}return t.prototype.reportStats_=function(){var t=this,e=this.statsListener_.get(),n={},r=!1;V(e,(function(e,i){i>0&&(0,o.contains)(t.statsToReport_,e)&&(n[e]=i,r=!0)})),r&&this.server_.reportStats(n),H(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))},t}();function Be(t){return{fromUser:!1,fromServer:!0,queryId:t,tagged:!0}}!function(t){t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"}(je||(je={}));var Ke,We=function(){function t(t,e,n){this.path=t,this.affectedTree=e,this.revert=n,this.type=je.ACK_USER_WRITE,this.source={fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}return t.prototype.operationForChild=function(e){if(Ct(this.path)){if(null!=this.affectedTree.value)return(0,o.assert)(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;var n=this.affectedTree.subtree(new yt(e));return new t(mt(),n,this.revert)}return(0,o.assert)(bt(this.path)===e,"operationForChild called for unrelated child."),new t(wt(this.path),this.affectedTree,this.revert)},t}(),Ge=function(){function t(t,e){this.source=t,this.path=e,this.type=je.LISTEN_COMPLETE}return t.prototype.operationForChild=function(e){return Ct(this.path)?new t(this.source,mt()):new t(this.source,wt(this.path))},t}(),He=function(){function t(t,e,n){this.source=t,this.path=e,this.snap=n,this.type=je.OVERWRITE}return t.prototype.operationForChild=function(e){return Ct(this.path)?new t(this.source,mt(),this.snap.getImmediateChild(e)):new t(this.source,wt(this.path),this.snap)},t}(),ze=function(){function t(t,e,n){this.source=t,this.path=e,this.children=n,this.type=je.MERGE}return t.prototype.operationForChild=function(e){if(Ct(this.path)){var n=this.children.subtree(new yt(e));return n.isEmpty()?null:n.value?new He(this.source,mt(),n.value):new t(this.source,mt(),n)}return(0,o.assert)(bt(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new t(this.source,wt(this.path),this.children)},t.prototype.toString=function(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"},t}(),Qe=function(){function t(t,e,n){this.node_=t,this.fullyInitialized_=e,this.filtered_=n}return t.prototype.isFullyInitialized=function(){return this.fullyInitialized_},t.prototype.isFiltered=function(){return this.filtered_},t.prototype.isCompleteForPath=function(t){if(Ct(t))return this.isFullyInitialized()&&!this.filtered_;var e=bt(t);return this.isCompleteForChild(e)},t.prototype.isCompleteForChild=function(t){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(t)},t.prototype.getNode=function(){return this.node_},t}(),Ye=function(t){this.query_=t,this.index_=this.query_._queryParams.getIndex()};function Xe(t,e,n,r,i,a){var s=r.filter((function(t){return t.type===n}));s.sort((function(e,n){return function(t,e,n){if(null==e.childName||null==n.childName)throw(0,o.assertionError)("Should only compare child_ events.");var r=new jt(e.childName,e.snapshotNode),i=new jt(n.childName,n.snapshotNode);return t.index_.compare(r,i)}(t,e,n)})),s.forEach((function(n){var r=function(t,e,n){return"value"===e.type||"child_removed"===e.type||(e.prevName=n.getPredecessorChildName(e.childName,e.snapshotNode,t.index_)),e}(t,n,a);i.forEach((function(i){i.respondsTo(n.type)&&e.push(i.createEvent(r,t.query_))}))}))}function Je(t,e){return{eventCache:t,serverCache:e}}function $e(t,e,n,r){return Je(new Qe(e,n,r),t.serverCache)}function Ze(t,e,n,r){return Je(t.eventCache,new Qe(e,n,r))}function tn(t){return t.eventCache.isFullyInitialized()?t.eventCache.getNode():null}function en(t){return t.serverCache.isFullyInitialized()?t.serverCache.getNode():null}var nn=function(){function t(t,e){void 0===e&&(Ke||(Ke=new Ht(F)),e=Ke),this.value=t,this.children=e}return t.fromObject=function(e){var n=new t(null);return V(e,(function(t,e){n=n.set(new yt(t),e)})),n},t.prototype.isEmpty=function(){return null===this.value&&this.children.isEmpty()},t.prototype.findRootMostMatchingPathAndValue=function(t,e){if(null!=this.value&&e(this.value))return{path:mt(),value:this.value};if(Ct(t))return null;var n=bt(t),r=this.children.get(n);if(null!==r){var i=r.findRootMostMatchingPathAndValue(wt(t),e);return null!=i?{path:St(new yt(n),i.path),value:i.value}:null}return null},t.prototype.findRootMostValueAndPath=function(t){return this.findRootMostMatchingPathAndValue(t,(function(){return!0}))},t.prototype.subtree=function(e){if(Ct(e))return this;var n=bt(e),r=this.children.get(n);return null!==r?r.subtree(wt(e)):new t(null)},t.prototype.set=function(e,n){if(Ct(e))return new t(n,this.children);var r=bt(e),i=(this.children.get(r)||new t(null)).set(wt(e),n),o=this.children.insert(r,i);return new t(this.value,o)},t.prototype.remove=function(e){if(Ct(e))return this.children.isEmpty()?new t(null):new t(null,this.children);var n=bt(e),r=this.children.get(n);if(r){var i=r.remove(wt(e)),o=void 0;return o=i.isEmpty()?this.children.remove(n):this.children.insert(n,i),null===this.value&&o.isEmpty()?new t(null):new t(this.value,o)}return this},t.prototype.get=function(t){if(Ct(t))return this.value;var e=bt(t),n=this.children.get(e);return n?n.get(wt(t)):null},t.prototype.setTree=function(e,n){if(Ct(e))return n;var r,i=bt(e),o=(this.children.get(i)||new t(null)).setTree(wt(e),n);return r=o.isEmpty()?this.children.remove(i):this.children.insert(i,o),new t(this.value,r)},t.prototype.fold=function(t){return this.fold_(mt(),t)},t.prototype.fold_=function(t,e){var n={};return this.children.inorderTraversal((function(r,i){n[r]=i.fold_(St(t,r),e)})),e(t,this.value,n)},t.prototype.findOnPath=function(t,e){return this.findOnPath_(t,mt(),e)},t.prototype.findOnPath_=function(t,e,n){var r=!!this.value&&n(e,this.value);if(r)return r;if(Ct(t))return null;var i=bt(t),o=this.children.get(i);return o?o.findOnPath_(wt(t),St(e,i),n):null},t.prototype.foreachOnPath=function(t,e){return this.foreachOnPath_(t,mt(),e)},t.prototype.foreachOnPath_=function(e,n,r){if(Ct(e))return this;this.value&&r(n,this.value);var i=bt(e),o=this.children.get(i);return o?o.foreachOnPath_(wt(e),St(n,i),r):new t(null)},t.prototype.foreach=function(t){this.foreach_(mt(),t)},t.prototype.foreach_=function(t,e){this.children.inorderTraversal((function(n,r){r.foreach_(St(t,n),e)})),this.value&&e(t,this.value)},t.prototype.foreachChild=function(t){this.children.inorderTraversal((function(e,n){n.value&&t(e,n.value)}))},t}(),rn=function(){function t(t){this.writeTree_=t}return t.empty=function(){return new t(new nn(null))},t}();function on(t,e,n){if(Ct(e))return new rn(new nn(n));var r=t.writeTree_.findRootMostValueAndPath(e);if(null!=r){var i=r.path,o=r.value,a=kt(i,e);return o=o.updateChild(a,n),new rn(t.writeTree_.set(i,o))}var s=new nn(n),u=t.writeTree_.setTree(e,s);return new rn(u)}function an(t,e,n){var r=t;return V(n,(function(t,n){r=on(r,St(e,t),n)})),r}function sn(t,e){if(Ct(e))return rn.empty();var n=t.writeTree_.setTree(e,new nn(null));return new rn(n)}function un(t,e){return null!=cn(t,e)}function cn(t,e){var n=t.writeTree_.findRootMostValueAndPath(e);return null!=n?t.writeTree_.get(n.path).getChild(kt(n.path,e)):null}function ln(t){var e=[],n=t.writeTree_.value;return null!=n?n.isLeafNode()||n.forEachChild(re,(function(t,n){e.push(new jt(t,n))})):t.writeTree_.children.inorderTraversal((function(t,n){null!=n.value&&e.push(new jt(t,n.value))})),e}function hn(t,e){if(Ct(e))return t;var n=cn(t,e);return new rn(null!=n?new nn(n):t.writeTree_.subtree(e))}function fn(t){return t.writeTree_.isEmpty()}function pn(t,e){return dn(mt(),t.writeTree_,e)}function dn(t,e,n){if(null!=e.value)return n.updateChild(t,e.value);var r=null;return e.children.inorderTraversal((function(e,i){".priority"===e?((0,o.assert)(null!==i.value,"Priority writes must always be leaf nodes"),r=i.value):n=dn(St(t,e),i,n)})),n.getChild(t).isEmpty()||null===r||(n=n.updateChild(St(t,".priority"),r)),n}function vn(t,e){return Cn(e,t)}function gn(t,e){if(t.snap)return Pt(t.path,e);for(var n in t.children)if(t.children.hasOwnProperty(n)&&Pt(St(t.path,n),e))return!0;return!1}function yn(t){return t.visible}function mn(t,e,n){for(var r=rn.empty(),i=0;i<t.length;++i){var a=t[i];if(e(a)){var s=a.path,u=void 0;if(a.snap)Pt(n,s)?r=on(r,u=kt(n,s),a.snap):Pt(s,n)&&(u=kt(s,n),r=on(r,mt(),a.snap.getChild(u)));else{if(!a.children)throw(0,o.assertionError)("WriteRecord should have .snap or .children");if(Pt(n,s))r=an(r,u=kt(n,s),a.children);else if(Pt(s,n))if(Ct(u=kt(s,n)))r=an(r,mt(),a.children);else{var c=(0,o.safeGet)(a.children,bt(u));if(c){var l=c.getChild(wt(u));r=on(r,mt(),l)}}}}}return r}function bn(t,e,n,r,i){if(r||i){var o=hn(t.visibleWrites,e);return!i&&fn(o)?n:i||null!=n||un(o,mt())?pn(mn(t.allWrites,(function(t){return(t.visible||i)&&(!r||!~r.indexOf(t.writeId))&&(Pt(t.path,e)||Pt(e,t.path))}),e),n||ce.EMPTY_NODE):null}var a=cn(t.visibleWrites,e);if(null!=a)return a;var s=hn(t.visibleWrites,e);return fn(s)?n:null!=n||un(s,mt())?pn(s,n||ce.EMPTY_NODE):null}function _n(t,e,n,r){return bn(t.writeTree,t.treePath,e,n,r)}function wn(t,e){return function(t,e,n){var r=ce.EMPTY_NODE,i=cn(t.visibleWrites,e);if(i)return i.isLeafNode()||i.forEachChild(re,(function(t,e){r=r.updateImmediateChild(t,e)})),r;if(n){var o=hn(t.visibleWrites,e);return n.forEachChild(re,(function(t,e){var n=pn(hn(o,new yt(t)),e);r=r.updateImmediateChild(t,n)})),ln(o).forEach((function(t){r=r.updateImmediateChild(t.name,t.node)})),r}return ln(hn(t.visibleWrites,e)).forEach((function(t){r=r.updateImmediateChild(t.name,t.node)})),r}(t.writeTree,t.treePath,e)}function In(t,e,n,r){return function(t,e,n,r,i){(0,o.assert)(r||i,"Either existingEventSnap or existingServerSnap must exist");var a=St(e,n);if(un(t.visibleWrites,a))return null;var s=hn(t.visibleWrites,a);return fn(s)?i.getChild(n):pn(s,i.getChild(n))}(t.writeTree,t.treePath,e,n,r)}function Tn(t,e){return function(t,e){return cn(t.visibleWrites,e)}(t.writeTree,St(t.treePath,e))}function En(t,e,n){return function(t,e,n,r){var i=St(e,n),o=cn(t.visibleWrites,i);return null!=o?o:r.isCompleteForChild(n)?pn(hn(t.visibleWrites,i),r.getNode().getImmediateChild(n)):null}(t.writeTree,t.treePath,e,n)}function Sn(t,e){return Cn(St(t.treePath,e),t.writeTree)}function Cn(t,e){return{treePath:t,writeTree:e}}var kn=function(){function t(){this.changeMap=new Map}return t.prototype.trackChildChange=function(t){var e=t.type,n=t.childName;(0,o.assert)("child_added"===e||"child_changed"===e||"child_removed"===e,"Only child changes supported for tracking"),(0,o.assert)(".priority"!==n,"Only non-priority child changes can be tracked.");var r=this.changeMap.get(n);if(r){var i=r.type;if("child_added"===e&&"child_removed"===i)this.changeMap.set(n,Te(n,t.snapshotNode,r.snapshotNode));else if("child_removed"===e&&"child_added"===i)this.changeMap.delete(n);else if("child_removed"===e&&"child_changed"===i)this.changeMap.set(n,Ie(n,r.oldSnap));else if("child_changed"===e&&"child_added"===i)this.changeMap.set(n,we(n,t.snapshotNode));else{if("child_changed"!==e||"child_changed"!==i)throw(0,o.assertionError)("Illegal combination of changes: "+t+" occurred after "+r);this.changeMap.set(n,Te(n,t.snapshotNode,r.oldSnap))}}else this.changeMap.set(n,t)},t.prototype.getChanges=function(){return Array.from(this.changeMap.values())},t}(),An=new(function(){function t(){}return t.prototype.getCompleteChild=function(t){return null},t.prototype.getChildAfterChild=function(t,e,n){return null},t}()),Nn=function(){function t(t,e,n){void 0===n&&(n=null),this.writes_=t,this.viewCache_=e,this.optCompleteServerCache_=n}return t.prototype.getCompleteChild=function(t){var e=this.viewCache_.eventCache;if(e.isCompleteForChild(t))return e.getNode().getImmediateChild(t);var n=null!=this.optCompleteServerCache_?new Qe(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return En(this.writes_,t,n)},t.prototype.getChildAfterChild=function(t,e,n){var r=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:en(this.viewCache_),i=function(t,e,n,r,i,o){return function(t,e,n,r,i,o,a){var s,u=hn(t.visibleWrites,e),c=cn(u,mt());if(null!=c)s=c;else{if(null==n)return[];s=pn(u,n)}if((s=s.withIndex(a)).isEmpty()||s.isLeafNode())return[];for(var l=[],h=a.getCompare(),f=o?s.getReverseIteratorFrom(r,a):s.getIteratorFrom(r,a),p=f.getNext();p&&l.length<i;)0!==h(p,r)&&l.push(p),p=f.getNext();return l}(t.writeTree,t.treePath,e,n,r,i,o)}(this.writes_,r,e,1,n,t);return 0===i.length?null:i[0]},t}();function Pn(t,e,n,r,i,a){var s=e.eventCache;if(null!=Tn(r,n))return e;var u=void 0,c=void 0;if(Ct(n))if((0,o.assert)(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){var l=en(e),h=wn(r,l instanceof ce?l:ce.EMPTY_NODE);u=t.filter.updateFullNode(e.eventCache.getNode(),h,a)}else{var f=_n(r,en(e));u=t.filter.updateFullNode(e.eventCache.getNode(),f,a)}else{var p=bt(n);if(".priority"===p){(0,o.assert)(1===_t(n),"Can't have a priority with additional path components");var d=s.getNode(),v=In(r,n,d,c=e.serverCache.getNode());u=null!=v?t.filter.updatePriority(d,v):s.getNode()}else{var g=wt(n),y=void 0;if(s.isCompleteForChild(p)){c=e.serverCache.getNode();var m=In(r,n,s.getNode(),c);y=null!=m?s.getNode().getImmediateChild(p).updateChild(g,m):s.getNode().getImmediateChild(p)}else y=En(r,p,e.serverCache);u=null!=y?t.filter.updateChild(s.getNode(),p,y,g,i,a):s.getNode()}}return $e(e,u,s.isFullyInitialized()||Ct(n),t.filter.filtersNodes())}function On(t,e,n,r,i,o,a,s){var u,c=e.serverCache,l=a?t.filter:t.filter.getIndexedFilter();if(Ct(n))u=l.updateFullNode(c.getNode(),r,null);else if(l.filtersNodes()&&!c.isFiltered()){var h=c.getNode().updateChild(n,r);u=l.updateFullNode(c.getNode(),h,null)}else{var f=bt(n);if(!c.isCompleteForPath(n)&&_t(n)>1)return e;var p=wt(n),d=c.getNode().getImmediateChild(f).updateChild(p,r);u=".priority"===f?l.updatePriority(c.getNode(),d):l.updateChild(c.getNode(),f,d,p,An,null)}var v=Ze(e,u,c.isFullyInitialized()||Ct(n),l.filtersNodes());return Pn(t,v,n,i,new Nn(i,v,o),s)}function Rn(t,e,n,r,i,o,a){var s,u,c=e.eventCache,l=new Nn(i,e,o);if(Ct(n))u=t.filter.updateFullNode(e.eventCache.getNode(),r,a),s=$e(e,u,!0,t.filter.filtersNodes());else{var h=bt(n);if(".priority"===h)u=t.filter.updatePriority(e.eventCache.getNode(),r),s=$e(e,u,c.isFullyInitialized(),c.isFiltered());else{var f=wt(n),p=c.getNode().getImmediateChild(h),d=void 0;if(Ct(f))d=r;else{var v=l.getCompleteChild(h);d=null!=v?".priority"===It(f)&&v.getChild(Et(f)).isEmpty()?v:v.updateChild(f,r):ce.EMPTY_NODE}s=p.equals(d)?e:$e(e,t.filter.updateChild(c.getNode(),h,d,f,l,a),c.isFullyInitialized(),t.filter.filtersNodes())}}return s}function xn(t,e){return t.eventCache.isCompleteForChild(e)}function Dn(t,e,n){return n.foreach((function(t,n){e=e.updateChild(t,n)})),e}function Ln(t,e,n,r,i,o,a,s){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;var u,c=e;u=Ct(n)?r:new nn(null).setTree(n,r);var l=e.serverCache.getNode();return u.children.inorderTraversal((function(n,r){if(l.hasChild(n)){var u=Dn(0,e.serverCache.getNode().getImmediateChild(n),r);c=On(t,c,new yt(n),u,i,o,a,s)}})),u.children.inorderTraversal((function(n,r){var u=!e.serverCache.isCompleteForChild(n)&&void 0===r.value;if(!l.hasChild(n)&&!u){var h=Dn(0,e.serverCache.getNode().getImmediateChild(n),r);c=On(t,c,new yt(n),h,i,o,a,s)}})),c}var Mn,Fn=function(){function t(t,e){this.query_=t,this.eventRegistrations_=[];var n,r=this.query_._queryParams,i=new Ee(r.getIndex()),o=(n=r).loadsAllData()?new Ee(n.getIndex()):n.hasLimit()?new Ce(n):new Se(n);this.processor_=function(t){return{filter:t}}(o);var a=e.serverCache,s=e.eventCache,u=i.updateFullNode(ce.EMPTY_NODE,a.getNode(),null),c=o.updateFullNode(ce.EMPTY_NODE,s.getNode(),null),l=new Qe(u,a.isFullyInitialized(),i.filtersNodes()),h=new Qe(c,s.isFullyInitialized(),o.filtersNodes());this.viewCache_=Je(h,l),this.eventGenerator_=new Ye(this.query_)}return Object.defineProperty(t.prototype,"query",{get:function(){return this.query_},enumerable:!1,configurable:!0}),t}();function Un(t,e){var n=en(t.viewCache_);return n&&(t.query._queryParams.loadsAllData()||!Ct(e)&&!n.getImmediateChild(bt(e)).isEmpty())?n.getChild(e):null}function jn(t){return 0===t.eventRegistrations_.length}function qn(t,e,n){var r=[];if(n){(0,o.assert)(null==e,"A cancel should cancel all event registrations.");var i=t.query._path;t.eventRegistrations_.forEach((function(t){var e=t.createCancelEvent(n,i);e&&r.push(e)}))}if(e){for(var a=[],s=0;s<t.eventRegistrations_.length;++s){var u=t.eventRegistrations_[s];if(u.matches(e)){if(e.hasAnyCallback()){a=a.concat(t.eventRegistrations_.slice(s+1));break}}else a.push(u)}t.eventRegistrations_=a}else t.eventRegistrations_=[];return r}function Vn(t,e,n,r){e.type===je.MERGE&&null!==e.source.queryId&&((0,o.assert)(en(t.viewCache_),"We should always have a full cache before handling merges"),(0,o.assert)(tn(t.viewCache_),"Missing event cache, even though we have a server cache"));var i,a,s=t.viewCache_,u=function(t,e,n,r,i){var a,s,u=new kn;if(n.type===je.OVERWRITE){var c=n;c.source.fromUser?a=Rn(t,e,c.path,c.snap,r,i,u):((0,o.assert)(c.source.fromServer,"Unknown source."),s=c.source.tagged||e.serverCache.isFiltered()&&!Ct(c.path),a=On(t,e,c.path,c.snap,r,i,s,u))}else if(n.type===je.MERGE){var l=n;l.source.fromUser?a=function(t,e,n,r,i,o,a){var s=e;return r.foreach((function(r,u){var c=St(n,r);xn(e,bt(c))&&(s=Rn(t,s,c,u,i,o,a))})),r.foreach((function(r,u){var c=St(n,r);xn(e,bt(c))||(s=Rn(t,s,c,u,i,o,a))})),s}(t,e,l.path,l.children,r,i,u):((0,o.assert)(l.source.fromServer,"Unknown source."),s=l.source.tagged||e.serverCache.isFiltered(),a=Ln(t,e,l.path,l.children,r,i,s,u))}else if(n.type===je.ACK_USER_WRITE){var h=n;a=h.revert?function(t,e,n,r,i,a){var s;if(null!=Tn(r,n))return e;var u=new Nn(r,e,i),c=e.eventCache.getNode(),l=void 0;if(Ct(n)||".priority"===bt(n)){var h=void 0;if(e.serverCache.isFullyInitialized())h=_n(r,en(e));else{var f=e.serverCache.getNode();(0,o.assert)(f instanceof ce,"serverChildren would be complete if leaf node"),h=wn(r,f)}h=h,l=t.filter.updateFullNode(c,h,a)}else{var p=bt(n),d=En(r,p,e.serverCache);null==d&&e.serverCache.isCompleteForChild(p)&&(d=c.getImmediateChild(p)),(l=null!=d?t.filter.updateChild(c,p,d,wt(n),u,a):e.eventCache.getNode().hasChild(p)?t.filter.updateChild(c,p,ce.EMPTY_NODE,wt(n),u,a):c).isEmpty()&&e.serverCache.isFullyInitialized()&&(s=_n(r,en(e))).isLeafNode()&&(l=t.filter.updateFullNode(l,s,a))}return s=e.serverCache.isFullyInitialized()||null!=Tn(r,mt()),$e(e,l,s,t.filter.filtersNodes())}(t,e,h.path,r,i,u):function(t,e,n,r,i,o,a){if(null!=Tn(i,n))return e;var s=e.serverCache.isFiltered(),u=e.serverCache;if(null!=r.value){if(Ct(n)&&u.isFullyInitialized()||u.isCompleteForPath(n))return On(t,e,n,u.getNode().getChild(n),i,o,s,a);if(Ct(n)){var c=new nn(null);return u.getNode().forEachChild(Bt,(function(t,e){c=c.set(new yt(t),e)})),Ln(t,e,n,c,i,o,s,a)}return e}var l=new nn(null);return r.foreach((function(t,e){var r=St(n,t);u.isCompleteForPath(r)&&(l=l.set(t,u.getNode().getChild(r)))})),Ln(t,e,n,l,i,o,s,a)}(t,e,h.path,h.affectedTree,r,i,u)}else{if(n.type!==je.LISTEN_COMPLETE)throw(0,o.assertionError)("Unknown operation type: "+n.type);a=function(t,e,n,r,i){var o=e.serverCache;return Pn(t,Ze(e,o.getNode(),o.isFullyInitialized()||Ct(n),o.isFiltered()),n,r,An,i)}(t,e,n.path,r,u)}var f=u.getChanges();return function(t,e,n){var r=e.eventCache;if(r.isFullyInitialized()){var i=r.getNode().isLeafNode()||r.getNode().isEmpty(),o=tn(t);(n.length>0||!t.eventCache.isFullyInitialized()||i&&!r.getNode().equals(o)||!r.getNode().getPriority().equals(o.getPriority()))&&n.push(_e(tn(e)))}}(e,a,f),{viewCache:a,changes:f}}(t.processor_,s,e,n,r);return i=t.processor_,a=u.viewCache,(0,o.assert)(a.eventCache.getNode().isIndexed(i.filter.getIndex()),"Event snap not indexed"),(0,o.assert)(a.serverCache.getNode().isIndexed(i.filter.getIndex()),"Server snap not indexed"),(0,o.assert)(u.viewCache.serverCache.isFullyInitialized()||!s.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),t.viewCache_=u.viewCache,Bn(t,u.changes,u.viewCache.eventCache.getNode(),null)}function Bn(t,e,n,r){var i=r?[r]:t.eventRegistrations_;return function(t,e,n,r){var i=[],o=[];return e.forEach((function(e){var n;"child_changed"===e.type&&t.index_.indexedValueChanged(e.oldSnap,e.snapshotNode)&&o.push((n=e.childName,{type:"child_moved",snapshotNode:e.snapshotNode,childName:n}))})),Xe(t,i,"child_removed",e,r,n),Xe(t,i,"child_added",e,r,n),Xe(t,i,"child_moved",o,r,n),Xe(t,i,"child_changed",e,r,n),Xe(t,i,"value",e,r,n),i}(t.eventGenerator_,e,n,i)}var Kn,Wn=function(){this.views=new Map};function Gn(t,e,n,r){var i,a,s=e.source.queryId;if(null!==s){var u=t.views.get(s);return(0,o.assert)(null!=u,"SyncTree gave us an op for an invalid query."),Vn(u,e,n,r)}var l=[];try{for(var h=c(t.views.values()),f=h.next();!f.done;f=h.next())u=f.value,l=l.concat(Vn(u,e,n,r))}catch(t){i={error:t}}finally{try{f&&!f.done&&(a=h.return)&&a.call(h)}finally{if(i)throw i.error}}return l}function Hn(t,e,n,r,i){var o=e._queryIdentifier,a=t.views.get(o);if(!a){var s=_n(n,i?r:null),u=!1;s?u=!0:r instanceof ce?(s=wn(n,r),u=!1):(s=ce.EMPTY_NODE,u=!1);var c=Je(new Qe(s,u,!1),new Qe(r,i,!1));return new Fn(e,c)}return a}function zn(t){var e,n,r=[];try{for(var i=c(t.views.values()),o=i.next();!o.done;o=i.next()){var a=o.value;a.query._queryParams.loadsAllData()||r.push(a)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function Qn(t,e){var n,r,i=null;try{for(var o=c(t.views.values()),a=o.next();!a.done;a=o.next()){var s=a.value;i=i||Un(s,e)}}catch(t){n={error:t}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return i}function Yn(t,e){if(e._queryParams.loadsAllData())return $n(t);var n=e._queryIdentifier;return t.views.get(n)}function Xn(t,e){return null!=Yn(t,e)}function Jn(t){return null!=$n(t)}function $n(t){var e,n;try{for(var r=c(t.views.values()),i=r.next();!i.done;i=r.next()){var o=i.value;if(o.query._queryParams.loadsAllData())return o}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}return null}var Zn=1,tr=function(t){this.listenProvider_=t,this.syncPointTree_=new nn(null),this.pendingWriteTree_={visibleWrites:rn.empty(),allWrites:[],lastWriteId:-1},this.tagToQueryMap=new Map,this.queryToTagMap=new Map};function er(t,e,n,r,i){return function(t,e,n,r,i){(0,o.assert)(r>t.lastWriteId,"Stacking an older write on top of newer ones"),void 0===i&&(i=!0),t.allWrites.push({path:e,snap:n,writeId:r,visible:i}),i&&(t.visibleWrites=on(t.visibleWrites,e,n)),t.lastWriteId=r}(t.pendingWriteTree_,e,n,r,i),i?sr(t,new He({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},e,n)):[]}function nr(t,e,n){void 0===n&&(n=!1);var r=function(t,e){for(var n=0;n<t.allWrites.length;n++){var r=t.allWrites[n];if(r.writeId===e)return r}return null}(t.pendingWriteTree_,e);if(function(t,e){var n=t.allWrites.findIndex((function(t){return t.writeId===e}));(0,o.assert)(n>=0,"removeWrite called with nonexistent writeId.");var r=t.allWrites[n];t.allWrites.splice(n,1);for(var i=r.visible,a=!1,s=t.allWrites.length-1;i&&s>=0;){var u=t.allWrites[s];u.visible&&(s>=n&&gn(u,r.path)?i=!1:Pt(r.path,u.path)&&(a=!0)),s--}return!!i&&(a?(function(t){t.visibleWrites=mn(t.allWrites,yn,mt()),t.allWrites.length>0?t.lastWriteId=t.allWrites[t.allWrites.length-1].writeId:t.lastWriteId=-1}(t),!0):(r.snap?t.visibleWrites=sn(t.visibleWrites,r.path):V(r.children,(function(e){t.visibleWrites=sn(t.visibleWrites,St(r.path,e))})),!0))}(t.pendingWriteTree_,e)){var i=new nn(null);return null!=r.snap?i=i.set(mt(),!0):V(r.children,(function(t){i=i.set(new yt(t),!0)})),sr(t,new We(r.path,i,n))}return[]}function rr(t,e,n){return sr(t,new He({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e,n))}function ir(t,e,n,r){var i=e._path,a=t.syncPointTree_.get(i),s=[];if(a&&("default"===e._queryIdentifier||Xn(a,e))){var u=function(t,e,n,r){var i,a,s=e._queryIdentifier,u=[],h=[],f=Jn(t);if("default"===s)try{for(var p=c(t.views.entries()),d=p.next();!d.done;d=p.next()){var v=l(d.value,2),g=v[0],y=v[1];h=h.concat(qn(y,n,r)),jn(y)&&(t.views.delete(g),y.query._queryParams.loadsAllData()||u.push(y.query))}}catch(t){i={error:t}}finally{try{d&&!d.done&&(a=p.return)&&a.call(p)}finally{if(i)throw i.error}}else(y=t.views.get(s))&&(h=h.concat(qn(y,n,r)),jn(y)&&(t.views.delete(s),y.query._queryParams.loadsAllData()||u.push(y.query)));return f&&!Jn(t)&&u.push(new((0,o.assert)(Mn,"Reference.ts has not been loaded"),Mn)(e._repo,e._path)),{removed:u,events:h}}(a,e,n,r);0===a.views.size&&(t.syncPointTree_=t.syncPointTree_.remove(i));var h=u.removed;s=u.events;var f=-1!==h.findIndex((function(t){return t._queryParams.loadsAllData()})),p=t.syncPointTree_.findOnPath(i,(function(t,e){return Jn(e)}));if(f&&!p){var d=t.syncPointTree_.subtree(i);if(!d.isEmpty())for(var v=function(t){return t.fold((function(t,e,n){if(e&&Jn(e))return[$n(e)];var r=[];return e&&(r=zn(e)),V(n,(function(t,e){r=r.concat(e)})),r}))}(d),g=0;g<v.length;++g){var y=v[g],m=y.query,b=lr(t,y);t.listenProvider_.startListening(gr(m),hr(t,m),b.hashFn,b.onComplete)}}!p&&h.length>0&&!r&&(f?t.listenProvider_.stopListening(gr(e),null):h.forEach((function(e){var n=t.queryToTagMap.get(fr(e));t.listenProvider_.stopListening(gr(e),n)}))),function(t,e){for(var n=0;n<e.length;++n){var r=e[n];if(!r._queryParams.loadsAllData()){var i=fr(r),o=t.queryToTagMap.get(i);t.queryToTagMap.delete(i),t.tagToQueryMap.delete(o)}}}(t,h)}return s}function or(t,e,n){var r=e._path,i=null,a=!1;t.syncPointTree_.foreachOnPath(r,(function(t,e){var n=kt(t,r);i=i||Qn(e,n),a=a||Jn(e)}));var s,u=t.syncPointTree_.get(r);u?(a=a||Jn(u),i=i||Qn(u,mt())):(u=new Wn,t.syncPointTree_=t.syncPointTree_.set(r,u)),null!=i?s=!0:(s=!1,i=ce.EMPTY_NODE,t.syncPointTree_.subtree(r).foreachChild((function(t,e){var n=Qn(e,mt());n&&(i=i.updateImmediateChild(t,n))})));var c=Xn(u,e);if(!c&&!e._queryParams.loadsAllData()){var l=fr(e);(0,o.assert)(!t.queryToTagMap.has(l),"View does not exist, but we have a tag");var h=Zn++;t.queryToTagMap.set(l,h),t.tagToQueryMap.set(h,l)}var f=function(t,e,n,r,i,o){var a=Hn(t,e,r,i,o);return t.views.has(e._queryIdentifier)||t.views.set(e._queryIdentifier,a),function(t,e){t.eventRegistrations_.push(e)}(a,n),function(t,e){var n=t.viewCache_.eventCache,r=[];return n.getNode().isLeafNode()||n.getNode().forEachChild(re,(function(t,e){r.push(we(t,e))})),n.isFullyInitialized()&&r.push(_e(n.getNode())),Bn(t,r,n.getNode(),e)}(a,n)}(u,e,n,vn(t.pendingWriteTree_,r),i,s);if(!c&&!a){var p=Yn(u,e);f=f.concat(function(t,e,n){var r=e._path,i=hr(t,e),a=lr(t,n),s=t.listenProvider_.startListening(gr(e),i,a.hashFn,a.onComplete),u=t.syncPointTree_.subtree(r);if(i)(0,o.assert)(!Jn(u.value),"If we're adding a query, it shouldn't be shadowed");else for(var c=u.fold((function(t,e,n){if(!Ct(t)&&e&&Jn(e))return[$n(e).query];var r=[];return e&&(r=r.concat(zn(e).map((function(t){return t.query})))),V(n,(function(t,e){r=r.concat(e)})),r})),l=0;l<c.length;++l){var h=c[l];t.listenProvider_.stopListening(gr(h),hr(t,h))}return s}(t,e,p))}return f}function ar(t,e,n){var r=t.pendingWriteTree_,i=t.syncPointTree_.findOnPath(e,(function(t,n){var r=Qn(n,kt(t,e));if(r)return r}));return bn(r,e,i,n,!0)}function sr(t,e){return ur(e,t.syncPointTree_,null,vn(t.pendingWriteTree_,mt()))}function ur(t,e,n,r){if(Ct(t.path))return cr(t,e,n,r);var i=e.get(mt());null==n&&null!=i&&(n=Qn(i,mt()));var o=[],a=bt(t.path),s=t.operationForChild(a),u=e.children.get(a);if(u&&s){var c=n?n.getImmediateChild(a):null,l=Sn(r,a);o=o.concat(ur(s,u,c,l))}return i&&(o=o.concat(Gn(i,t,r,n))),o}function cr(t,e,n,r){var i=e.get(mt());null==n&&null!=i&&(n=Qn(i,mt()));var o=[];return e.children.inorderTraversal((function(e,i){var a=n?n.getImmediateChild(e):null,s=Sn(r,e),u=t.operationForChild(e);u&&(o=o.concat(cr(u,i,a,s)))})),i&&(o=o.concat(Gn(i,t,r,n))),o}function lr(t,e){var n=e.query,r=hr(t,n);return{hashFn:function(){return(function(t){return t.viewCache_.serverCache.getNode()}(e)||ce.EMPTY_NODE).hash()},onComplete:function(e){if("ok"===e)return r?function(t,e,n){var r=pr(t,n);if(r){var i=dr(r),o=i.path,a=i.queryId,s=kt(o,e);return vr(t,o,new Ge(Be(a),s))}return[]}(t,n._path,r):function(t,e){return sr(t,new Ge({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e))}(t,n._path);var i=function(t,e){var n="Unknown Error";"too_big"===t?n="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"===t?n="Client doesn't have permission to access the desired data.":"unavailable"===t&&(n="The service is unavailable");var r=new Error(t+" at "+e._path.toString()+": "+n);return r.code=t.toUpperCase(),r}(e,n);return ir(t,n,null,i)}}}function hr(t,e){var n=fr(e);return t.queryToTagMap.get(n)}function fr(t){return t._path.toString()+"$"+t._queryIdentifier}function pr(t,e){return t.tagToQueryMap.get(e)}function dr(t){var e=t.indexOf("$");return(0,o.assert)(-1!==e&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new yt(t.substr(0,e))}}function vr(t,e,n){var r=t.syncPointTree_.get(e);return(0,o.assert)(r,"Missing sync point for query tag that we're tracking"),Gn(r,n,vn(t.pendingWriteTree_,e),null)}function gr(t){return t._queryParams.loadsAllData()&&!t._queryParams.isDefault()?new((0,o.assert)(Kn,"Reference.ts has not been loaded"),Kn)(t._repo,t._path):t}var yr=function(){function t(t){this.node_=t}return t.prototype.getImmediateChild=function(e){return new t(this.node_.getImmediateChild(e))},t.prototype.node=function(){return this.node_},t}(),mr=function(){function t(t,e){this.syncTree_=t,this.path_=e}return t.prototype.getImmediateChild=function(e){var n=St(this.path_,e);return new t(this.syncTree_,n)},t.prototype.node=function(){return ar(this.syncTree_,this.path_)},t}(),br=function(t,e,n){return t&&"object"==typeof t?((0,o.assert)(".sv"in t,"Unexpected leaf node or priority contents"),"string"==typeof t[".sv"]?_r(t[".sv"],e,n):"object"==typeof t[".sv"]?wr(t[".sv"],e):void(0,o.assert)(!1,"Unexpected server value: "+JSON.stringify(t,null,2))):t},_r=function(t,e,n){switch(t){case"timestamp":return n.timestamp;default:(0,o.assert)(!1,"Unexpected server value: "+t)}},wr=function(t,e,n){t.hasOwnProperty("increment")||(0,o.assert)(!1,"Unexpected server value: "+JSON.stringify(t,null,2));var r=t.increment;"number"!=typeof r&&(0,o.assert)(!1,"Unexpected increment value: "+r);var i=e.node();if((0,o.assert)(null!=i,"Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;var a=i.getValue();return"number"!=typeof a?r:a+r},Ir=function(t,e,n,r){return Er(e,new mr(n,t),r)},Tr=function(t,e,n){return Er(t,new yr(e),n)};function Er(t,e,n){var r,i=t.getPriority().val(),o=br(i,e.getImmediateChild(".priority"),n);if(t.isLeafNode()){var a=t,s=br(a.getValue(),e,n);return s!==a.getValue()||o!==a.getPriority().val()?new ne(s,he(o)):t}var u=t;return r=u,o!==u.getPriority().val()&&(r=r.updatePriority(new ne(o))),u.forEachChild(re,(function(t,i){var o=Er(i,e.getImmediateChild(t),n);o!==i&&(r=r.updateImmediateChild(t,o))})),r}var Sr=function(t,e,n){void 0===t&&(t=""),void 0===e&&(e=null),void 0===n&&(n={children:{},childCount:0}),this.name=t,this.parent=e,this.node=n};function Cr(t,e){for(var n=e instanceof yt?e:new yt(e),r=t,i=bt(n);null!==i;){var a=(0,o.safeGet)(r.node.children,i)||{children:{},childCount:0};r=new Sr(i,r,a),i=bt(n=wt(n))}return r}function kr(t){return t.node.value}function Ar(t,e){t.node.value=e,xr(t)}function Nr(t){return t.node.childCount>0}function Pr(t,e){V(t.node.children,(function(n,r){e(new Sr(n,t,r))}))}function Or(t,e,n,r){n&&!r&&e(t),Pr(t,(function(t){Or(t,e,!0,r)})),n&&r&&e(t)}function Rr(t){return new yt(null===t.parent?t.name:Rr(t.parent)+"/"+t.name)}function xr(t){null!==t.parent&&function(t,e,n){var r=function(t){return void 0===kr(t)&&!Nr(t)}(n),i=(0,o.contains)(t.node.children,e);r&&i?(delete t.node.children[e],t.node.childCount--,xr(t)):r||i||(t.node.children[e]=n.node,t.node.childCount++,xr(t))}(t.parent,t.name,t)}var Dr=/[\[\].#$\/\u0000-\u001F\u007F]/,Lr=/[\[\].#$\u0000-\u001F\u007F]/,Mr=10485760,Fr=function(t){return"string"==typeof t&&0!==t.length&&!Dr.test(t)},Ur=function(t){return"string"==typeof t&&0!==t.length&&!Lr.test(t)},jr=function(t){return null===t||"string"==typeof t||"number"==typeof t&&!x(t)||t&&"object"==typeof t&&(0,o.contains)(t,".sv")},qr=function(t,e,n,r){r&&void 0===e||Vr((0,o.errorPrefix)(t,"value"),e,n)},Vr=function(t,e,n){var r=n instanceof yt?new Ot(n,t):n;if(void 0===e)throw new Error(t+"contains undefined "+xt(r));if("function"==typeof e)throw new Error(t+"contains a function "+xt(r)+" with contents = "+e.toString());if(x(e))throw new Error(t+"contains "+e.toString()+" "+xt(r));if("string"==typeof e&&e.length>Mr/3&&(0,o.stringLength)(e)>Mr)throw new Error(t+"contains a string greater than 10485760 utf8 bytes "+xt(r)+" ('"+e.substring(0,50)+"...')");if(e&&"object"==typeof e){var i=!1,a=!1;if(V(e,(function(e,n){if(".value"===e)i=!0;else if(".priority"!==e&&".sv"!==e&&(a=!0,!Fr(e)))throw new Error(t+" contains an invalid key ("+e+") "+xt(r)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');var s,u;!function(t,e){t.parts_.length>0&&(t.byteLength_+=1),t.parts_.push(e),t.byteLength_+=(0,o.stringLength)(e),Rt(t)}(r,e),Vr(t,n,r),u=(s=r).parts_.pop(),s.byteLength_-=(0,o.stringLength)(u),s.parts_.length>0&&(s.byteLength_-=1)})),i&&a)throw new Error(t+' contains ".value" child '+xt(r)+" in addition to actual children.")}},Br=function(t,e,n,r){if(!r||void 0!==e){var i=(0,o.errorPrefix)(t,"values");if(!e||"object"!=typeof e||Array.isArray(e))throw new Error(i+" must be an object containing the children to replace.");var a=[];V(e,(function(t,e){var r=new yt(t);if(Vr(i,e,St(n,r)),".priority"===It(r)&&!jr(e))throw new Error(i+"contains an invalid value for '"+r.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");a.push(r)})),function(t,e){var n,r;for(n=0;n<e.length;n++)for(var i=Tt(r=e[n]),o=0;o<i.length;o++)if(".priority"===i[o]&&o===i.length-1);else if(!Fr(i[o]))throw new Error(t+"contains an invalid key ("+i[o]+") in path "+r.toString()+'. Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');e.sort(At);var a=null;for(n=0;n<e.length;n++){if(r=e[n],null!==a&&Pt(a,r))throw new Error(t+"contains a path "+a.toString()+" that is ancestor of another path "+r.toString());a=r}}(i,a)}},Kr=function(t,e,n){if(!n||void 0!==e){if(x(e))throw new Error((0,o.errorPrefix)(t,"priority")+"is "+e.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!jr(e))throw new Error((0,o.errorPrefix)(t,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},Wr=function(t,e,n){if(!n||void 0!==e)switch(e){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error((0,o.errorPrefix)(t,"eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}},Gr=function(t,e,n,r){if(!(r&&void 0===n||Fr(n)))throw new Error((0,o.errorPrefix)(t,e)+'was an invalid key = "'+n+'".  Firebase keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]").')},Hr=function(t,e,n,r){if(!(r&&void 0===n||Ur(n)))throw new Error((0,o.errorPrefix)(t,e)+'was an invalid path = "'+n+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},zr=function(t,e){if(".info"===bt(e))throw new Error(t+" failed = Can't modify data under /.info/")},Qr=function(t,e){var n=e.path.toString();if("string"!=typeof e.repoInfo.host||0===e.repoInfo.host.length||!Fr(e.repoInfo.namespace)&&"localhost"!==e.repoInfo.host.split(":")[0]||0!==n.length&&!function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),Ur(t)}(n))throw new Error((0,o.errorPrefix)(t,"url")+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')},Yr=function(t,e,n,r){if((!r||void 0!==n)&&"boolean"!=typeof n)throw new Error((0,o.errorPrefix)(t,e)+"must be a boolean.")},Xr=function(){this.eventLists_=[],this.recursionDepth_=0};function Jr(t,e){for(var n=null,r=0;r<e.length;r++){var i=e[r],o=i.getPath();null===n||Nt(o,n.path)||(t.eventLists_.push(n),n=null),null===n&&(n={events:[],path:o}),n.events.push(i)}n&&t.eventLists_.push(n)}function $r(t,e,n){Jr(t,n),ti(t,(function(t){return Nt(t,e)}))}function Zr(t,e,n){Jr(t,n),ti(t,(function(t){return Pt(t,e)||Pt(e,t)}))}function ti(t,e){t.recursionDepth_++;for(var n=!0,r=0;r<t.eventLists_.length;r++){var i=t.eventLists_[r];i&&(e(i.path)?(ei(t.eventLists_[r]),t.eventLists_[r]=null):n=!1)}n&&(t.eventLists_=[]),t.recursionDepth_--}function ei(t){for(var e=0;e<t.events.length;e++){var n=t.events[e];if(null!==n){t.events[e]=null;var r=n.getEventRunner();S&&A("event: "+n.toString()),G(r)}}}var ni="repo_interrupt",ri=function(){function t(t,e,n,r){this.repoInfo_=t,this.forceRestClient_=e,this.authTokenProvider_=n,this.appCheckProvider_=r,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new Xr,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=Le(),this.transactionQueueTree_=new Sr,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}return t.prototype.toString=function(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host},t}();function ii(t){var e=t.infoData_.getNode(new yt(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+e}function oi(t){return(e=(e={timestamp:ii(t)})||{}).timestamp=e.timestamp||(new Date).getTime(),e;var e}function ai(t,e,n,r,i){t.dataUpdateCount++;var a=new yt(e);n=t.interceptServerDataCallback_?t.interceptServerDataCallback_(e,n):n;var s=[];if(i)if(r){var u=(0,o.map)(n,(function(t){return he(t)}));s=function(t,e,n,r){var i=pr(t,r);if(i){var o=dr(i),a=o.path,s=o.queryId,u=kt(a,e),c=nn.fromObject(n);return vr(t,a,new ze(Be(s),u,c))}return[]}(t.serverSyncTree_,a,u,i)}else{var c=he(n);s=function(t,e,n,r){var i=pr(t,r);if(null!=i){var o=dr(i),a=o.path,s=o.queryId,u=kt(a,e);return vr(t,a,new He(Be(s),u,n))}return[]}(t.serverSyncTree_,a,c,i)}else if(r){var l=(0,o.map)(n,(function(t){return he(t)}));s=function(t,e,n){var r=nn.fromObject(n);return sr(t,new ze({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e,r))}(t.serverSyncTree_,a,l)}else{var h=he(n);s=rr(t.serverSyncTree_,a,h)}var f=a;s.length>0&&(f=bi(t,a)),Zr(t.eventQueue_,f,s)}function si(t,e){ui(t,"connected",e),!1===e&&function(t){vi(t,"onDisconnectEvents");var e=oi(t),n=Le();Ue(t.onDisconnect_,mt(),(function(r,i){var o=Ir(r,i,t.serverSyncTree_,e);Me(n,r,o)}));var r=[];Ue(n,mt(),(function(e,n){r=r.concat(rr(t.serverSyncTree_,e,n));var i=Ei(t,e);bi(t,i)})),t.onDisconnect_=Le(),Zr(t.eventQueue_,mt(),r)}(t)}function ui(t,e,n){var r=new yt("/.info/"+e),i=he(n);t.infoData_.updateSnapshot(r,i);var o=rr(t.infoSyncTree_,r,i);Zr(t.eventQueue_,r,o)}function ci(t){return t.nextWriteId_++}function li(t,e,n,r,i){vi(t,"set",{path:e.toString(),value:n,priority:r});var o=oi(t),a=he(n,r),s=ar(t.serverSyncTree_,e),u=Tr(a,s,o),c=ci(t),l=er(t.serverSyncTree_,e,u,c,!0);Jr(t.eventQueue_,l),t.server_.put(e.toString(),a.val(!0),(function(n,r){var o="ok"===n;o||R("set at "+e+" failed: "+n);var a=nr(t.serverSyncTree_,c,!o);Zr(t.eventQueue_,e,a),gi(0,i,n,r)}));var h=Ei(t,e);bi(t,h),Zr(t.eventQueue_,h,[])}function hi(t,e,n){t.server_.onDisconnectCancel(e.toString(),(function(r,i){"ok"===r&&Fe(t.onDisconnect_,e),gi(0,n,r,i)}))}function fi(t,e,n,r){var i=he(n);t.server_.onDisconnectPut(e.toString(),i.val(!0),(function(n,o){"ok"===n&&Me(t.onDisconnect_,e,i),gi(0,r,n,o)}))}function pi(t,e,n){var r;r=".info"===bt(e._path)?ir(t.infoSyncTree_,e,n):ir(t.serverSyncTree_,e,n),$r(t.eventQueue_,e._path,r)}function di(t){t.persistentConnection_&&t.persistentConnection_.interrupt(ni)}function vi(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r="";t.persistentConnection_&&(r=t.persistentConnection_.id+":"),A.apply(void 0,h([r],l(e)))}function gi(t,e,n,r){e&&G((function(){if("ok"===n)e(null);else{var t=(n||"error").toUpperCase(),i=t;r&&(i+=": "+r);var o=new Error(i);o.code=t,e(o)}}))}function yi(t,e,n){return ar(t.serverSyncTree_,e,n)||ce.EMPTY_NODE}function mi(t,e){if(void 0===e&&(e=t.transactionQueueTree_),e||Ti(t,e),kr(e)){var n=wi(t,e);(0,o.assert)(n.length>0,"Sending zero length transaction queue"),n.every((function(t){return 0===t.status}))&&function(t,e,n){for(var r=n.map((function(t){return t.currentWriteId})),i=yi(t,e,r),a=i,s=i.hash(),u=0;u<n.length;u++){var c=n[u];(0,o.assert)(0===c.status,"tryToSendTransactionQueue_: items in queue should all be run."),c.status=1,c.retryCount++;var l=kt(e,c.path);a=a.updateChild(l,c.currentOutputSnapshotRaw)}var h=a.val(!0),f=e;t.server_.put(f.toString(),h,(function(r){vi(t,"transaction put response",{path:f.toString(),status:r});var i=[];if("ok"===r){for(var o=[],a=function(e){n[e].status=2,i=i.concat(nr(t.serverSyncTree_,n[e].currentWriteId)),n[e].onComplete&&o.push((function(){return n[e].onComplete(null,!0,n[e].currentOutputSnapshotResolved)})),n[e].unwatcher()},s=0;s<n.length;s++)a(s);for(Ti(t,Cr(t.transactionQueueTree_,e)),mi(t,t.transactionQueueTree_),Zr(t.eventQueue_,e,i),s=0;s<o.length;s++)G(o[s])}else{if("datastale"===r)for(s=0;s<n.length;s++)3===n[s].status?n[s].status=4:n[s].status=0;else for(R("transaction at "+f.toString()+" failed: "+r),s=0;s<n.length;s++)n[s].status=4,n[s].abortReason=r;bi(t,e)}}),s)}(t,Rr(e),n)}else Nr(e)&&Pr(e,(function(e){mi(t,e)}))}function bi(t,e){var n=_i(t,e),r=Rr(n);return function(t,e,n){if(0!==e.length){for(var r=[],i=[],a=e.filter((function(t){return 0===t.status})).map((function(t){return t.currentWriteId})),s=function(s){var u,c,l=e[s],h=kt(n,l.path),f=!1;if((0,o.assert)(null!==h,"rerunTransactionsUnderNode_: relativePath should not be null."),4===l.status)f=!0,u=l.abortReason,i=i.concat(nr(t.serverSyncTree_,l.currentWriteId,!0));else if(0===l.status)if(l.retryCount>=25)f=!0,u="maxretry",i=i.concat(nr(t.serverSyncTree_,l.currentWriteId,!0));else{var p=yi(t,l.path,a);l.currentInputSnapshot=p;var d=e[s].update(p.val());if(void 0!==d){Vr("transaction failed: Data returned ",d,l.path);var v=he(d);"object"==typeof d&&null!=d&&(0,o.contains)(d,".priority")||(v=v.updatePriority(p.getPriority()));var g=l.currentWriteId,y=oi(t),m=Tr(v,p,y);l.currentOutputSnapshotRaw=v,l.currentOutputSnapshotResolved=m,l.currentWriteId=ci(t),a.splice(a.indexOf(g),1),i=(i=i.concat(er(t.serverSyncTree_,l.path,m,l.currentWriteId,l.applyLocally))).concat(nr(t.serverSyncTree_,g,!0))}else f=!0,u="nodata",i=i.concat(nr(t.serverSyncTree_,l.currentWriteId,!0))}Zr(t.eventQueue_,n,i),i=[],f&&(e[s].status=2,c=e[s].unwatcher,setTimeout(c,Math.floor(0)),e[s].onComplete&&("nodata"===u?r.push((function(){return e[s].onComplete(null,!1,e[s].currentInputSnapshot)})):r.push((function(){return e[s].onComplete(new Error(u),!1,null)}))))},u=0;u<e.length;u++)s(u);for(Ti(t,t.transactionQueueTree_),u=0;u<r.length;u++)G(r[u]);mi(t,t.transactionQueueTree_)}}(t,wi(t,n),r),r}function _i(t,e){var n,r=t.transactionQueueTree_;for(n=bt(e);null!==n&&void 0===kr(r);)r=Cr(r,n),n=bt(e=wt(e));return r}function wi(t,e){var n=[];return Ii(t,e,n),n.sort((function(t,e){return t.order-e.order})),n}function Ii(t,e,n){var r=kr(e);if(r)for(var i=0;i<r.length;i++)n.push(r[i]);Pr(e,(function(e){Ii(t,e,n)}))}function Ti(t,e){var n=kr(e);if(n){for(var r=0,i=0;i<n.length;i++)2!==n[i].status&&(n[r]=n[i],r++);n.length=r,Ar(e,n.length>0?n:void 0)}Pr(e,(function(e){Ti(t,e)}))}function Ei(t,e){var n=Rr(_i(t,e)),r=Cr(t.transactionQueueTree_,e);return function(t,e,n){for(var r=t.parent;null!==r;){if(e(r))return!0;r=r.parent}}(r,(function(e){Si(t,e)})),Si(t,r),Or(r,(function(e){Si(t,e)})),n}function Si(t,e){var n=kr(e);if(n){for(var r=[],i=[],a=-1,s=0;s<n.length;s++)3===n[s].status||(1===n[s].status?((0,o.assert)(a===s-1,"All SENT items should be at beginning of queue."),a=s,n[s].status=3,n[s].abortReason="set"):((0,o.assert)(0===n[s].status,"Unexpected transaction status in abort"),n[s].unwatcher(),i=i.concat(nr(t.serverSyncTree_,n[s].currentWriteId,!0)),n[s].onComplete&&r.push(n[s].onComplete.bind(null,new Error("set"),!1,null))));for(-1===a?Ar(e,void 0):n.length=a+1,Zr(t.eventQueue_,Rr(e),i),s=0;s<r.length;s++)G(r[s])}}var Ci=function(t,e){var n=ki(t),r=n.namespace;"firebase.com"===n.domain&&O(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),r&&"undefined"!==r||"localhost"===n.domain||O("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||"undefined"!=typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&R("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().");var i="ws"===n.scheme||"wss"===n.scheme;return{repoInfo:new Z(n.host,n.secure,r,e,i,"",r!==n.subdomain),path:new yt(n.pathString)}},ki=function(t){var e="",n="",r="",i="",o="",a=!0,s="https",u=443;if("string"==typeof t){var l=t.indexOf("//");l>=0&&(s=t.substring(0,l-1),t=t.substring(l+2));var h=t.indexOf("/");-1===h&&(h=t.length);var f=t.indexOf("?");-1===f&&(f=t.length),e=t.substring(0,Math.min(h,f)),h<f&&(i=function(t){for(var e="",n=t.split("/"),r=0;r<n.length;r++)if(n[r].length>0){var i=n[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch(t){}e+="/"+i}return e}(t.substring(h,f)));var p=function(t){var e,n,r={};"?"===t.charAt(0)&&(t=t.substring(1));try{for(var i=c(t.split("&")),o=i.next();!o.done;o=i.next()){var a=o.value;if(0!==a.length){var s=a.split("=");2===s.length?r[decodeURIComponent(s[0])]=decodeURIComponent(s[1]):R("Invalid query segment '"+a+"' in query '"+t+"'")}}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}(t.substring(Math.min(t.length,f)));(l=e.indexOf(":"))>=0?(a="https"===s||"wss"===s,u=parseInt(e.substring(l+1),10)):l=e.length;var d=e.slice(0,l);if("localhost"===d.toLowerCase())n="localhost";else if(d.split(".").length<=2)n=d;else{var v=e.indexOf(".");r=e.substring(0,v).toLowerCase(),n=e.substring(v+1),o=r}"ns"in p&&(o=p.ns)}return{host:e,port:u,domain:n,subdomain:r,secure:a,scheme:s,pathString:i,namespace:o}},Ai=function(){function t(t,e,n,r){this.eventType=t,this.eventRegistration=e,this.snapshot=n,this.prevName=r}return t.prototype.getPath=function(){var t=this.snapshot.ref;return"value"===this.eventType?t._path:t.parent._path},t.prototype.getEventType=function(){return this.eventType},t.prototype.getEventRunner=function(){return this.eventRegistration.getEventRunner(this)},t.prototype.toString=function(){return this.getPath().toString()+":"+this.eventType+":"+(0,o.stringify)(this.snapshot.exportVal())},t}(),Ni=function(){function t(t,e,n){this.eventRegistration=t,this.error=e,this.path=n}return t.prototype.getPath=function(){return this.path},t.prototype.getEventType=function(){return"cancel"},t.prototype.getEventRunner=function(){return this.eventRegistration.getEventRunner(this)},t.prototype.toString=function(){return this.path.toString()+":cancel"},t}(),Pi=function(){function t(t,e){this.snapshotCallback=t,this.cancelCallback=e}return t.prototype.onValue=function(t,e){this.snapshotCallback.call(null,t,e)},t.prototype.onCancel=function(t){return(0,o.assert)(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,t)},Object.defineProperty(t.prototype,"hasCancelCallback",{get:function(){return!!this.cancelCallback},enumerable:!1,configurable:!0}),t.prototype.matches=function(t){return this.snapshotCallback===t.snapshotCallback||this.snapshotCallback.userCallback===t.snapshotCallback.userCallback&&this.snapshotCallback.context===t.snapshotCallback.context},t}(),Oi=function(){function t(t,e){this._repo=t,this._path=e}return t.prototype.cancel=function(){var t=new o.Deferred;return hi(this._repo,this._path,t.wrapCallback((function(){}))),t.promise},t.prototype.remove=function(){zr("OnDisconnect.remove",this._path);var t=new o.Deferred;return fi(this._repo,this._path,null,t.wrapCallback((function(){}))),t.promise},t.prototype.set=function(t){zr("OnDisconnect.set",this._path),qr("OnDisconnect.set",t,this._path,!1);var e=new o.Deferred;return fi(this._repo,this._path,t,e.wrapCallback((function(){}))),e.promise},t.prototype.setWithPriority=function(t,e){zr("OnDisconnect.setWithPriority",this._path),qr("OnDisconnect.setWithPriority",t,this._path,!1),Kr("OnDisconnect.setWithPriority",e,!1);var n=new o.Deferred;return function(t,e,n,r,i){var o=he(n,r);t.server_.onDisconnectPut(e.toString(),o.val(!0),(function(n,r){"ok"===n&&Me(t.onDisconnect_,e,o),gi(0,i,n,r)}))}(this._repo,this._path,t,e,n.wrapCallback((function(){}))),n.promise},t.prototype.update=function(t){zr("OnDisconnect.update",this._path),Br("OnDisconnect.update",t,this._path,!1);var e=new o.Deferred;return function(t,e,n,r){if((0,o.isEmpty)(n))return A("onDisconnect().update() called with empty data.  Don't do anything."),void gi(0,r,"ok",void 0);t.server_.onDisconnectMerge(e.toString(),n,(function(i,o){"ok"===i&&V(n,(function(n,r){var i=he(r);Me(t.onDisconnect_,St(e,n),i)})),gi(0,r,i,o)}))}(this._repo,this._path,t,e.wrapCallback((function(){}))),e.promise},t}(),Ri=function(){function t(t,e,n,r){this._repo=t,this._path=e,this._queryParams=n,this._orderByCalled=r}return Object.defineProperty(t.prototype,"key",{get:function(){return Ct(this._path)?null:It(this._path)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ref",{get:function(){return new Mi(this._repo,this._path)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_queryIdentifier",{get:function(){var t=Re(this._queryParams),e=j(t);return"{}"===e?"default":e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_queryObject",{get:function(){return Re(this._queryParams)},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){if(!((e=(0,o.getModularInstance)(e))instanceof t))return!1;var n=this._repo===e._repo,r=Nt(this._path,e._path),i=this._queryIdentifier===e._queryIdentifier;return n&&r&&i},t.prototype.toJSON=function(){return this.toString()},t.prototype.toString=function(){return this._repo.toString()+function(t){for(var e="",n=t.pieceNum_;n<t.pieces_.length;n++)""!==t.pieces_[n]&&(e+="/"+encodeURIComponent(String(t.pieces_[n])));return e||"/"}(this._path)},t}();function xi(t,e){if(!0===t._orderByCalled)throw new Error(e+": You can't combine multiple orderBy calls.")}function Di(t){var e=null,n=null;if(t.hasStart()&&(e=t.getIndexStartValue()),t.hasEnd()&&(n=t.getIndexEndValue()),t.getIndex()===Bt){var r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",i="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(t.hasStart()){if(t.getIndexStartName()!==D)throw new Error(r);if("string"!=typeof e)throw new Error(i)}if(t.hasEnd()){if(t.getIndexEndName()!==L)throw new Error(r);if("string"!=typeof n)throw new Error(i)}}else if(t.getIndex()===re){if(null!=e&&!jr(e)||null!=n&&!jr(n))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if((0,o.assert)(t.getIndex()instanceof de||t.getIndex()===ve,"unknown index type."),null!=e&&"object"==typeof e||null!=n&&"object"==typeof n)throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function Li(t){if(t.hasStart()&&t.hasEnd()&&t.hasLimit()&&!t.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}var Mi=function(t){function e(e,n){return t.call(this,e,n,new ke,!1)||this}return s(e,t),Object.defineProperty(e.prototype,"parent",{get:function(){var t=Et(this._path);return null===t?null:new e(this._repo,t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"root",{get:function(){for(var t=this;null!==t.parent;)t=t.parent;return t},enumerable:!1,configurable:!0}),e}(Ri),Fi=function(){function t(t,e,n){this._node=t,this.ref=e,this._index=n}return Object.defineProperty(t.prototype,"priority",{get:function(){return this._node.getPriority().val()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"key",{get:function(){return this.ref.key},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._node.numChildren()},enumerable:!1,configurable:!0}),t.prototype.child=function(e){var n=new yt(e),r=qi(this.ref,e);return new t(this._node.getChild(n),r,re)},t.prototype.exists=function(){return!this._node.isEmpty()},t.prototype.exportVal=function(){return this._node.val(!0)},t.prototype.forEach=function(e){var n=this;return!this._node.isLeafNode()&&!!this._node.forEachChild(this._index,(function(r,i){return e(new t(i,qi(n.ref,r),re))}))},t.prototype.hasChild=function(t){var e=new yt(t);return!this._node.getChild(e).isEmpty()},t.prototype.hasChildren=function(){return!this._node.isLeafNode()&&!this._node.isEmpty()},t.prototype.toJSON=function(){return this.exportVal()},t.prototype.val=function(){return this._node.val()},t}();function Ui(t,e){return(t=(0,o.getModularInstance)(t))._checkNotDeleted("ref"),void 0!==e?qi(t._root,e):t._root}function ji(t,e){(t=(0,o.getModularInstance)(t))._checkNotDeleted("refFromURL");var n=Ci(e,t._repo.repoInfo_.nodeAdmin);Qr("refFromURL",n);var r=n.repoInfo;return t._repo.repoInfo_.isCustomHost()||r.host===t._repo.repoInfo_.host||O("refFromURL: Host name does not match the current database: (found "+r.host+" but expected "+t._repo.repoInfo_.host+")"),Ui(t,n.path.toString())}function qi(t,e){var n;return null===bt((t=(0,o.getModularInstance)(t))._path)?("child","path",!1,(n=e)&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),Hr("child","path",n,false)):Hr("child","path",e,!1),new Mi(t._repo,St(t._path,e))}function Vi(t,e){t=(0,o.getModularInstance)(t),zr("push",t._path),qr("push",e,t._path,!0);var n,r=ii(t._repo),i=ye(r),a=qi(t,i),s=qi(t,i);return n=null!=e?Ki(s,e).then((function(){return s})):Promise.resolve(s),a.then=n.then.bind(n),a.catch=n.then.bind(n,void 0),a}function Bi(t){return zr("remove",t._path),Ki(t,null)}function Ki(t,e){t=(0,o.getModularInstance)(t),zr("set",t._path),qr("set",e,t._path,!1);var n=new o.Deferred;return li(t._repo,t._path,e,null,n.wrapCallback((function(){}))),n.promise}function Wi(t,e){t=(0,o.getModularInstance)(t),zr("setPriority",t._path),Kr("setPriority",e,!1);var n=new o.Deferred;return li(t._repo,St(t._path,".priority"),e,null,n.wrapCallback((function(){}))),n.promise}function Gi(t,e,n){if(zr("setWithPriority",t._path),qr("setWithPriority",e,t._path,!1),Kr("setWithPriority",n,!1),".length"===t.key||".keys"===t.key)throw"setWithPriority failed: "+t.key+" is a read-only object.";var r=new o.Deferred;return li(t._repo,t._path,e,n,r.wrapCallback((function(){}))),r.promise}function Hi(t,e){Br("update",e,t._path,!1);var n=new o.Deferred;return function(t,e,n,r){vi(t,"update",{path:e.toString(),value:n});var i=!0,a=oi(t),s={};if(V(n,(function(n,r){i=!1,s[n]=Ir(St(e,n),he(r),t.serverSyncTree_,a)})),i)A("update() called with empty data.  Don't do anything."),gi(0,r,"ok",void 0);else{var u=ci(t),c=function(t,e,n,r){!function(t,e,n,r){(0,o.assert)(r>t.lastWriteId,"Stacking an older merge on top of newer ones"),t.allWrites.push({path:e,children:n,writeId:r,visible:!0}),t.visibleWrites=an(t.visibleWrites,e,n),t.lastWriteId=r}(t.pendingWriteTree_,e,n,r);var i=nn.fromObject(n);return sr(t,new ze({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},e,i))}(t.serverSyncTree_,e,s,u);Jr(t.eventQueue_,c),t.server_.merge(e.toString(),n,(function(n,i){var o="ok"===n;o||R("update at "+e+" failed: "+n);var a=nr(t.serverSyncTree_,u,!o),s=a.length>0?bi(t,e):e;Zr(t.eventQueue_,s,a),gi(0,r,n,i)})),V(n,(function(n){var r=Ei(t,St(e,n));bi(t,r)})),Zr(t.eventQueue_,e,[])}}(t._repo,t._path,e,n.wrapCallback((function(){}))),n.promise}function zi(t){return function(t,e){var n=function(t,e){var n=e._path,r=null;t.syncPointTree_.foreachOnPath(n,(function(t,e){var i=kt(t,n);r=r||Qn(e,i)}));var i=t.syncPointTree_.get(n);i?r=r||Qn(i,mt()):(i=new Wn,t.syncPointTree_=t.syncPointTree_.set(n,i));var o=null!=r,a=o?new Qe(r,!0,!1):null;return tn(Hn(i,e,vn(t.pendingWriteTree_,e._path),o?a.getNode():ce.EMPTY_NODE,o).viewCache_)}(t.serverSyncTree_,e);return null!=n?Promise.resolve(n):t.server_.get(e).then((function(n){var r=he(n),i=rr(t.serverSyncTree_,e._path,r);return $r(t.eventQueue_,e._path,i),Promise.resolve(r)}),(function(n){return vi(t,"get for query "+(0,o.stringify)(e)+" failed: "+n),Promise.reject(new Error(n))}))}((t=(0,o.getModularInstance)(t))._repo,t).then((function(e){return new Fi(e,new Mi(t._repo,t._path),t._queryParams.getIndex())}))}var Qi=function(){function t(t){this.callbackContext=t}return t.prototype.respondsTo=function(t){return"value"===t},t.prototype.createEvent=function(t,e){var n=e._queryParams.getIndex();return new Ai("value",this,new Fi(t.snapshotNode,new Mi(e._repo,e._path),n))},t.prototype.getEventRunner=function(t){var e=this;return"cancel"===t.getEventType()?function(){return e.callbackContext.onCancel(t.error)}:function(){return e.callbackContext.onValue(t.snapshot,null)}},t.prototype.createCancelEvent=function(t,e){return this.callbackContext.hasCancelCallback?new Ni(this,t,e):null},t.prototype.matches=function(e){return e instanceof t&&(!e.callbackContext||!this.callbackContext||e.callbackContext.matches(this.callbackContext))},t.prototype.hasAnyCallback=function(){return null!==this.callbackContext},t}(),Yi=function(){function t(t,e){this.eventType=t,this.callbackContext=e}return t.prototype.respondsTo=function(t){var e="children_added"===t?"child_added":t;return e="children_removed"===e?"child_removed":e,this.eventType===e},t.prototype.createCancelEvent=function(t,e){return this.callbackContext.hasCancelCallback?new Ni(this,t,e):null},t.prototype.createEvent=function(t,e){(0,o.assert)(null!=t.childName,"Child events should have a childName.");var n=qi(new Mi(e._repo,e._path),t.childName),r=e._queryParams.getIndex();return new Ai(t.type,this,new Fi(t.snapshotNode,n,r),t.prevName)},t.prototype.getEventRunner=function(t){var e=this;return"cancel"===t.getEventType()?function(){return e.callbackContext.onCancel(t.error)}:function(){return e.callbackContext.onValue(t.snapshot,t.prevName)}},t.prototype.matches=function(e){return e instanceof t&&this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext))},t.prototype.hasAnyCallback=function(){return!!this.callbackContext},t}();function Xi(t,e,n,r,i){var o;if("object"==typeof r&&(o=void 0,i=r),"function"==typeof r&&(o=r),i&&i.onlyOnce){var a=n,s=function(e,n){pi(t._repo,t,c),a(e,n)};s.userCallback=n.userCallback,s.context=n.context,n=s}var u=new Pi(n,o||void 0),c="value"===e?new Qi(u):new Yi(e,u);return function(t,e,n){var r;r=".info"===bt(e._path)?or(t.infoSyncTree_,e,n):or(t.serverSyncTree_,e,n),$r(t.eventQueue_,e._path,r)}(t._repo,t,c),function(){return pi(t._repo,t,c)}}function Ji(t,e,n,r){return Xi(t,"value",e,n,r)}function $i(t,e,n,r){return Xi(t,"child_added",e,n,r)}function Zi(t,e,n,r){return Xi(t,"child_changed",e,n,r)}function to(t,e,n,r){return Xi(t,"child_moved",e,n,r)}function eo(t,e,n,r){return Xi(t,"child_removed",e,n,r)}function no(t,e,n){var r=null,i=n?new Pi(n):null;"value"===e?r=new Qi(i):e&&(r=new Yi(e,i)),pi(t._repo,t,r)}var ro=function(){},io=function(t){function e(e,n){var r=t.call(this)||this;return r._value=e,r._key=n,r}return s(e,t),e.prototype._apply=function(t){qr("endAt",this._value,t._path,!0);var e=Ne(t._queryParams,this._value,this._key);if(Li(e),Di(e),t._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new Ri(t._repo,t._path,e,t._orderByCalled)},e}(ro);function oo(t,e){return Gr("endAt","key",e,!0),new io(t,e)}var ao=function(t){function e(e,n){var r=t.call(this)||this;return r._value=e,r._key=n,r}return s(e,t),e.prototype._apply=function(t){qr("endBefore",this._value,t._path,!1);var e,n,r,i,o=(e=t._queryParams,n=this._value,r=this._key,e.index_===Bt?("string"==typeof n&&(n=be(n)),i=Ne(e,n,r)):i=Ne(e,n,null==r?D:be(r)),i.endBeforeSet_=!0,i);if(Li(o),Di(o),t._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new Ri(t._repo,t._path,o,t._orderByCalled)},e}(ro);function so(t,e){return Gr("endBefore","key",e,!0),new ao(t,e)}var uo=function(t){function e(e,n){var r=t.call(this)||this;return r._value=e,r._key=n,r}return s(e,t),e.prototype._apply=function(t){qr("startAt",this._value,t._path,!0);var e=Ae(t._queryParams,this._value,this._key);if(Li(e),Di(e),t._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new Ri(t._repo,t._path,e,t._orderByCalled)},e}(ro);function co(t,e){return void 0===t&&(t=null),Gr("startAt","key",e,!0),new uo(t,e)}var lo=function(t){function e(e,n){var r=t.call(this)||this;return r._value=e,r._key=n,r}return s(e,t),e.prototype._apply=function(t){qr("startAfter",this._value,t._path,!1);var e,n,r,i,o=(e=t._queryParams,n=this._value,r=this._key,e.index_===Bt?("string"==typeof n&&(n=me(n)),i=Ae(e,n,r)):i=Ae(e,n,null==r?L:me(r)),i.startAfterSet_=!0,i);if(Li(o),Di(o),t._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new Ri(t._repo,t._path,o,t._orderByCalled)},e}(ro);function ho(t,e){return Gr("startAfter","key",e,!0),new lo(t,e)}var fo=function(t){function e(e){var n=t.call(this)||this;return n._limit=e,n}return s(e,t),e.prototype._apply=function(t){if(t._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new Ri(t._repo,t._path,(e=t._queryParams,n=this._limit,(r=e.copy()).limitSet_=!0,r.limit_=n,r.viewFrom_="l",r),t._orderByCalled);var e,n,r},e}(ro);function po(t){if("number"!=typeof t||Math.floor(t)!==t||t<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new fo(t)}var vo=function(t){function e(e){var n=t.call(this)||this;return n._limit=e,n}return s(e,t),e.prototype._apply=function(t){if(t._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new Ri(t._repo,t._path,(e=t._queryParams,n=this._limit,(r=e.copy()).limitSet_=!0,r.limit_=n,r.viewFrom_="r",r),t._orderByCalled);var e,n,r},e}(ro);function go(t){if("number"!=typeof t||Math.floor(t)!==t||t<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new vo(t)}var yo=function(t){function e(e){var n=t.call(this)||this;return n._path=e,n}return s(e,t),e.prototype._apply=function(t){xi(t,"orderByChild");var e=new yt(this._path);if(Ct(e))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");var n=new de(e),r=Pe(t._queryParams,n);return Di(r),new Ri(t._repo,t._path,r,!0)},e}(ro);function mo(t){if("$key"===t)throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if("$priority"===t)throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if("$value"===t)throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return Hr("orderByChild","path",t,!1),new yo(t)}var bo=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.prototype._apply=function(t){xi(t,"orderByKey");var e=Pe(t._queryParams,Bt);return Di(e),new Ri(t._repo,t._path,e,!0)},e}(ro);function _o(){return new bo}var wo=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.prototype._apply=function(t){xi(t,"orderByPriority");var e=Pe(t._queryParams,re);return Di(e),new Ri(t._repo,t._path,e,!0)},e}(ro);function Io(){return new wo}var To=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.prototype._apply=function(t){xi(t,"orderByValue");var e=Pe(t._queryParams,ve);return Di(e),new Ri(t._repo,t._path,e,!0)},e}(ro);function Eo(){return new To}var So=function(t){function e(e,n){var r=t.call(this)||this;return r._value=e,r._key=n,r}return s(e,t),e.prototype._apply=function(t){if(qr("equalTo",this._value,t._path,!1),t._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(t._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new io(this._value,this._key)._apply(new uo(this._value,this._key)._apply(t))},e}(ro);function Co(t,e){return Gr("equalTo","key",e,!0),new So(t,e)}function ko(t){for(var e,n,r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];var a=(0,o.getModularInstance)(t);try{for(var s=c(r),u=s.next();!u.done;u=s.next()){var l=u.value;a=l._apply(a)}}catch(t){e={error:t}}finally{try{u&&!u.done&&(n=s.return)&&n.call(s)}finally{if(e)throw e.error}}return a}!function(t){(0,o.assert)(!Mn,"__referenceConstructor has already been defined"),Mn=t}(Mi),function(t){(0,o.assert)(!Kn,"__referenceConstructor has already been defined"),Kn=t}(Mi);var Ao={},No=!1;function Po(t,e,n,r,i){var o=r||t.options.databaseURL;void 0===o&&(t.options.projectId||O("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),A("Using default host for project ",t.options.projectId),o=t.options.projectId+"-default-rtdb.firebaseio.com");var a,s=Ci(o,i),u=s.repoInfo,c=void 0;"undefined"!=typeof process&&(c=process.env.FIREBASE_DATABASE_EMULATOR_HOST),c?(a=!0,o="http://"+c+"?ns="+u.namespace,u=(s=Ci(o,i)).repoInfo):a=!s.repoInfo.secure;var l=i&&a?new Y(Y.OWNER):new Q(t.name,t.options,e);Qr("Invalid Firebase Database URL",s),Ct(s.path)||O("Database URL must point to the root of a Firebase Database (not including a child path).");var h=function(t,e,n,r){var i=Ao[e.name];i||(i={},Ao[e.name]=i);var o=i[t.toURLString()];return o&&O("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),o=new ri(t,No,n,r),i[t.toURLString()]=o,o}(u,t,l,new z(t.name,n));return new Oo(h,t)}var Oo=function(){function t(t,e){this._repoInternal=t,this.app=e,this.type="database",this._instanceStarted=!1}return Object.defineProperty(t.prototype,"_repo",{get:function(){return this._instanceStarted||(function(t,e,n){if(t.stats_=it(t.repoInfo_),t.forceRestClient_||("object"==typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0)t.server_=new xe(t.repoInfo_,(function(e,n,r,i){ai(t,e,n,r,i)}),t.authTokenProvider_,t.appCheckProvider_),setTimeout((function(){return si(t,!0)}),0);else{if(null!=n){if("object"!=typeof n)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{(0,o.stringify)(n)}catch(t){throw new Error("Invalid authOverride provided: "+t)}}t.persistentConnection_=new Ut(t.repoInfo_,e,(function(e,n,r,i){ai(t,e,n,r,i)}),(function(e){si(t,e)}),(function(e){!function(t,e){V(e,(function(e,n){ui(t,e,n)}))}(t,e)}),t.authTokenProvider_,t.appCheckProvider_,n),t.server_=t.persistentConnection_}var r,i;t.authTokenProvider_.addTokenChangeListener((function(e){t.server_.refreshAuthToken(e)})),t.appCheckProvider_.addTokenChangeListener((function(e){t.server_.refreshAppCheckToken(e.token)})),t.statsReporter_=(r=function(){return new Ve(t.stats_,t.server_)},i=t.repoInfo_.toString(),rt[i]||(rt[i]=r()),rt[i]),t.infoData_=new De,t.infoSyncTree_=new tr({startListening:function(e,n,r,i){var o=[],a=t.infoData_.getNode(e._path);return a.isEmpty()||(o=rr(t.infoSyncTree_,e._path,a),setTimeout((function(){i("ok")}),0)),o},stopListening:function(){}}),ui(t,"connected",!1),t.serverSyncTree_=new tr({startListening:function(e,n,r,i){return t.server_.listen(e,r,n,(function(n,r){var o=i(n,r);Zr(t.eventQueue_,e._path,o)})),[]},stopListening:function(e,n){t.server_.unlisten(e,n)}})}(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_root",{get:function(){return this._rootInternal||(this._rootInternal=new Mi(this._repo,mt())),this._rootInternal},enumerable:!1,configurable:!0}),t.prototype._delete=function(){var t,e,n;return this._checkNotDeleted("delete"),t=this._repo,e=this.app.name,(n=Ao[e])&&n[t.key]===t||O("Database "+e+"("+t.repoInfo_+") has already been deleted."),di(t),delete n[t.key],this._repoInternal=null,this._rootInternal=null,Promise.resolve()},t.prototype._checkNotDeleted=function(t){null===this._rootInternal&&O("Cannot call "+t+" on a deleted database.")},t}();function Ro(t){(t=(0,o.getModularInstance)(t))._checkNotDeleted("goOffline"),di(t._repo)}function xo(t){var e;(t=(0,o.getModularInstance)(t))._checkNotDeleted("goOnline"),(e=t._repo).persistentConnection_&&e.persistentConnection_.resume(ni)}var Do={".sv":"timestamp"},Lo=function(){function t(t,e){this.committed=t,this.snapshot=e}return t.prototype.toJSON=function(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}},t}();function Mo(t,e,n){var r;if(t=(0,o.getModularInstance)(t),zr("Reference.transaction",t._path),".length"===t.key||".keys"===t.key)throw"Reference.transaction failed: "+t.key+" is a read-only object.";var i=null===(r=null==n?void 0:n.applyLocally)||void 0===r||r,a=new o.Deferred,s=Ji(t,(function(){}));return function(e,n,r,i,s,u){vi(e,"transaction on "+n);var c={path:n,update:r,onComplete:function(e,n,r){var i=null;e?a.reject(e):(i=new Fi(r,new Mi(t._repo,t._path),re),a.resolve(new Lo(n,i)))},status:null,order:I(),applyLocally:u,retryCount:0,unwatcher:s,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},l=yi(e,n,void 0);c.currentInputSnapshot=l;var h=c.update(l.val());if(void 0===h)c.unwatcher(),c.currentOutputSnapshotRaw=null,c.currentOutputSnapshotResolved=null,c.onComplete&&c.onComplete(null,!1,c.currentInputSnapshot);else{Vr("transaction failed: Data returned ",h,c.path),c.status=0;var f=Cr(e.transactionQueueTree_,n),p=kr(f)||[];p.push(c),Ar(f,p);var d=void 0;"object"==typeof h&&null!==h&&(0,o.contains)(h,".priority")?(d=(0,o.safeGet)(h,".priority"),(0,o.assert)(jr(d),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):d=(ar(e.serverSyncTree_,n)||ce.EMPTY_NODE).getPriority().val();var v=oi(e),g=he(h,d),y=Tr(g,l,v);c.currentOutputSnapshotRaw=g,c.currentOutputSnapshotResolved=y,c.currentWriteId=ci(e);var m=er(e.serverSyncTree_,n,y,c.currentWriteId,c.applyLocally);Zr(e.eventQueue_,n,m),mi(e,e.transactionQueueTree_)}}(t._repo,t._path,e,0,s,i),a.promise}var Fo=function(){function t(t){this._delegate=t}return t.prototype.cancel=function(t){(0,o.validateArgCount)("OnDisconnect.cancel",0,1,arguments.length),(0,o.validateCallback)("OnDisconnect.cancel","onComplete",t,!0);var e=this._delegate.cancel();return t&&e.then((function(){return t(null)}),(function(e){return t(e)})),e},t.prototype.remove=function(t){(0,o.validateArgCount)("OnDisconnect.remove",0,1,arguments.length),(0,o.validateCallback)("OnDisconnect.remove","onComplete",t,!0);var e=this._delegate.remove();return t&&e.then((function(){return t(null)}),(function(e){return t(e)})),e},t.prototype.set=function(t,e){(0,o.validateArgCount)("OnDisconnect.set",1,2,arguments.length),(0,o.validateCallback)("OnDisconnect.set","onComplete",e,!0);var n=this._delegate.set(t);return e&&n.then((function(){return e(null)}),(function(t){return e(t)})),n},t.prototype.setWithPriority=function(t,e,n){(0,o.validateArgCount)("OnDisconnect.setWithPriority",2,3,arguments.length),(0,o.validateCallback)("OnDisconnect.setWithPriority","onComplete",n,!0);var r=this._delegate.setWithPriority(t,e);return n&&r.then((function(){return n(null)}),(function(t){return n(t)})),r},t.prototype.update=function(t,e){if((0,o.validateArgCount)("OnDisconnect.update",1,2,arguments.length),Array.isArray(t)){for(var n={},r=0;r<t.length;++r)n[""+r]=t[r];t=n,R("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}(0,o.validateCallback)("OnDisconnect.update","onComplete",e,!0);var i=this._delegate.update(t);return e&&i.then((function(){return e(null)}),(function(t){return e(t)})),i},t}(),Uo=function(){function t(t,e){this.committed=t,this.snapshot=e}return t.prototype.toJSON=function(){return(0,o.validateArgCount)("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}},t}(),jo=function(){function t(t,e){this._database=t,this._delegate=e}return t.prototype.val=function(){return(0,o.validateArgCount)("DataSnapshot.val",0,0,arguments.length),this._delegate.val()},t.prototype.exportVal=function(){return(0,o.validateArgCount)("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()},t.prototype.toJSON=function(){return(0,o.validateArgCount)("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()},t.prototype.exists=function(){return(0,o.validateArgCount)("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()},t.prototype.child=function(e){return(0,o.validateArgCount)("DataSnapshot.child",0,1,arguments.length),e=String(e),Hr("DataSnapshot.child","path",e,!1),new t(this._database,this._delegate.child(e))},t.prototype.hasChild=function(t){return(0,o.validateArgCount)("DataSnapshot.hasChild",1,1,arguments.length),Hr("DataSnapshot.hasChild","path",t,!1),this._delegate.hasChild(t)},t.prototype.getPriority=function(){return(0,o.validateArgCount)("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority},t.prototype.forEach=function(e){var n=this;return(0,o.validateArgCount)("DataSnapshot.forEach",1,1,arguments.length),(0,o.validateCallback)("DataSnapshot.forEach","action",e,!1),this._delegate.forEach((function(r){return e(new t(n._database,r))}))},t.prototype.hasChildren=function(){return(0,o.validateArgCount)("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()},Object.defineProperty(t.prototype,"key",{get:function(){return this._delegate.key},enumerable:!1,configurable:!0}),t.prototype.numChildren=function(){return(0,o.validateArgCount)("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size},t.prototype.getRef=function(){return(0,o.validateArgCount)("DataSnapshot.ref",0,0,arguments.length),new Vo(this._database,this._delegate.ref)},Object.defineProperty(t.prototype,"ref",{get:function(){return this.getRef()},enumerable:!1,configurable:!0}),t}(),qo=function(){function t(t,e){this.database=t,this._delegate=e}return t.prototype.on=function(e,n,r,i){var a,s=this;(0,o.validateArgCount)("Query.on",2,4,arguments.length),(0,o.validateCallback)("Query.on","callback",n,!1);var u=t.getCancelAndContextArgs_("Query.on",r,i),c=function(t,e){n.call(u.context,new jo(s.database,t),e)};c.userCallback=n,c.context=u.context;var l=null===(a=u.cancel)||void 0===a?void 0:a.bind(u.context);switch(e){case"value":return Ji(this._delegate,c,l),n;case"child_added":return $i(this._delegate,c,l),n;case"child_removed":return eo(this._delegate,c,l),n;case"child_changed":return Zi(this._delegate,c,l),n;case"child_moved":return to(this._delegate,c,l),n;default:throw new Error((0,o.errorPrefix)("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}},t.prototype.off=function(t,e,n){if((0,o.validateArgCount)("Query.off",0,3,arguments.length),Wr("Query.off",t,!0),(0,o.validateCallback)("Query.off","callback",e,!0),(0,o.validateContextObject)("Query.off","context",n,!0),e){var r=function(){};r.userCallback=e,r.context=n,no(this._delegate,t,r)}else no(this._delegate,t)},t.prototype.get=function(){var t=this;return zi(this._delegate).then((function(e){return new jo(t.database,e)}))},t.prototype.once=function(e,n,r,i){var a=this;(0,o.validateArgCount)("Query.once",1,4,arguments.length),(0,o.validateCallback)("Query.once","callback",n,!0);var s=t.getCancelAndContextArgs_("Query.once",r,i),u=new o.Deferred,c=function(t,e){var r=new jo(a.database,t);n&&n.call(s.context,r,e),u.resolve(r)};c.userCallback=n,c.context=s.context;var l=function(t){s.cancel&&s.cancel.call(s.context,t),u.reject(t)};switch(e){case"value":Ji(this._delegate,c,l,{onlyOnce:!0});break;case"child_added":$i(this._delegate,c,l,{onlyOnce:!0});break;case"child_removed":eo(this._delegate,c,l,{onlyOnce:!0});break;case"child_changed":Zi(this._delegate,c,l,{onlyOnce:!0});break;case"child_moved":to(this._delegate,c,l,{onlyOnce:!0});break;default:throw new Error((0,o.errorPrefix)("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return u.promise},t.prototype.limitToFirst=function(e){return(0,o.validateArgCount)("Query.limitToFirst",1,1,arguments.length),new t(this.database,ko(this._delegate,po(e)))},t.prototype.limitToLast=function(e){return(0,o.validateArgCount)("Query.limitToLast",1,1,arguments.length),new t(this.database,ko(this._delegate,go(e)))},t.prototype.orderByChild=function(e){return(0,o.validateArgCount)("Query.orderByChild",1,1,arguments.length),new t(this.database,ko(this._delegate,mo(e)))},t.prototype.orderByKey=function(){return(0,o.validateArgCount)("Query.orderByKey",0,0,arguments.length),new t(this.database,ko(this._delegate,_o()))},t.prototype.orderByPriority=function(){return(0,o.validateArgCount)("Query.orderByPriority",0,0,arguments.length),new t(this.database,ko(this._delegate,Io()))},t.prototype.orderByValue=function(){return(0,o.validateArgCount)("Query.orderByValue",0,0,arguments.length),new t(this.database,ko(this._delegate,Eo()))},t.prototype.startAt=function(e,n){return void 0===e&&(e=null),(0,o.validateArgCount)("Query.startAt",0,2,arguments.length),new t(this.database,ko(this._delegate,co(e,n)))},t.prototype.startAfter=function(e,n){return void 0===e&&(e=null),(0,o.validateArgCount)("Query.startAfter",0,2,arguments.length),new t(this.database,ko(this._delegate,ho(e,n)))},t.prototype.endAt=function(e,n){return void 0===e&&(e=null),(0,o.validateArgCount)("Query.endAt",0,2,arguments.length),new t(this.database,ko(this._delegate,oo(e,n)))},t.prototype.endBefore=function(e,n){return void 0===e&&(e=null),(0,o.validateArgCount)("Query.endBefore",0,2,arguments.length),new t(this.database,ko(this._delegate,so(e,n)))},t.prototype.equalTo=function(e,n){return(0,o.validateArgCount)("Query.equalTo",1,2,arguments.length),new t(this.database,ko(this._delegate,Co(e,n)))},t.prototype.toString=function(){return(0,o.validateArgCount)("Query.toString",0,0,arguments.length),this._delegate.toString()},t.prototype.toJSON=function(){return(0,o.validateArgCount)("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()},t.prototype.isEqual=function(e){if((0,o.validateArgCount)("Query.isEqual",1,1,arguments.length),!(e instanceof t)){var n="Query.isEqual failed: First argument must be an instance of firebase.database.Query.";throw new Error(n)}return this._delegate.isEqual(e._delegate)},t.getCancelAndContextArgs_=function(t,e,n){var r={cancel:void 0,context:void 0};if(e&&n)r.cancel=e,(0,o.validateCallback)(t,"cancel",r.cancel,!0),r.context=n,(0,o.validateContextObject)(t,"context",r.context,!0);else if(e)if("object"==typeof e&&null!==e)r.context=e;else{if("function"!=typeof e)throw new Error((0,o.errorPrefix)(t,"cancelOrContext")+" must either be a cancel callback or a context object.");r.cancel=e}return r},Object.defineProperty(t.prototype,"ref",{get:function(){return new Vo(this.database,new Mi(this._delegate._repo,this._delegate._path))},enumerable:!1,configurable:!0}),t}(),Vo=function(t){function e(e,n){var r=t.call(this,e,new Ri(n._repo,n._path,new ke,!1))||this;return r.database=e,r._delegate=n,r}return s(e,t),e.prototype.getKey=function(){return(0,o.validateArgCount)("Reference.key",0,0,arguments.length),this._delegate.key},e.prototype.child=function(t){return(0,o.validateArgCount)("Reference.child",1,1,arguments.length),"number"==typeof t&&(t=String(t)),new e(this.database,qi(this._delegate,t))},e.prototype.getParent=function(){(0,o.validateArgCount)("Reference.parent",0,0,arguments.length);var t=this._delegate.parent;return t?new e(this.database,t):null},e.prototype.getRoot=function(){return(0,o.validateArgCount)("Reference.root",0,0,arguments.length),new e(this.database,this._delegate.root)},e.prototype.set=function(t,e){(0,o.validateArgCount)("Reference.set",1,2,arguments.length),(0,o.validateCallback)("Reference.set","onComplete",e,!0);var n=Ki(this._delegate,t);return e&&n.then((function(){return e(null)}),(function(t){return e(t)})),n},e.prototype.update=function(t,e){if((0,o.validateArgCount)("Reference.update",1,2,arguments.length),Array.isArray(t)){for(var n={},r=0;r<t.length;++r)n[""+r]=t[r];t=n,R("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}zr("Reference.update",this._delegate._path),(0,o.validateCallback)("Reference.update","onComplete",e,!0);var i=Hi(this._delegate,t);return e&&i.then((function(){return e(null)}),(function(t){return e(t)})),i},e.prototype.setWithPriority=function(t,e,n){(0,o.validateArgCount)("Reference.setWithPriority",2,3,arguments.length),(0,o.validateCallback)("Reference.setWithPriority","onComplete",n,!0);var r=Gi(this._delegate,t,e);return n&&r.then((function(){return n(null)}),(function(t){return n(t)})),r},e.prototype.remove=function(t){(0,o.validateArgCount)("Reference.remove",0,1,arguments.length),(0,o.validateCallback)("Reference.remove","onComplete",t,!0);var e=Bi(this._delegate);return t&&e.then((function(){return t(null)}),(function(e){return t(e)})),e},e.prototype.transaction=function(t,e,n){var r=this;(0,o.validateArgCount)("Reference.transaction",1,3,arguments.length),(0,o.validateCallback)("Reference.transaction","transactionUpdate",t,!1),(0,o.validateCallback)("Reference.transaction","onComplete",e,!0),Yr("Reference.transaction","applyLocally",n,!0);var i=Mo(this._delegate,t,{applyLocally:n}).then((function(t){return new Uo(t.committed,new jo(r.database,t.snapshot))}));return e&&i.then((function(t){return e(null,t.committed,t.snapshot)}),(function(t){return e(t,!1,null)})),i},e.prototype.setPriority=function(t,e){(0,o.validateArgCount)("Reference.setPriority",1,2,arguments.length),(0,o.validateCallback)("Reference.setPriority","onComplete",e,!0);var n=Wi(this._delegate,t);return e&&n.then((function(){return e(null)}),(function(t){return e(t)})),n},e.prototype.push=function(t,n){var r=this;(0,o.validateArgCount)("Reference.push",0,2,arguments.length),(0,o.validateCallback)("Reference.push","onComplete",n,!0);var i=Vi(this._delegate,t),a=i.then((function(t){return new e(r.database,t)}));n&&a.then((function(){return n(null)}),(function(t){return n(t)}));var s=new e(this.database,i);return s.then=a.then.bind(a),s.catch=a.catch.bind(a,void 0),s},e.prototype.onDisconnect=function(){return zr("Reference.onDisconnect",this._delegate._path),new Fo(new Oi(this._delegate._repo,this._delegate._path))},Object.defineProperty(e.prototype,"key",{get:function(){return this.getKey()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return this.getParent()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"root",{get:function(){return this.getRoot()},enumerable:!1,configurable:!0}),e}(qo),Bo=function(){function t(t,e){var n=this;this._delegate=t,this.app=e,this.INTERNAL={delete:function(){return n._delegate._delete()}}}return t.prototype.useEmulator=function(t,e,n){void 0===n&&(n={}),function(t,e,n,r){void 0===r&&(r={}),(t=(0,o.getModularInstance)(t))._checkNotDeleted("useEmulator"),t._instanceStarted&&O("Cannot call useEmulator() after instance has already been initialized.");var i=t._repoInternal,a=void 0;if(i.repoInfo_.nodeAdmin)r.mockUserToken&&O('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),a=new Y(Y.OWNER);else if(r.mockUserToken){var s=(0,o.createMockUserToken)(r.mockUserToken,t.app.options.projectId);a=new Y(s)}!function(t,e,n,r){t.repoInfo_=new Z(e+":"+n,!1,t.repoInfo_.namespace,t.repoInfo_.webSocketOnly,t.repoInfo_.nodeAdmin,t.repoInfo_.persistenceKey,t.repoInfo_.includeNamespaceInQueryParams),r&&(t.authTokenProvider_=r)}(i,e,n,a)}(this._delegate,t,e,n)},t.prototype.ref=function(t){if((0,o.validateArgCount)("database.ref",0,1,arguments.length),t instanceof Vo){var e=ji(this._delegate,t.toString());return new Vo(this,e)}return e=Ui(this._delegate,t),new Vo(this,e)},t.prototype.refFromURL=function(t){var e="database.refFromURL";(0,o.validateArgCount)(e,1,1,arguments.length);var n=ji(this._delegate,t);return new Vo(this,n)},t.prototype.goOffline=function(){return(0,o.validateArgCount)("database.goOffline",0,0,arguments.length),Ro(this._delegate)},t.prototype.goOnline=function(){return(0,o.validateArgCount)("database.goOnline",0,0,arguments.length),xo(this._delegate)},t.ServerValue={TIMESTAMP:Do,increment:function(t){return function(t){return{".sv":{increment:t}}}(t)}},t}(),Ko=Object.freeze({__proto__:null,forceLongPolling:function(){ht.forceDisallow(),ut.forceAllow()},forceWebSockets:function(){ut.forceDisallow()},isWebSocketsAvailable:function(){return ht.isAvailable()},setSecurityDebugCallback:function(t,e){t._delegate._repo.persistentConnection_.securityDebugCallback_=e},stats:function(t,e){!function(t,e){if(void 0===e&&(e=!1),"undefined"!=typeof console){var n;e?(t.statsListener_||(t.statsListener_=new qe(t.stats_)),n=t.statsListener_.get()):n=t.stats_.get();var r=Object.keys(n).reduce((function(t,e){return Math.max(e.length,t)}),0);V(n,(function(t,e){for(var n=t,i=t.length;i<r+2;i++)n+=" ";console.log(n+e)}))}}(t._delegate._repo,e)},statsIncrementCounter:function(t,e){!function(t,e){var n;t.stats_.incrementCounter(e),n=e,t.statsReporter_.statsToReport_[n]=!0}(t._delegate._repo,e)},dataUpdateCount:function(t){return t._delegate._repo.dataUpdateCount},interceptServerData:function(t,e){return function(t,e){t.interceptServerDataCallback_=e}(t._delegate._repo,e)},initStandalone:function(t){var e=t.app,n=t.url,r=t.version,o=t.customAuthImpl,a=t.namespace,s=t.nodeAdmin,u=void 0!==s&&s;d(r);var c=new i.Provider("auth-internal",new i.ComponentContainer("database-standalone"));return c.setComponent(new i.Component("auth-internal",(function(){return o}),"PRIVATE")),{instance:new Bo(Po(e,c,void 0,n,u),e),namespace:a}}}),Wo=Ut;Ut.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)},Ut.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)};var Go=pt,Ho=Z,zo=Object.freeze({__proto__:null,DataConnection:Wo,RealTimeConnection:Go,hijackHash:function(t){var e=Ut.prototype.put;return Ut.prototype.put=function(n,r,i,o){void 0!==o&&(o=t()),e.call(this,n,r,i,o)},function(){Ut.prototype.put=e}},ConnectionTarget:Ho,queryIdentifier:function(t){return t._delegate._queryIdentifier},forceRestClient:function(t){!function(t){No=t}(t)}}),Qo=Bo.ServerValue;!function(e){d(e.SDK_VERSION);var n=e.INTERNAL.registerComponent(new i.Component("database",(function(t,e){var n=e.instanceIdentifier,r=t.getProvider("app").getImmediate(),i=t.getProvider("auth-internal"),o=t.getProvider("app-check-internal");return new Bo(Po(r,i,o,n),r)}),"PUBLIC").setServiceProps({Reference:Vo,Query:qo,Database:Bo,DataSnapshot:jo,enableLogging:k,INTERNAL:Ko,ServerValue:Qo,TEST_ACCESS:zo}).setMultipleInstances(!0));e.registerVersion("@firebase/database","0.10.1"),(0,o.isNodeSdk)()&&(t.exports=n)}(r.default)},594:(t,e,n)=>{"use strict";function r(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],a=0,s=o.length;a<s;a++,i++)r[i]=o[a];return r}var i;n.r(e),n.d(e,{LogLevel:()=>o,Logger:()=>h,setLogLevel:()=>f,setUserLogHandler:()=>p});var o,a=[];!function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"}(o||(o={}));var s={debug:o.DEBUG,verbose:o.VERBOSE,info:o.INFO,warn:o.WARN,error:o.ERROR,silent:o.SILENT},u=o.INFO,c=((i={})[o.DEBUG]="log",i[o.VERBOSE]="log",i[o.INFO]="info",i[o.WARN]="warn",i[o.ERROR]="error",i),l=function(t,e){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];if(!(e<t.logLevel)){var o=(new Date).toISOString(),a=c[e];if(!a)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[a].apply(console,r(["["+o+"]  "+t.name+":"],n))}},h=function(){function t(t){this.name=t,this._logLevel=u,this._logHandler=l,this._userLogHandler=null,a.push(this)}return Object.defineProperty(t.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in o))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),t.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?s[t]:t},Object.defineProperty(t.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),t.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,r([this,o.DEBUG],t)),this._logHandler.apply(this,r([this,o.DEBUG],t))},t.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,r([this,o.VERBOSE],t)),this._logHandler.apply(this,r([this,o.VERBOSE],t))},t.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,r([this,o.INFO],t)),this._logHandler.apply(this,r([this,o.INFO],t))},t.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,r([this,o.WARN],t)),this._logHandler.apply(this,r([this,o.WARN],t))},t.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,r([this,o.ERROR],t)),this._logHandler.apply(this,r([this,o.ERROR],t))},t}();function f(t){a.forEach((function(e){e.setLogLevel(t)}))}function p(t,e){for(var n=function(n){var r=null;e&&e.level&&(r=s[e.level]),n.userLogHandler=null===t?null:function(e,n){for(var i=[],a=2;a<arguments.length;a++)i[a-2]=arguments[a];var s=i.map((function(t){if(null==t)return null;if("string"==typeof t)return t;if("number"==typeof t||"boolean"==typeof t)return t.toString();if(t instanceof Error)return t.message;try{return JSON.stringify(t)}catch(t){return null}})).filter((function(t){return t})).join(" ");n>=(null!=r?r:e.logLevel)&&t({level:o[n].toLowerCase(),message:s,args:i,type:e.name})}},r=0,i=a;r<i.length;r++)n(i[r])}},448:(t,e,n)=>{"use strict";n.r(e),n.d(e,{CONSTANTS:()=>o,Deferred:()=>d,ErrorFactory:()=>R,FirebaseError:()=>O,MAX_VALUE_MILLIS:()=>st,RANDOM_FACTOR:()=>ut,Sha1:()=>Y,areCookiesEnabled:()=>N,assert:()=>a,assertionError:()=>s,async:()=>$,base64:()=>c,base64Decode:()=>h,base64Encode:()=>l,calculateBackoffMillis:()=>ct,contains:()=>B,createMockUserToken:()=>v,createSubscribe:()=>X,decode:()=>F,deepCopy:()=>f,deepExtend:()=>p,errorPrefix:()=>et,extractQuerystring:()=>Q,getGlobal:()=>P,getModularInstance:()=>ht,getUA:()=>g,isAdmin:()=>V,isBrowser:()=>b,isBrowserExtension:()=>_,isElectron:()=>I,isEmpty:()=>W,isIE:()=>T,isIndexedDBAvailable:()=>k,isMobileCordova:()=>y,isNode:()=>m,isNodeSdk:()=>S,isReactNative:()=>w,isSafari:()=>C,isUWP:()=>E,isValidFormat:()=>q,isValidTimestamp:()=>U,issuedAtTime:()=>j,jsonEval:()=>L,map:()=>G,ordinal:()=>lt,querystring:()=>H,querystringDecode:()=>z,safeGet:()=>K,stringLength:()=>at,stringToByteArray:()=>ot,stringify:()=>M,validateArgCount:()=>tt,validateCallback:()=>rt,validateContextObject:()=>it,validateIndexedDBOpenable:()=>A,validateNamespace:()=>nt});var r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},i=function(){return(i=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};Object.create,Object.create;var o={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"},a=function(t,e){if(!t)throw s(e)},s=function(t){return new Error("Firebase Database ("+o.SDK_VERSION+") INTERNAL ASSERT FAILED: "+t)},u=function(t){for(var e=[],n=0,r=0;r<t.length;r++){var i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=63&i|128):55296==(64512&i)&&r+1<t.length&&56320==(64512&t.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&t.charCodeAt(++r)),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=63&i|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=63&i|128)}return e},c={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray:function(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[],i=0;i<t.length;i+=3){var o=t[i],a=i+1<t.length,s=a?t[i+1]:0,u=i+2<t.length,c=u?t[i+2]:0,l=o>>2,h=(3&o)<<4|s>>4,f=(15&s)<<2|c>>6,p=63&c;u||(p=64,a||(f=64)),r.push(n[l],n[h],n[f],n[p])}return r.join("")},encodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(u(t),e)},decodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):function(t){for(var e=[],n=0,r=0;n<t.length;){var i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){var o=t[n++];e[r++]=String.fromCharCode((31&i)<<6|63&o)}else if(i>239&&i<365){var a=((7&i)<<18|(63&(o=t[n++]))<<12|(63&(s=t[n++]))<<6|63&t[n++])-65536;e[r++]=String.fromCharCode(55296+(a>>10)),e[r++]=String.fromCharCode(56320+(1023&a))}else{o=t[n++];var s=t[n++];e[r++]=String.fromCharCode((15&i)<<12|(63&o)<<6|63&s)}}return e.join("")}(this.decodeStringToByteArray(t,e))},decodeStringToByteArray:function(t,e){this.init_();for(var n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[],i=0;i<t.length;){var o=n[t.charAt(i++)],a=i<t.length?n[t.charAt(i)]:0,s=++i<t.length?n[t.charAt(i)]:64,u=++i<t.length?n[t.charAt(i)]:64;if(++i,null==o||null==a||null==s||null==u)throw Error();var c=o<<2|a>>4;if(r.push(c),64!==s){var l=a<<4&240|s>>2;if(r.push(l),64!==u){var h=s<<6&192|u;r.push(h)}}}return r},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}},l=function(t){var e=u(t);return c.encodeByteArray(e,!0)},h=function(t){try{return c.decodeString(t,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};function f(t){return p(void 0,t)}function p(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:return new Date(e.getTime());case Object:void 0===t&&(t={});break;case Array:t=[];break;default:return e}for(var n in e)e.hasOwnProperty(n)&&"__proto__"!==n&&(t[n]=p(t[n],e[n]));return t}var d=function(){function t(){var t=this;this.reject=function(){},this.resolve=function(){},this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))}return t.prototype.wrapCallback=function(t){var e=this;return function(n,r){n?e.reject(n):e.resolve(r),"function"==typeof t&&(e.promise.catch((function(){})),1===t.length?t(n):t(n,r))}},t}();function v(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');var n=e||"demo-project",r=t.iat||0,o=t.sub||t.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");var a=i({iss:"https://securetoken.google.com/"+n,aud:n,iat:r,exp:r+3600,auth_time:r,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}}},t);return[c.encodeString(JSON.stringify({alg:"none",type:"JWT"}),!1),c.encodeString(JSON.stringify(a),!1),""].join(".")}function g(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function y(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(g())}function m(){try{return"[object process]"===Object.prototype.toString.call(n.g.process)}catch(t){return!1}}function b(){return"object"==typeof self&&self.self===self}function _(){var t="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof t&&void 0!==t.id}function w(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function I(){return g().indexOf("Electron/")>=0}function T(){var t=g();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function E(){return g().indexOf("MSAppHost/")>=0}function S(){return!0===o.NODE_CLIENT||!0===o.NODE_ADMIN}function C(){return!m()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function k(){return"indexedDB"in self&&null!=indexedDB}function A(){return new Promise((function(t,e){try{var n=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=function(){i.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=function(){n=!1},i.onerror=function(){var t;e((null===(t=i.error)||void 0===t?void 0:t.message)||"")}}catch(t){e(t)}}))}function N(){return!(!navigator||!navigator.cookieEnabled)}function P(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==n.g)return n.g;throw new Error("Unable to locate global object.")}var O=function(t){function e(n,r,i){var o=t.call(this,r)||this;return o.code=n,o.customData=i,o.name="FirebaseError",Object.setPrototypeOf(o,e.prototype),Error.captureStackTrace&&Error.captureStackTrace(o,R.prototype.create),o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e}(Error),R=function(){function t(t,e,n){this.service=t,this.serviceName=e,this.errors=n}return t.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r=e[0]||{},i=this.service+"/"+t,o=this.errors[t],a=o?x(o,r):"Error",s=this.serviceName+": "+a+" ("+i+").",u=new O(i,s,r);return u},t}();function x(t,e){return t.replace(D,(function(t,n){var r=e[n];return null!=r?String(r):"<"+n+"?>"}))}var D=/\{\$([^}]+)}/g;function L(t){return JSON.parse(t)}function M(t){return JSON.stringify(t)}var F=function(t){var e={},n={},r={},i="";try{var o=t.split(".");e=L(h(o[0])||""),n=L(h(o[1])||""),i=o[2],r=n.d||{},delete n.d}catch(t){}return{header:e,claims:n,data:r,signature:i}},U=function(t){var e=F(t).claims,n=Math.floor((new Date).getTime()/1e3),r=0,i=0;return"object"==typeof e&&(e.hasOwnProperty("nbf")?r=e.nbf:e.hasOwnProperty("iat")&&(r=e.iat),i=e.hasOwnProperty("exp")?e.exp:r+86400),!!n&&!!r&&!!i&&n>=r&&n<=i},j=function(t){var e=F(t).claims;return"object"==typeof e&&e.hasOwnProperty("iat")?e.iat:null},q=function(t){var e=F(t).claims;return!!e&&"object"==typeof e&&e.hasOwnProperty("iat")},V=function(t){var e=F(t).claims;return"object"==typeof e&&!0===e.admin};function B(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function K(t,e){return Object.prototype.hasOwnProperty.call(t,e)?t[e]:void 0}function W(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function G(t,e,n){var r={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(r[i]=e.call(n,t[i],i,t));return r}function H(t){for(var e=[],n=function(t,n){Array.isArray(n)?n.forEach((function(n){e.push(encodeURIComponent(t)+"="+encodeURIComponent(n))})):e.push(encodeURIComponent(t)+"="+encodeURIComponent(n))},r=0,i=Object.entries(t);r<i.length;r++){var o=i[r];n(o[0],o[1])}return e.length?"&"+e.join("&"):""}function z(t){var e={};return t.replace(/^\?/,"").split("&").forEach((function(t){if(t){var n=t.split("="),r=n[0],i=n[1];e[decodeURIComponent(r)]=decodeURIComponent(i)}})),e}function Q(t){var e=t.indexOf("?");if(!e)return"";var n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}var Y=function(){function t(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(var t=1;t<this.blockSize;++t)this.pad_[t]=0;this.reset()}return t.prototype.reset=function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0},t.prototype.compress_=function(t,e){e||(e=0);var n=this.W_;if("string"==typeof t)for(var r=0;r<16;r++)n[r]=t.charCodeAt(e)<<24|t.charCodeAt(e+1)<<16|t.charCodeAt(e+2)<<8|t.charCodeAt(e+3),e+=4;else for(r=0;r<16;r++)n[r]=t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3],e+=4;for(r=16;r<80;r++){var i=n[r-3]^n[r-8]^n[r-14]^n[r-16];n[r]=4294967295&(i<<1|i>>>31)}var o,a,s=this.chain_[0],u=this.chain_[1],c=this.chain_[2],l=this.chain_[3],h=this.chain_[4];for(r=0;r<80;r++)r<40?r<20?(o=l^u&(c^l),a=1518500249):(o=u^c^l,a=1859775393):r<60?(o=u&c|l&(u|c),a=2400959708):(o=u^c^l,a=3395469782),i=(s<<5|s>>>27)+o+h+a+n[r]&4294967295,h=l,l=c,c=4294967295&(u<<30|u>>>2),u=s,s=i;this.chain_[0]=this.chain_[0]+s&4294967295,this.chain_[1]=this.chain_[1]+u&4294967295,this.chain_[2]=this.chain_[2]+c&4294967295,this.chain_[3]=this.chain_[3]+l&4294967295,this.chain_[4]=this.chain_[4]+h&4294967295},t.prototype.update=function(t,e){if(null!=t){void 0===e&&(e=t.length);for(var n=e-this.blockSize,r=0,i=this.buf_,o=this.inbuf_;r<e;){if(0===o)for(;r<=n;)this.compress_(t,r),r+=this.blockSize;if("string"==typeof t){for(;r<e;)if(i[o]=t.charCodeAt(r),++r,++o===this.blockSize){this.compress_(i),o=0;break}}else for(;r<e;)if(i[o]=t[r],++r,++o===this.blockSize){this.compress_(i),o=0;break}}this.inbuf_=o,this.total_+=e}},t.prototype.digest=function(){var t=[],e=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(var n=this.blockSize-1;n>=56;n--)this.buf_[n]=255&e,e/=256;this.compress_(this.buf_);var r=0;for(n=0;n<5;n++)for(var i=24;i>=0;i-=8)t[r]=this.chain_[n]>>i&255,++r;return t},t}();function X(t,e){var n=new J(t,e);return n.subscribe.bind(n)}var J=function(){function t(t,e){var n=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then((function(){t(n)})).catch((function(t){n.error(t)}))}return t.prototype.next=function(t){this.forEachObserver((function(e){e.next(t)}))},t.prototype.error=function(t){this.forEachObserver((function(e){e.error(t)})),this.close(t)},t.prototype.complete=function(){this.forEachObserver((function(t){t.complete()})),this.close()},t.prototype.subscribe=function(t,e,n){var r,i=this;if(void 0===t&&void 0===e&&void 0===n)throw new Error("Missing Observer.");void 0===(r=function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=0,r=["next","error","complete"];n<r.length;n++){var i=r[n];if(i in t&&"function"==typeof t[i])return!0}return!1}(t)?t:{next:t,error:e,complete:n}).next&&(r.next=Z),void 0===r.error&&(r.error=Z),void 0===r.complete&&(r.complete=Z);var o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((function(){try{i.finalError?r.error(i.finalError):r.complete()}catch(t){}})),this.observers.push(r),o},t.prototype.unsubscribeOne=function(t){void 0!==this.observers&&void 0!==this.observers[t]&&(delete this.observers[t],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},t.prototype.forEachObserver=function(t){if(!this.finalized)for(var e=0;e<this.observers.length;e++)this.sendOne(e,t)},t.prototype.sendOne=function(t,e){var n=this;this.task.then((function(){if(void 0!==n.observers&&void 0!==n.observers[t])try{e(n.observers[t])}catch(t){"undefined"!=typeof console&&console.error&&console.error(t)}}))},t.prototype.close=function(t){var e=this;this.finalized||(this.finalized=!0,void 0!==t&&(this.finalError=t),this.task.then((function(){e.observers=void 0,e.onNoObservers=void 0})))},t}();function $(t,e){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];Promise.resolve(!0).then((function(){t.apply(void 0,n)})).catch((function(t){e&&e(t)}))}}function Z(){}var tt=function(t,e,n,r){var i;if(r<e?i="at least "+e:r>n&&(i=0===n?"none":"no more than "+n),i)throw new Error(t+" failed: Was called with "+r+(1===r?" argument.":" arguments.")+" Expects "+i+".")};function et(t,e){return t+" failed: "+e+" argument "}function nt(t,e,n){if((!n||e)&&"string"!=typeof e)throw new Error(et(t,"namespace")+"must be a valid firebase namespace.")}function rt(t,e,n,r){if((!r||n)&&"function"!=typeof n)throw new Error(et(t,e)+"must be a valid function.")}function it(t,e,n,r){if((!r||n)&&("object"!=typeof n||null===n))throw new Error(et(t,e)+"must be a valid context object.")}var ot=function(t){for(var e=[],n=0,r=0;r<t.length;r++){var i=t.charCodeAt(r);if(i>=55296&&i<=56319){var o=i-55296;r++,a(r<t.length,"Surrogate pair missing trail surrogate."),i=65536+(o<<10)+(t.charCodeAt(r)-56320)}i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=63&i|128):i<65536?(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=63&i|128):(e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=63&i|128)}return e},at=function(t){for(var e=0,n=0;n<t.length;n++){var r=t.charCodeAt(n);r<128?e++:r<2048?e+=2:r>=55296&&r<=56319?(e+=4,n++):e+=3}return e},st=144e5,ut=.5;function ct(t,e,n){void 0===e&&(e=1e3),void 0===n&&(n=2);var r=e*Math.pow(n,t),i=Math.round(ut*r*(Math.random()-.5)*2);return Math.min(st,r+i)}function lt(t){return Number.isFinite(t)?t+function(t){var e=(t=Math.abs(t))%100;if(e>=10&&e<=20)return"th";var n=t%10;return 1===n?"st":2===n?"nd":3===n?"rd":"th"}(t):""+t}function ht(t){return t&&t._delegate?t._delegate:t}},437:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>r.default});var r=n(983);(function(){var t,e="function"==typeof Object.defineProperties?Object.defineProperty:function(t,e,n){t!=Array.prototype&&t!=Object.prototype&&(t[e]=n.value)},i=function(t){t=["object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof n.g&&n.g,t];for(var e=0;e<t.length;++e){var r=t[e];if(r&&r.Math==Math)return r}return globalThis}(this);function o(t){var e=0;return function(){return e<t.length?{done:!1,value:t[e++]}:{done:!0}}}function a(t){var e="undefined"!=typeof Symbol&&Symbol.iterator&&t[Symbol.iterator];return e?e.call(t):{next:o(t)}}!function(t,n){if(n){var r=i;t=t.split(".");for(var o=0;o<t.length-1;o++){var a=t[o];a in r||(r[a]={}),r=r[a]}(n=n(o=r[t=t[t.length-1]]))!=o&&null!=n&&e(r,t,{configurable:!0,writable:!0,value:n})}}("Promise",(function(t){function e(t){this.b=0,this.c=void 0,this.a=[];var e=this.f();try{t(e.resolve,e.reject)}catch(t){e.reject(t)}}function n(){this.a=null}function r(t){return t instanceof e?t:new e((function(e){e(t)}))}if(t)return t;n.prototype.b=function(t){if(null==this.a){this.a=[];var e=this;this.c((function(){e.g()}))}this.a.push(t)};var o=i.setTimeout;n.prototype.c=function(t){o(t,0)},n.prototype.g=function(){for(;this.a&&this.a.length;){var t=this.a;this.a=[];for(var e=0;e<t.length;++e){var n=t[e];t[e]=null;try{n()}catch(t){this.f(t)}}}this.a=null},n.prototype.f=function(t){this.c((function(){throw t}))},e.prototype.f=function(){function t(t){return function(r){n||(n=!0,t.call(e,r))}}var e=this,n=!1;return{resolve:t(this.m),reject:t(this.g)}},e.prototype.m=function(t){if(t===this)this.g(new TypeError("A Promise cannot resolve to itself"));else if(t instanceof e)this.s(t);else{t:switch(typeof t){case"object":var n=null!=t;break t;case"function":n=!0;break t;default:n=!1}n?this.v(t):this.h(t)}},e.prototype.v=function(t){var e=void 0;try{e=t.then}catch(t){return void this.g(t)}"function"==typeof e?this.u(e,t):this.h(t)},e.prototype.g=function(t){this.i(2,t)},e.prototype.h=function(t){this.i(1,t)},e.prototype.i=function(t,e){if(0!=this.b)throw Error("Cannot settle("+t+", "+e+"): Promise already settled in state"+this.b);this.b=t,this.c=e,this.l()},e.prototype.l=function(){if(null!=this.a){for(var t=0;t<this.a.length;++t)s.b(this.a[t]);this.a=null}};var s=new n;return e.prototype.s=function(t){var e=this.f();t.Qa(e.resolve,e.reject)},e.prototype.u=function(t,e){var n=this.f();try{t.call(e,n.resolve,n.reject)}catch(t){n.reject(t)}},e.prototype.then=function(t,n){function r(t,e){return"function"==typeof t?function(e){try{i(t(e))}catch(t){o(t)}}:e}var i,o,a=new e((function(t,e){i=t,o=e}));return this.Qa(r(t,i),r(n,o)),a},e.prototype.catch=function(t){return this.then(void 0,t)},e.prototype.Qa=function(t,e){function n(){switch(r.b){case 1:t(r.c);break;case 2:e(r.c);break;default:throw Error("Unexpected state: "+r.b)}}var r=this;null==this.a?s.b(n):this.a.push(n)},e.resolve=r,e.reject=function(t){return new e((function(e,n){n(t)}))},e.race=function(t){return new e((function(e,n){for(var i=a(t),o=i.next();!o.done;o=i.next())r(o.value).Qa(e,n)}))},e.all=function(t){var n=a(t),i=n.next();return i.done?r([]):new e((function(t,e){function o(e){return function(n){a[e]=n,0==--s&&t(a)}}var a=[],s=0;do{a.push(void 0),s++,r(i.value).Qa(o(a.length-1),e),i=n.next()}while(!i.done)}))},e}));var s=s||{},u=this||self,c=/^[\w+/_-]+[=]{0,2}$/,l=null;function h(t){return(t=t.querySelector&&t.querySelector("script[nonce]"))&&(t=t.nonce||t.getAttribute("nonce"))&&c.test(t)?t:""}function f(){}function p(t){var e=typeof t;return"object"!=e?e:t?Array.isArray(t)?"array":e:"null"}function d(t){var e=p(t);return"array"==e||"object"==e&&"number"==typeof t.length}function v(t){return"function"==p(t)}function g(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}function y(t){return Object.prototype.hasOwnProperty.call(t,m)&&t[m]||(t[m]=++b)}var m="closure_uid_"+(1e9*Math.random()>>>0),b=0;function _(t,e,n){return t.call.apply(t.bind,arguments)}function w(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function I(t,e,n){return(I=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?_:w).apply(null,arguments)}function T(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}var E=Date.now;function S(t,e){function n(){}n.prototype=e.prototype,t.ab=e.prototype,t.prototype=new n,t.prototype.constructor=t}function C(t){return t}function k(t,e,n){this.code=P+t,this.message=e||O[t]||"",this.a=n||null}function A(t){var e=t&&t.code;return e?new k(e.substring(P.length),t.message,t.serverResponse):null}S(k,Error),k.prototype.w=function(){var t={code:this.code,message:this.message};return this.a&&(t.serverResponse=this.a),t},k.prototype.toJSON=function(){return this.w()};var N,P="auth/",O={"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","expired-action-code":"The action code has expired. ","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal error has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal error has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal error has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network error (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal error has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled."},R={ld:{Ta:"https://staging-identitytoolkit.sandbox.googleapis.com/identitytoolkit/v3/relyingparty/",Za:"https://staging-securetoken.sandbox.googleapis.com/v1/token",Wa:"https://staging-identitytoolkit.sandbox.googleapis.com/v2/",id:"b"},sd:{Ta:"https://www.googleapis.com/identitytoolkit/v3/relyingparty/",Za:"https://securetoken.googleapis.com/v1/token",Wa:"https://identitytoolkit.googleapis.com/v2/",id:"p"},ud:{Ta:"https://staging-www.sandbox.googleapis.com/identitytoolkit/v3/relyingparty/",Za:"https://staging-securetoken.sandbox.googleapis.com/v1/token",Wa:"https://staging-identitytoolkit.sandbox.googleapis.com/v2/",id:"s"},vd:{Ta:"https://www-googleapis-test.sandbox.google.com/identitytoolkit/v3/relyingparty/",Za:"https://test-securetoken.sandbox.googleapis.com/v1/token",Wa:"https://test-identitytoolkit.sandbox.googleapis.com/v2/",id:"t"}};function x(t){for(var e in R)if(R[e].id===t)return{firebaseEndpoint:(t=R[e]).Ta,secureTokenEndpoint:t.Za,identityPlatformEndpoint:t.Wa};return null}function D(t){if(!t)return!1;try{return!!t.$goog_Thenable}catch(t){return!1}}function L(t){if(Error.captureStackTrace)Error.captureStackTrace(this,L);else{var e=Error().stack;e&&(this.stack=e)}t&&(this.message=String(t))}function M(t,e){for(var n="",r=(t=t.split("%s")).length-1,i=0;i<r;i++)n+=t[i]+(i<e.length?e[i]:"%s");L.call(this,n+t[r])}function F(t,e){throw new M("Failure"+(t?": "+t:""),Array.prototype.slice.call(arguments,1))}function U(t,e){this.c=t,this.f=e,this.b=0,this.a=null}function j(t,e){t.f(e),100>t.b&&(t.b++,e.next=t.a,t.a=e)}function q(){this.b=this.a=null}N=x("__EID__")?"__EID__":void 0,S(L,Error),L.prototype.name="CustomError",S(M,L),M.prototype.name="AssertionError",U.prototype.get=function(){if(0<this.b){this.b--;var t=this.a;this.a=t.next,t.next=null}else t=this.c();return t};var V=new U((function(){return new K}),(function(t){t.reset()}));function B(){var t=_e,e=null;return t.a&&(e=t.a,t.a=t.a.next,t.a||(t.b=null),e.next=null),e}function K(){this.next=this.b=this.a=null}q.prototype.add=function(t,e){var n=V.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},K.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null},K.prototype.reset=function(){this.next=this.b=this.a=null};var W=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},G=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)},H=Array.prototype.filter?function(t,e){return Array.prototype.filter.call(t,e,void 0)}:function(t,e){for(var n=t.length,r=[],i=0,o="string"==typeof t?t.split(""):t,a=0;a<n;a++)if(a in o){var s=o[a];e.call(void 0,s,a,t)&&(r[i++]=s)}return r},z=Array.prototype.map?function(t,e){return Array.prototype.map.call(t,e,void 0)}:function(t,e){for(var n=t.length,r=Array(n),i="string"==typeof t?t.split(""):t,o=0;o<n;o++)o in i&&(r[o]=e.call(void 0,i[o],o,t));return r},Q=Array.prototype.some?function(t,e){return Array.prototype.some.call(t,e,void 0)}:function(t,e){for(var n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t))return!0;return!1};function Y(t,e){return 0<=W(t,e)}function X(t,e){var n;return(n=0<=(e=W(t,e)))&&Array.prototype.splice.call(t,e,1),n}function J(t,e){!function(t,e){for(var n="string"==typeof t?t.split(""):t,r=t.length-1;0<=r;--r)r in n&&e.call(void 0,n[r],r,t)}(t,(function(n,r){e.call(void 0,n,r,t)&&Array.prototype.splice.call(t,r,1).length}))}function $(t){return Array.prototype.concat.apply([],arguments)}function Z(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}var tt,et=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]},nt=/&/g,rt=/</g,it=/>/g,ot=/"/g,at=/'/g,st=/\x00/g,ut=/[\x00&<>"']/;function ct(t,e){return-1!=t.indexOf(e)}function lt(t,e){return t<e?-1:t>e?1:0}t:{var ht=u.navigator;if(ht){var ft=ht.userAgent;if(ft){tt=ft;break t}}tt=""}function pt(t){return ct(tt,t)}function dt(t,e){for(var n in t)e.call(void 0,t[n],n,t)}function vt(t){for(var e in t)return!1;return!0}function gt(t){var e,n={};for(e in t)n[e]=t[e];return n}var yt="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function mt(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<yt.length;o++)n=yt[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function bt(t,e){t:{try{var n=t&&t.ownerDocument,r=n&&(n.defaultView||n.parentWindow);if((r=r||u).Element&&r.Location){var i=r;break t}}catch(t){}i=null}if(i&&void 0!==i[e]&&(!t||!(t instanceof i[e])&&(t instanceof i.Location||t instanceof i.Element))){if(g(t))try{var o=t.constructor.displayName||t.constructor.name||Object.prototype.toString.call(t)}catch(t){o="<object could not be stringified>"}else o=void 0===t?"undefined":null===t?"null":typeof t;F("Argument is not a %s (or a non-Element, non-Location mock); got: %s",e,o)}}function _t(t,e){this.a=t===Et&&e||"",this.b=Tt}function wt(t){return t instanceof _t&&t.constructor===_t&&t.b===Tt?t.a:(F("expected object of type Const, got '"+t+"'"),"type_error:Const")}_t.prototype.sa=!0,_t.prototype.ra=function(){return this.a},_t.prototype.toString=function(){return"Const{"+this.a+"}"};var It,Tt={},Et={};function St(){if(void 0===It){var t=null,e=u.trustedTypes;if(e&&e.createPolicy){try{t=e.createPolicy("goog#html",{createHTML:C,createScript:C,createScriptURL:C})}catch(t){u.console&&u.console.error(t.message)}It=t}else It=t}return It}function Ct(t,e){this.a=e===Ot?t:""}function kt(t){return t instanceof Ct&&t.constructor===Ct?t.a:(F("expected object of type TrustedResourceUrl, got '"+t+"' of type "+p(t)),"type_error:TrustedResourceUrl")}function At(t,e){var n=wt(t);if(!Pt.test(n))throw Error("Invalid TrustedResourceUrl format: "+n);return function(t){var e=St();return new Ct(t=e?e.createScriptURL(t):t,Ot)}(t=n.replace(Nt,(function(t,r){if(!Object.prototype.hasOwnProperty.call(e,r))throw Error('Found marker, "'+r+'", in format string, "'+n+'", but no valid label mapping found in args: '+JSON.stringify(e));return(t=e[r])instanceof _t?wt(t):encodeURIComponent(String(t))})))}Ct.prototype.sa=!0,Ct.prototype.ra=function(){return this.a.toString()},Ct.prototype.toString=function(){return"TrustedResourceUrl{"+this.a+"}"};var Nt=/%{(\w+)}/g,Pt=/^((https:)?\/\/[0-9a-z.:[\]-]+\/|\/[^/\\]|[^:/\\%]+\/|[^:/\\%]*[?#]|about:blank#)/i,Ot={};function Rt(t,e){this.a=e===jt?t:""}function xt(t){return t instanceof Rt&&t.constructor===Rt?t.a:(F("expected object of type SafeUrl, got '"+t+"' of type "+p(t)),"type_error:SafeUrl")}Rt.prototype.sa=!0,Rt.prototype.ra=function(){return this.a.toString()},Rt.prototype.toString=function(){return"SafeUrl{"+this.a+"}"};var Dt=/^(?:audio\/(?:3gpp2|3gpp|aac|L16|midi|mp3|mp4|mpeg|oga|ogg|opus|x-m4a|x-matroska|x-wav|wav|webm)|font\/\w+|image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp|x-icon)|text\/csv|video\/(?:mpeg|mp4|ogg|webm|quicktime|x-matroska))(?:;\w+=(?:\w+|"[\w;,= ]+"))*$/i,Lt=/^data:(.*);base64,[a-z0-9+\/]+=*$/i,Mt=/^(?:(?:https?|mailto|ftp):|[^:/?#]*(?:[/?#]|$))/i;function Ft(t){if(t instanceof Rt)return t;if(t="object"==typeof t&&t.sa?t.ra():String(t),Mt.test(t))t=new Rt(t,jt);else{var e=(t=(t=String(t)).replace(/(%0A|%0D)/g,"")).match(Lt);t=e&&Dt.test(e[1])?new Rt(t,jt):null}return t}function Ut(t){return t instanceof Rt?t:(t="object"==typeof t&&t.sa?t.ra():String(t),Mt.test(t)||(t="about:invalid#zClosurez"),new Rt(t,jt))}var jt={},qt=new Rt("about:invalid#zClosurez",jt);function Vt(t,e,n){this.a=n===Bt?t:""}Vt.prototype.sa=!0,Vt.prototype.ra=function(){return this.a.toString()},Vt.prototype.toString=function(){return"SafeHtml{"+this.a+"}"};var Bt={};function Kt(t,e,n,r){return t=t instanceof Rt?t:Ut(t),e=e||u,n=n instanceof _t?wt(n):n||"",e.open(xt(t),n,r,void 0)}function Wt(t,e){for(var n=t.split("%s"),r="",i=Array.prototype.slice.call(arguments,1);i.length&&1<n.length;)r+=n.shift()+i.shift();return r+n.join("%s")}function Gt(t){return ut.test(t)&&(-1!=t.indexOf("&")&&(t=t.replace(nt,"&amp;")),-1!=t.indexOf("<")&&(t=t.replace(rt,"&lt;")),-1!=t.indexOf(">")&&(t=t.replace(it,"&gt;")),-1!=t.indexOf('"')&&(t=t.replace(ot,"&quot;")),-1!=t.indexOf("'")&&(t=t.replace(at,"&#39;")),-1!=t.indexOf("\0")&&(t=t.replace(st,"&#0;"))),t}function Ht(t){return Ht[" "](t),t}Ht[" "]=f;var zt,Qt,Yt=pt("Opera"),Xt=pt("Trident")||pt("MSIE"),Jt=pt("Edge"),$t=Jt||Xt,Zt=pt("Gecko")&&!(ct(tt.toLowerCase(),"webkit")&&!pt("Edge"))&&!(pt("Trident")||pt("MSIE"))&&!pt("Edge"),te=ct(tt.toLowerCase(),"webkit")&&!pt("Edge");function ee(){var t=u.document;return t?t.documentMode:void 0}t:{var ne="",re=(Qt=tt,Zt?/rv:([^\);]+)(\)|;)/.exec(Qt):Jt?/Edge\/([\d\.]+)/.exec(Qt):Xt?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(Qt):te?/WebKit\/(\S+)/.exec(Qt):Yt?/(?:Version)[ \/]?(\S+)/.exec(Qt):void 0);if(re&&(ne=re?re[1]:""),Xt){var ie=ee();if(null!=ie&&ie>parseFloat(ne)){zt=String(ie);break t}}zt=ne}var oe,ae={};function se(t){return function(t,e){var n=ae;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e()}(t,(function(){for(var e=0,n=et(String(zt)).split("."),r=et(String(t)).split("."),i=Math.max(n.length,r.length),o=0;0==e&&o<i;o++){var a=n[o]||"",s=r[o]||"";do{if(a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==a[0].length&&0==s[0].length)break;e=lt(0==a[1].length?0:parseInt(a[1],10),0==s[1].length?0:parseInt(s[1],10))||lt(0==a[2].length,0==s[2].length)||lt(a[2],s[2]),a=a[3],s=s[3]}while(0==e)}return 0<=e}))}u.document&&Xt?oe=ee()||parseInt(zt,10)||void 0:oe=void 0;var ue=oe;try{new self.OffscreenCanvas(0,0).getContext("2d")}catch(Qt){}var ce=!Xt||9<=Number(ue);function le(t){var e=document;return"string"==typeof t?e.getElementById(t):t}function he(t,e){dt(e,(function(e,n){e&&"object"==typeof e&&e.sa&&(e=e.ra()),"style"==n?t.style.cssText=e:"class"==n?t.className=e:"for"==n?t.htmlFor=e:de.hasOwnProperty(n)?t.setAttribute(de[n],e):0==n.lastIndexOf("aria-",0)||0==n.lastIndexOf("data-",0)?t.setAttribute(n,e):t[n]=e}))}var fe,pe,de={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",frameborder:"frameBorder",height:"height",maxlength:"maxLength",nonce:"nonce",role:"role",rowspan:"rowSpan",type:"type",usemap:"useMap",valign:"vAlign",width:"width"};function ve(t,e,n){function r(n){n&&e.appendChild("string"==typeof n?t.createTextNode(n):n)}for(var i=2;i<n.length;i++){var o=n[i];if(!d(o)||g(o)&&0<o.nodeType)r(o);else{t:{if(o&&"number"==typeof o.length){if(g(o)){var a="function"==typeof o.item||"string"==typeof o.item;break t}if(v(o)){a="function"==typeof o.item;break t}}a=!1}G(a?Z(o):o,r)}}}function ge(t,e){return e=String(e),"application/xhtml+xml"===t.contentType&&(e=e.toLowerCase()),t.createElement(e)}function ye(t){u.setTimeout((function(){throw t}),0)}function me(t,e){pe||function(){if(u.Promise&&u.Promise.resolve){var t=u.Promise.resolve(void 0);pe=function(){t.then(we)}}else pe=function(){var t=we;!v(u.setImmediate)||u.Window&&u.Window.prototype&&!pt("Edge")&&u.Window.prototype.setImmediate==u.setImmediate?(fe||(fe=function(){var t=u.MessageChannel;if(void 0===t&&"undefined"!=typeof window&&window.postMessage&&window.addEventListener&&!pt("Presto")&&(t=function(){var t=ge(document,"IFRAME");t.style.display="none",document.documentElement.appendChild(t);var e=t.contentWindow;(t=e.document).open(),t.close();var n="callImmediate"+Math.random(),r="file:"==e.location.protocol?"*":e.location.protocol+"//"+e.location.host;t=I((function(t){"*"!=r&&t.origin!=r||t.data!=n||this.port1.onmessage()}),this),e.addEventListener("message",t,!1),this.port1={},this.port2={postMessage:function(){e.postMessage(n,r)}}}),void 0!==t&&!pt("Trident")&&!pt("MSIE")){var e=new t,n={},r=n;return e.port1.onmessage=function(){if(void 0!==n.next){var t=(n=n.next).Gb;n.Gb=null,t()}},function(t){r.next={Gb:t},r=r.next,e.port2.postMessage(0)}}return function(t){u.setTimeout(t,0)}}()),fe(t)):u.setImmediate(t)}}(),be||(pe(),be=!0),_e.add(t,e)}var be=!1,_e=new q;function we(){for(var t;t=B();){try{t.a.call(t.b)}catch(t){ye(t)}j(V,t)}be=!1}function Ie(t,e){if(this.a=Te,this.i=void 0,this.f=this.b=this.c=null,this.g=this.h=!1,t!=f)try{var n=this;t.call(e,(function(t){Me(n,Ee,t)}),(function(t){if(!(t instanceof Ke))try{if(t instanceof Error)throw t;throw Error("Promise rejected.")}catch(t){}Me(n,Se,t)}))}catch(t){Me(this,Se,t)}}var Te=0,Ee=2,Se=3;function Ce(){this.next=this.f=this.b=this.g=this.a=null,this.c=!1}Ce.prototype.reset=function(){this.f=this.b=this.g=this.a=null,this.c=!1};var ke=new U((function(){return new Ce}),(function(t){t.reset()}));function Ae(t,e,n){var r=ke.get();return r.g=t,r.b=e,r.f=n,r}function Ne(t){if(t instanceof Ie)return t;var e=new Ie(f);return Me(e,Ee,t),e}function Pe(t){return new Ie((function(e,n){n(t)}))}function Oe(t,e,n){Fe(t,e,n,null)||me(T(e,t))}function Re(t){return new Ie((function(e){var n=t.length,r=[];if(n)for(var i=function(t,i,o){n--,r[t]=i?{Pb:!0,value:o}:{Pb:!1,reason:o},0==n&&e(r)},o=0;o<t.length;o++)Oe(t[o],T(i,o,!0),T(i,o,!1));else e(r)}))}function xe(t,e){if(t.a==Te)if(t.c){var n=t.c;if(n.b){for(var r=0,i=null,o=null,a=n.b;a&&(a.c||(r++,a.a==t&&(i=a),!(i&&1<r)));a=a.next)i||(o=a);i&&(n.a==Te&&1==r?xe(n,e):(o?((r=o).next==n.f&&(n.f=r),r.next=r.next.next):je(n),qe(n,i,Se,e)))}t.c=null}else Me(t,Se,e)}function De(t,e){t.b||t.a!=Ee&&t.a!=Se||Ue(t),t.f?t.f.next=e:t.b=e,t.f=e}function Le(t,e,n,r){var i=Ae(null,null,null);return i.a=new Ie((function(t,o){i.g=e?function(n){try{var i=e.call(r,n);t(i)}catch(t){o(t)}}:t,i.b=n?function(e){try{var i=n.call(r,e);void 0===i&&e instanceof Ke?o(e):t(i)}catch(t){o(t)}}:o})),i.a.c=t,De(t,i),i.a}function Me(t,e,n){t.a==Te&&(t===n&&(e=Se,n=new TypeError("Promise cannot resolve to itself")),t.a=1,Fe(n,t.$c,t.ad,t)||(t.i=n,t.a=e,t.c=null,Ue(t),e!=Se||n instanceof Ke||function(t,e){t.g=!0,me((function(){t.g&&Be.call(null,e)}))}(t,n)))}function Fe(t,e,n,r){if(t instanceof Ie)return De(t,Ae(e||f,n||null,r)),!0;if(D(t))return t.then(e,n,r),!0;if(g(t))try{var i=t.then;if(v(i))return function(t,e,n,r,i){function o(t){a||(a=!0,r.call(i,t))}var a=!1;try{e.call(t,(function(t){a||(a=!0,n.call(i,t))}),o)}catch(t){o(t)}}(t,i,e,n,r),!0}catch(t){return n.call(r,t),!0}return!1}function Ue(t){t.h||(t.h=!0,me(t.gc,t))}function je(t){var e=null;return t.b&&(e=t.b,t.b=e.next,e.next=null),t.b||(t.f=null),e}function qe(t,e,n,r){if(n==Se&&e.b&&!e.c)for(;t&&t.g;t=t.c)t.g=!1;if(e.a)e.a.c=null,Ve(e,n,r);else try{e.c?e.g.call(e.f):Ve(e,n,r)}catch(t){Be.call(null,t)}j(ke,e)}function Ve(t,e,n){e==Ee?t.g.call(t.f,n):t.b&&t.b.call(t.f,n)}Ie.prototype.then=function(t,e,n){return Le(this,v(t)?t:null,v(e)?e:null,n)},Ie.prototype.$goog_Thenable=!0,(t=Ie.prototype).oa=function(t,e){return(t=Ae(t,t,e)).c=!0,De(this,t),this},t.o=function(t,e){return Le(this,null,t,e)},t.cancel=function(t){if(this.a==Te){var e=new Ke(t);me((function(){xe(this,e)}),this)}},t.$c=function(t){this.a=Te,Me(this,Ee,t)},t.ad=function(t){this.a=Te,Me(this,Se,t)},t.gc=function(){for(var t;t=je(this);)qe(this,t,this.a,this.i);this.h=!1};var Be=ye;function Ke(t){L.call(this,t)}function We(){0!=Ge&&(He[y(this)]=this),this.xa=this.xa,this.pa=this.pa}S(Ke,L),Ke.prototype.name="cancel";var Ge=0,He={};function ze(t){if(!t.xa&&(t.xa=!0,t.Da(),0!=Ge)){var e=y(t);if(0!=Ge&&t.pa&&0<t.pa.length)throw Error(t+" did not empty its onDisposeCallbacks queue. This probably means it overrode dispose() or disposeInternal() without calling the superclass' method.");delete He[e]}}We.prototype.xa=!1,We.prototype.Da=function(){if(this.pa)for(;this.pa.length;)this.pa.shift()()};var Qe=Object.freeze||function(t){return t},Ye=!Xt||9<=Number(ue),Xe=Xt&&!se("9"),Je=function(){if(!u.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{u.addEventListener("test",f,e),u.removeEventListener("test",f,e)}catch(t){}return t}();function $e(t,e){this.type=t,this.b=this.target=e,this.defaultPrevented=!1}function Ze(t,e){if($e.call(this,t?t.type:""),this.relatedTarget=this.b=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.a=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.b=e,e=t.relatedTarget){if(Zt){t:{try{Ht(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:tn[t.pointerType]||"",this.a=t,t.defaultPrevented&&this.preventDefault()}}$e.prototype.preventDefault=function(){this.defaultPrevented=!0},S(Ze,$e);var tn=Qe({2:"touch",3:"pen",4:"mouse"});Ze.prototype.preventDefault=function(){Ze.ab.preventDefault.call(this);var t=this.a;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,Xe)try{(t.ctrlKey||112<=t.keyCode&&123>=t.keyCode)&&(t.keyCode=-1)}catch(t){}},Ze.prototype.g=function(){return this.a};var en="closure_listenable_"+(1e6*Math.random()|0),nn=0;function rn(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.Va=i,this.key=++nn,this.va=this.Pa=!1}function on(t){t.va=!0,t.listener=null,t.proxy=null,t.src=null,t.Va=null}function an(t){this.src=t,this.a={},this.b=0}function sn(t,e){var n=e.type;n in t.a&&X(t.a[n],e)&&(on(e),0==t.a[n].length&&(delete t.a[n],t.b--))}function un(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.va&&o.listener==e&&o.capture==!!n&&o.Va==r)return i}return-1}an.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var a=un(t,e,r,i);return-1<a?(e=t[a],n||(e.Pa=!1)):((e=new rn(e,this.src,o,!!r,i)).Pa=n,t.push(e)),e};var cn="closure_lm_"+(1e6*Math.random()|0),ln={};function hn(t,e,n,r,i){if(r&&r.once)pn(t,e,n,r,i);else if(Array.isArray(e))for(var o=0;o<e.length;o++)hn(t,e[o],n,r,i);else n=In(n),t&&t[en]?En(t,e,n,g(r)?!!r.capture:!!r,i):fn(t,e,n,!1,r,i)}function fn(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var a=g(i)?!!i.capture:!!i,s=_n(t);if(s||(t[cn]=s=new an(t)),!(n=s.add(e,n,r,a,o)).proxy)if(r=function(){var t=bn,e=Ye?function(n){return t.call(e.src,e.listener,n)}:function(n){if(!(n=t.call(e.src,e.listener,n)))return n};return e}(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)Je||(i=a),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(gn(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}}function pn(t,e,n,r,i){if(Array.isArray(e))for(var o=0;o<e.length;o++)pn(t,e[o],n,r,i);else n=In(n),t&&t[en]?Sn(t,e,n,g(r)?!!r.capture:!!r,i):fn(t,e,n,!0,r,i)}function dn(t,e,n,r,i){if(Array.isArray(e))for(var o=0;o<e.length;o++)dn(t,e[o],n,r,i);else r=g(r)?!!r.capture:!!r,n=In(n),t&&t[en]?(t=t.v,(e=String(e).toString())in t.a&&-1<(n=un(o=t.a[e],n,r,i))&&(on(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete t.a[e],t.b--))):t&&(t=_n(t))&&(e=t.a[e.toString()],t=-1,e&&(t=un(e,n,r,i)),(n=-1<t?e[t]:null)&&vn(n))}function vn(t){if("number"!=typeof t&&t&&!t.va){var e=t.src;if(e&&e[en])sn(e.v,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(gn(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=_n(e))?(sn(n,t),0==n.b&&(n.src=null,e[cn]=null)):on(t)}}}function gn(t){return t in ln?ln[t]:ln[t]="on"+t}function yn(t,e,n,r){var i=!0;if((t=_n(t))&&(e=t.a[e.toString()]))for(e=e.concat(),t=0;t<e.length;t++){var o=e[t];o&&o.capture==n&&!o.va&&(o=mn(o,r),i=i&&!1!==o)}return i}function mn(t,e){var n=t.listener,r=t.Va||t.src;return t.Pa&&vn(t),n.call(r,e)}function bn(t,e){if(t.va)return!0;if(!Ye){if(!e)t:{e=["window","event"];for(var n=u,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}if(e=new Ze(r=e,this),n=!0,!(0>r.keyCode||null!=r.returnValue)){t:{var i=!1;if(0==r.keyCode)try{r.keyCode=-1;break t}catch(t){i=!0}(i||null==r.returnValue)&&(r.returnValue=!0)}for(r=[],i=e.b;i;i=i.parentNode)r.push(i);for(t=t.type,i=r.length-1;0<=i;i--){e.b=r[i];var o=yn(r[i],t,!0,e);n=n&&o}for(i=0;i<r.length;i++)e.b=r[i],o=yn(r[i],t,!1,e),n=n&&o}return n}return mn(t,new Ze(e,this))}function _n(t){return(t=t[cn])instanceof an?t:null}var wn="__closure_events_fn_"+(1e9*Math.random()>>>0);function In(t){return v(t)?t:(t[wn]||(t[wn]=function(e){return t.handleEvent(e)}),t[wn])}function Tn(){We.call(this),this.v=new an(this),this.ac=this,this.gb=null}function En(t,e,n,r,i){t.v.add(String(e),n,!1,r,i)}function Sn(t,e,n,r,i){t.v.add(String(e),n,!0,r,i)}function Cn(t,e,n,r){if(!(e=t.v.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var a=e[o];if(a&&!a.va&&a.capture==n){var s=a.listener,u=a.Va||a.src;a.Pa&&sn(t.v,a),i=!1!==s.call(u,r)&&i}}return i&&!r.defaultPrevented}function kn(t,e,n){if(v(t))n&&(t=I(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=I(t.handleEvent,t)}return 2147483647<Number(e)?-1:u.setTimeout(t,e||0)}function An(t){var e=null;return new Ie((function(n,r){-1==(e=kn((function(){n(void 0)}),t))&&r(Error("Failed to schedule timer."))})).o((function(t){throw u.clearTimeout(e),t}))}function Nn(t){if(t.W&&"function"==typeof t.W)return t.W();if("string"==typeof t)return t.split("");if(d(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}function Pn(t){if(t.Y&&"function"==typeof t.Y)return t.Y();if(!t.W||"function"!=typeof t.W){if(d(t)||"string"==typeof t){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}for(var r in e=[],n=0,t)e[n++]=r;return e}}function On(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof On)for(n=t.Y(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function Rn(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];xn(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){var i={};for(n=e=0;e<t.a.length;)xn(i,r=t.a[e])||(t.a[n++]=r,i[r]=1),e++;t.a.length=n}}function xn(t,e){return Object.prototype.hasOwnProperty.call(t,e)}S(Tn,We),Tn.prototype[en]=!0,Tn.prototype.addEventListener=function(t,e,n,r){hn(this,t,e,n,r)},Tn.prototype.removeEventListener=function(t,e,n,r){dn(this,t,e,n,r)},Tn.prototype.dispatchEvent=function(t){var e,n=this.gb;if(n)for(e=[];n;n=n.gb)e.push(n);n=this.ac;var r=t.type||t;if("string"==typeof t)t=new $e(t,n);else if(t instanceof $e)t.target=t.target||n;else{var i=t;mt(t=new $e(r,n),i)}if(i=!0,e)for(var o=e.length-1;0<=o;o--){var a=t.b=e[o];i=Cn(a,r,!0,t)&&i}if(i=Cn(a=t.b=n,r,!0,t)&&i,i=Cn(a,r,!1,t)&&i,e)for(o=0;o<e.length;o++)i=Cn(a=t.b=e[o],r,!1,t)&&i;return i},Tn.prototype.Da=function(){if(Tn.ab.Da.call(this),this.v){var t,e=this.v;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)on(n[r]);delete e.a[t],e.b--}}this.gb=null},(t=On.prototype).W=function(){Rn(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},t.Y=function(){return Rn(this),this.a.concat()},t.clear=function(){this.b={},this.c=this.a.length=0},t.get=function(t,e){return xn(this.b,t)?this.b[t]:e},t.set=function(t,e){xn(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},t.forEach=function(t,e){for(var n=this.Y(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var Dn=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Ln(t,e){var n;this.a=this.l=this.c="",this.g=null,this.h=this.f="",this.i=!1,t instanceof Ln?(this.i=void 0!==e?e:t.i,Mn(this,t.c),this.l=t.l,this.a=t.a,Fn(this,t.g),this.f=t.f,Un(this,rr(t.b)),this.h=t.h):t&&(n=String(t).match(Dn))?(this.i=!!e,Mn(this,n[1]||"",!0),this.l=Kn(n[2]||""),this.a=Kn(n[3]||"",!0),Fn(this,n[4]),this.f=Kn(n[5]||"",!0),Un(this,n[6]||"",!0),this.h=Kn(n[7]||"")):(this.i=!!e,this.b=new Jn(null,this.i))}function Mn(t,e,n){t.c=n?Kn(e,!0):e,t.c&&(t.c=t.c.replace(/:$/,""))}function Fn(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.g=e}else t.g=null}function Un(t,e,n){e instanceof Jn?(t.b=e,function(t,e){e&&!t.f&&($n(t),t.c=null,t.a.forEach((function(t,e){var n=e.toLowerCase();e!=n&&(tr(this,e),nr(this,n,t))}),t)),t.f=e}(t.b,t.i)):(n||(e=Wn(e,Yn)),t.b=new Jn(e,t.i))}function jn(t,e,n){t.b.set(e,n)}function qn(t,e){return t.b.get(e)}function Vn(t){return t instanceof Ln?new Ln(t):new Ln(t,void 0)}function Bn(t,e,n,r){var i=new Ln(null,void 0);return t&&Mn(i,t),e&&(i.a=e),n&&Fn(i,n),r&&(i.f=r),i}function Kn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Wn(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,Gn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function Gn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Ln.prototype.toString=function(){var t=[],e=this.c;e&&t.push(Wn(e,Hn,!0),":");var n=this.a;return(n||"file"==e)&&(t.push("//"),(e=this.l)&&t.push(Wn(e,Hn,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.g)&&t.push(":",String(n))),(n=this.f)&&(this.a&&"/"!=n.charAt(0)&&t.push("/"),t.push(Wn(n,"/"==n.charAt(0)?Qn:zn,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.h)&&t.push("#",Wn(n,Xn)),t.join("")},Ln.prototype.resolve=function(t){var e=new Ln(this),n=!!t.c;n?Mn(e,t.c):n=!!t.l,n?e.l=t.l:n=!!t.a,n?e.a=t.a:n=null!=t.g;var r=t.f;if(n)Fn(e,t.g);else if(n=!!t.f){if("/"!=r.charAt(0))if(this.a&&!this.f)r="/"+r;else{var i=e.f.lastIndexOf("/");-1!=i&&(r=e.f.substr(0,i+1)+r)}if(".."==(i=r)||"."==i)r="";else if(ct(i,"./")||ct(i,"/.")){r=0==i.lastIndexOf("/",0),i=i.split("/");for(var o=[],a=0;a<i.length;){var s=i[a++];"."==s?r&&a==i.length&&o.push(""):".."==s?((1<o.length||1==o.length&&""!=o[0])&&o.pop(),r&&a==i.length&&o.push("")):(o.push(s),r=!0)}r=o.join("/")}else r=i}return n?e.f=r:n=""!==t.b.toString(),n?Un(e,rr(t.b)):n=!!t.h,n&&(e.h=t.h),e};var Hn=/[#\/\?@]/g,zn=/[#\?:]/g,Qn=/[#\?]/g,Yn=/[#\?@]/g,Xn=/#/g;function Jn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function $n(t){t.a||(t.a=new On,t.b=0,t.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(t.c,(function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)})))}function Zn(t){var e=Pn(t);if(void 0===e)throw Error("Keys are undefined");var n=new Jn(null,void 0);t=Nn(t);for(var r=0;r<e.length;r++){var i=e[r],o=t[r];Array.isArray(o)?nr(n,i,o):n.add(i,o)}return n}function tr(t,e){$n(t),e=ir(t,e),xn(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,xn((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&Rn(t)))}function er(t,e){return $n(t),e=ir(t,e),xn(t.a.b,e)}function nr(t,e,n){tr(t,e),0<n.length&&(t.c=null,t.a.set(ir(t,e),Z(n)),t.b+=n.length)}function rr(t){var e=new Jn;return e.c=t.c,t.a&&(e.a=new On(t.a),e.b=t.b),e}function ir(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function or(t){var e=[];return sr(new ar,t,e),e.join("")}function ar(){}function sr(t,e,n){if(null==e)n.push("null");else{if("object"==typeof e){if(Array.isArray(e)){var r=e;e=r.length,n.push("[");for(var i="",o=0;o<e;o++)n.push(i),sr(t,r[o],n),i=",";return void n.push("]")}if(!(e instanceof String||e instanceof Number||e instanceof Boolean)){for(r in n.push("{"),i="",e)Object.prototype.hasOwnProperty.call(e,r)&&"function"!=typeof(o=e[r])&&(n.push(i),lr(r,n),n.push(":"),sr(t,o,n),i=",");return void n.push("}")}e=e.valueOf()}switch(typeof e){case"string":lr(e,n);break;case"number":n.push(isFinite(e)&&!isNaN(e)?String(e):"null");break;case"boolean":n.push(String(e));break;case"function":n.push("null");break;default:throw Error("Unknown type: "+typeof e)}}}(t=Jn.prototype).add=function(t,e){$n(this),this.c=null,t=ir(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},t.clear=function(){this.a=this.c=null,this.b=0},t.forEach=function(t,e){$n(this),this.a.forEach((function(n,r){G(n,(function(n){t.call(e,n,r,this)}),this)}),this)},t.Y=function(){$n(this);for(var t=this.a.W(),e=this.a.Y(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},t.W=function(t){$n(this);var e=[];if("string"==typeof t)er(this,t)&&(e=$(e,this.a.get(ir(this,t))));else{t=this.a.W();for(var n=0;n<t.length;n++)e=$(e,t[n])}return e},t.set=function(t,e){return $n(this),this.c=null,er(this,t=ir(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},t.get=function(t,e){return t&&0<(t=this.W(t)).length?String(t[0]):e},t.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.Y(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.W(r);for(var o=0;o<r.length;o++){var a=i;""!==r[o]&&(a+="="+encodeURIComponent(String(r[o]))),t.push(a)}}return this.c=t.join("&")};var ur={'"':'\\"',"\\":"\\\\","/":"\\/","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\v":"\\u000b"},cr=/\uffff/.test("")?/[\\"\x00-\x1f\x7f-\uffff]/g:/[\\"\x00-\x1f\x7f-\xff]/g;function lr(t,e){e.push('"',t.replace(cr,(function(t){var e=ur[t];return e||(e="\\u"+(65536|t.charCodeAt(0)).toString(16).substr(1),ur[t]=e),e})),'"')}function hr(){var t=Or();return Xt&&!!ue&&11==ue||/Edge\/\d+/.test(t)}function fr(){return u.window&&u.window.location.href||self&&self.location&&self.location.href||""}function pr(t,e){e=e||u.window;var n="about:blank";t&&(n=xt(Ft(t)||qt)),e.location.href=n}function dr(t,e){var n,r=[];for(n in t)n in e?typeof t[n]!=typeof e[n]?r.push(n):"object"==typeof t[n]&&null!=t[n]&&null!=e[n]?0<dr(t[n],e[n]).length&&r.push(n):t[n]!==e[n]&&r.push(n):r.push(n);for(n in e)n in t||r.push(n);return r}function vr(t){return!!((t=(t||Or()).toLowerCase()).match(/android/)||t.match(/webos/)||t.match(/iphone|ipad|ipod/)||t.match(/blackberry/)||t.match(/windows phone/)||t.match(/iemobile/))}function gr(t){t=t||u.window;try{t.close()}catch(t){}}function yr(t,e,n){var r=Math.floor(1e9*Math.random()).toString();e=e||500,n=n||600;var i=(window.screen.availHeight-n)/2,o=(window.screen.availWidth-e)/2;for(a in e={width:e,height:n,top:0<i?i:0,left:0<o?o:0,location:!0,resizable:!0,statusbar:!0,toolbar:!1},n=Or().toLowerCase(),r&&(e.target=r,ct(n,"crios/")&&(e.target="_blank")),Ar(Or())==Cr&&(t=t||"http://localhost",e.scrollbars=!0),n=t||"",(t=e)||(t={}),r=window,e=n instanceof Rt?n:Ft(void 0!==n.href?n.href:String(n))||qt,n=t.target||n.target,i=[],t)switch(a){case"width":case"height":case"top":case"left":i.push(a+"="+t[a]);break;case"target":case"noopener":case"noreferrer":break;default:i.push(a+"="+(t[a]?1:0))}var a=i.join(",");if((pt("iPhone")&&!pt("iPod")&&!pt("iPad")||pt("iPad")||pt("iPod"))&&r.navigator&&r.navigator.standalone&&n&&"_self"!=n?(bt(a=ge(document,"A"),"HTMLAnchorElement"),e=e instanceof Rt?e:Ut(e),a.href=xt(e),a.setAttribute("target",n),t.noreferrer&&a.setAttribute("rel","noreferrer"),(t=document.createEvent("MouseEvent")).initMouseEvent("click",!0,!0,r,1),a.dispatchEvent(t),a={}):t.noreferrer?(a=Kt("",r,n,a),t=xt(e),a&&($t&&ct(t,";")&&(t="'"+t.replace(/'/g,"%27")+"'"),a.opener=null,t='<meta name="referrer" content="no-referrer"><meta http-equiv="refresh" content="0; url='+Gt(t)+'">',t=new Vt(t=(r=St())?r.createHTML(t):t,null,Bt),r=a.document)&&(r.write(function(t){return t instanceof Vt&&t.constructor===Vt?t.a:(F("expected object of type SafeHtml, got '"+t+"' of type "+p(t)),"type_error:SafeHtml")}(t)),r.close())):(a=Kt(e,r,n,a))&&t.noopener&&(a.opener=null),a)try{a.focus()}catch(t){}return a}var mr=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,br=/^[^@]+@[^@]+$/;function _r(){var t=null;return new Ie((function(e){"complete"==u.document.readyState?e():(t=function(){e()},pn(window,"load",t))})).o((function(e){throw dn(window,"load",t),e}))}function wr(t){return t=t||Or(),!("file:"!==Mr()&&"ionic:"!==Mr()||!t.toLowerCase().match(/iphone|ipad|ipod|android/))}function Ir(){var t=u.window;try{return!(!t||t==t.top)}catch(t){return!1}}function Tr(){return void 0!==u.WorkerGlobalScope&&"function"==typeof u.importScripts}function Er(){return r.default.INTERNAL.hasOwnProperty("reactNative")?"ReactNative":r.default.INTERNAL.hasOwnProperty("node")?"Node":Tr()?"Worker":"Browser"}function Sr(){var t=Er();return"ReactNative"===t||"Node"===t}var Cr="Firefox",kr="Chrome";function Ar(t){var e=t.toLowerCase();return ct(e,"opera/")||ct(e,"opr/")||ct(e,"opios/")?"Opera":ct(e,"iemobile")?"IEMobile":ct(e,"msie")||ct(e,"trident/")?"IE":ct(e,"edge/")?"Edge":ct(e,"firefox/")?Cr:ct(e,"silk/")?"Silk":ct(e,"blackberry")?"Blackberry":ct(e,"webos")?"Webos":!ct(e,"safari/")||ct(e,"chrome/")||ct(e,"crios/")||ct(e,"android")?!ct(e,"chrome/")&&!ct(e,"crios/")||ct(e,"edge/")?ct(e,"android")?"Android":(t=t.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/))&&2==t.length?t[1]:"Other":kr:"Safari"}var Nr={md:"FirebaseCore-web",od:"FirebaseUI-web"};function Pr(t,e){e=e||[];var n,r=[],i={};for(n in Nr)i[Nr[n]]=!0;for(n=0;n<e.length;n++)void 0!==i[e[n]]&&(delete i[e[n]],r.push(e[n]));return r.sort(),(e=r).length||(e=["FirebaseCore-web"]),"Browser"===(r=Er())?r=Ar(i=Or()):"Worker"===r&&(r=Ar(i=Or())+"-"+r),r+"/JsCore/"+t+"/"+e.join(",")}function Or(){return u.navigator&&u.navigator.userAgent||""}function Rr(t,e){t=t.split("."),e=e||u;for(var n=0;n<t.length&&"object"==typeof e&&null!=e;n++)e=e[t[n]];return n!=t.length&&(e=void 0),e}function xr(){try{var t=u.localStorage,e=Vr();if(t)return t.setItem(e,"1"),t.removeItem(e),!hr()||!!u.indexedDB}catch(t){return Tr()&&!!u.indexedDB}return!1}function Dr(){return(Lr()||"chrome-extension:"===Mr()||wr())&&!Sr()&&xr()&&!Tr()}function Lr(){return"http:"===Mr()||"https:"===Mr()}function Mr(){return u.location&&u.location.protocol||null}function Fr(t){return!vr(t=t||Or())&&Ar(t)!=Cr}function Ur(t){return void 0===t?null:or(t)}function jr(t){var e,n={};for(e in t)t.hasOwnProperty(e)&&null!==t[e]&&void 0!==t[e]&&(n[e]=t[e]);return n}function qr(t){if(null!==t)return JSON.parse(t)}function Vr(t){return t||Math.floor(1e9*Math.random()).toString()}function Br(t){return"Safari"!=Ar(t=t||Or())&&!t.toLowerCase().match(/iphone|ipad|ipod/)}function Kr(){var t=u.___jsl;if(t&&t.H)for(var e in t.H)if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=t.H[e].L.concat(),t.CP)for(var n=0;n<t.CP.length;n++)t.CP[n]=null}function Wr(t,e){if(t>e)throw Error("Short delay should be less than long delay!");this.a=t,this.c=e,t=Or(),e=Er(),this.b=vr(t)||"ReactNative"===e}function Gr(){var t=u.document;return!t||void 0===t.visibilityState||"visible"==t.visibilityState}function Hr(t){try{var e=new Date(parseInt(t,10));if(!isNaN(e.getTime())&&!/[^0-9]/.test(t))return e.toUTCString()}catch(t){}return null}function zr(){return!(!Rr("fireauth.oauthhelper",u)&&!Rr("fireauth.iframe",u))}Wr.prototype.get=function(){var t=u.navigator;return!t||"boolean"!=typeof t.onLine||!Lr()&&"chrome-extension:"!==Mr()&&void 0===t.connection||t.onLine?this.b?this.c:this.a:Math.min(5e3,this.a)};var Qr,Yr={};function Xr(t){Yr[t]||(Yr[t]=!0,"undefined"!=typeof console&&"function"==typeof console.warn&&console.warn(t))}try{var Jr={};Object.defineProperty(Jr,"abcd",{configurable:!0,enumerable:!0,value:1}),Object.defineProperty(Jr,"abcd",{configurable:!0,enumerable:!0,value:2}),Qr=2==Jr.abcd}catch(Qt){Qr=!1}function $r(t,e,n){Qr?Object.defineProperty(t,e,{configurable:!0,enumerable:!0,value:n}):t[e]=n}function Zr(t,e){if(e)for(var n in e)e.hasOwnProperty(n)&&$r(t,n,e[n])}function ti(t){var e={};return Zr(e,t),e}function ei(t){var e=t;if("object"==typeof t&&null!=t)for(var n in e="length"in t?[]:{},t)$r(e,n,ei(t[n]));return e}function ni(t){var e=t&&(t[si]?"phone":null);if(!(e&&t&&t[ai]))throw new k("internal-error","Internal assert: invalid MultiFactorInfo object");$r(this,"uid",t[ai]),$r(this,"displayName",t[ii]||null);var n=null;t[oi]&&(n=new Date(t[oi]).toUTCString()),$r(this,"enrollmentTime",n),$r(this,"factorId",e)}function ri(t){try{var e=new ui(t)}catch(t){e=null}return e}ni.prototype.w=function(){return{uid:this.uid,displayName:this.displayName,factorId:this.factorId,enrollmentTime:this.enrollmentTime}};var ii="displayName",oi="enrolledAt",ai="mfaEnrollmentId",si="phoneInfo";function ui(t){ni.call(this,t),$r(this,"phoneNumber",t[si])}function ci(t){var e={},n=t[pi],r=t[vi],i=t[gi];if(t=ri(t[di]),!i||i!=hi&&i!=fi&&!n||i==fi&&!r||i==li&&!t)throw Error("Invalid checkActionCode response!");i==fi?(e[mi]=n||null,e[_i]=n||null,e[yi]=r):(e[mi]=r||null,e[_i]=r||null,e[yi]=n||null),e[bi]=t||null,$r(this,Ii,i),$r(this,wi,ei(e))}S(ui,ni),ui.prototype.w=function(){var t=ui.ab.w.call(this);return t.phoneNumber=this.phoneNumber,t};var li="REVERT_SECOND_FACTOR_ADDITION",hi="EMAIL_SIGNIN",fi="VERIFY_AND_CHANGE_EMAIL",pi="email",di="mfaInfo",vi="newEmail",gi="requestType",yi="email",mi="fromEmail",bi="multiFactorInfo",_i="previousEmail",wi="data",Ii="operation";function Ti(t){var e=qn(t=Vn(t),Ei)||null,n=qn(t,Si)||null,r=qn(t,Ai)||null;if(r=r&&Pi[r]||null,!e||!n||!r)throw new k("argument-error",Ei+", "+Si+"and "+Ai+" are required in a valid action code URL.");Zr(this,{apiKey:e,operation:r,code:n,continueUrl:qn(t,Ci)||null,languageCode:qn(t,ki)||null,tenantId:qn(t,Ni)||null})}var Ei="apiKey",Si="oobCode",Ci="continueUrl",ki="languageCode",Ai="mode",Ni="tenantId",Pi={recoverEmail:"RECOVER_EMAIL",resetPassword:"PASSWORD_RESET",revertSecondFactorAddition:li,signIn:hi,verifyAndChangeEmail:fi,verifyEmail:"VERIFY_EMAIL"};function Oi(t){try{return new Ti(t)}catch(t){return null}}function Ri(t){var e=t[Fi];if(void 0===e)throw new k("missing-continue-uri");if("string"!=typeof e||"string"==typeof e&&!e.length)throw new k("invalid-continue-uri");this.h=e,this.b=this.a=null,this.g=!1;var n=t[xi];if(n&&"object"==typeof n){e=n[qi];var r=n[Ui];if(n=n[ji],"string"==typeof e&&e.length){if(this.a=e,void 0!==r&&"boolean"!=typeof r)throw new k("argument-error",Ui+" property must be a boolean when specified.");if(this.g=!!r,void 0!==n&&("string"!=typeof n||"string"==typeof n&&!n.length))throw new k("argument-error",ji+" property must be a non empty string when specified.");this.b=n||null}else{if(void 0!==e)throw new k("argument-error",qi+" property must be a non empty string when specified.");if(void 0!==r||void 0!==n)throw new k("missing-android-pkg-name")}}else if(void 0!==n)throw new k("argument-error",xi+" property must be a non null object when specified.");if(this.f=null,(e=t[Mi])&&"object"==typeof e){if("string"==typeof(e=e[Vi])&&e.length)this.f=e;else if(void 0!==e)throw new k("argument-error",Vi+" property must be a non empty string when specified.")}else if(void 0!==e)throw new k("argument-error",Mi+" property must be a non null object when specified.");if(void 0!==(e=t[Li])&&"boolean"!=typeof e)throw new k("argument-error",Li+" property must be a boolean when specified.");if(this.c=!!e,void 0!==(t=t[Di])&&("string"!=typeof t||"string"==typeof t&&!t.length))throw new k("argument-error",Di+" property must be a non empty string when specified.");this.i=t||null}var xi="android",Di="dynamicLinkDomain",Li="handleCodeInApp",Mi="iOS",Fi="url",Ui="installApp",ji="minimumVersion",qi="packageName",Vi="bundleId";function Bi(t){var e={};for(var n in e.continueUrl=t.h,e.canHandleCodeInApp=t.c,(e.androidPackageName=t.a)&&(e.androidMinimumVersion=t.b,e.androidInstallApp=t.g),e.iOSBundleId=t.f,e.dynamicLinkDomain=t.i,e)null===e[n]&&delete e[n];return e}var Ki=null;function Wi(t){var e=Hi(t);if(!(e&&e.sub&&e.iss&&e.aud&&e.exp))throw Error("Invalid JWT");this.h=t,this.a=e.exp,this.i=e.sub,t=Date.now()/1e3,this.g=e.iat||(t>this.a?this.a:t),this.b=e.provider_id||e.firebase&&e.firebase.sign_in_provider||null,this.f=e.firebase&&e.firebase.tenant||null,this.c=!!e.is_anonymous||"anonymous"==this.b}function Gi(t){try{return new Wi(t)}catch(t){return null}}function Hi(t){if(!t)return null;if(3!=(t=t.split(".")).length)return null;for(var e=(4-(t=t[1]).length%4)%4,n=0;n<e;n++)t+=".";try{var r=function(t){var e=[];return function(t,e){function n(e){for(;r<t.length;){var n=t.charAt(r++),i=Ki[n];if(null!=i)return i;if(!/^[\s\xa0]*$/.test(n))throw Error("Unknown base64 encoding at char: "+n)}return e}!function(){if(!Ki){Ki={};for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),e=["+/=","+/","-_=","-_.","-_"],n=0;5>n;n++)for(var r=t.concat(e[n].split("")),i=0;i<r.length;i++){var o=r[i];void 0===Ki[o]&&(Ki[o]=i)}}}();for(var r=0;;){var i=n(-1),o=n(0),a=n(64),s=n(64);if(64===s&&-1===i)break;e(i<<2|o>>4),64!=a&&(e(o<<4&240|a>>2),64!=s&&e(a<<6&192|s))}}(t,(function(t){e.push(t)})),e}(t);for(t=[],n=e=0;e<r.length;){var i=r[e++];if(128>i)t[n++]=String.fromCharCode(i);else if(191<i&&224>i){var o=r[e++];t[n++]=String.fromCharCode((31&i)<<6|63&o)}else if(239<i&&365>i){o=r[e++];var a=r[e++],s=((7&i)<<18|(63&o)<<12|(63&a)<<6|63&r[e++])-65536;t[n++]=String.fromCharCode(55296+(s>>10)),t[n++]=String.fromCharCode(56320+(1023&s))}else o=r[e++],a=r[e++],t[n++]=String.fromCharCode((15&i)<<12|(63&o)<<6|63&a)}return JSON.parse(t.join(""))}catch(t){}return null}Wi.prototype.T=function(){return this.f},Wi.prototype.l=function(){return this.c},Wi.prototype.toString=function(){return this.h};var zi="oauth_consumer_key oauth_nonce oauth_signature oauth_signature_method oauth_timestamp oauth_token oauth_version".split(" "),Qi=["client_id","response_type","scope","redirect_uri","state"],Yi={nd:{Ja:"locale",ua:700,ta:600,fa:"facebook.com",Xa:Qi},pd:{Ja:null,ua:500,ta:750,fa:"github.com",Xa:Qi},qd:{Ja:"hl",ua:515,ta:680,fa:"google.com",Xa:Qi},wd:{Ja:"lang",ua:485,ta:705,fa:"twitter.com",Xa:zi},kd:{Ja:"locale",ua:640,ta:600,fa:"apple.com",Xa:[]}};function Xi(t){for(var e in Yi)if(Yi[e].fa==t)return Yi[e];return null}function Ji(t){var e={};e["facebook.com"]=no,e["google.com"]=io,e["github.com"]=ro,e["twitter.com"]=oo;var n=t&&t[Zi];try{if(n)return e[n]?new e[n](t):new eo(t);if(void 0!==t[$i])return new to(t)}catch(t){}return null}var $i="idToken",Zi="providerId";function to(t){var e=t[Zi];if(!e&&t[$i]){var n=Gi(t[$i]);n&&n.b&&(e=n.b)}if(!e)throw Error("Invalid additional user info!");"anonymous"!=e&&"custom"!=e||(e=null),n=!1,void 0!==t.isNewUser?n=!!t.isNewUser:"identitytoolkit#SignupNewUserResponse"===t.kind&&(n=!0),$r(this,"providerId",e),$r(this,"isNewUser",n)}function eo(t){to.call(this,t),$r(this,"profile",ei((t=qr(t.rawUserInfo||"{}"))||{}))}function no(t){if(eo.call(this,t),"facebook.com"!=this.providerId)throw Error("Invalid provider ID!")}function ro(t){if(eo.call(this,t),"github.com"!=this.providerId)throw Error("Invalid provider ID!");$r(this,"username",this.profile&&this.profile.login||null)}function io(t){if(eo.call(this,t),"google.com"!=this.providerId)throw Error("Invalid provider ID!")}function oo(t){if(eo.call(this,t),"twitter.com"!=this.providerId)throw Error("Invalid provider ID!");$r(this,"username",t.screenName||null)}function ao(t){var e=Vn(t),n=qn(e,"link"),r=qn(Vn(n),"link");return e=qn(e,"deep_link_id"),qn(Vn(e),"link")||e||r||n||t}function so(t,e){if(!t&&!e)throw new k("internal-error","Internal assert: no raw session string available");if(t&&e)throw new k("internal-error","Internal assert: unable to determine the session type");this.a=t||null,this.b=e||null,this.type=this.a?uo:co}S(eo,to),S(no,eo),S(ro,eo),S(io,eo),S(oo,eo);var uo="enroll",co="signin";function lo(){}function ho(t,e){return t.then((function(t){if(t[Za]){var n=Gi(t[Za]);if(!n||e!=n.i)throw new k("user-mismatch");return t}throw new k("user-mismatch")})).o((function(t){throw t&&t.code&&t.code==P+"user-not-found"?new k("user-mismatch"):t}))}function fo(t,e){if(!e)throw new k("internal-error","failed to construct a credential");this.a=e,$r(this,"providerId",t),$r(this,"signInMethod",t)}function po(t){return{pendingToken:t.a,requestUri:"http://localhost"}}function vo(t){if(t&&t.providerId&&t.signInMethod&&0==t.providerId.indexOf("saml.")&&t.pendingToken)try{return new fo(t.providerId,t.pendingToken)}catch(t){}return null}function go(t,e,n){if(this.a=null,e.idToken||e.accessToken)e.idToken&&$r(this,"idToken",e.idToken),e.accessToken&&$r(this,"accessToken",e.accessToken),e.nonce&&!e.pendingToken&&$r(this,"nonce",e.nonce),e.pendingToken&&(this.a=e.pendingToken);else{if(!e.oauthToken||!e.oauthTokenSecret)throw new k("internal-error","failed to construct a credential");$r(this,"accessToken",e.oauthToken),$r(this,"secret",e.oauthTokenSecret)}$r(this,"providerId",t),$r(this,"signInMethod",n)}function yo(t){var e={};return t.idToken&&(e.id_token=t.idToken),t.accessToken&&(e.access_token=t.accessToken),t.secret&&(e.oauth_token_secret=t.secret),e.providerId=t.providerId,t.nonce&&!t.a&&(e.nonce=t.nonce),e={postBody:Zn(e).toString(),requestUri:"http://localhost"},t.a&&(delete e.postBody,e.pendingToken=t.a),e}function mo(t){if(t&&t.providerId&&t.signInMethod){var e={idToken:t.oauthIdToken,accessToken:t.oauthTokenSecret?null:t.oauthAccessToken,oauthTokenSecret:t.oauthTokenSecret,oauthToken:t.oauthTokenSecret&&t.oauthAccessToken,nonce:t.nonce,pendingToken:t.pendingToken};try{return new go(t.providerId,e,t.signInMethod)}catch(t){}}return null}function bo(t,e){this.Qc=e||[],Zr(this,{providerId:t,isOAuthProvider:!0}),this.Ib={},this.pb=(Xi(t)||{}).Ja||null,this.ob=null}function _o(t){if("string"!=typeof t||0!=t.indexOf("saml."))throw new k("argument-error",'SAML provider IDs must be prefixed with "saml."');bo.call(this,t,[])}function wo(t){bo.call(this,t,Qi),this.a=[]}function Io(){wo.call(this,"facebook.com")}function To(t){if(!t)throw new k("argument-error","credential failed: expected 1 argument (the OAuth access token).");var e=t;return g(t)&&(e=t.accessToken),(new Io).credential({accessToken:e})}function Eo(){wo.call(this,"github.com")}function So(t){if(!t)throw new k("argument-error","credential failed: expected 1 argument (the OAuth access token).");var e=t;return g(t)&&(e=t.accessToken),(new Eo).credential({accessToken:e})}function Co(){wo.call(this,"google.com"),this.Ca("profile")}function ko(t,e){var n=t;return g(t)&&(n=t.idToken,e=t.accessToken),(new Co).credential({idToken:n,accessToken:e})}function Ao(){bo.call(this,"twitter.com",zi)}function No(t,e){var n=t;if(g(n)||(n={oauthToken:t,oauthTokenSecret:e}),!n.oauthToken||!n.oauthTokenSecret)throw new k("argument-error","credential failed: expected 2 arguments (the OAuth access token and secret).");return new go("twitter.com",n,"twitter.com")}function Po(t,e,n){this.a=t,this.f=e,$r(this,"providerId","password"),$r(this,"signInMethod",n===Ro.EMAIL_LINK_SIGN_IN_METHOD?Ro.EMAIL_LINK_SIGN_IN_METHOD:Ro.EMAIL_PASSWORD_SIGN_IN_METHOD)}function Oo(t){return t&&t.email&&t.password?new Po(t.email,t.password,t.signInMethod):null}function Ro(){Zr(this,{providerId:"password",isOAuthProvider:!1})}function xo(t,e){if(!(e=Do(e)))throw new k("argument-error","Invalid email link!");return new Po(t,e.code,Ro.EMAIL_LINK_SIGN_IN_METHOD)}function Do(t){return(t=Oi(t=ao(t)))&&t.operation===hi?t:null}function Lo(t){if(!(t.eb&&t.cb||t.La&&t.ea))throw new k("internal-error");this.a=t,$r(this,"providerId","phone"),this.fa="phone",$r(this,"signInMethod","phone")}function Mo(t){if(t&&"phone"===t.providerId&&(t.verificationId&&t.verificationCode||t.temporaryProof&&t.phoneNumber)){var e={};return G(["verificationId","verificationCode","temporaryProof","phoneNumber"],(function(n){t[n]&&(e[n]=t[n])})),new Lo(e)}return null}function Fo(t){return t.a.La&&t.a.ea?{temporaryProof:t.a.La,phoneNumber:t.a.ea}:{sessionInfo:t.a.eb,code:t.a.cb}}function Uo(t){try{this.a=t||r.default.auth()}catch(t){throw new k("argument-error","Either an instance of firebase.auth.Auth must be passed as an argument to the firebase.auth.PhoneAuthProvider constructor, or the default firebase App instance must be initialized via firebase.initializeApp().")}Zr(this,{providerId:"phone",isOAuthProvider:!1})}function jo(t,e){if(!t)throw new k("missing-verification-id");if(!e)throw new k("missing-verification-code");return new Lo({eb:t,cb:e})}function qo(t){if(t.temporaryProof&&t.phoneNumber)return new Lo({La:t.temporaryProof,ea:t.phoneNumber});var e=t&&t.providerId;if(!e||"password"===e)return null;var n=t&&t.oauthAccessToken,r=t&&t.oauthTokenSecret,i=t&&t.nonce,o=t&&t.oauthIdToken,a=t&&t.pendingToken;try{switch(e){case"google.com":return ko(o,n);case"facebook.com":return To(n);case"github.com":return So(n);case"twitter.com":return No(n,r);default:return n||r||o||a?a?0==e.indexOf("saml.")?new fo(e,a):new go(e,{pendingToken:a,idToken:t.oauthIdToken,accessToken:t.oauthAccessToken},e):new wo(e).credential({idToken:o,accessToken:n,rawNonce:i}):null}}catch(t){return null}}function Vo(t){if(!t.isOAuthProvider)throw new k("invalid-oauth-provider")}function Bo(t,e,n,r,i,o,a){if(this.c=t,this.b=e||null,this.g=n||null,this.f=r||null,this.i=o||null,this.h=a||null,this.a=i||null,!this.g&&!this.a)throw new k("invalid-auth-event");if(this.g&&this.a)throw new k("invalid-auth-event");if(this.g&&!this.f)throw new k("invalid-auth-event")}function Ko(t){return(t=t||{}).type?new Bo(t.type,t.eventId,t.urlResponse,t.sessionId,t.error&&A(t.error),t.postBody,t.tenantId):null}function Wo(){this.b=null,this.a=[]}so.prototype.Ha=function(){return this.a?Ne(this.a):Ne(this.b)},so.prototype.w=function(){return this.type==uo?{multiFactorSession:{idToken:this.a}}:{multiFactorSession:{pendingCredential:this.b}}},lo.prototype.ka=function(){},lo.prototype.b=function(){},lo.prototype.c=function(){},lo.prototype.w=function(){},fo.prototype.ka=function(t){return _s(t,po(this))},fo.prototype.b=function(t,e){var n=po(this);return n.idToken=e,ws(t,n)},fo.prototype.c=function(t,e){return ho(Is(t,po(this)),e)},fo.prototype.w=function(){return{providerId:this.providerId,signInMethod:this.signInMethod,pendingToken:this.a}},go.prototype.ka=function(t){return _s(t,yo(this))},go.prototype.b=function(t,e){var n=yo(this);return n.idToken=e,ws(t,n)},go.prototype.c=function(t,e){return ho(Is(t,yo(this)),e)},go.prototype.w=function(){var t={providerId:this.providerId,signInMethod:this.signInMethod};return this.idToken&&(t.oauthIdToken=this.idToken),this.accessToken&&(t.oauthAccessToken=this.accessToken),this.secret&&(t.oauthTokenSecret=this.secret),this.nonce&&(t.nonce=this.nonce),this.a&&(t.pendingToken=this.a),t},bo.prototype.Ka=function(t){return this.Ib=gt(t),this},S(_o,bo),S(wo,bo),wo.prototype.Ca=function(t){return Y(this.a,t)||this.a.push(t),this},wo.prototype.Qb=function(){return Z(this.a)},wo.prototype.credential=function(t,e){var n;if(!(n=g(t)?{idToken:t.idToken||null,accessToken:t.accessToken||null,nonce:t.rawNonce||null}:{idToken:t||null,accessToken:e||null}).idToken&&!n.accessToken)throw new k("argument-error","credential failed: must provide the ID token and/or the access token.");return new go(this.providerId,n,this.providerId)},S(Io,wo),$r(Io,"PROVIDER_ID","facebook.com"),$r(Io,"FACEBOOK_SIGN_IN_METHOD","facebook.com"),S(Eo,wo),$r(Eo,"PROVIDER_ID","github.com"),$r(Eo,"GITHUB_SIGN_IN_METHOD","github.com"),S(Co,wo),$r(Co,"PROVIDER_ID","google.com"),$r(Co,"GOOGLE_SIGN_IN_METHOD","google.com"),S(Ao,bo),$r(Ao,"PROVIDER_ID","twitter.com"),$r(Ao,"TWITTER_SIGN_IN_METHOD","twitter.com"),Po.prototype.ka=function(t){return this.signInMethod==Ro.EMAIL_LINK_SIGN_IN_METHOD?ru(t,Ps,{email:this.a,oobCode:this.f}):ru(t,$s,{email:this.a,password:this.f})},Po.prototype.b=function(t,e){return this.signInMethod==Ro.EMAIL_LINK_SIGN_IN_METHOD?ru(t,Os,{idToken:e,email:this.a,oobCode:this.f}):ru(t,Ws,{idToken:e,email:this.a,password:this.f})},Po.prototype.c=function(t,e){return ho(this.ka(t),e)},Po.prototype.w=function(){return{email:this.a,password:this.f,signInMethod:this.signInMethod}},Zr(Ro,{PROVIDER_ID:"password"}),Zr(Ro,{EMAIL_LINK_SIGN_IN_METHOD:"emailLink"}),Zr(Ro,{EMAIL_PASSWORD_SIGN_IN_METHOD:"password"}),Lo.prototype.ka=function(t){return t.fb(Fo(this))},Lo.prototype.b=function(t,e){var n=Fo(this);return n.idToken=e,ru(t,tu,n)},Lo.prototype.c=function(t,e){var n=Fo(this);return n.operation="REAUTH",ho(t=ru(t,eu,n),e)},Lo.prototype.w=function(){var t={providerId:"phone"};return this.a.eb&&(t.verificationId=this.a.eb),this.a.cb&&(t.verificationCode=this.a.cb),this.a.La&&(t.temporaryProof=this.a.La),this.a.ea&&(t.phoneNumber=this.a.ea),t},Uo.prototype.fb=function(t,e){var n=this.a.a;return Ne(e.verify()).then((function(r){if("string"!=typeof r)throw new k("argument-error","An implementation of firebase.auth.ApplicationVerifier.prototype.verify() must return a firebase.Promise that resolves with a string.");switch(e.type){case"recaptcha":var i=g(t)?t.session:null,o=g(t)?t.phoneNumber:t;return(i&&i.type==uo?i.Ha().then((function(t){return function(t,e){return ru(t,Hs,e).then((function(t){return t.phoneSessionInfo.sessionInfo}))}(n,{idToken:t,phoneEnrollmentInfo:{phoneNumber:o,recaptchaToken:r}})})):i&&i.type==co?i.Ha().then((function(e){return function(t,e){return ru(t,zs,e).then((function(t){return t.phoneResponseInfo.sessionInfo}))}(n,{mfaPendingCredential:e,mfaEnrollmentId:t.multiFactorHint&&t.multiFactorHint.uid||t.multiFactorUid,phoneSignInInfo:{recaptchaToken:r}})})):function(t,e){return ru(t,Bs,e)}(n,{phoneNumber:o,recaptchaToken:r})).then((function(t){return"function"==typeof e.reset&&e.reset(),t}),(function(t){throw"function"==typeof e.reset&&e.reset(),t}));default:throw new k("argument-error",'Only firebase.auth.ApplicationVerifiers with type="recaptcha" are currently supported.')}}))},Zr(Uo,{PROVIDER_ID:"phone"}),Zr(Uo,{PHONE_SIGN_IN_METHOD:"phone"}),Bo.prototype.getUid=function(){var t=[];return t.push(this.c),this.b&&t.push(this.b),this.f&&t.push(this.f),this.h&&t.push(this.h),t.join("-")},Bo.prototype.T=function(){return this.h},Bo.prototype.w=function(){return{type:this.c,eventId:this.b,urlResponse:this.g,sessionId:this.f,postBody:this.i,tenantId:this.h,error:this.a&&this.a.w()}};var Go,Ho=null;function zo(t){var e="unauthorized-domain",n=void 0,r=Vn(t);t=r.a,"chrome-extension"==(r=r.c)?n=Wt("This chrome extension ID (chrome-extension://%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.",t):"http"==r||"https"==r?n=Wt("This domain (%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.",t):e="operation-not-supported-in-this-environment",k.call(this,e,n)}function Qo(t,e,n){k.call(this,t,n),(t=e||{}).Jb&&$r(this,"email",t.Jb),t.ea&&$r(this,"phoneNumber",t.ea),t.credential&&$r(this,"credential",t.credential),t.Zb&&$r(this,"tenantId",t.Zb)}function Yo(t){if(t.code){var e=t.code||"";0==e.indexOf(P)&&(e=e.substring(P.length));var n={credential:qo(t),Zb:t.tenantId};if(t.email)n.Jb=t.email;else if(t.phoneNumber)n.ea=t.phoneNumber;else if(!n.credential)return new k(e,t.message||void 0);return new Qo(e,n,t.message)}return null}function Xo(){}function Jo(t){return t.c||(t.c=t.b())}function $o(){}function Zo(t){if(!t.f&&"undefined"==typeof XMLHttpRequest&&"undefined"!=typeof ActiveXObject){for(var e=["MSXML2.XMLHTTP.6.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],n=0;n<e.length;n++){var r=e[n];try{return new ActiveXObject(r),t.f=r}catch(t){}}throw Error("Could not create ActiveXObject. ActiveX might be disabled, or MSXML might not be installed")}return t.f}function ta(){}function ea(){this.a=new XDomainRequest,this.readyState=0,this.onreadystatechange=null,this.responseType=this.responseText=this.response="",this.status=-1,this.statusText="",this.a.onload=I(this.qc,this),this.a.onerror=I(this.Sb,this),this.a.onprogress=I(this.rc,this),this.a.ontimeout=I(this.vc,this)}function na(t,e){t.readyState=e,t.onreadystatechange&&t.onreadystatechange()}function ra(t,e,n){this.reset(t,e,n,void 0,void 0)}function ia(t){this.f=t,this.b=this.c=this.a=null}function oa(t,e){this.name=t,this.value=e}S(zo,k),S(Qo,k),Qo.prototype.w=function(){var t={code:this.code,message:this.message};this.email&&(t.email=this.email),this.phoneNumber&&(t.phoneNumber=this.phoneNumber),this.tenantId&&(t.tenantId=this.tenantId);var e=this.credential&&this.credential.w();return e&&mt(t,e),t},Qo.prototype.toJSON=function(){return this.w()},Xo.prototype.c=null,S($o,Xo),$o.prototype.a=function(){var t=Zo(this);return t?new ActiveXObject(t):new XMLHttpRequest},$o.prototype.b=function(){var t={};return Zo(this)&&(t[0]=!0,t[1]=!0),t},Go=new $o,S(ta,Xo),ta.prototype.a=function(){var t=new XMLHttpRequest;if("withCredentials"in t)return t;if("undefined"!=typeof XDomainRequest)return new ea;throw Error("Unsupported browser")},ta.prototype.b=function(){return{}},(t=ea.prototype).open=function(t,e,n){if(null!=n&&!n)throw Error("Only async requests are supported.");this.a.open(t,e)},t.send=function(t){if(t){if("string"!=typeof t)throw Error("Only string data is supported");this.a.send(t)}else this.a.send()},t.abort=function(){this.a.abort()},t.setRequestHeader=function(){},t.getResponseHeader=function(t){return"content-type"==t.toLowerCase()?this.a.contentType:""},t.qc=function(){this.status=200,this.response=this.responseText=this.a.responseText,na(this,4)},t.Sb=function(){this.status=500,this.response=this.responseText="",na(this,4)},t.vc=function(){this.Sb()},t.rc=function(){this.status=200,na(this,1)},t.getAllResponseHeaders=function(){return"content-type: "+this.a.contentType},ra.prototype.a=null,ra.prototype.reset=function(t,e,n,r,i){r||E(),delete this.a},oa.prototype.toString=function(){return this.name};var aa=new oa("SEVERE",1e3),sa=new oa("WARNING",900),ua=new oa("CONFIG",700),ca=new oa("FINE",500);function la(t){return t.c?t.c:t.a?la(t.a):(F("Root logger has no level set."),null)}ia.prototype.log=function(t,e,n){if(t.value>=la(this).value)for(v(e)&&(e=e()),t=new ra(t,String(e),this.f),n&&(t.a=n),n=this;n;)n=n.a};var ha={},fa=null;function pa(t){var e;if(fa||(fa=new ia(""),ha[""]=fa,fa.c=ua),!(e=ha[t])){e=new ia(t);var n=t.lastIndexOf("."),r=t.substr(n+1);(n=pa(t.substr(0,n))).b||(n.b={}),n.b[r]=e,e.a=n,ha[t]=e}return e}function da(t,e){t&&t.log(ca,e,void 0)}function va(t){this.f=t}function ga(t){Tn.call(this),this.u=t,this.h=void 0,this.readyState=ya,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.l=new Headers,this.b=null,this.s="GET",this.f="",this.a=!1,this.i=pa("goog.net.FetchXmlHttp"),this.m=this.c=this.g=null}S(va,Xo),va.prototype.a=function(){return new ga(this.f)},va.prototype.b=function(t){return function(){return t}}({}),S(ga,Tn);var ya=0;function ma(t){t.c.read().then(t.pc.bind(t)).catch(t.Ua.bind(t))}function ba(t){t.readyState=4,t.g=null,t.c=null,t.m=null,_a(t)}function _a(t){t.onreadystatechange&&t.onreadystatechange.call(t)}function wa(t){Tn.call(this),this.headers=new On,this.D=t||null,this.c=!1,this.C=this.a=null,this.h=this.R=this.l="",this.f=this.O=this.i=this.J=!1,this.g=0,this.s=null,this.m=Ia,this.u=this.S=!1}(t=ga.prototype).open=function(t,e){if(this.readyState!=ya)throw this.abort(),Error("Error reopening a connection");this.s=t,this.f=e,this.readyState=1,_a(this)},t.send=function(t){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.a=!0;var e={headers:this.l,method:this.s,credentials:this.h,cache:void 0};t&&(e.body=t),this.u.fetch(new Request(this.f,e)).then(this.uc.bind(this),this.Ua.bind(this))},t.abort=function(){this.response=this.responseText="",this.l=new Headers,this.status=0,this.c&&this.c.cancel("Request was aborted."),1<=this.readyState&&this.a&&4!=this.readyState&&(this.a=!1,ba(this)),this.readyState=ya},t.uc=function(t){this.a&&(this.g=t,this.b||(this.status=this.g.status,this.statusText=this.g.statusText,this.b=t.headers,this.readyState=2,_a(this)),this.a&&(this.readyState=3,_a(this),this.a&&("arraybuffer"===this.responseType?t.arrayBuffer().then(this.sc.bind(this),this.Ua.bind(this)):void 0!==u.ReadableStream&&"body"in t?(this.response=this.responseText="",this.c=t.body.getReader(),this.m=new TextDecoder,ma(this)):t.text().then(this.tc.bind(this),this.Ua.bind(this)))))},t.pc=function(t){if(this.a){var e=this.m.decode(t.value?t.value:new Uint8Array(0),{stream:!t.done});e&&(this.response=this.responseText+=e),t.done?ba(this):_a(this),3==this.readyState&&ma(this)}},t.tc=function(t){this.a&&(this.response=this.responseText=t,ba(this))},t.sc=function(t){this.a&&(this.response=t,ba(this))},t.Ua=function(t){var e=this.i;e&&e.log(sa,"Failed to fetch url "+this.f,t instanceof Error?t:Error(t)),this.a&&ba(this)},t.setRequestHeader=function(t,e){this.l.append(t,e)},t.getResponseHeader=function(t){return this.b?this.b.get(t.toLowerCase())||"":((t=this.i)&&t.log(sa,"Attempting to get response header but no headers have been received for url: "+this.f,void 0),"")},t.getAllResponseHeaders=function(){if(!this.b){var t=this.i;return t&&t.log(sa,"Attempting to get all response headers but no headers have been received for url: "+this.f,void 0),""}t=[];for(var e=this.b.entries(),n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join("\r\n")},Object.defineProperty(ga.prototype,"withCredentials",{get:function(){return"include"===this.h},set:function(t){this.h=t?"include":"same-origin"}}),S(wa,Tn);var Ia="";wa.prototype.b=pa("goog.net.XhrIo");var Ta=/^https?$/i,Ea=["POST","PUT"];function Sa(t){return"content-type"==t.toLowerCase()}function Ca(t,e){t.c=!1,t.a&&(t.f=!0,t.a.abort(),t.f=!1),t.h=e,ka(t),Na(t)}function ka(t){t.J||(t.J=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function Aa(t){if(t.c&&void 0!==s)if(t.C[1]&&4==Oa(t)&&2==Ra(t))da(t.b,xa(t,"Local request error detected and ignored"));else if(t.i&&4==Oa(t))kn(t.Vb,0,t);else if(t.dispatchEvent("readystatechange"),4==Oa(t)){da(t.b,xa(t,"Request complete")),t.c=!1;try{var e,n=Ra(t);t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}if(!(e=r)){var i;if(i=0===n){var o=String(t.l).match(Dn)[1]||null;if(!o&&u.self&&u.self.location){var a=u.self.location.protocol;o=a.substr(0,a.length-1)}i=!Ta.test(o?o.toLowerCase():"")}e=i}if(e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{try{var c=2<Oa(t)?t.a.statusText:""}catch(e){da(t.b,"Can not get status: "+e.message),c=""}t.h=c+" ["+Ra(t)+"]",ka(t)}}finally{Na(t)}}}function Na(t,e){if(t.a){Pa(t);var n=t.a,r=t.C[0]?f:null;t.a=null,t.C=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=r}catch(e){(t=t.b)&&t.log(aa,"Problem encountered resetting onreadystatechange: "+e.message,void 0)}}}function Pa(t){t.a&&t.u&&(t.a.ontimeout=null),t.s&&(u.clearTimeout(t.s),t.s=null)}function Oa(t){return t.a?t.a.readyState:0}function Ra(t){try{return 2<Oa(t)?t.a.status:-1}catch(t){return-1}}function xa(t,e){return e+" ["+t.R+" "+t.l+" "+Ra(t)+"]"}function Da(t){var e=Ga;this.g=[],this.u=e,this.s=t||null,this.f=this.a=!1,this.c=void 0,this.v=this.C=this.i=!1,this.h=0,this.b=null,this.l=0}function La(t,e,n){t.a=!0,t.c=n,t.f=!e,ja(t)}function Ma(t){if(t.a){if(!t.v)throw new qa(t);t.v=!1}}function Fa(t,e,n,r){t.g.push([e,n,r]),t.a&&ja(t)}function Ua(t){return Q(t.g,(function(t){return v(t[1])}))}function ja(t){if(t.h&&t.a&&Ua(t)){var e=t.h,n=Ka[e];n&&(u.clearTimeout(n.a),delete Ka[e]),t.h=0}t.b&&(t.b.l--,delete t.b),e=t.c;for(var r=n=!1;t.g.length&&!t.i;){var i=t.g.shift(),o=i[0],a=i[1];if(i=i[2],o=t.f?a:o)try{var s=o.call(i||t.s,e);void 0!==s&&(t.f=t.f&&(s==e||s instanceof Error),t.c=e=s),(D(e)||"function"==typeof u.Promise&&e instanceof u.Promise)&&(r=!0,t.i=!0)}catch(r){e=r,t.f=!0,Ua(t)||(n=!0)}}t.c=e,r&&(s=I(t.m,t,!0),r=I(t.m,t,!1),e instanceof Da?(Fa(e,s,r),e.C=!0):e.then(s,r)),n&&(e=new Ba(e),Ka[e.a]=e,t.h=e.a)}function qa(){L.call(this)}function Va(){L.call(this)}function Ba(t){this.a=u.setTimeout(I(this.c,this),0),this.b=t}(t=wa.prototype).Ma=function(){void 0!==s&&this.a&&(this.h="Timed out after "+this.g+"ms, aborting",da(this.b,xa(this,this.h)),this.dispatchEvent("timeout"),this.abort(8))},t.abort=function(){this.a&&this.c&&(da(this.b,xa(this,"Aborting")),this.c=!1,this.f=!0,this.a.abort(),this.f=!1,this.dispatchEvent("complete"),this.dispatchEvent("abort"),Na(this))},t.Da=function(){this.a&&(this.c&&(this.c=!1,this.f=!0,this.a.abort(),this.f=!1),Na(this,!0)),wa.ab.Da.call(this)},t.Vb=function(){this.xa||(this.O||this.i||this.f?Aa(this):this.Jc())},t.Jc=function(){Aa(this)},t.getResponse=function(){try{if(!this.a)return null;if("response"in this.a)return this.a.response;switch(this.m){case Ia:case"text":return this.a.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in this.a)return this.a.mozResponseArrayBuffer}var t=this.b;return t&&t.log(aa,"Response type "+this.m+" is not supported on this browser",void 0),null}catch(t){return da(this.b,"Can not get response: "+t.message),null}},Da.prototype.cancel=function(t){if(this.a)this.c instanceof Da&&this.c.cancel();else{if(this.b){var e=this.b;delete this.b,t?e.cancel(t):(e.l--,0>=e.l&&e.cancel())}this.u?this.u.call(this.s,this):this.v=!0,this.a||(t=new Va(this),Ma(this),La(this,!1,t))}},Da.prototype.m=function(t,e){this.i=!1,La(this,t,e)},Da.prototype.then=function(t,e,n){var r,i,o=new Ie((function(t,e){r=t,i=e}));return Fa(this,r,(function(t){t instanceof Va?o.cancel():i(t)})),o.then(t,e,n)},Da.prototype.$goog_Thenable=!0,S(qa,L),qa.prototype.message="Deferred has already fired",qa.prototype.name="AlreadyCalledError",S(Va,L),Va.prototype.message="Deferred was canceled",Va.prototype.name="CanceledError",Ba.prototype.c=function(){throw delete Ka[this.a],this.b};var Ka={};function Wa(t){var e={},n=e.document||document,r=kt(t).toString(),i=ge(document,"SCRIPT"),o={Wb:i,Ma:void 0},a=new Da(o),s=null,c=null!=e.timeout?e.timeout:5e3;return 0<c&&(s=window.setTimeout((function(){Ha(i,!0);var t=new Ya(Qa,"Timeout reached for loading script "+r);Ma(a),La(a,!1,t)}),c),o.Ma=s),i.onload=i.onreadystatechange=function(){i.readyState&&"loaded"!=i.readyState&&"complete"!=i.readyState||(Ha(i,e.xd||!1,s),Ma(a),La(a,!0,null))},i.onerror=function(){Ha(i,!0,s);var t=new Ya(za,"Error while loading script "+r);Ma(a),La(a,!1,t)},mt(o=e.attributes||{},{type:"text/javascript",charset:"UTF-8"}),he(i,o),function(t,e){bt(t,"HTMLScriptElement"),t.src=kt(e),(e=t.ownerDocument&&t.ownerDocument.defaultView)&&e!=u?e=h(e.document):(null===l&&(l=h(u.document)),e=l),e&&t.setAttribute("nonce",e)}(i,t),function(t){var e;return(e=(t||document).getElementsByTagName("HEAD"))&&0!=e.length?e[0]:t.documentElement}(n).appendChild(i),a}function Ga(){if(this&&this.Wb){var t=this.Wb;t&&"SCRIPT"==t.tagName&&Ha(t,!0,this.Ma)}}function Ha(t,e,n){null!=n&&u.clearTimeout(n),t.onload=f,t.onerror=f,t.onreadystatechange=f,e&&window.setTimeout((function(){t&&t.parentNode&&t.parentNode.removeChild(t)}),0)}var za=0,Qa=1;function Ya(t,e){var n="Jsloader error (code #"+t+")";e&&(n+=": "+e),L.call(this,n),this.code=t}function Xa(t){this.f=t}function Ja(t,e,n){if(this.c=t,t=e||{},this.l=t.secureTokenEndpoint||"https://securetoken.googleapis.com/v1/token",this.m=t.secureTokenTimeout||ts,this.g=gt(t.secureTokenHeaders||es),this.h=t.firebaseEndpoint||"https://www.googleapis.com/identitytoolkit/v3/relyingparty/",this.i=t.identityPlatformEndpoint||"https://identitytoolkit.googleapis.com/v2/",this.v=t.firebaseTimeout||ns,this.a=gt(t.firebaseHeaders||rs),n&&(this.a["X-Client-Version"]=n,this.g["X-Client-Version"]=n),n="Node"==Er(),!(n=u.XMLHttpRequest||n&&r.default.INTERNAL.node&&r.default.INTERNAL.node.XMLHttpRequest)&&!Tr())throw new k("internal-error","The XMLHttpRequest compatibility library was not found.");this.f=void 0,Tr()?this.f=new va(self):Sr()?this.f=new Xa(n):this.f=new ta,this.b=null}S(Ya,L),S(Xa,Xo),Xa.prototype.a=function(){return new this.f},Xa.prototype.b=function(){return{}};var $a,Za="idToken",ts=new Wr(3e4,6e4),es={"Content-Type":"application/x-www-form-urlencoded"},ns=new Wr(3e4,6e4),rs={"Content-Type":"application/json"};function is(t,e){e?t.a["X-Firebase-Locale"]=e:delete t.a["X-Firebase-Locale"]}function os(t,e){e&&(t.l=as("https://securetoken.googleapis.com/v1/token",e),t.h=as("https://www.googleapis.com/identitytoolkit/v3/relyingparty/",e),t.i=as("https://identitytoolkit.googleapis.com/v2/",e))}function as(t,e){return t=Vn(t),e=Vn(e.url),t.f=t.a+t.f,Mn(t,e.c),t.a=e.a,Fn(t,e.g),t.toString()}function ss(t,e){e?(t.a["X-Client-Version"]=e,t.g["X-Client-Version"]=e):(delete t.a["X-Client-Version"],delete t.g["X-Client-Version"])}function us(t,e,n,r,i,o,a){(function(){var t=Or();return!((t=Ar(t)!=kr?null:(t=t.match(/\sChrome\/(\d+)/i))&&2==t.length?parseInt(t[1],10):null)&&30>t||Xt&&ue&&!(9<ue))})()||Tr()?t=I(t.u,t):($a||($a=new Ie((function(t,e){!function(t,e){((window.gapi||{}).client||{}).request?t():(u[ls]=function(){((window.gapi||{}).client||{}).request?t():e(Error("CORS_UNSUPPORTED"))},function(t,e){Fa(t,null,e,void 0)}(Wa(At(cs,{onload:ls})),(function(){e(Error("CORS_UNSUPPORTED"))})))}(t,e)}))),t=I(t.s,t)),t(e,n,r,i,o,a)}Ja.prototype.T=function(){return this.b},Ja.prototype.u=function(t,e,n,r,i,o){if(Tr()&&(void 0===u.fetch||void 0===u.Headers||void 0===u.Request))throw new k("operation-not-supported-in-this-environment","fetch, Headers and Request native APIs or equivalent Polyfills must be available to support HTTP requests from a Worker environment.");var a=new wa(this.f);if(o){a.g=Math.max(0,o);var s=setTimeout((function(){a.dispatchEvent("timeout")}),o)}En(a,"complete",(function(){s&&clearTimeout(s);var t=null;try{t=JSON.parse(function(t){try{return t.a?t.a.responseText:""}catch(e){return da(t.b,"Can not get responseText: "+e.message),""}}(this))||null}catch(e){t=null}e&&e(t)})),Sn(a,"ready",(function(){s&&clearTimeout(s),ze(this)})),Sn(a,"timeout",(function(){s&&clearTimeout(s),ze(this),e&&e(null)})),function(t,e,n,r,i){if(t.a)throw Error("[goog.net.XhrIo] Object is active with another request="+t.l+"; newUri="+e);n=n?n.toUpperCase():"GET",t.l=e,t.h="",t.R=n,t.J=!1,t.c=!0,t.a=t.D?t.D.a():Go.a(),t.C=t.D?Jo(t.D):Jo(Go),t.a.onreadystatechange=I(t.Vb,t);try{da(t.b,xa(t,"Opening Xhr")),t.O=!0,t.a.open(n,String(e),!0),t.O=!1}catch(e){return da(t.b,xa(t,"Error opening Xhr: "+e.message)),void Ca(t,e)}e=r||"";var o=new On(t.headers);i&&function(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(d(t)||"string"==typeof t)G(t,e,void 0);else for(var n=Pn(t),r=Nn(t),i=r.length,o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}(i,(function(t,e){o.set(e,t)})),i=function(t){t:{for(var e=Sa,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return 0>e?null:"string"==typeof t?t.charAt(e):t[e]}(o.Y()),r=u.FormData&&e instanceof u.FormData,!Y(Ea,n)||i||r||o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach((function(t,e){this.a.setRequestHeader(e,t)}),t),t.m&&(t.a.responseType=t.m),"withCredentials"in t.a&&t.a.withCredentials!==t.S&&(t.a.withCredentials=t.S);try{Pa(t),0<t.g&&(t.u=function(t){return Xt&&se(9)&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(t.a),da(t.b,xa(t,"Will abort after "+t.g+"ms if incomplete, xhr2 "+t.u)),t.u?(t.a.timeout=t.g,t.a.ontimeout=I(t.Ma,t)):t.s=kn(t.Ma,t.g,t)),da(t.b,xa(t,"Sending request")),t.i=!0,t.a.send(e),t.i=!1}catch(e){da(t.b,xa(t,"Send error: "+e.message)),Ca(t,e)}}(a,t,n,r,i)};var cs=new _t(Et,"https://apis.google.com/js/client.js?onload=%{onload}"),ls="__fcb"+Math.floor(1e6*Math.random()).toString();function hs(t){if("string"!=typeof(t=t.email)||!br.test(t))throw new k("invalid-email")}function fs(t){"email"in t&&hs(t)}function ps(t){if(!t[Za]){if(t.mfaPendingCredential)throw new k("multi-factor-auth-required",null,gt(t));throw new k("internal-error")}}function ds(t){if(t.phoneNumber||t.temporaryProof){if(!t.phoneNumber||!t.temporaryProof)throw new k("internal-error")}else{if(!t.sessionInfo)throw new k("missing-verification-id");if(!t.code)throw new k("missing-verification-code")}}Ja.prototype.s=function(t,e,n,r,i){var o=this;$a.then((function(){window.gapi.client.setApiKey(o.c);var a=window.gapi.auth.getToken();window.gapi.auth.setToken(null),window.gapi.client.request({path:t,method:n,body:r,headers:i,authType:"none",callback:function(t){window.gapi.auth.setToken(a),e&&e(t)}})})).o((function(t){e&&e({error:{message:t&&t.message||"CORS_UNSUPPORTED"}})}))},Ja.prototype.zb=function(){return ru(this,Gs,{})},Ja.prototype.Bb=function(t,e){return ru(this,Ks,{idToken:t,email:e})},Ja.prototype.Cb=function(t,e){return ru(this,Ws,{idToken:t,password:e})};var vs={displayName:"DISPLAY_NAME",photoUrl:"PHOTO_URL"};function gs(t){if(!t.phoneVerificationInfo)throw new k("internal-error");if(!t.phoneVerificationInfo.sessionInfo)throw new k("missing-verification-id");if(!t.phoneVerificationInfo.code)throw new k("missing-verification-code")}function ys(t){if(!t.requestUri||!t.sessionId&&!t.postBody&&!t.pendingToken)throw new k("internal-error")}function ms(t,e){return e.oauthIdToken&&e.providerId&&0==e.providerId.indexOf("oidc.")&&!e.pendingToken&&(t.sessionId?e.nonce=t.sessionId:t.postBody&&er(t=new Jn(t.postBody),"nonce")&&(e.nonce=t.get("nonce"))),e}function bs(t){var e=null;if(t.needConfirmation?(t.code="account-exists-with-different-credential",e=Yo(t)):"FEDERATED_USER_ID_ALREADY_LINKED"==t.errorMessage?(t.code="credential-already-in-use",e=Yo(t)):"EMAIL_EXISTS"==t.errorMessage?(t.code="email-already-in-use",e=Yo(t)):t.errorMessage&&(e=iu(t.errorMessage)),e)throw e;ps(t)}function _s(t,e){return e.returnIdpCredential=!0,ru(t,Qs,e)}function ws(t,e){return e.returnIdpCredential=!0,ru(t,Xs,e)}function Is(t,e){return e.returnIdpCredential=!0,e.autoCreate=!1,ru(t,Ys,e)}function Ts(t){if(!t.oobCode)throw new k("invalid-action-code")}(t=Ja.prototype).Db=function(t,e){var n={idToken:t},r=[];return dt(vs,(function(t,i){var o=e[i];null===o?r.push(t):i in e&&(n[i]=o)})),r.length&&(n.deleteAttribute=r),ru(this,Ks,n)},t.vb=function(t,e){return mt(t={requestType:"PASSWORD_RESET",email:t},e),ru(this,Us,t)},t.wb=function(t,e){return mt(t={requestType:"EMAIL_SIGNIN",email:t},e),ru(this,Ls,t)},t.ub=function(t,e){return mt(t={requestType:"VERIFY_EMAIL",idToken:t},e),ru(this,Ms,t)},t.Eb=function(t,e,n){return mt(t={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:t,newEmail:e},n),ru(this,Fs,t)},t.fb=function(t){return ru(this,Zs,t)},t.nb=function(t,e){return ru(this,Vs,{oobCode:t,newPassword:e})},t.Ra=function(t){return ru(this,Ss,{oobCode:t})},t.jb=function(t){return ru(this,Es,{oobCode:t})};var Es={endpoint:"setAccountInfo",A:Ts,Z:"email",B:!0},Ss={endpoint:"resetPassword",A:Ts,G:function(t){var e=t.requestType;if(!e||!t.email&&"EMAIL_SIGNIN"!=e&&"VERIFY_AND_CHANGE_EMAIL"!=e)throw new k("internal-error")},B:!0},Cs={endpoint:"signupNewUser",A:function(t){if(hs(t),!t.password)throw new k("weak-password")},G:ps,V:!0,B:!0},ks={endpoint:"createAuthUri",B:!0},As={endpoint:"deleteAccount",N:["idToken"]},Ns={endpoint:"setAccountInfo",N:["idToken","deleteProvider"],A:function(t){if(!Array.isArray(t.deleteProvider))throw new k("internal-error")}},Ps={endpoint:"emailLinkSignin",N:["email","oobCode"],A:hs,G:ps,V:!0,B:!0},Os={endpoint:"emailLinkSignin",N:["idToken","email","oobCode"],A:hs,G:ps,V:!0},Rs={endpoint:"accounts/mfaEnrollment:finalize",N:["idToken","phoneVerificationInfo"],A:gs,G:ps,B:!0,Na:!0},xs={endpoint:"accounts/mfaSignIn:finalize",N:["mfaPendingCredential","phoneVerificationInfo"],A:gs,G:ps,B:!0,Na:!0},Ds={endpoint:"getAccountInfo"},Ls={endpoint:"getOobConfirmationCode",N:["requestType"],A:function(t){if("EMAIL_SIGNIN"!=t.requestType)throw new k("internal-error");hs(t)},Z:"email",B:!0},Ms={endpoint:"getOobConfirmationCode",N:["idToken","requestType"],A:function(t){if("VERIFY_EMAIL"!=t.requestType)throw new k("internal-error")},Z:"email",B:!0},Fs={endpoint:"getOobConfirmationCode",N:["idToken","newEmail","requestType"],A:function(t){if("VERIFY_AND_CHANGE_EMAIL"!=t.requestType)throw new k("internal-error")},Z:"email",B:!0},Us={endpoint:"getOobConfirmationCode",N:["requestType"],A:function(t){if("PASSWORD_RESET"!=t.requestType)throw new k("internal-error");hs(t)},Z:"email",B:!0},js={lb:!0,endpoint:"getProjectConfig",Ub:"GET"},qs={lb:!0,endpoint:"getRecaptchaParam",Ub:"GET",G:function(t){if(!t.recaptchaSiteKey)throw new k("internal-error")}},Vs={endpoint:"resetPassword",A:Ts,Z:"email",B:!0},Bs={endpoint:"sendVerificationCode",N:["phoneNumber","recaptchaToken"],Z:"sessionInfo",B:!0},Ks={endpoint:"setAccountInfo",N:["idToken"],A:fs,V:!0},Ws={endpoint:"setAccountInfo",N:["idToken"],A:function(t){if(fs(t),!t.password)throw new k("weak-password")},G:ps,V:!0},Gs={endpoint:"signupNewUser",G:ps,V:!0,B:!0},Hs={endpoint:"accounts/mfaEnrollment:start",N:["idToken","phoneEnrollmentInfo"],A:function(t){if(!t.phoneEnrollmentInfo)throw new k("internal-error");if(!t.phoneEnrollmentInfo.phoneNumber)throw new k("missing-phone-number");if(!t.phoneEnrollmentInfo.recaptchaToken)throw new k("missing-app-credential")},G:function(t){if(!t.phoneSessionInfo||!t.phoneSessionInfo.sessionInfo)throw new k("internal-error")},B:!0,Na:!0},zs={endpoint:"accounts/mfaSignIn:start",N:["mfaPendingCredential","mfaEnrollmentId","phoneSignInInfo"],A:function(t){if(!t.phoneSignInInfo||!t.phoneSignInInfo.recaptchaToken)throw new k("missing-app-credential")},G:function(t){if(!t.phoneResponseInfo||!t.phoneResponseInfo.sessionInfo)throw new k("internal-error")},B:!0,Na:!0},Qs={endpoint:"verifyAssertion",A:ys,Ya:ms,G:bs,V:!0,B:!0},Ys={endpoint:"verifyAssertion",A:ys,Ya:ms,G:function(t){if(t.errorMessage&&"USER_NOT_FOUND"==t.errorMessage)throw new k("user-not-found");if(t.errorMessage)throw iu(t.errorMessage);ps(t)},V:!0,B:!0},Xs={endpoint:"verifyAssertion",A:function(t){if(ys(t),!t.idToken)throw new k("internal-error")},Ya:ms,G:bs,V:!0},Js={endpoint:"verifyCustomToken",A:function(t){if(!t.token)throw new k("invalid-custom-token")},G:ps,V:!0,B:!0},$s={endpoint:"verifyPassword",A:function(t){if(hs(t),!t.password)throw new k("wrong-password")},G:ps,V:!0,B:!0},Zs={endpoint:"verifyPhoneNumber",A:ds,G:ps,B:!0},tu={endpoint:"verifyPhoneNumber",A:function(t){if(!t.idToken)throw new k("internal-error");ds(t)},G:function(t){if(t.temporaryProof)throw t.code="credential-already-in-use",Yo(t);ps(t)}},eu={Hb:{USER_NOT_FOUND:"user-not-found"},endpoint:"verifyPhoneNumber",A:ds,G:ps,B:!0},nu={endpoint:"accounts/mfaEnrollment:withdraw",N:["idToken","mfaEnrollmentId"],G:function(t){if(!!t[Za]^!!t.refreshToken)throw new k("internal-error")},B:!0,Na:!0};function ru(t,e,n){if(!function(t,e){if(!e||!e.length)return!0;if(!t)return!1;for(var n=0;n<e.length;n++){var r=t[e[n]];if(null==r||""===r)return!1}return!0}(n,e.N))return Pe(new k("internal-error"));var r,i=!!e.Na,o=e.Ub||"POST";return Ne(n).then(e.A).then((function(){return e.V&&(n.returnSecureToken=!0),e.B&&t.b&&void 0===n.tenantId&&(n.tenantId=t.b),function(t,e,n,r,i,o,a){var s=Vn(e+n);jn(s,"key",t.c),a&&jn(s,"cb",Date.now().toString());var u="GET"==r;if(u)for(var c in i)i.hasOwnProperty(c)&&jn(s,c,i[c]);return new Ie((function(e,n){us(t,s.toString(),(function(t){t?t.error?n(ou(t,o||{})):e(t):n(new k("network-request-failed"))}),r,u?void 0:or(jr(i)),t.a,t.v.get())}))}(t,i?t.i:t.h,e.endpoint,o,n,e.Hb,e.lb||!1)})).then((function(t){return r=t,e.Ya?e.Ya(n,r):r})).then(e.G).then((function(){if(!e.Z)return r;if(!(e.Z in r))throw new k("internal-error");return r[e.Z]}))}function iu(t){return ou({error:{errors:[{message:t}],code:400,message:t}})}function ou(t,e){var n=(t.error&&t.error.errors&&t.error.errors[0]||{}).reason||"",r={keyInvalid:"invalid-api-key",ipRefererBlocked:"app-not-authorized"};if(n=r[n]?new k(r[n]):null)return n;for(var i in n=t.error&&t.error.message||"",mt(r={INVALID_CUSTOM_TOKEN:"invalid-custom-token",CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_EMAIL:"invalid-email",INVALID_PASSWORD:"wrong-password",USER_DISABLED:"user-disabled",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_OR_INVALID_NONCE:"missing-or-invalid-nonce",INVALID_MESSAGE_PAYLOAD:"invalid-message-payload",INVALID_RECIPIENT_EMAIL:"invalid-recipient-email",INVALID_SENDER:"invalid-sender",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",INVALID_PROVIDER_ID:"invalid-provider-id",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",CORS_UNSUPPORTED:"cors-unsupported",DYNAMIC_LINK_NOT_ACTIVATED:"dynamic-link-not-activated",INVALID_APP_ID:"invalid-app-id",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",WEAK_PASSWORD:"weak-password",OPERATION_NOT_ALLOWED:"operation-not-allowed",USER_CANCELLED:"user-cancelled",CAPTCHA_CHECK_FAILED:"captcha-check-failed",INVALID_APP_CREDENTIAL:"invalid-app-credential",INVALID_CODE:"invalid-verification-code",INVALID_PHONE_NUMBER:"invalid-phone-number",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_APP_CREDENTIAL:"missing-app-credential",MISSING_CODE:"missing-verification-code",MISSING_PHONE_NUMBER:"missing-phone-number",MISSING_SESSION_INFO:"missing-verification-id",QUOTA_EXCEEDED:"quota-exceeded",SESSION_EXPIRED:"code-expired",REJECTED_CREDENTIAL:"rejected-credential",INVALID_CONTINUE_URI:"invalid-continue-uri",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",MISSING_IOS_BUNDLE_ID:"missing-ios-bundle-id",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_DYNAMIC_LINK_DOMAIN:"invalid-dynamic-link-domain",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",INVALID_CERT_HASH:"invalid-cert-hash",UNSUPPORTED_TENANT_OPERATION:"unsupported-tenant-operation",INVALID_TENANT_ID:"invalid-tenant-id",TENANT_ID_MISMATCH:"tenant-id-mismatch",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",EMAIL_CHANGE_NEEDS_VERIFICATION:"email-change-needs-verification",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",UNSUPPORTED_FIRST_FACTOR:"unsupported-first-factor",UNVERIFIED_EMAIL:"unverified-email"},e||{}),e=(e=n.match(/^[^\s]+\s*:\s*([\s\S]*)$/))&&1<e.length?e[1]:void 0,r)if(0===n.indexOf(i))return new k(r[i],e);return!e&&t&&(e=Ur(t)),new k("internal-error",e)}function au(t){this.b=t,this.a=null,this.rb=function(t){return(lu||(lu=new Ie((function(t,e){function n(){Kr(),Rr("gapi.load")("gapi.iframes",{callback:t,ontimeout:function(){Kr(),e(Error("Network Error"))},timeout:uu.get()})}if(Rr("gapi.iframes.Iframe"))t();else if(Rr("gapi.load"))n();else{var r="__iframefcb"+Math.floor(1e6*Math.random()).toString();u[r]=function(){Rr("gapi.load")?n():e(Error("Network Error"))},Ne(Wa(r=At(su,{onload:r}))).o((function(){e(Error("Network Error"))}))}})).o((function(t){throw lu=null,t})))).then((function(){return new Ie((function(e,n){Rr("gapi.iframes.getContext")().open({where:document.body,url:t.b,messageHandlersFilter:Rr("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"),attributes:{style:{position:"absolute",top:"-100px",width:"1px",height:"1px"}},dontclear:!0},(function(r){function i(){clearTimeout(o),e()}t.a=r,t.a.restyle({setHideOnLeave:!1});var o=setTimeout((function(){n(Error("Network Error"))}),cu.get());r.ping(i).then(i,(function(){n(Error("Network Error"))}))}))}))}))}(this)}var su=new _t(Et,"https://apis.google.com/js/api.js?onload=%{onload}"),uu=new Wr(3e4,6e4),cu=new Wr(5e3,15e3),lu=null;function hu(t,e,n,r){this.l=t,this.h=e,this.i=n,this.g=r,this.f=null,t=this.g?Bn((t=Vn(this.g.url)).c,t.a,t.g,"/emulator/auth/iframe"):Bn("https",this.l,null,"/__/auth/iframe"),this.a=t,jn(this.a,"apiKey",this.h),jn(this.a,"appName",this.i),this.b=null,this.c=[]}function fu(t,e,n,r,i,o){this.u=t,this.s=e,this.c=n,this.m=r,this.v=o,this.i=this.g=this.l=null,this.a=i,this.h=this.f=null}function pu(t){try{return r.default.app(t).auth().Ga()}catch(t){return[]}}function du(t,e,n,r,i,o){this.s=t,this.g=e,this.b=n,this.f=o,this.c=r||null,this.i=i||null,this.l=this.u=this.C=null,this.h=[],this.m=this.a=null}function vu(t){var e=fr();return function(t){return ru(t,js,{}).then((function(t){return t.authorizedDomains||[]}))}(t).then((function(t){t:{var n=Vn(e),r=n.c;n=n.a;for(var i=0;i<t.length;i++){var o=t[i],a=n,s=r;if(0==o.indexOf("chrome-extension://")?a=Vn(o).a==a&&"chrome-extension"==s:"http"!=s&&"https"!=s?a=!1:mr.test(o)?a=a==o:(o=o.split(".").join("\\."),a=new RegExp("^(.+\\."+o+"|"+o+")$","i").test(a)),a){t=!0;break t}}t=!1}if(!t)throw new zo(fr())}))}function gu(t){return t.m||(t.m=_r().then((function(){if(!t.u){var e=t.c,n=t.i,r=pu(t.b),i=new hu(t.s,t.g,t.b,t.f);i.f=e,i.b=n,i.c=Z(r||[]),t.u=i.toString()}t.v=new au(t.u),function(t){if(!t.v)throw Error("IfcHandler must be initialized!");!function(t,e){t.rb.then((function(){t.a.register("authEvent",e,Rr("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"))}))}(t.v,(function(e){var n={};if(e&&e.authEvent){var r=!1;for(e=Ko(e.authEvent),n=0;n<t.h.length;n++)r=t.h[n](e)||r;return(n={}).status=r?"ACK":"ERROR",Ne(n)}return n.status="ERROR",Ne(n)}))}(t)}))),t.m}function yu(t){return t.l||(t.C=t.c?Pr(t.c,pu(t.b)):null,t.l=new Ja(t.g,x(t.i),t.C),t.f&&os(t.l,t.f)),t.l}function mu(t,e,n,r,i,o,a,s,u,c,l,h){return(t=new fu(t,e,n,r,i,h)).l=o,t.g=a,t.i=s,t.b=gt(u||null),t.f=c,t.yb(l).toString()}function bu(t){if(this.a=t||r.default.INTERNAL.reactNative&&r.default.INTERNAL.reactNative.AsyncStorage,!this.a)throw new k("internal-error","The React Native compatibility library was not found.");this.type="asyncStorage"}function _u(t){this.b=t,this.a={},this.f=I(this.c,this)}hu.prototype.toString=function(){return this.f?jn(this.a,"v",this.f):tr(this.a.b,"v"),this.b?jn(this.a,"eid",this.b):tr(this.a.b,"eid"),this.c.length?jn(this.a,"fw",this.c.join(",")):tr(this.a.b,"fw"),this.a.toString()},fu.prototype.yb=function(t){return this.h=t,this},fu.prototype.toString=function(){if(this.v){var t=Vn(this.v.url);t=Bn(t.c,t.a,t.g,"/emulator/auth/handler")}else t=Bn("https",this.u,null,"/__/auth/handler");if(jn(t,"apiKey",this.s),jn(t,"appName",this.c),jn(t,"authType",this.m),this.a.isOAuthProvider){var e=this.a;try{var n=r.default.app(this.c).auth().la()}catch(t){n=null}for(var i in e.ob=n,jn(t,"providerId",this.a.providerId),e=jr((n=this.a).Ib))e[i]=e[i].toString();i=n.Qc,e=gt(e);for(var o=0;o<i.length;o++){var a=i[o];a in e&&delete e[a]}n.pb&&n.ob&&!e[n.pb]&&(e[n.pb]=n.ob),vt(e)||jn(t,"customParameters",Ur(e))}if("function"==typeof this.a.Qb&&(n=this.a.Qb()).length&&jn(t,"scopes",n.join(",")),this.l?jn(t,"redirectUrl",this.l):tr(t.b,"redirectUrl"),this.g?jn(t,"eventId",this.g):tr(t.b,"eventId"),this.i?jn(t,"v",this.i):tr(t.b,"v"),this.b)for(var s in this.b)this.b.hasOwnProperty(s)&&!qn(t,s)&&jn(t,s,this.b[s]);return this.h?jn(t,"tid",this.h):tr(t.b,"tid"),this.f?jn(t,"eid",this.f):tr(t.b,"eid"),(s=pu(this.c)).length&&jn(t,"fw",s.join(",")),t.toString()},(t=du.prototype).Ob=function(t,e,n){var r=new k("popup-closed-by-user"),i=new k("web-storage-unsupported"),o=this,a=!1;return this.ma().then((function(){(function(t){var e={type:"webStorageSupport"};return gu(t).then((function(){return function(t,e){return t.rb.then((function(){return new Ie((function(n){t.a.send(e.type,e,n,Rr("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"))}))}))}(t.v,e)})).then((function(t){if(t&&t.length&&void 0!==t[0].webStorageSupport)return t[0].webStorageSupport;throw Error()}))})(o).then((function(n){n||(t&&gr(t),e(i),a=!0)}))})).o((function(){})).then((function(){if(!a)return function(t){return new Ie((function(e){return function n(){An(2e3).then((function(){if(t&&!t.closed)return n();e()}))}()}))}(t)})).then((function(){if(!a)return An(n).then((function(){e(r)}))}))},t.Xb=function(){var t=Or();return!Fr(t)&&!Br(t)},t.Tb=function(){return!1},t.Mb=function(t,e,n,r,i,o,a,s){if(!t)return Pe(new k("popup-blocked"));if(a&&!Fr())return this.ma().o((function(e){gr(t),i(e)})),r(),Ne();this.a||(this.a=vu(yu(this)));var u=this;return this.a.then((function(){var e=u.ma().o((function(e){throw gr(t),i(e),e}));return r(),e})).then((function(){Vo(n),a||pr(mu(u.s,u.g,u.b,e,n,null,o,u.c,void 0,u.i,s,u.f),t)})).o((function(t){throw"auth/network-request-failed"==t.code&&(u.a=null),t}))},t.Nb=function(t,e,n,r){this.a||(this.a=vu(yu(this)));var i=this;return this.a.then((function(){Vo(e),pr(mu(i.s,i.g,i.b,t,e,fr(),n,i.c,void 0,i.i,r,i.f))})).o((function(t){throw"auth/network-request-failed"==t.code&&(i.a=null),t}))},t.ma=function(){var t=this;return gu(this).then((function(){return t.v.rb})).o((function(){throw t.a=null,new k("network-request-failed")}))},t.$b=function(){return!0},t.Ea=function(t){this.h.push(t)},t.Sa=function(t){J(this.h,(function(e){return e==t}))},(t=bu.prototype).get=function(t){return Ne(this.a.getItem(t)).then((function(t){return t&&qr(t)}))},t.set=function(t,e){return Ne(this.a.setItem(t,Ur(e)))},t.U=function(t){return Ne(this.a.removeItem(t))},t.ca=function(){},t.ia=function(){};var wu,Iu=[];function Tu(t,e,n){vt(t.a)&&t.b.addEventListener("message",t.f),void 0===t.a[e]&&(t.a[e]=[]),t.a[e].push(n)}function Eu(t){this.a=t}function Su(t){this.c=t,this.b=!1,this.a=[]}function Cu(t,e,n,r){var i,o,a,s,u=n||{},c=null;if(t.b)return Pe(Error("connection_unavailable"));var l=r?800:50,h="undefined"!=typeof MessageChannel?new MessageChannel:null;return new Ie((function(n,r){h?(i=Math.floor(Math.random()*Math.pow(10,20)).toString(),h.port1.start(),a=setTimeout((function(){r(Error("unsupported_event"))}),l),c={messageChannel:h,onMessage:o=function(t){t.data.eventId===i&&("ack"===t.data.status?(clearTimeout(a),s=setTimeout((function(){r(Error("timeout"))}),3e3)):"done"===t.data.status?(clearTimeout(s),void 0!==t.data.response?n(t.data.response):r(Error("unknown_error"))):(clearTimeout(a),clearTimeout(s),r(Error("invalid_response"))))}},t.a.push(c),h.port1.addEventListener("message",o),t.c.postMessage({eventType:e,eventId:i,data:u},[h.port2])):r(Error("connection_unavailable"))})).then((function(e){return ku(t,c),e})).o((function(e){throw ku(t,c),e}))}function ku(t,e){if(e){var n=e.messageChannel,r=e.onMessage;n&&(n.port1.removeEventListener("message",r),n.port1.close()),J(t.a,(function(t){return t==e}))}}function Au(){if(!Ru())throw new k("web-storage-unsupported");this.c={},this.a=[],this.b=0,this.m=u.indexedDB,this.type="indexedDB",this.g=this.v=this.f=this.l=null,this.s=!1,this.h=null;var t=this;Tr()&&self?(this.v=function(){var t=Tr()?self:null;if(G(Iu,(function(n){n.b==t&&(e=n)})),!e){var e=new _u(t);Iu.push(e)}return e}(),Tu(this.v,"keyChanged",(function(e,n){return Fu(t).then((function(e){return 0<e.length&&G(t.a,(function(t){t(e)})),{keyProcessed:Y(e,n.key)}}))})),Tu(this.v,"ping",(function(){return Ne(["keyChanged"])}))):function(){var t=u.navigator;return t&&t.serviceWorker?Ne().then((function(){return t.serviceWorker.ready})).then((function(t){return t.active||null})).o((function(){return null})):Ne(null)}().then((function(e){(t.h=e)&&(t.g=new Su(new Eu(e)),Cu(t.g,"ping",null,!0).then((function(e){e[0].fulfilled&&Y(e[0].value,"keyChanged")&&(t.s=!0)})).o((function(){})))}))}function Nu(t){return new Ie((function(e,n){var r=t.m.open("firebaseLocalStorageDb",1);r.onerror=function(t){try{t.preventDefault()}catch(t){}n(Error(t.target.error))},r.onupgradeneeded=function(t){t=t.target.result;try{t.createObjectStore("firebaseLocalStorage",{keyPath:"fbase_key"})}catch(t){n(t)}},r.onsuccess=function(r){(r=r.target.result).objectStoreNames.contains("firebaseLocalStorage")?e(r):function(t){return new Ie((function(e,n){var r=t.m.deleteDatabase("firebaseLocalStorageDb");r.onsuccess=function(){e()},r.onerror=function(t){n(Error(t.target.error))}}))}(t).then((function(){return Nu(t)})).then((function(t){e(t)})).o((function(t){n(t)}))}}))}function Pu(t){return t.i||(t.i=Nu(t)),t.i}function Ou(t,e){var n=0;return new Ie((function r(i,o){Pu(t).then(e).then(i).o((function(e){if(!(3<++n))return Pu(t).then((function(e){return e.close(),t.i=void 0,r(i,o)})).o((function(t){o(t)}));o(e)}))}))}function Ru(){try{return!!u.indexedDB}catch(t){return!1}}function xu(t){return t.objectStore("firebaseLocalStorage")}function Du(t,e){return t.transaction(["firebaseLocalStorage"],e?"readwrite":"readonly")}function Lu(t){return new Ie((function(e,n){t.onsuccess=function(t){t&&t.target?e(t.target.result):e()},t.onerror=function(t){n(t.target.error)}}))}function Mu(t,e){return t.g&&t.h&&function(){var t=u.navigator;return t&&t.serviceWorker&&t.serviceWorker.controller||null}()===t.h?Cu(t.g,"keyChanged",{key:e},t.s).then((function(){})).o((function(){})):Ne()}function Fu(t){return Pu(t).then((function(t){var e=xu(Du(t,!1));return e.getAll?Lu(e.getAll()):new Ie((function(t,n){var r=[],i=e.openCursor();i.onsuccess=function(e){(e=e.target.result)?(r.push(e.value),e.continue()):t(r)},i.onerror=function(t){n(t.target.error)}}))})).then((function(e){var n={},r=[];if(0==t.b){for(r=0;r<e.length;r++)n[e[r].fbase_key]=e[r].value;r=dr(t.c,n),t.c=n}return r}))}function Uu(t){t.l&&t.l.cancel("STOP_EVENT"),t.f&&(clearTimeout(t.f),t.f=null)}function ju(t){var e=this,n=null;this.a=[],this.type="indexedDB",this.c=t,this.b=Ne().then((function(){if(Ru()){var t=Vr(),r="__sak"+t;return wu||(wu=new Au),(n=wu).set(r,t).then((function(){return n.get(r)})).then((function(e){if(e!==t)throw Error("indexedDB not supported!");return n.U(r)})).then((function(){return n})).o((function(){return e.c}))}return e.c})).then((function(t){return e.type=t.type,t.ca((function(t){G(e.a,(function(e){e(t)}))})),t}))}function qu(){this.a={},this.type="inMemory"}function Vu(){if(!function(){var t="Node"==Er();if(!(t=Bu()||t&&r.default.INTERNAL.node&&r.default.INTERNAL.node.localStorage))return!1;try{return t.setItem("__sak","1"),t.removeItem("__sak"),!0}catch(t){return!1}}()){if("Node"==Er())throw new k("internal-error","The LocalStorage compatibility library was not found.");throw new k("web-storage-unsupported")}this.a=Bu()||r.default.INTERNAL.node.localStorage,this.type="localStorage"}function Bu(){try{var t=u.localStorage,e=Vr();return t&&(t.setItem(e,"1"),t.removeItem(e)),t}catch(t){return null}}function Ku(){this.type="nullStorage"}function Wu(){if(!function(){var t="Node"==Er();if(!(t=Gu()||t&&r.default.INTERNAL.node&&r.default.INTERNAL.node.sessionStorage))return!1;try{return t.setItem("__sak","1"),t.removeItem("__sak"),!0}catch(t){return!1}}()){if("Node"==Er())throw new k("internal-error","The SessionStorage compatibility library was not found.");throw new k("web-storage-unsupported")}this.a=Gu()||r.default.INTERNAL.node.sessionStorage,this.type="sessionStorage"}function Gu(){try{var t=u.sessionStorage,e=Vr();return t&&(t.setItem(e,"1"),t.removeItem(e)),t}catch(t){return null}}function Hu(){var t={};t.Browser=Yu,t.Node=Xu,t.ReactNative=Ju,t.Worker=$u,this.a=t[Er()]}_u.prototype.c=function(t){var e=t.data.eventType,n=t.data.eventId,r=this.a[e];if(r&&0<r.length){t.ports[0].postMessage({status:"ack",eventId:n,eventType:e,response:null});var i=[];G(r,(function(e){i.push(Ne().then((function(){return e(t.origin,t.data.data)})))})),Re(i).then((function(r){var i=[];G(r,(function(t){i.push({fulfilled:t.Pb,value:t.value,reason:t.reason?t.reason.message:void 0})})),G(i,(function(t){for(var e in t)void 0===t[e]&&delete t[e]})),t.ports[0].postMessage({status:"done",eventId:n,eventType:e,response:i})}))}},Eu.prototype.postMessage=function(t,e){this.a.postMessage(t,e)},Su.prototype.close=function(){for(;0<this.a.length;)ku(this,this.a[0]);this.b=!0},(t=Au.prototype).set=function(t,e){var n=this,r=!1;return Ou(this,(function(e){return Lu((e=xu(Du(e,!0))).get(t))})).then((function(i){return Ou(n,(function(o){if(o=xu(Du(o,!0)),i)return i.value=e,Lu(o.put(i));n.b++,r=!0;var a={};return a.fbase_key=t,a.value=e,Lu(o.add(a))}))})).then((function(){return n.c[t]=e,Mu(n,t)})).oa((function(){r&&n.b--}))},t.get=function(t){return Ou(this,(function(e){return Lu(xu(Du(e,!1)).get(t))})).then((function(t){return t&&t.value}))},t.U=function(t){var e=this,n=!1;return Ou(this,(function(r){return n=!0,e.b++,Lu(xu(Du(r,!0)).delete(t))})).then((function(){return delete e.c[t],Mu(e,t)})).oa((function(){n&&e.b--}))},t.ca=function(t){0==this.a.length&&function(t){Uu(t),function e(){t.f=setTimeout((function(){t.l=Fu(t).then((function(e){0<e.length&&G(t.a,(function(t){t(e)}))})).then((function(){e()})).o((function(t){"STOP_EVENT"!=t.message&&e()}))}),800)}()}(this),this.a.push(t)},t.ia=function(t){J(this.a,(function(e){return e==t})),0==this.a.length&&Uu(this)},(t=ju.prototype).get=function(t){return this.b.then((function(e){return e.get(t)}))},t.set=function(t,e){return this.b.then((function(n){return n.set(t,e)}))},t.U=function(t){return this.b.then((function(e){return e.U(t)}))},t.ca=function(t){this.a.push(t)},t.ia=function(t){J(this.a,(function(e){return e==t}))},(t=qu.prototype).get=function(t){return Ne(this.a[t])},t.set=function(t,e){return this.a[t]=e,Ne()},t.U=function(t){return delete this.a[t],Ne()},t.ca=function(){},t.ia=function(){},(t=Vu.prototype).get=function(t){var e=this;return Ne().then((function(){return qr(e.a.getItem(t))}))},t.set=function(t,e){var n=this;return Ne().then((function(){var r=Ur(e);null===r?n.U(t):n.a.setItem(t,r)}))},t.U=function(t){var e=this;return Ne().then((function(){e.a.removeItem(t)}))},t.ca=function(t){u.window&&hn(u.window,"storage",t)},t.ia=function(t){u.window&&dn(u.window,"storage",t)},(t=Ku.prototype).get=function(){return Ne(null)},t.set=function(){return Ne()},t.U=function(){return Ne()},t.ca=function(){},t.ia=function(){},(t=Wu.prototype).get=function(t){var e=this;return Ne().then((function(){return qr(e.a.getItem(t))}))},t.set=function(t,e){var n=this;return Ne().then((function(){var r=Ur(e);null===r?n.U(t):n.a.setItem(t,r)}))},t.U=function(t){var e=this;return Ne().then((function(){e.a.removeItem(t)}))},t.ca=function(){},t.ia=function(){};var zu,Qu,Yu={F:Vu,bb:Wu},Xu={F:Vu,bb:Wu},Ju={F:bu,bb:Ku},$u={F:Vu,bb:Ku},Zu={rd:"local",NONE:"none",td:"session"};function tc(){var t=!(Br(Or())||!Ir()),e=Fr(),n=xr();this.m=t,this.h=e,this.l=n,this.a={},zu||(zu=new Hu),t=zu;try{this.g=!hr()&&zr()||!u.indexedDB?new t.a.F:new ju(Tr()?new qu:new t.a.F)}catch(t){this.g=new qu,this.h=!0}try{this.i=new t.a.bb}catch(t){this.i=new qu}this.v=new qu,this.f=I(this.Yb,this),this.b={}}function ec(){return Qu||(Qu=new tc),Qu}function nc(t,e){switch(e){case"session":return t.i;case"none":return t.v;default:return t.g}}function rc(t,e){return"firebase:"+t.name+(e?":"+e:"")}function ic(t,e,n){return n=rc(e,n),"local"==e.F&&(t.b[n]=null),nc(t,e.F).U(n)}function oc(t){t.c&&(clearInterval(t.c),t.c=null)}function ac(t){this.a=t,this.b=ec()}(t=tc.prototype).get=function(t,e){return nc(this,t.F).get(rc(t,e))},t.set=function(t,e,n){var r=rc(t,n),i=this,o=nc(this,t.F);return o.set(r,e).then((function(){return o.get(r)})).then((function(e){"local"==t.F&&(i.b[r]=e)}))},t.addListener=function(t,e,n){t=rc(t,e),this.l&&(this.b[t]=u.localStorage.getItem(t)),vt(this.a)&&(nc(this,"local").ca(this.f),this.h||(hr()||!zr())&&u.indexedDB||!this.l||function(t){oc(t),t.c=setInterval((function(){for(var e in t.a){var n=u.localStorage.getItem(e),r=t.b[e];n!=r&&(t.b[e]=n,n=new Ze({type:"storage",key:e,target:window,oldValue:r,newValue:n,a:!0}),t.Yb(n))}}),1e3)}(this)),this.a[t]||(this.a[t]=[]),this.a[t].push(n)},t.removeListener=function(t,e,n){t=rc(t,e),this.a[t]&&(J(this.a[t],(function(t){return t==n})),0==this.a[t].length&&delete this.a[t]),vt(this.a)&&(nc(this,"local").ia(this.f),oc(this))},t.Yb=function(t){if(t&&t.g){var e=t.a.key;if(null==e)for(var n in this.a){var r=this.b[n];void 0===r&&(r=null);var i=u.localStorage.getItem(n);i!==r&&(this.b[n]=i,this.mb(n))}else if(0==e.indexOf("firebase:")&&this.a[e]){if(void 0!==t.a.a?nc(this,"local").ia(this.f):oc(this),this.m)if(n=u.localStorage.getItem(e),(r=t.a.newValue)!==n)null!==r?u.localStorage.setItem(e,r):u.localStorage.removeItem(e);else if(this.b[e]===r&&void 0===t.a.a)return;var o=this;n=function(){void 0===t.a.a&&o.b[e]===u.localStorage.getItem(e)||(o.b[e]=u.localStorage.getItem(e),o.mb(e))},Xt&&ue&&10==ue&&u.localStorage.getItem(e)!==t.a.newValue&&t.a.newValue!==t.a.oldValue?setTimeout(n,10):n()}}else G(t,I(this.mb,this))},t.mb=function(t){this.a[t]&&G(this.a[t],(function(t){t()}))};var sc,uc={name:"authEvent",F:"local"};function cc(){this.a=ec()}function lc(t,e){this.b=hc,this.f=u.Uint8Array?new Uint8Array(this.b):Array(this.b),this.g=this.c=0,this.a=[],this.i=t,this.h=e,this.l=u.Int32Array?new Int32Array(64):Array(64),void 0===sc&&(sc=u.Int32Array?new Int32Array(mc):mc),this.reset()}S(lc,(function(){this.b=-1}));for(var hc=64,fc=hc-1,pc=[],dc=0;dc<fc;dc++)pc[dc]=0;var vc=$(128,pc);function gc(t){for(var e=t.f,n=t.l,r=0,i=0;i<e.length;)n[r++]=e[i]<<24|e[i+1]<<16|e[i+2]<<8|e[i+3],i=4*r;for(e=16;64>e;e++){i=0|n[e-15],r=0|n[e-2];var o=(0|n[e-16])+((i>>>7|i<<25)^(i>>>18|i<<14)^i>>>3)|0,a=(0|n[e-7])+((r>>>17|r<<15)^(r>>>19|r<<13)^r>>>10)|0;n[e]=o+a|0}r=0|t.a[0],i=0|t.a[1];var s=0|t.a[2],u=0|t.a[3],c=0|t.a[4],l=0|t.a[5],h=0|t.a[6];for(o=0|t.a[7],e=0;64>e;e++){var f=((r>>>2|r<<30)^(r>>>13|r<<19)^(r>>>22|r<<10))+(r&i^r&s^i&s)|0;a=(o=o+((c>>>6|c<<26)^(c>>>11|c<<21)^(c>>>25|c<<7))|0)+((a=(a=c&l^~c&h)+(0|sc[e])|0)+(0|n[e])|0)|0,o=h,h=l,l=c,c=u+a|0,u=s,s=i,i=r,r=a+f|0}t.a[0]=t.a[0]+r|0,t.a[1]=t.a[1]+i|0,t.a[2]=t.a[2]+s|0,t.a[3]=t.a[3]+u|0,t.a[4]=t.a[4]+c|0,t.a[5]=t.a[5]+l|0,t.a[6]=t.a[6]+h|0,t.a[7]=t.a[7]+o|0}function yc(t,e,n){void 0===n&&(n=e.length);var r=0,i=t.c;if("string"==typeof e)for(;r<n;)t.f[i++]=e.charCodeAt(r++),i==t.b&&(gc(t),i=0);else{if(!d(e))throw Error("message must be string or array");for(;r<n;){var o=e[r++];if(!("number"==typeof o&&0<=o&&255>=o&&o==(0|o)))throw Error("message must be a byte array");t.f[i++]=o,i==t.b&&(gc(t),i=0)}}t.c=i,t.g+=n}lc.prototype.reset=function(){this.g=this.c=0,this.a=u.Int32Array?new Int32Array(this.h):Z(this.h)};var mc=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function bc(){lc.call(this,8,_c)}S(bc,lc);var _c=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225];function wc(t,e,n,r,i,o){this.v=t,this.i=e,this.l=n,this.m=r||null,this.u=i||null,this.s=o,this.h=e+":"+n,this.C=new cc,this.g=new ac(this.h),this.f=null,this.b=[],this.a=this.c=null}function Ic(t){return new k("invalid-cordova-configuration",t)}function Tc(t,e){for(var n=0;n<t.b.length;n++)try{t.b[n](e)}catch(t){}}function Ec(t){return t.f||(t.f=t.ma().then((function(){return new Ie((function(e){t.Ea((function n(r){return e(r),t.Sa(n),!1})),function(t){function e(e){r=!0,i&&i.cancel(),Sc(t).then((function(r){var i=n;if(r&&e&&e.url){var o=null;-1!=(i=ao(e.url)).indexOf("/__/auth/callback")&&(o=(o="object"==typeof(o=qr(qn(o=Vn(i),"firebaseError")||null))?A(o):null)?new Bo(r.c,r.b,null,null,o,null,r.T()):new Bo(r.c,r.b,i,r.f,null,null,r.T())),i=o||n}Tc(t,i)}))}var n=new Bo("unknown",null,null,null,new k("no-auth-event")),r=!1,i=An(500).then((function(){return Sc(t).then((function(){r||Tc(t,n)}))})),o=u.handleOpenURL;u.handleOpenURL=function(t){if(0==t.toLowerCase().indexOf(Rr("BuildInfo.packageName",u).toLowerCase()+"://")&&e({url:t}),"function"==typeof o)try{o(t)}catch(t){console.error(t)}},Ho||(Ho=new Wo),function(t){var e=Ho;e.a.push(t),e.b||(e.b=function(t){for(var n=0;n<e.a.length;n++)e.a[n](t)},"function"==typeof(t=Rr("universalLinks.subscribe",u))&&t(null,e.b))}(e)}(t)}))}))),t.f}function Sc(t){var e=null;return function(t){return t.b.get(uc,t.a).then((function(t){return Ko(t)}))}(t.g).then((function(n){return e=n,ic((n=t.g).b,uc,n.a)})).then((function(){return e}))}function Cc(t){this.a=t,this.b=ec()}(t=wc.prototype).ma=function(){return this.Ia?this.Ia:this.Ia=(wr(void 0)?_r().then((function(){return new Ie((function(t,e){var n=u.document,r=setTimeout((function(){e(Error("Cordova framework is not ready."))}),1e3);n.addEventListener("deviceready",(function(){clearTimeout(r),t()}),!1)}))})):Pe(Error("Cordova must run in an Android or iOS file scheme."))).then((function(){if("function"!=typeof Rr("universalLinks.subscribe",u))throw Ic("cordova-universal-links-plugin-fix is not installed");if(void 0===Rr("BuildInfo.packageName",u))throw Ic("cordova-plugin-buildinfo is not installed");if("function"!=typeof Rr("cordova.plugins.browsertab.openUrl",u))throw Ic("cordova-plugin-browsertab is not installed");if("function"!=typeof Rr("cordova.InAppBrowser.open",u))throw Ic("cordova-plugin-inappbrowser is not installed")}),(function(){throw new k("cordova-not-ready")}))},t.Ob=function(t,e){return e(new k("operation-not-supported-in-this-environment")),Ne()},t.Mb=function(){return Pe(new k("operation-not-supported-in-this-environment"))},t.$b=function(){return!1},t.Xb=function(){return!0},t.Tb=function(){return!0},t.Nb=function(t,e,n,r){if(this.c)return Pe(new k("redirect-operation-pending"));var i=this,o=u.document,a=null,s=null,c=null,l=null;return this.c=Ne().then((function(){return Vo(e),Ec(i)})).then((function(){return function(t,e,n,r,i){var o=function(){for(var t=20,e=[];0<t;)e.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(Math.floor(62*Math.random()))),t--;return e.join("")}(),a=new Bo(e,r,null,o,new k("no-auth-event"),null,i),s=Rr("BuildInfo.packageName",u);if("string"!=typeof s)throw new k("invalid-cordova-configuration");var c=Rr("BuildInfo.displayName",u),l={};if(Or().toLowerCase().match(/iphone|ipad|ipod/))l.ibi=s;else{if(!Or().toLowerCase().match(/android/))return Pe(new k("operation-not-supported-in-this-environment"));l.apn=s}c&&(l.appDisplayName=c),o=function(t){var e=new bc;yc(e,t),t=[];var n=8*e.g;56>e.c?yc(e,vc,56-e.c):yc(e,vc,e.b-(e.c-56));for(var r=63;56<=r;r--)e.f[r]=255&n,n/=256;for(gc(e),r=n=0;r<e.i;r++)for(var i=24;0<=i;i-=8)t[n++]=e.a[r]>>i&255;return function(t){return z(t,(function(t){return 1<(t=t.toString(16)).length?t:"0"+t})).join("")}(t)}(o),l.sessionId=o;var h=mu(t.v,t.i,t.l,e,n,null,r,t.m,l,t.u,i,t.s);return t.ma().then((function(){var e=t.h;return t.C.a.set(uc,a.w(),e)})).then((function(){var e=Rr("cordova.plugins.browsertab.isAvailable",u);if("function"!=typeof e)throw new k("invalid-cordova-configuration");var n=null;e((function(e){if(e){if("function"!=typeof(n=Rr("cordova.plugins.browsertab.openUrl",u)))throw new k("invalid-cordova-configuration");n(h)}else{if("function"!=typeof(n=Rr("cordova.InAppBrowser.open",u)))throw new k("invalid-cordova-configuration");e=Or(),t.a=n(h,e.match(/(iPad|iPhone|iPod).*OS 7_\d/i)||e.match(/(iPad|iPhone|iPod).*OS 8_\d/i)?"_blank":"_system","location=yes")}}))}))}(i,t,e,n,r)})).then((function(){return new Ie((function(t,e){s=function(){var e=Rr("cordova.plugins.browsertab.close",u);return t(),"function"==typeof e&&e(),i.a&&"function"==typeof i.a.close&&(i.a.close(),i.a=null),!1},i.Ea(s),c=function(){a||(a=An(2e3).then((function(){e(new k("redirect-cancelled-by-user"))})))},l=function(){Gr()&&c()},o.addEventListener("resume",c,!1),Or().toLowerCase().match(/android/)||o.addEventListener("visibilitychange",l,!1)})).o((function(t){return Sc(i).then((function(){throw t}))}))})).oa((function(){c&&o.removeEventListener("resume",c,!1),l&&o.removeEventListener("visibilitychange",l,!1),a&&a.cancel(),s&&i.Sa(s),i.c=null}))},t.Ea=function(t){this.b.push(t),Ec(this).o((function(e){"auth/invalid-cordova-configuration"===e.code&&(e=new Bo("unknown",null,null,null,new k("no-auth-event")),t(e))}))},t.Sa=function(t){J(this.b,(function(e){return e==t}))};var kc={name:"pendingRedirect",F:"session"};function Ac(t){return ic(t.b,kc,t.a)}function Nc(t,e,n,r){this.i={},this.u=0,this.D=t,this.v=e,this.m=n,this.J=r,this.h=[],this.f=!1,this.l=I(this.s,this),this.b=new Wc,this.C=new Yc,this.g=new Cc(Bc(this.v,this.m)),this.c={},this.c.unknown=this.b,this.c.signInViaRedirect=this.b,this.c.linkViaRedirect=this.b,this.c.reauthViaRedirect=this.b,this.c.signInViaPopup=this.C,this.c.linkViaPopup=this.C,this.c.reauthViaPopup=this.C,this.a=Pc(this.D,this.v,this.m,N,this.J)}function Pc(t,e,n,i,o){var a=r.default.SDK_VERSION||null;return wr()?new wc(t,e,n,a,i,o):new du(t,e,n,a,i,o)}function Oc(t){t.f||(t.f=!0,t.a.Ea(t.l));var e=t.a;return t.a.ma().o((function(n){throw t.a==e&&t.reset(),n}))}function Rc(t){t.a.Xb()&&Oc(t).o((function(e){var n=new Bo("unknown",null,null,null,new k("operation-not-supported-in-this-environment"));Uc(e)&&t.s(n)})),t.a.Tb()||Gc(t.b)}function xc(t,e){Y(t.h,e)||t.h.push(e),t.f||function(t){return t.b.get(kc,t.a).then((function(t){return"pending"==t}))}(t.g).then((function(e){e?Ac(t.g).then((function(){Oc(t).o((function(e){var n=new Bo("unknown",null,null,null,new k("operation-not-supported-in-this-environment"));Uc(e)&&t.s(n)}))})):Rc(t)})).o((function(){Rc(t)}))}function Dc(t,e){J(t.h,(function(t){return t==e}))}Nc.prototype.reset=function(){this.f=!1,this.a.Sa(this.l),this.a=Pc(this.D,this.v,this.m,null,this.J),this.i={}},Nc.prototype.s=function(t){if(!t)throw new k("invalid-auth-event");if(6e5<=Date.now()-this.u&&(this.i={},this.u=0),t&&t.getUid()&&this.i.hasOwnProperty(t.getUid()))return!1;for(var e=!1,n=0;n<this.h.length;n++){var r=this.h[n];if(r.Fb(t.c,t.b)){(e=this.c[t.c])&&(e.h(t,r),t&&(t.f||t.b)&&(this.i[t.getUid()]=!0,this.u=Date.now())),e=!0;break}}return Gc(this.b),e};var Lc=new Wr(2e3,1e4),Mc=new Wr(3e4,6e4);function Fc(t,e,n,r,i,o,a){return t.a.Mb(e,n,r,(function(){t.f||(t.f=!0,t.a.Ea(t.l))}),(function(){t.reset()}),i,o,a)}function Uc(t){return!(!t||"auth/cordova-not-ready"!=t.code)}function jc(t,e,n,r,i){var o;return function(t){return t.b.set(kc,"pending",t.a)}(t.g).then((function(){return t.a.Nb(e,n,r,i).o((function(e){if(Uc(e))throw new k("operation-not-supported-in-this-environment");return o=e,Ac(t.g).then((function(){throw o}))})).then((function(){return t.a.$b()?new Ie((function(){})):Ac(t.g).then((function(){return t.qa()})).then((function(){})).o((function(){}))}))}))}function qc(t,e,n,r,i){return t.a.Ob(r,(function(t){e.na(n,null,t,i)}),Lc.get())}Nc.prototype.qa=function(){return this.b.qa()};var Vc={};function Bc(t,e,n){return t=t+":"+e,n&&(t=t+":"+n.url),t}function Kc(t,e,n,r){var i=Bc(e,n,r);return Vc[i]||(Vc[i]=new Nc(t,e,n,r)),Vc[i]}function Wc(){this.b=null,this.f=[],this.c=[],this.a=null,this.i=this.g=!1}function Gc(t){t.g||(t.g=!0,Qc(t,!1,null,null))}function Hc(t){t.g&&!t.i&&Qc(t,!1,null,null)}function zc(t,e){if(t.b=function(){return Ne(e)},t.f.length)for(var n=0;n<t.f.length;n++)t.f[n](e)}function Qc(t,e,n,r){e?r?function(t,e){if(t.b=function(){return Pe(e)},t.c.length)for(var n=0;n<t.c.length;n++)t.c[n](e)}(t,r):zc(t,n):zc(t,{user:null}),t.f=[],t.c=[]}function Yc(){}function Xc(){this.ib=!1,Object.defineProperty(this,"appVerificationDisabled",{get:function(){return this.ib},set:function(t){this.ib=t},enumerable:!1})}function Jc(t,e){this.a=e,$r(this,"verificationId",t)}function $c(t,e,n,r){return new Uo(t).fb(e,n).then((function(t){return new Jc(t,r)}))}function Zc(t){var e=Hi(t);if(!(e&&e.exp&&e.auth_time&&e.iat))throw new k("internal-error","An internal error occurred. The token obtained by Firebase appears to be malformed. Please retry the operation.");Zr(this,{token:t,expirationTime:Hr(1e3*e.exp),authTime:Hr(1e3*e.auth_time),issuedAtTime:Hr(1e3*e.iat),signInProvider:e.firebase&&e.firebase.sign_in_provider?e.firebase.sign_in_provider:null,signInSecondFactor:e.firebase&&e.firebase.sign_in_second_factor?e.firebase.sign_in_second_factor:null,claims:e})}function tl(t,e,n){var r=e&&e[nl];if(!r)throw new k("argument-error","Internal assert: Invalid MultiFactorResolver");this.a=t,this.f=gt(e),this.g=n,this.c=new so(null,r),this.b=[];var i=this;G(e[el]||[],(function(t){(t=ri(t))&&i.b.push(t)})),$r(this,"auth",this.a),$r(this,"session",this.c),$r(this,"hints",this.b)}Wc.prototype.reset=function(){this.b=null,this.a&&(this.a.cancel(),this.a=null)},Wc.prototype.h=function(t,e){if(t){this.reset(),this.g=!0;var n=t.c,r=t.b,i=t.a&&"auth/web-storage-unsupported"==t.a.code,o=t.a&&"auth/operation-not-supported-in-this-environment"==t.a.code;this.i=!(!i&&!o),"unknown"!=n||i||o?t.a?(Qc(this,!0,null,t.a),Ne()):e.Fa(n,r)?function(t,e,n){n=n.Fa(e.c,e.b);var r=e.g,i=e.f,o=e.i,a=e.T(),s=!!e.c.match(/Redirect$/);n(r,i,a,o).then((function(e){Qc(t,s,e,null)})).o((function(e){Qc(t,s,null,e)}))}(this,t,e):Pe(new k("invalid-auth-event")):(Qc(this,!1,null,null),Ne())}else Pe(new k("invalid-auth-event"))},Wc.prototype.qa=function(){var t=this;return new Ie((function(e,n){t.b?t.b().then(e,n):(t.f.push(e),t.c.push(n),function(t){var e=new k("timeout");t.a&&t.a.cancel(),t.a=An(Mc.get()).then((function(){t.b||(t.g=!0,Qc(t,!0,null,e))}))}(t))}))},Yc.prototype.h=function(t,e){if(t){var n=t.c,r=t.b;t.a?(e.na(t.c,null,t.a,t.b),Ne()):e.Fa(n,r)?function(t,e){var n=t.b,r=t.c;e.Fa(r,n)(t.g,t.f,t.T(),t.i).then((function(t){e.na(r,t,null,n)})).o((function(t){e.na(r,null,t,n)}))}(t,e):Pe(new k("invalid-auth-event"))}else Pe(new k("invalid-auth-event"))},Jc.prototype.confirm=function(t){return t=jo(this.verificationId,t),this.a(t)};var el="mfaInfo",nl="mfaPendingCredential";function rl(t,e,n,r){k.call(this,"multi-factor-auth-required",r,e),this.b=new tl(t,e,n),$r(this,"resolver",this.b)}function il(t,e,n){if(t&&g(t.serverResponse)&&"auth/multi-factor-auth-required"===t.code)try{return new rl(e,t.serverResponse,n,t.message)}catch(t){}return null}function ol(){}function al(t){$r(this,"factorId",t.fa),this.a=t}function sl(t){if(al.call(this,t),this.a.fa!=Uo.PROVIDER_ID)throw new k("argument-error","firebase.auth.PhoneMultiFactorAssertion requires a valid firebase.auth.PhoneAuthCredential")}function ul(t,e){for(var n in $e.call(this,t),e)this[n]=e[n]}function cl(t,e){this.a=t,this.b=[],this.c=I(this.yc,this),hn(this.a,"userReloaded",this.c);var n=[];e&&e.multiFactor&&e.multiFactor.enrolledFactors&&G(e.multiFactor.enrolledFactors,(function(t){var e=null,r={};if(t){t.uid&&(r[ai]=t.uid),t.displayName&&(r[ii]=t.displayName),t.enrollmentTime&&(r[oi]=new Date(t.enrollmentTime).toISOString()),t.phoneNumber&&(r[si]=t.phoneNumber);try{e=new ui(r)}catch(t){}t=e}else t=null;t&&n.push(t)})),ll(this,n)}function ll(t,e){t.b=e,$r(t,"enrolledFactors",e)}function hl(t,e,n){if(this.h=t,this.i=e,this.g=n,this.c=3e4,this.f=96e4,this.b=null,this.a=this.c,this.f<this.c)throw Error("Proactive refresh lower bound greater than upper bound!")}function fl(t,e){t.stop(),t.b=An(function(t,e){return e?(t.a=t.c,t.g()):(e=t.a,t.a*=2,t.a>t.f&&(t.a=t.f),e)}(t,e)).then((function(){return function(){var t=u.document,e=null;return Gr()||!t?Ne():new Ie((function(n){e=function(){Gr()&&(t.removeEventListener("visibilitychange",e,!1),n())},t.addEventListener("visibilitychange",e,!1)})).o((function(n){throw t.removeEventListener("visibilitychange",e,!1),n}))}()})).then((function(){return t.h()})).then((function(){fl(t,!0)})).o((function(e){t.i(e)&&fl(t,!1)}))}function pl(t){this.f=t,this.b=this.a=null,this.c=Date.now()}function dl(t,e){void 0===e&&(e=t.b?(e=t.b).a-e.g:0),t.c=Date.now()+1e3*e}function vl(t,e){t.b=Gi(e[Za]||""),t.a=e.refreshToken,dl(t,void 0!==(e=e.expiresIn)?Number(e):void 0)}function gl(t,e){this.a=t||null,this.b=e||null,Zr(this,{lastSignInTime:Hr(e||null),creationTime:Hr(t||null)})}function yl(t,e,n,r,i,o){Zr(this,{uid:t,displayName:r||null,photoURL:i||null,email:n||null,phoneNumber:o||null,providerId:e})}function ml(t,e,n){this.J=[],this.l=t.apiKey,this.m=t.appName,this.s=t.authDomain||null;var i=r.default.SDK_VERSION?Pr(r.default.SDK_VERSION):null;this.a=new Ja(this.l,x(N),i),t.emulatorConfig&&os(this.a,t.emulatorConfig),this.b=new pl(this.a),Cl(this,e[Za]),vl(this.b,e),$r(this,"refreshToken",this.b.a),Nl(this,n||{}),Tn.call(this),this.R=!1,this.s&&Dr()&&(this.i=Kc(this.s,this.l,this.m)),this.S=[],this.h=null,this.u=function(t){return new hl((function(){return t.I(!0)}),(function(t){return!(!t||"auth/network-request-failed"!=t.code)}),(function(){var e=t.b.c-Date.now()-3e5;return 0<e?e:0}))}(this),this.aa=I(this.hb,this);var o=this;this.ya=null,this.Oa=function(t){o.wa(t.h)},this.ja=null,this.Aa=function(t){os(o.a,t.c)},this.X=null,this.$=[],this.Ba=function(t){wl(o,t.f)},this.ba=null,this.O=new cl(this,n),$r(this,"multiFactor",this.O)}function bl(t,e){t.ja&&dn(t.ja,"languageCodeChanged",t.Oa),(t.ja=e)&&hn(e,"languageCodeChanged",t.Oa)}function _l(t,e){t.X&&dn(t.X,"emulatorConfigChanged",t.Aa),(t.X=e)&&hn(e,"emulatorConfigChanged",t.Aa)}function wl(t,e){t.$=e,ss(t.a,r.default.SDK_VERSION?Pr(r.default.SDK_VERSION,t.$):null)}function Il(t,e){t.ba&&dn(t.ba,"frameworkChanged",t.Ba),(t.ba=e)&&hn(e,"frameworkChanged",t.Ba)}function Tl(t){try{return r.default.app(t.m).auth()}catch(e){throw new k("internal-error","No firebase.auth.Auth instance is available for the Firebase App '"+t.m+"'!")}}function El(t){t.D||t.u.b||(t.u.start(),dn(t,"tokenChanged",t.aa),hn(t,"tokenChanged",t.aa))}function Sl(t){dn(t,"tokenChanged",t.aa),t.u.stop()}function Cl(t,e){t.za=e,$r(t,"_lat",e)}function kl(t){for(var e=[],n=0;n<t.S.length;n++)e.push(t.S[n](t));return Re(e).then((function(){return t}))}function Al(t){t.i&&!t.R&&(t.R=!0,xc(t.i,t))}function Nl(t,e){Zr(t,{uid:e.uid,displayName:e.displayName||null,photoURL:e.photoURL||null,email:e.email||null,emailVerified:e.emailVerified||!1,phoneNumber:e.phoneNumber||null,isAnonymous:e.isAnonymous||!1,tenantId:e.tenantId||null,metadata:new gl(e.createdAt,e.lastLoginAt),providerData:[]}),t.a.b=t.tenantId}function Pl(){}function Ol(t){return Ne().then((function(){if(t.D)throw new k("app-deleted")}))}function Rl(t){return z(t.providerData,(function(t){return t.providerId}))}function xl(t,e){e&&(Dl(t,e.providerId),t.providerData.push(e))}function Dl(t,e){J(t.providerData,(function(t){return t.providerId==e}))}function Ll(t,e,n){("uid"!=e||n)&&t.hasOwnProperty(e)&&$r(t,e,n)}function Ml(t,e){t!=e&&(Zr(t,{uid:e.uid,displayName:e.displayName,photoURL:e.photoURL,email:e.email,emailVerified:e.emailVerified,phoneNumber:e.phoneNumber,isAnonymous:e.isAnonymous,tenantId:e.tenantId,providerData:[]}),e.metadata?$r(t,"metadata",function(t){return new gl(t.a,t.b)}(e.metadata)):$r(t,"metadata",new gl),G(e.providerData,(function(e){xl(t,e)})),function(t,e){t.b=e.b,t.a=e.a,t.c=e.c}(t.b,e.b),$r(t,"refreshToken",t.b.a),ll(t.O,e.O.b))}function Fl(t){return t.I().then((function(e){var n=t.isAnonymous;return function(t,e){return ru(t.a,Ds,{idToken:e}).then(I(t.Kc,t))}(t,e).then((function(){return n||Ll(t,"isAnonymous",!1),e}))}))}function Ul(t,e){e[Za]&&t.za!=e[Za]&&(vl(t.b,e),t.dispatchEvent(new ul("tokenChanged")),Cl(t,e[Za]),Ll(t,"refreshToken",t.b.a))}function jl(t,e){return Fl(t).then((function(){if(Y(Rl(t),e))return kl(t).then((function(){throw new k("provider-already-linked")}))}))}function ql(t,e,n){return ti({user:t,credential:qo(e),additionalUserInfo:e=Ji(e),operationType:n})}function Vl(t,e){return Ul(t,e),t.reload().then((function(){return t}))}function Bl(t,e,n,i,o){if(!Dr())return Pe(new k("operation-not-supported-in-this-environment"));if(t.h&&!o)return Pe(t.h);var a=Xi(n.providerId),s=Vr(t.uid+":::"),u=null;(!Fr()||Ir())&&t.s&&n.isOAuthProvider&&(u=mu(t.s,t.l,t.m,e,n,null,s,r.default.SDK_VERSION||null,null,null,t.tenantId));var c=yr(u,a&&a.ua,a&&a.ta);return i=i().then((function(){if(Wl(t),!o)return t.I().then((function(){}))})).then((function(){return Fc(t.i,c,e,n,s,!!u,t.tenantId)})).then((function(){return new Ie((function(n,r){t.na(e,null,new k("cancelled-popup-request"),t.g||null),t.f=n,t.C=r,t.g=s,t.c=qc(t.i,t,e,c,s)}))})).then((function(t){return c&&gr(c),t?ti(t):null})).o((function(t){throw c&&gr(c),t})),Gl(t,i,o)}function Kl(t,e,n,r,i){if(!Dr())return Pe(new k("operation-not-supported-in-this-environment"));if(t.h&&!i)return Pe(t.h);var o=null,a=Vr(t.uid+":::");return r=r().then((function(){if(Wl(t),!i)return t.I().then((function(){}))})).then((function(){return t.ga=a,kl(t)})).then((function(e){return t.ha&&(e=(e=t.ha).b.set(Ql,t.w(),e.a)),e})).then((function(){return jc(t.i,e,n,a,t.tenantId)})).o((function(e){if(o=e,t.ha)return Yl(t.ha);throw o})).then((function(){if(o)throw o})),Gl(t,r,i)}function Wl(t){if(!t.i||!t.R){if(t.i&&!t.R)throw new k("internal-error");throw new k("auth-domain-config-required")}}function Gl(t,e,n){var r=function(t,e,n){return t.h&&!n?(e.cancel(),Pe(t.h)):e.o((function(e){throw!e||"auth/user-disabled"!=e.code&&"auth/user-token-expired"!=e.code||(t.h||t.dispatchEvent(new ul("userInvalidated")),t.h=e),e}))}(t,e,n);return t.J.push(r),r.oa((function(){X(t.J,r)})),r.o((function(e){var n=null;throw e&&"auth/multi-factor-auth-required"===e.code&&(n=il(e.w(),Tl(t),I(t.jc,t))),n||e}))}function Hl(t){if(!t.apiKey)return null;var e={apiKey:t.apiKey,authDomain:t.authDomain,appName:t.appName,emulatorConfig:t.emulatorConfig},n={};if(!t.stsTokenManager||!t.stsTokenManager.accessToken)return null;n[Za]=t.stsTokenManager.accessToken,n.refreshToken=t.stsTokenManager.refreshToken||null;var r=t.stsTokenManager.expirationTime;r&&(n.expiresIn=(r-Date.now())/1e3);var i=new ml(e,n,t);return t.providerData&&G(t.providerData,(function(t){t&&xl(i,ti(t))})),t.redirectEventId&&(i.ga=t.redirectEventId),i}function zl(t){this.a=t,this.b=ec()}tl.prototype.Rc=function(t){var e=this;return t.sb(this.a.a,this.c).then((function(t){var n=gt(e.f);return delete n[el],delete n[nl],mt(n,t),e.g(n)}))},S(rl,k),ol.prototype.sb=function(t,e,n){return e.type==uo?function(t,e,n,r){return n.Ha().then((function(n){return n={idToken:n},void 0!==r&&(n.displayName=r),mt(n,{phoneVerificationInfo:Fo(t.a)}),ru(e,Rs,n)}))}(this,t,e,n):function(t,e,n){return n.Ha().then((function(n){return mt(n={mfaPendingCredential:n},{phoneVerificationInfo:Fo(t.a)}),ru(e,xs,n)}))}(this,t,e)},S(al,ol),S(sl,al),S(ul,$e),(t=cl.prototype).yc=function(t){ll(this,function(t){var e=[];return G(t.mfaInfo||[],(function(t){(t=ri(t))&&e.push(t)})),e}(t.hd))},t.Rb=function(){return this.a.I().then((function(t){return new so(t,null)}))},t.fc=function(t,e){var n=this,r=this.a.a;return this.Rb().then((function(n){return t.sb(r,n,e)})).then((function(t){return Ul(n.a,t),n.a.reload()}))},t.bd=function(t){var e=this,n="string"==typeof t?t:t.uid,r=this.a.a;return this.a.I().then((function(t){return ru(r,nu,{idToken:t,mfaEnrollmentId:n})})).then((function(t){var r=H(e.b,(function(t){return t.uid!=n}));return ll(e,r),Ul(e.a,t),e.a.reload().o((function(t){if("auth/user-token-expired"!=t.code)throw t}))}))},t.w=function(){return{multiFactor:{enrolledFactors:z(this.b,(function(t){return t.w()}))}}},hl.prototype.start=function(){this.a=this.c,fl(this,!0)},hl.prototype.stop=function(){this.b&&(this.b.cancel(),this.b=null)},pl.prototype.w=function(){return{apiKey:this.f.c,refreshToken:this.a,accessToken:this.b&&this.b.toString(),expirationTime:this.c}},pl.prototype.getToken=function(t){return t=!!t,this.b&&!this.a?Pe(new k("user-token-expired")):t||!this.b||Date.now()>this.c-3e4?this.a?function(t,e){return function(t,e){return new Ie((function(n,r){"refresh_token"==e.grant_type&&e.refresh_token||"authorization_code"==e.grant_type&&e.code?us(t,t.l+"?key="+encodeURIComponent(t.c),(function(t){t?t.error?r(ou(t)):t.access_token&&t.refresh_token?n(t):r(new k("internal-error")):r(new k("network-request-failed"))}),"POST",Zn(e).toString(),t.g,t.m.get()):r(new k("internal-error"))}))}(t.f,e).then((function(e){return t.b=Gi(e.access_token),t.a=e.refresh_token,dl(t,e.expires_in),{accessToken:t.b.toString(),refreshToken:t.a}})).o((function(e){throw"auth/user-token-expired"==e.code&&(t.a=null),e}))}(this,{grant_type:"refresh_token",refresh_token:this.a}):Ne(null):Ne({accessToken:this.b.toString(),refreshToken:this.a})},gl.prototype.w=function(){return{lastLoginAt:this.b,createdAt:this.a}},S(ml,Tn),ml.prototype.wa=function(t){this.ya=t,is(this.a,t)},ml.prototype.la=function(){return this.ya},ml.prototype.Ga=function(){return Z(this.$)},ml.prototype.hb=function(){this.u.b&&(this.u.stop(),this.u.start())},$r(ml.prototype,"providerId","firebase"),(t=ml.prototype).reload=function(){var t=this;return Gl(this,Ol(this).then((function(){return Fl(t).then((function(){return kl(t)})).then(Pl)})))},t.oc=function(t){return this.I(t).then((function(t){return new Zc(t)}))},t.I=function(t){var e=this;return Gl(this,Ol(this).then((function(){return e.b.getToken(t)})).then((function(t){if(!t)throw new k("internal-error");return t.accessToken!=e.za&&(Cl(e,t.accessToken),e.dispatchEvent(new ul("tokenChanged"))),Ll(e,"refreshToken",t.refreshToken),t.accessToken})))},t.Kc=function(t){if(!(t=t.users)||!t.length)throw new k("internal-error");Nl(this,{uid:(t=t[0]).localId,displayName:t.displayName,photoURL:t.photoUrl,email:t.email,emailVerified:!!t.emailVerified,phoneNumber:t.phoneNumber,lastLoginAt:t.lastLoginAt,createdAt:t.createdAt,tenantId:t.tenantId});for(var e=function(t){return(t=t.providerUserInfo)&&t.length?z(t,(function(t){return new yl(t.rawId,t.providerId,t.email,t.displayName,t.photoUrl,t.phoneNumber)})):[]}(t),n=0;n<e.length;n++)xl(this,e[n]);Ll(this,"isAnonymous",!(this.email&&t.passwordHash||this.providerData&&this.providerData.length)),this.dispatchEvent(new ul("userReloaded",{hd:t}))},t.Lc=function(t){return Xr("firebase.User.prototype.reauthenticateAndRetrieveDataWithCredential is deprecated. Please use firebase.User.prototype.reauthenticateWithCredential instead."),this.tb(t)},t.tb=function(t){var e=this,n=null;return Gl(this,t.c(this.a,this.uid).then((function(t){return Ul(e,t),n=ql(e,t,"reauthenticate"),e.h=null,e.reload()})).then((function(){return n})),!0)},t.Cc=function(t){return Xr("firebase.User.prototype.linkAndRetrieveDataWithCredential is deprecated. Please use firebase.User.prototype.linkWithCredential instead."),this.qb(t)},t.qb=function(t){var e=this,n=null;return Gl(this,jl(this,t.providerId).then((function(){return e.I()})).then((function(n){return t.b(e.a,n)})).then((function(t){return n=ql(e,t,"link"),Vl(e,t)})).then((function(){return n})))},t.Dc=function(t,e){var n=this;return Gl(this,jl(this,"phone").then((function(){return $c(Tl(n),t,e,I(n.qb,n))})))},t.Mc=function(t,e){var n=this;return Gl(this,Ne().then((function(){return $c(Tl(n),t,e,I(n.tb,n))})),!0)},t.Bb=function(t){var e=this;return Gl(this,this.I().then((function(n){return e.a.Bb(n,t)})).then((function(t){return Ul(e,t),e.reload()})))},t.ed=function(t){var e=this;return Gl(this,this.I().then((function(n){return t.b(e.a,n)})).then((function(t){return Ul(e,t),e.reload()})))},t.Cb=function(t){var e=this;return Gl(this,this.I().then((function(n){return e.a.Cb(n,t)})).then((function(t){return Ul(e,t),e.reload()})))},t.Db=function(t){if(void 0===t.displayName&&void 0===t.photoURL)return Ol(this);var e=this;return Gl(this,this.I().then((function(n){return e.a.Db(n,{displayName:t.displayName,photoUrl:t.photoURL})})).then((function(t){return Ul(e,t),Ll(e,"displayName",t.displayName||null),Ll(e,"photoURL",t.photoUrl||null),G(e.providerData,(function(t){"password"===t.providerId&&($r(t,"displayName",e.displayName),$r(t,"photoURL",e.photoURL))})),kl(e)})).then(Pl))},t.cd=function(t){var e=this;return Gl(this,Fl(this).then((function(n){return Y(Rl(e),t)?function(t,e,n){return ru(t,Ns,{idToken:e,deleteProvider:n})}(e.a,n,[t]).then((function(t){var n={};return G(t.providerUserInfo||[],(function(t){n[t.providerId]=!0})),G(Rl(e),(function(t){n[t]||Dl(e,t)})),n[Uo.PROVIDER_ID]||$r(e,"phoneNumber",null),kl(e)})):kl(e).then((function(){throw new k("no-such-provider")}))})))},t.delete=function(){var t=this;return Gl(this,this.I().then((function(e){return ru(t.a,As,{idToken:e})})).then((function(){t.dispatchEvent(new ul("userDeleted"))}))).then((function(){for(var e=0;e<t.J.length;e++)t.J[e].cancel("app-deleted");bl(t,null),_l(t,null),Il(t,null),t.J=[],t.D=!0,Sl(t),$r(t,"refreshToken",null),t.i&&Dc(t.i,t)}))},t.Fb=function(t,e){return!!("linkViaPopup"==t&&(this.g||null)==e&&this.f||"reauthViaPopup"==t&&(this.g||null)==e&&this.f||"linkViaRedirect"==t&&(this.ga||null)==e||"reauthViaRedirect"==t&&(this.ga||null)==e)},t.na=function(t,e,n,r){"linkViaPopup"!=t&&"reauthViaPopup"!=t||r!=(this.g||null)||(n&&this.C?this.C(n):e&&!n&&this.f&&this.f(e),this.c&&(this.c.cancel(),this.c=null),delete this.f,delete this.C)},t.Fa=function(t,e){return"linkViaPopup"==t&&e==(this.g||null)?I(this.Kb,this):"reauthViaPopup"==t&&e==(this.g||null)?I(this.Lb,this):"linkViaRedirect"==t&&(this.ga||null)==e?I(this.Kb,this):"reauthViaRedirect"==t&&(this.ga||null)==e?I(this.Lb,this):null},t.Ec=function(t){var e=this;return Bl(this,"linkViaPopup",t,(function(){return jl(e,t.providerId).then((function(){return kl(e)}))}),!1)},t.Nc=function(t){return Bl(this,"reauthViaPopup",t,(function(){return Ne()}),!0)},t.Fc=function(t){var e=this;return Kl(this,"linkViaRedirect",t,(function(){return jl(e,t.providerId)}),!1)},t.Oc=function(t){return Kl(this,"reauthViaRedirect",t,(function(){return Ne()}),!0)},t.Kb=function(t,e,n,r){var i=this;this.c&&(this.c.cancel(),this.c=null);var o=null;return Gl(this,this.I().then((function(n){return ws(i.a,{requestUri:t,postBody:r,sessionId:e,idToken:n})})).then((function(t){return o=ql(i,t,"link"),Vl(i,t)})).then((function(){return o})))},t.Lb=function(t,e,n,r){var i=this;this.c&&(this.c.cancel(),this.c=null);var o=null;return Gl(this,Ne().then((function(){return ho(Is(i.a,{requestUri:t,sessionId:e,postBody:r,tenantId:n}),i.uid)})).then((function(t){return o=ql(i,t,"reauthenticate"),Ul(i,t),i.h=null,i.reload()})).then((function(){return o})),!0)},t.ub=function(t){var e=this,n=null;return Gl(this,this.I().then((function(e){return n=e,void 0===t||vt(t)?{}:Bi(new Ri(t))})).then((function(t){return e.a.ub(n,t)})).then((function(t){if(e.email!=t)return e.reload()})).then((function(){})))},t.Eb=function(t,e){var n=this,r=null;return Gl(this,this.I().then((function(t){return r=t,void 0===e||vt(e)?{}:Bi(new Ri(e))})).then((function(e){return n.a.Eb(r,t,e)})).then((function(t){if(n.email!=t)return n.reload()})).then((function(){})))},t.jc=function(t){var e=null,n=this;return Gl(this,t=ho(Ne(t),n.uid).then((function(t){return e=ql(n,t,"reauthenticate"),Ul(n,t),n.h=null,n.reload()})).then((function(){return e})),!0)},t.toJSON=function(){return this.w()},t.w=function(){var t={uid:this.uid,displayName:this.displayName,photoURL:this.photoURL,email:this.email,emailVerified:this.emailVerified,phoneNumber:this.phoneNumber,isAnonymous:this.isAnonymous,tenantId:this.tenantId,providerData:[],apiKey:this.l,appName:this.m,authDomain:this.s,stsTokenManager:this.b.w(),redirectEventId:this.ga||null};return this.metadata&&mt(t,this.metadata.w()),G(this.providerData,(function(e){t.providerData.push(function(t){var e,n={};for(e in t)t.hasOwnProperty(e)&&(n[e]=t[e]);return n}(e))})),mt(t,this.O.w()),t};var Ql={name:"redirectUser",F:"session"};function Yl(t){return ic(t.b,Ql,t.a)}function Xl(t){this.a=t,this.b=ec(),this.c=null,this.f=function(t){var e=Zl("local"),n=Zl("session"),r=Zl("none");return function(t,e,n){var r=rc(e,n),i=nc(t,e.F);return t.get(e,n).then((function(o){var a=null;try{a=qr(u.localStorage.getItem(r))}catch(t){}if(a&&!o)return u.localStorage.removeItem(r),t.set(e,a,n);a&&o&&"localStorage"!=i.type&&u.localStorage.removeItem(r)}))}(t.b,e,t.a).then((function(){return t.b.get(n,t.a)})).then((function(i){return i?n:t.b.get(r,t.a).then((function(n){return n?r:t.b.get(e,t.a).then((function(n){return n?e:t.b.get($l,t.a).then((function(t){return t?Zl(t):e}))}))}))})).then((function(e){return t.c=e,Jl(t,e.F)})).o((function(){t.c||(t.c=e)}))}(this),this.b.addListener(Zl("local"),this.a,I(this.g,this))}function Jl(t,e){var n,r=[];for(n in Zu)Zu[n]!==e&&r.push(ic(t.b,Zl(Zu[n]),t.a));return r.push(ic(t.b,$l,t.a)),function(t){return new Ie((function(e,n){var r=t.length,i=[];if(r)for(var o=function(t,n){r--,i[t]=n,0==r&&e(i)},a=function(t){n(t)},s=0;s<t.length;s++)Oe(t[s],T(o,s),a);else e(i)}))}(r)}Xl.prototype.g=function(){var t=this,e=Zl("local");rh(this,(function(){return Ne().then((function(){return t.c&&"local"!=t.c.F?t.b.get(e,t.a):null})).then((function(n){if(n)return Jl(t,"local").then((function(){t.c=e}))}))}))};var $l={name:"persistence",F:"session"};function Zl(t){return{name:"authUser",F:t}}function th(t,e){return rh(t,(function(){return t.b.set(t.c,e.w(),t.a)}))}function eh(t){return rh(t,(function(){return ic(t.b,t.c,t.a)}))}function nh(t,e,n){return rh(t,(function(){return t.b.get(t.c,t.a).then((function(t){return t&&e&&(t.authDomain=e),t&&n&&(t.emulatorConfig=n),Hl(t||{})}))}))}function rh(t,e){return t.f=t.f.then(e,e),t.f}function ih(t){if(this.l=!1,$r(this,"settings",new Xc),$r(this,"app",t),!fh(this).options||!fh(this).options.apiKey)throw new k("invalid-api-key");t=r.default.SDK_VERSION?Pr(r.default.SDK_VERSION):null,this.a=new Ja(fh(this).options&&fh(this).options.apiKey,x(N),t),this.R=[],this.s=[],this.O=[],this.hb=r.default.INTERNAL.createSubscribe(I(this.zc,this)),this.X=void 0,this.bc=r.default.INTERNAL.createSubscribe(I(this.Ac,this)),lh(this,null),this.i=new Xl(fh(this).options.apiKey+":"+fh(this).name),this.D=new zl(fh(this).options.apiKey+":"+fh(this).name),this.$=gh(this,function(t){var e=fh(t).options.authDomain,n=function(t){var e=function(t,e){return t.b.get(Ql,t.a).then((function(t){return t&&e&&(t.authDomain=e),Hl(t||{})}))}(t.D,fh(t).options.authDomain).then((function(e){return(t.m=e)&&(e.ha=t.D),Yl(t.D)}));return gh(t,e)}(t).then((function(){return nh(t.i,e,t.P)})).then((function(e){return e?(e.ha=t.D,t.m&&(t.m.ga||null)==(e.ga||null)?e:e.reload().then((function(){return th(t.i,e).then((function(){return e}))})).o((function(n){return"auth/network-request-failed"==n.code?e:eh(t.i)}))):null})).then((function(e){lh(t,e||null)}));return gh(t,n)}(this)),this.h=gh(this,function(t){return t.$.then((function(){return ch(t)})).o((function(){})).then((function(){if(!t.l)return t.ja()})).o((function(){})).then((function(){if(!t.l){t.ba=!0;var e=t.i;e.b.addListener(Zl("local"),e.a,t.ja)}}))}(this)),this.ba=!1,this.ja=I(this.Zc,this),this.Ba=I(this.da,this),this.ya=I(this.mc,this),this.za=I(this.wc,this),this.Aa=I(this.xc,this),this.b=null,function(t){var e=fh(t).options.authDomain,n=fh(t).options.apiKey;e&&Dr()&&(t.Oa=t.$.then((function(){if(!t.l){if(t.b=Kc(e,n,fh(t).name,t.P),xc(t.b,t),ph(t)&&Al(ph(t)),t.m){Al(t.m);var r=t.m;r.wa(t.la()),bl(r,t),wl(r=t.m,t.J),Il(r,t),os((r=t.m).a,t.P),_l(r,t),t.m=null}return t.b}})))}(this),this.INTERNAL={},this.INTERNAL.delete=I(this.delete,this),this.INTERNAL.logFramework=I(this.Gc,this),this.u=0,Tn.call(this),function(t){Object.defineProperty(t,"lc",{get:function(){return this.la()},set:function(t){this.wa(t)},enumerable:!1}),t.aa=null,Object.defineProperty(t,"ti",{get:function(){return this.T()},set:function(t){this.yb(t)},enumerable:!1}),t.S=null,Object.defineProperty(t,"emulatorConfig",{get:function(){if(this.P){var t=Vn(this.P.url);t=ti({protocol:t.c,host:t.a,port:t.g,options:ti({disableWarnings:this.P.ec})})}else t=null;return t},enumerable:!1})}(this),this.J=[],this.P=null}function oh(t){$e.call(this,"languageCodeChanged"),this.h=t}function ah(t){$e.call(this,"emulatorConfigChanged"),this.c=t}function sh(t){$e.call(this,"frameworkChanged"),this.f=t}function uh(t){return t.Oa||Pe(new k("auth-domain-config-required"))}function ch(t){if(!Dr())return Pe(new k("operation-not-supported-in-this-environment"));var e=uh(t).then((function(){return t.b.qa()})).then((function(t){return t?ti(t):null}));return gh(t,e)}function lh(t,e){ph(t)&&(function(t,e){J(t.S,(function(t){return t==e}))}(ph(t),t.Ba),dn(ph(t),"tokenChanged",t.ya),dn(ph(t),"userDeleted",t.za),dn(ph(t),"userInvalidated",t.Aa),Sl(ph(t))),e&&(e.S.push(t.Ba),hn(e,"tokenChanged",t.ya),hn(e,"userDeleted",t.za),hn(e,"userInvalidated",t.Aa),0<t.u&&El(e)),$r(t,"currentUser",e),e&&(e.wa(t.la()),bl(e,t),wl(e,t.J),Il(e,t),os(e.a,t.P),_l(e,t))}function hh(t,e){var n=null,r=null;return gh(t,e.then((function(e){return n=qo(e),r=Ji(e),function(t,e){var n={};return n.apiKey=fh(t).options.apiKey,n.authDomain=fh(t).options.authDomain,n.appName=fh(t).name,t.P&&(n.emulatorConfig=t.P),t.$.then((function(){return function(t,e,n,r){var i=new ml(t,e);return n&&(i.ha=n),r&&wl(i,r),i.reload().then((function(){return i}))}(n,e,t.D,t.Ga())})).then((function(e){return ph(t)&&e.uid==ph(t).uid?(Ml(ph(t),e),t.da(e)):(lh(t,e),Al(e),t.da(e))})).then((function(){vh(t)}))}(t,e)}),(function(e){var n=null;throw e&&"auth/multi-factor-auth-required"===e.code&&(n=il(e.w(),t,I(t.kc,t))),n||e})).then((function(){return ti({user:ph(t),credential:n,additionalUserInfo:r,operationType:"signIn"})})))}function fh(t){return t.app}function ph(t){return t.currentUser}function dh(t){return ph(t)&&ph(t)._lat||null}function vh(t){if(t.ba){for(var e=0;e<t.s.length;e++)t.s[e]&&t.s[e](dh(t));if(t.X!==t.getUid()&&t.O.length)for(t.X=t.getUid(),e=0;e<t.O.length;e++)t.O[e]&&t.O[e](dh(t))}}function gh(t,e){return t.R.push(e),e.oa((function(){X(t.R,e)})),e}function yh(){}function mh(){this.a={},this.b=1e12}Xl.prototype.xb=function(t){var e=null,n=this;return function(t){var e=new k("invalid-persistence-type"),n=new k("unsupported-persistence-type");t:{for(r in Zu)if(Zu[r]==t){var r=!0;break t}r=!1}if(!r||"string"!=typeof t)throw e;switch(Er()){case"ReactNative":if("session"===t)throw n;break;case"Node":if("none"!==t)throw n;break;case"Worker":if("session"===t||!Ru()&&"none"!==t)throw n;break;default:if(!xr()&&"none"!==t)throw n}}(t),rh(this,(function(){return t!=n.c.F?n.b.get(n.c,n.a).then((function(r){return e=r,Jl(n,t)})).then((function(){if(n.c=Zl(t),e)return n.b.set(n.c,e,n.a)})):Ne()}))},S(ih,Tn),S(oh,$e),S(ah,$e),S(sh,$e),(t=ih.prototype).xb=function(t){return gh(this,t=this.i.xb(t))},t.wa=function(t){this.aa===t||this.l||(this.aa=t,is(this.a,this.aa),this.dispatchEvent(new oh(this.la())))},t.la=function(){return this.aa},t.fd=function(){var t=u.navigator;this.wa(t&&(t.languages&&t.languages[0]||t.language||t.userLanguage)||null)},t.gd=function(t,e){if(!this.P){if(!/^https?:\/\//.test(t))throw new k("argument-error","Emulator URL must start with a valid scheme (http:// or https://).");(function(t){"undefined"!=typeof console&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),u.document&&!t&&_r().then((function(){var t=u.document.createElement("div");t.innerText="Running in emulator mode. Do not use with production credentials.",t.style.position="fixed",t.style.width="100%",t.style.backgroundColor="#ffffff",t.style.border=".1em solid #000000",t.style.color="#b50000",t.style.bottom="0px",t.style.left="0px",t.style.margin="0px",t.style.zIndex=1e4,t.style.textAlign="center",t.classList.add("firebase-emulator-warning"),u.document.body.appendChild(t)}))})(e=!!e&&!!e.disableWarnings),this.P={url:t,ec:e},this.settings.ib=!0,os(this.a,this.P),this.dispatchEvent(new ah(this.P))}},t.Gc=function(t){this.J.push(t),ss(this.a,r.default.SDK_VERSION?Pr(r.default.SDK_VERSION,this.J):null),this.dispatchEvent(new sh(this.J))},t.Ga=function(){return Z(this.J)},t.yb=function(t){this.S===t||this.l||(this.S=t,this.a.b=this.S)},t.T=function(){return this.S},t.toJSON=function(){return{apiKey:fh(this).options.apiKey,authDomain:fh(this).options.authDomain,appName:fh(this).name,currentUser:ph(this)&&ph(this).w()}},t.Fb=function(t,e){switch(t){case"unknown":case"signInViaRedirect":return!0;case"signInViaPopup":return this.g==e&&!!this.f;default:return!1}},t.na=function(t,e,n,r){"signInViaPopup"==t&&this.g==r&&(n&&this.C?this.C(n):e&&!n&&this.f&&this.f(e),this.c&&(this.c.cancel(),this.c=null),delete this.f,delete this.C)},t.Fa=function(t,e){return"signInViaRedirect"==t||"signInViaPopup"==t&&this.g==e&&this.f?I(this.ic,this):null},t.ic=function(t,e,n,r){var i=this,o={requestUri:t,postBody:r,sessionId:e,tenantId:n};return this.c&&(this.c.cancel(),this.c=null),i.$.then((function(){return hh(i,_s(i.a,o))}))},t.Xc=function(t){if(!Dr())return Pe(new k("operation-not-supported-in-this-environment"));var e=this,n=Xi(t.providerId),i=Vr(),o=null;(!Fr()||Ir())&&fh(this).options.authDomain&&t.isOAuthProvider&&(o=mu(fh(this).options.authDomain,fh(this).options.apiKey,fh(this).name,"signInViaPopup",t,null,i,r.default.SDK_VERSION||null,null,null,this.T(),this.P));var a=yr(o,n&&n.ua,n&&n.ta);return gh(this,n=uh(this).then((function(n){return Fc(n,a,"signInViaPopup",t,i,!!o,e.T())})).then((function(){return new Ie((function(t,n){e.na("signInViaPopup",null,new k("cancelled-popup-request"),e.g),e.f=t,e.C=n,e.g=i,e.c=qc(e.b,e,"signInViaPopup",a,i)}))})).then((function(t){return a&&gr(a),t?ti(t):null})).o((function(t){throw a&&gr(a),t})))},t.Yc=function(t){if(!Dr())return Pe(new k("operation-not-supported-in-this-environment"));var e=this;return gh(this,uh(this).then((function(){return function(t){return rh(t,(function(){return t.b.set($l,t.c.F,t.a)}))}(e.i)})).then((function(){return jc(e.b,"signInViaRedirect",t,void 0,e.T())})))},t.qa=function(){var t=this;return ch(this).then((function(e){return t.b&&Hc(t.b.b),e})).o((function(e){throw t.b&&Hc(t.b.b),e}))},t.dd=function(t){if(!t)return Pe(new k("null-user"));if(this.S!=t.tenantId)return Pe(new k("tenant-id-mismatch"));var e=this,n={};n.apiKey=fh(this).options.apiKey,n.authDomain=fh(this).options.authDomain,n.appName=fh(this).name;var r=function(t,e,n,r){var i=t.b,o={};return o[Za]=i.b&&i.b.toString(),o.refreshToken=i.a,e=new ml(e||{apiKey:t.l,authDomain:t.s,appName:t.m},o),n&&(e.ha=n),r&&wl(e,r),Ml(e,t),e}(t,n,e.D,e.Ga());return gh(this,this.h.then((function(){if(fh(e).options.apiKey!=t.l)return r.reload()})).then((function(){return ph(e)&&t.uid==ph(e).uid?(Ml(ph(e),t),e.da(t)):(lh(e,r),Al(r),e.da(r))})).then((function(){vh(e)})))},t.Ab=function(){var t=this;return gh(this,this.h.then((function(){return t.b&&Hc(t.b.b),ph(t)?(lh(t,null),eh(t.i).then((function(){vh(t)}))):Ne()})))},t.Zc=function(){var t=this;return nh(this.i,fh(this).options.authDomain).then((function(e){if(!t.l){var n;if(n=ph(t)&&e){n=ph(t).uid;var r=e.uid;n=null!=n&&""!==n&&null!=r&&""!==r&&n==r}if(n)return Ml(ph(t),e),ph(t).I();(ph(t)||e)&&(lh(t,e),e&&(Al(e),e.ha=t.D),t.b&&xc(t.b,t),vh(t))}}))},t.da=function(t){return th(this.i,t)},t.mc=function(){vh(this),this.da(ph(this))},t.wc=function(){this.Ab()},t.xc=function(){this.Ab()},t.kc=function(t){var e=this;return this.h.then((function(){return hh(e,Ne(t))}))},t.zc=function(t){var e=this;this.addAuthTokenListener((function(){t.next(ph(e))}))},t.Ac=function(t){var e=this;!function(t,e){t.O.push(e),gh(t,t.h.then((function(){!t.l&&Y(t.O,e)&&t.X!==t.getUid()&&(t.X=t.getUid(),e(dh(t)))})))}(this,(function(){t.next(ph(e))}))},t.Ic=function(t,e,n){var r=this;return this.ba&&Promise.resolve().then((function(){"function"==typeof t?t(ph(r)):"function"==typeof t.next&&t.next(ph(r))})),this.hb(t,e,n)},t.Hc=function(t,e,n){var r=this;return this.ba&&Promise.resolve().then((function(){r.X=r.getUid(),"function"==typeof t?t(ph(r)):"function"==typeof t.next&&t.next(ph(r))})),this.bc(t,e,n)},t.nc=function(t){var e=this;return gh(this,this.h.then((function(){return ph(e)?ph(e).I(t).then((function(t){return{accessToken:t}})):null})))},t.Tc=function(t){var e=this;return this.h.then((function(){return hh(e,ru(e.a,Js,{token:t}))})).then((function(t){var n=t.user;return Ll(n,"isAnonymous",!1),e.da(n),t}))},t.Uc=function(t,e){var n=this;return this.h.then((function(){return hh(n,ru(n.a,$s,{email:t,password:e}))}))},t.dc=function(t,e){var n=this;return this.h.then((function(){return hh(n,ru(n.a,Cs,{email:t,password:e}))}))},t.$a=function(t){var e=this;return this.h.then((function(){return hh(e,t.ka(e.a))}))},t.Sc=function(t){return Xr("firebase.auth.Auth.prototype.signInAndRetrieveDataWithCredential is deprecated. Please use firebase.auth.Auth.prototype.signInWithCredential instead."),this.$a(t)},t.zb=function(){var t=this;return this.h.then((function(){var e=ph(t);if(e&&e.isAnonymous){var n=ti({providerId:null,isNewUser:!1});return ti({user:e,credential:null,additionalUserInfo:n,operationType:"signIn"})}return hh(t,t.a.zb()).then((function(e){var n=e.user;return Ll(n,"isAnonymous",!0),t.da(n),e}))}))},t.getUid=function(){return ph(this)&&ph(this).uid||null},t.cc=function(t){this.addAuthTokenListener(t),this.u++,0<this.u&&ph(this)&&El(ph(this))},t.Pc=function(t){var e=this;G(this.s,(function(n){n==t&&e.u--})),0>this.u&&(this.u=0),0==this.u&&ph(this)&&Sl(ph(this)),this.removeAuthTokenListener(t)},t.addAuthTokenListener=function(t){var e=this;this.s.push(t),gh(this,this.h.then((function(){e.l||Y(e.s,t)&&t(dh(e))})))},t.removeAuthTokenListener=function(t){J(this.s,(function(e){return e==t}))},t.delete=function(){this.l=!0;for(var t=0;t<this.R.length;t++)this.R[t].cancel("app-deleted");return this.R=[],this.i&&(t=this.i).b.removeListener(Zl("local"),t.a,this.ja),this.b&&(Dc(this.b,this),Hc(this.b.b)),Promise.resolve()},t.hc=function(t){return gh(this,function(t,e){return ru(t,ks,{identifier:e,continueUri:Lr()?fr():"http://localhost"}).then((function(t){return t.signinMethods||[]}))}(this.a,t))},t.Bc=function(t){return!!Do(t)},t.wb=function(t,e){var n=this;return gh(this,Ne().then((function(){var t=new Ri(e);if(!t.c)throw new k("argument-error",Li+" must be true when sending sign in link to email");return Bi(t)})).then((function(e){return n.a.wb(t,e)})).then((function(){})))},t.jd=function(t){return this.Ra(t).then((function(t){return t.data.email}))},t.nb=function(t,e){return gh(this,this.a.nb(t,e).then((function(){})))},t.Ra=function(t){return gh(this,this.a.Ra(t).then((function(t){return new ci(t)})))},t.jb=function(t){return gh(this,this.a.jb(t).then((function(){})))},t.vb=function(t,e){var n=this;return gh(this,Ne().then((function(){return void 0===e||vt(e)?{}:Bi(new Ri(e))})).then((function(e){return n.a.vb(t,e)})).then((function(){})))},t.Wc=function(t,e){return gh(this,$c(this,t,e,I(this.$a,this)))},t.Vc=function(t,e){var n=this;return gh(this,Ne().then((function(){var r=e||fr(),i=xo(t,r);if(!(r=Do(r)))throw new k("argument-error","Invalid email link!");if(r.tenantId!==n.T())throw new k("tenant-id-mismatch");return n.$a(i)})))},yh.prototype.render=function(){},yh.prototype.reset=function(){},yh.prototype.getResponse=function(){},yh.prototype.execute=function(){};var bh=null;function _h(t,e){return(e=wh(e))&&t.a[e]||null}function wh(t){return(t=void 0===t?1e12:t)?t.toString():null}function Ih(t,e){this.g=!1,this.c=e,this.a=this.b=null,this.h="invisible"!==this.c.size,this.f=le(t);var n=this;this.i=function(){n.execute()},this.h?this.execute():hn(this.f,"click",this.i)}function Th(t){if(t.g)throw Error("reCAPTCHA mock was already deleted!")}function Eh(){}function Sh(){}mh.prototype.render=function(t,e){return this.a[this.b.toString()]=new Ih(t,e),this.b++},mh.prototype.reset=function(t){var e=_h(this,t);t=wh(t),e&&t&&(e.delete(),delete this.a[t])},mh.prototype.getResponse=function(t){return(t=_h(this,t))?t.getResponse():null},mh.prototype.execute=function(t){(t=_h(this,t))&&t.execute()},Ih.prototype.getResponse=function(){return Th(this),this.b},Ih.prototype.execute=function(){Th(this);var t=this;this.a||(this.a=setTimeout((function(){t.b=function(){for(var t=50,e=[];0<t;)e.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(Math.floor(62*Math.random()))),t--;return e.join("")}();var e=t.c.callback,n=t.c["expired-callback"];if(e)try{e(t.b)}catch(t){}t.a=setTimeout((function(){if(t.a=null,t.b=null,n)try{n()}catch(t){}t.h&&t.execute()}),6e4)}),500))},Ih.prototype.delete=function(){Th(this),this.g=!0,clearTimeout(this.a),this.a=null,dn(this.f,"click",this.i)},$r(Eh,"FACTOR_ID","phone"),Sh.prototype.g=function(){return bh||(bh=new mh),Ne(bh)},Sh.prototype.c=function(){};var Ch=null;function kh(){this.b=u.grecaptcha?1/0:0,this.f=null,this.a="__rcb"+Math.floor(1e6*Math.random()).toString()}var Ah=new _t(Et,"https://www.google.com/recaptcha/api.js?onload=%{onload}&render=explicit&hl=%{hl}"),Nh=new Wr(3e4,6e4);kh.prototype.g=function(t){var e=this;return new Ie((function(n,r){var i=setTimeout((function(){r(new k("network-request-failed"))}),Nh.get());!u.grecaptcha||t!==e.f&&!e.b?(u[e.a]=function(){if(u.grecaptcha){e.f=t;var o=u.grecaptcha.render;u.grecaptcha.render=function(t,n){return t=o(t,n),e.b++,t},clearTimeout(i),n(u.grecaptcha)}else clearTimeout(i),r(new k("internal-error"));delete u[e.a]},Ne(Wa(At(Ah,{onload:e.a,hl:t||""}))).o((function(){clearTimeout(i),r(new k("internal-error","Unable to load external reCAPTCHA dependencies!"))}))):(clearTimeout(i),n(u.grecaptcha))}))},kh.prototype.c=function(){this.b--};var Ph=null;function Oh(t,e,n,r,i,o,a){if($r(this,"type","recaptcha"),this.c=this.f=null,this.D=!1,this.v=e,this.g=null,a?(Ch||(Ch=new Sh),a=Ch):(Ph||(Ph=new kh),a=Ph),this.m=a,this.a=n||{theme:"light",type:"image"},this.h=[],this.a[Dh])throw new k("argument-error","sitekey should not be provided for reCAPTCHA as one is automatically provisioned for the current project.");if(this.i="invisible"===this.a[Lh],!u.document)throw new k("operation-not-supported-in-this-environment","RecaptchaVerifier is only supported in a browser HTTP/HTTPS environment with DOM support.");if(!le(e)||!this.i&&le(e).hasChildNodes())throw new k("argument-error","reCAPTCHA container is either not found or already contains inner elements!");this.s=new Ja(t,o||null,i||null),this.u=r||function(){return null};var s=this;this.l=[];var c=this.a[Rh];this.a[Rh]=function(t){if(Mh(s,t),"function"==typeof c)c(t);else if("string"==typeof c){var e=Rr(c,u);"function"==typeof e&&e(t)}};var l=this.a[xh];this.a[xh]=function(){if(Mh(s,null),"function"==typeof l)l();else if("string"==typeof l){var t=Rr(l,u);"function"==typeof t&&t()}}}var Rh="callback",xh="expired-callback",Dh="sitekey",Lh="size";function Mh(t,e){for(var n=0;n<t.l.length;n++)try{t.l[n](e)}catch(t){}}function Fh(t,e){return t.h.push(e),e.oa((function(){X(t.h,e)})),e}function Uh(t){if(t.D)throw new k("internal-error","RecaptchaVerifier instance has been destroyed.")}function jh(t,e,n){var i=!1;try{this.b=n||r.default.app()}catch(t){throw new k("argument-error","No firebase.app.App instance is currently initialized.")}if(!this.b.options||!this.b.options.apiKey)throw new k("invalid-api-key");n=this.b.options.apiKey;var o=this,a=null;try{a=this.b.auth().Ga()}catch(t){}try{i=this.b.auth().settings.appVerificationDisabledForTesting}catch(t){}a=r.default.SDK_VERSION?Pr(r.default.SDK_VERSION,a):null,Oh.call(this,n,t,e,(function(){try{var t=o.b.auth().la()}catch(e){t=null}return t}),a,x(N),i)}function qh(t,e,n,r){t:{n=Array.prototype.slice.call(n);for(var i=0,o=!1,a=0;a<e.length;a++)if(e[a].optional)o=!0;else{if(o)throw new k("internal-error","Argument validator encountered a required argument after an optional argument.");i++}if(o=e.length,n.length<i||o<n.length)r="Expected "+(i==o?1==i?"1 argument":i+" arguments":i+"-"+o+" arguments")+" but got "+n.length+".";else{for(i=0;i<n.length;i++)if(o=e[i].optional&&void 0===n[i],!e[i].M(n[i])&&!o){if(e=e[i],0>i||i>=Vh.length)throw new k("internal-error","Argument validator received an unsupported number of arguments.");n=Vh[i],r=(r?"":n+" argument ")+(e.name?'"'+e.name+'" ':"")+"must be "+e.K+".";break t}r=null}}if(r)throw new k("argument-error",t+" failed: "+r)}(t=Oh.prototype).Ia=function(){var t=this;return this.f?this.f:this.f=Fh(this,Ne().then((function(){if(Lr()&&!Tr())return _r();throw new k("operation-not-supported-in-this-environment","RecaptchaVerifier is only supported in a browser HTTP/HTTPS environment.")})).then((function(){return t.m.g(t.u())})).then((function(e){return t.g=e,ru(t.s,qs,{})})).then((function(e){t.a[Dh]=e.recaptchaSiteKey})).o((function(e){throw t.f=null,e})))},t.render=function(){Uh(this);var t=this;return Fh(this,this.Ia().then((function(){if(null===t.c){var e=t.v;if(!t.i){var n=le(e);e=function(t,e,n){var r=arguments,i=document,o=String(r[0]),a=r[1];if(!ce&&a&&(a.name||a.type)){if(o=["<",o],a.name&&o.push(' name="',Gt(a.name),'"'),a.type){o.push(' type="',Gt(a.type),'"');var s={};mt(s,a),delete s.type,a=s}o.push(">"),o=o.join("")}return o=ge(i,o),a&&("string"==typeof a?o.className=a:Array.isArray(a)?o.className=a.join(" "):he(o,a)),2<r.length&&ve(i,o,r),o}("DIV"),n.appendChild(e)}t.c=t.g.render(e,t.a)}return t.c})))},t.verify=function(){Uh(this);var t=this;return Fh(this,this.render().then((function(e){return new Ie((function(n){var r=t.g.getResponse(e);if(r)n(r);else{var i=function(e){e&&(function(t,e){J(t.l,(function(t){return t==e}))}(t,i),n(e))};t.l.push(i),t.i&&t.g.execute(t.c)}}))})))},t.reset=function(){Uh(this),null!==this.c&&this.g.reset(this.c)},t.clear=function(){Uh(this),this.D=!0,this.m.c();for(var t=0;t<this.h.length;t++)this.h[t].cancel("RecaptchaVerifier instance has been destroyed.");if(!this.i){t=le(this.v);for(var e;e=t.firstChild;)t.removeChild(e)}},S(jh,Oh);var Vh="First Second Third Fourth Fifth Sixth Seventh Eighth Ninth".split(" ");function Bh(t,e){return{name:t||"",K:"a valid string",optional:!!e,M:function(t){return"string"==typeof t}}}function Kh(t,e){return{name:t||"",K:"a boolean",optional:!!e,M:function(t){return"boolean"==typeof t}}}function Wh(t,e){return{name:t||"",K:"a valid object",optional:!!e,M:g}}function Gh(t,e){return{name:t||"",K:"a function",optional:!!e,M:function(t){return"function"==typeof t}}}function Hh(t,e){return{name:t||"",K:"null",optional:!!e,M:function(t){return null===t}}}function zh(t){return{name:t?t+"Credential":"credential",K:t?"a valid "+t+" credential":"a valid credential",optional:!1,M:function(e){if(!e)return!1;var n=!t||e.providerId===t;return!(!e.ka||!n)}}}function Qh(t,e){return g(t)&&"string"==typeof t.type&&t.type===e&&"function"==typeof t.Ha}function Yh(t){return g(t)&&"string"==typeof t.uid}function Xh(t,e,n,r){return{name:n||"",K:t.K+" or "+e.K,optional:!!r,M:function(n){return t.M(n)||e.M(n)}}}function Jh(t,e){for(var n in e){var r=e[n].name;t[r]=tf(r,t[n],e[n].j)}}function $h(t,e){for(var n in e){var r=e[n].name;r!==n&&Object.defineProperty(t,r,{get:T((function(t){return this[t]}),n),set:T((function(t,e,n,r){qh(t,[n],[r],!0),this[e]=r}),r,n,e[n].kb),enumerable:!0})}}function Zh(t,e,n,r){t[e]=tf(e,n,r)}function tf(t,e,n){function r(){var t=Array.prototype.slice.call(arguments);return qh(o,n,t),e.apply(this,t)}if(!n)return e;var i,o=function(t){return(t=t.split("."))[t.length-1]}(t);for(i in e)r[i]=e[i];for(i in e.prototype)r.prototype[i]=e.prototype[i];return r}Jh(ih.prototype,{jb:{name:"applyActionCode",j:[Bh("code")]},Ra:{name:"checkActionCode",j:[Bh("code")]},nb:{name:"confirmPasswordReset",j:[Bh("code"),Bh("newPassword")]},dc:{name:"createUserWithEmailAndPassword",j:[Bh("email"),Bh("password")]},hc:{name:"fetchSignInMethodsForEmail",j:[Bh("email")]},qa:{name:"getRedirectResult",j:[]},Bc:{name:"isSignInWithEmailLink",j:[Bh("emailLink")]},Hc:{name:"onAuthStateChanged",j:[Xh(Wh(),Gh(),"nextOrObserver"),Gh("opt_error",!0),Gh("opt_completed",!0)]},Ic:{name:"onIdTokenChanged",j:[Xh(Wh(),Gh(),"nextOrObserver"),Gh("opt_error",!0),Gh("opt_completed",!0)]},vb:{name:"sendPasswordResetEmail",j:[Bh("email"),Xh(Wh("opt_actionCodeSettings",!0),Hh(null,!0),"opt_actionCodeSettings",!0)]},wb:{name:"sendSignInLinkToEmail",j:[Bh("email"),Wh("actionCodeSettings")]},xb:{name:"setPersistence",j:[Bh("persistence")]},Sc:{name:"signInAndRetrieveDataWithCredential",j:[zh()]},zb:{name:"signInAnonymously",j:[]},$a:{name:"signInWithCredential",j:[zh()]},Tc:{name:"signInWithCustomToken",j:[Bh("token")]},Uc:{name:"signInWithEmailAndPassword",j:[Bh("email"),Bh("password")]},Vc:{name:"signInWithEmailLink",j:[Bh("email"),Bh("emailLink",!0)]},Wc:{name:"signInWithPhoneNumber",j:[Bh("phoneNumber"),{name:"applicationVerifier",K:"an implementation of firebase.auth.ApplicationVerifier",optional:!1,M:function(t){return!(!t||"string"!=typeof t.type||"function"!=typeof t.verify)}}]},Xc:{name:"signInWithPopup",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},Yc:{name:"signInWithRedirect",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},dd:{name:"updateCurrentUser",j:[Xh({name:"user",K:"an instance of Firebase User",optional:!1,M:function(t){return!!(t&&t instanceof ml)}},Hh(),"user")]},Ab:{name:"signOut",j:[]},toJSON:{name:"toJSON",j:[Bh(null,!0)]},fd:{name:"useDeviceLanguage",j:[]},gd:{name:"useEmulator",j:[Bh("url"),Wh("options",!0)]},jd:{name:"verifyPasswordResetCode",j:[Bh("code")]}}),$h(ih.prototype,{lc:{name:"languageCode",kb:Xh(Bh(),Hh(),"languageCode")},ti:{name:"tenantId",kb:Xh(Bh(),Hh(),"tenantId")}}),ih.Persistence=Zu,ih.Persistence.LOCAL="local",ih.Persistence.SESSION="session",ih.Persistence.NONE="none",Jh(ml.prototype,{delete:{name:"delete",j:[]},oc:{name:"getIdTokenResult",j:[Kh("opt_forceRefresh",!0)]},I:{name:"getIdToken",j:[Kh("opt_forceRefresh",!0)]},Cc:{name:"linkAndRetrieveDataWithCredential",j:[zh()]},qb:{name:"linkWithCredential",j:[zh()]},Dc:{name:"linkWithPhoneNumber",j:[Bh("phoneNumber"),{name:"applicationVerifier",K:"an implementation of firebase.auth.ApplicationVerifier",optional:!1,M:function(t){return!(!t||"string"!=typeof t.type||"function"!=typeof t.verify)}}]},Ec:{name:"linkWithPopup",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},Fc:{name:"linkWithRedirect",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},Lc:{name:"reauthenticateAndRetrieveDataWithCredential",j:[zh()]},tb:{name:"reauthenticateWithCredential",j:[zh()]},Mc:{name:"reauthenticateWithPhoneNumber",j:[Bh("phoneNumber"),{name:"applicationVerifier",K:"an implementation of firebase.auth.ApplicationVerifier",optional:!1,M:function(t){return!(!t||"string"!=typeof t.type||"function"!=typeof t.verify)}}]},Nc:{name:"reauthenticateWithPopup",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},Oc:{name:"reauthenticateWithRedirect",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},reload:{name:"reload",j:[]},ub:{name:"sendEmailVerification",j:[Xh(Wh("opt_actionCodeSettings",!0),Hh(null,!0),"opt_actionCodeSettings",!0)]},toJSON:{name:"toJSON",j:[Bh(null,!0)]},cd:{name:"unlink",j:[Bh("provider")]},Bb:{name:"updateEmail",j:[Bh("email")]},Cb:{name:"updatePassword",j:[Bh("password")]},ed:{name:"updatePhoneNumber",j:[zh("phone")]},Db:{name:"updateProfile",j:[Wh("profile")]},Eb:{name:"verifyBeforeUpdateEmail",j:[Bh("email"),Xh(Wh("opt_actionCodeSettings",!0),Hh(null,!0),"opt_actionCodeSettings",!0)]}}),Jh(mh.prototype,{execute:{name:"execute"},render:{name:"render"},reset:{name:"reset"},getResponse:{name:"getResponse"}}),Jh(yh.prototype,{execute:{name:"execute"},render:{name:"render"},reset:{name:"reset"},getResponse:{name:"getResponse"}}),Jh(Ie.prototype,{oa:{name:"finally"},o:{name:"catch"},then:{name:"then"}}),$h(Xc.prototype,{appVerificationDisabled:{name:"appVerificationDisabledForTesting",kb:Kh("appVerificationDisabledForTesting")}}),Jh(Jc.prototype,{confirm:{name:"confirm",j:[Bh("verificationCode")]}}),Zh(lo,"fromJSON",(function(t){t="string"==typeof t?JSON.parse(t):t;for(var e,n=[mo,Oo,Mo,vo],r=0;r<n.length;r++)if(e=n[r](t))return e;return null}),[Xh(Bh(),Wh(),"json")]),Zh(Ro,"credential",(function(t,e){return new Po(t,e)}),[Bh("email"),Bh("password")]),Jh(Po.prototype,{w:{name:"toJSON",j:[Bh(null,!0)]}}),Jh(Io.prototype,{Ca:{name:"addScope",j:[Bh("scope")]},Ka:{name:"setCustomParameters",j:[Wh("customOAuthParameters")]}}),Zh(Io,"credential",To,[Xh(Bh(),Wh(),"token")]),Zh(Ro,"credentialWithLink",xo,[Bh("email"),Bh("emailLink")]),Jh(Eo.prototype,{Ca:{name:"addScope",j:[Bh("scope")]},Ka:{name:"setCustomParameters",j:[Wh("customOAuthParameters")]}}),Zh(Eo,"credential",So,[Xh(Bh(),Wh(),"token")]),Jh(Co.prototype,{Ca:{name:"addScope",j:[Bh("scope")]},Ka:{name:"setCustomParameters",j:[Wh("customOAuthParameters")]}}),Zh(Co,"credential",ko,[Xh(Bh(),Xh(Wh(),Hh()),"idToken"),Xh(Bh(),Hh(),"accessToken",!0)]),Jh(Ao.prototype,{Ka:{name:"setCustomParameters",j:[Wh("customOAuthParameters")]}}),Zh(Ao,"credential",No,[Xh(Bh(),Wh(),"token"),Bh("secret",!0)]),Jh(wo.prototype,{Ca:{name:"addScope",j:[Bh("scope")]},credential:{name:"credential",j:[Xh(Bh(),Xh(Wh(),Hh()),"optionsOrIdToken"),Xh(Bh(),Hh(),"accessToken",!0)]},Ka:{name:"setCustomParameters",j:[Wh("customOAuthParameters")]}}),Jh(go.prototype,{w:{name:"toJSON",j:[Bh(null,!0)]}}),Jh(fo.prototype,{w:{name:"toJSON",j:[Bh(null,!0)]}}),Zh(Uo,"credential",jo,[Bh("verificationId"),Bh("verificationCode")]),Jh(Uo.prototype,{fb:{name:"verifyPhoneNumber",j:[Xh(Bh(),{name:"phoneInfoOptions",K:"valid phone info options",optional:!1,M:function(t){return!!t&&(t.session&&t.phoneNumber?Qh(t.session,uo)&&"string"==typeof t.phoneNumber:t.session&&t.multiFactorHint?Qh(t.session,co)&&Yh(t.multiFactorHint):t.session&&t.multiFactorUid?Qh(t.session,co)&&"string"==typeof t.multiFactorUid:!!t.phoneNumber&&"string"==typeof t.phoneNumber)}},"phoneInfoOptions"),{name:"applicationVerifier",K:"an implementation of firebase.auth.ApplicationVerifier",optional:!1,M:function(t){return!(!t||"string"!=typeof t.type||"function"!=typeof t.verify)}}]}}),Jh(Lo.prototype,{w:{name:"toJSON",j:[Bh(null,!0)]}}),Jh(k.prototype,{toJSON:{name:"toJSON",j:[Bh(null,!0)]}}),Jh(Qo.prototype,{toJSON:{name:"toJSON",j:[Bh(null,!0)]}}),Jh(zo.prototype,{toJSON:{name:"toJSON",j:[Bh(null,!0)]}}),Jh(rl.prototype,{toJSON:{name:"toJSON",j:[Bh(null,!0)]}}),Jh(tl.prototype,{Rc:{name:"resolveSignIn",j:[{name:"multiFactorAssertion",K:"a valid multiFactorAssertion",optional:!1,M:function(t){return!!t&&!!t.sb}}]}}),Jh(cl.prototype,{Rb:{name:"getSession",j:[]},fc:{name:"enroll",j:[{name:"multiFactorAssertion",K:"a valid multiFactorAssertion",optional:!1,M:function(t){return!!t&&!!t.sb}},Bh("displayName",!0)]},bd:{name:"unenroll",j:[Xh({name:"multiFactorInfo",K:"a valid multiFactorInfo",optional:!1,M:Yh},Bh(),"multiFactorInfoIdentifier")]}}),Jh(jh.prototype,{clear:{name:"clear",j:[]},render:{name:"render",j:[]},verify:{name:"verify",j:[]}}),Zh(Ti,"parseLink",Oi,[Bh("link")]),Zh(Eh,"assertion",(function(t){return new sl(t)}),[zh("phone")]),function(){if(void 0===r.default||!r.default.INTERNAL||!r.default.INTERNAL.registerComponent)throw Error("Cannot find the firebase namespace; be sure to include firebase-app.js before this library.");var t={ActionCodeInfo:{Operation:{EMAIL_SIGNIN:hi,PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:li,VERIFY_AND_CHANGE_EMAIL:fi,VERIFY_EMAIL:"VERIFY_EMAIL"}},Auth:ih,AuthCredential:lo,Error:k};Zh(t,"EmailAuthProvider",Ro,[]),Zh(t,"FacebookAuthProvider",Io,[]),Zh(t,"GithubAuthProvider",Eo,[]),Zh(t,"GoogleAuthProvider",Co,[]),Zh(t,"TwitterAuthProvider",Ao,[]),Zh(t,"OAuthProvider",wo,[Bh("providerId")]),Zh(t,"SAMLAuthProvider",_o,[Bh("providerId")]),Zh(t,"PhoneAuthProvider",Uo,[{name:"auth",K:"an instance of Firebase Auth",optional:!0,M:function(t){return!!(t&&t instanceof ih)}}]),Zh(t,"RecaptchaVerifier",jh,[Xh(Bh(),{name:"",K:"an HTML element",optional:!1,M:function(t){return!!(t&&t instanceof Element)}},"recaptchaContainer"),Wh("recaptchaParameters",!0),{name:"app",K:"an instance of Firebase App",optional:!0,M:function(t){return!!(t&&t instanceof r.default.app.App)}}]),Zh(t,"ActionCodeURL",Ti,[]),Zh(t,"PhoneMultiFactorGenerator",Eh,[]),r.default.INTERNAL.registerComponent({name:"auth",instanceFactory:function(t){return new ih(t=t.getProvider("app").getImmediate())},multipleInstances:!1,serviceProps:t,instantiationMode:"LAZY",type:"PUBLIC"}),r.default.INTERNAL.registerComponent({name:"auth-internal",instanceFactory:function(t){return{getUid:I((t=t.getProvider("auth").getImmediate()).getUid,t),getToken:I(t.nc,t),addAuthTokenListener:I(t.cc,t),removeAuthTokenListener:I(t.Pc,t)}},multipleInstances:!1,instantiationMode:"LAZY",type:"PRIVATE"}),r.default.registerVersion("@firebase/auth","0.16.6"),r.default.INTERNAL.extendNamespace({User:ml})}()}).apply(void 0!==n.g?n.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{}),n(790);var i=n(448),o=n(594),a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function s(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var u,c="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==n.g?n.g:"undefined"!=typeof self?self:{},l=l||{},h=c||self;function f(){}function p(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function d(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var v="closure_uid_"+(1e9*Math.random()>>>0),g=0;function y(t,e,n){return t.call.apply(t.bind,arguments)}function m(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function b(t,e,n){return(b=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?y:m).apply(null,arguments)}function _(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}function w(){return Date.now()}function I(t,e){function n(){}n.prototype=e.prototype,t.X=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.Kb=function(t,n,r){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return e.prototype[n].apply(t,i)}}function T(){this.j=this.j,this.i=this.i}T.prototype.j=!1,T.prototype.ja=function(){!this.j&&(this.j=!0,this.G(),0)&&function(t){Object.prototype.hasOwnProperty.call(t,v)&&t[v]||(t[v]=++g)}(this)},T.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var E=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},S=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function C(t){return Array.prototype.concat.apply([],arguments)}function k(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function A(t){return/^[\s\xa0]*$/.test(t)}var N,P=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function O(t,e){return-1!=t.indexOf(e)}function R(t,e){return t<e?-1:t>e?1:0}t:{var x=h.navigator;if(x){var D=x.userAgent;if(D){N=D;break t}}N=""}function L(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function M(t){var e={};for(var n in t)e[n]=t[n];return e}var F="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function U(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<F.length;o++)n=F[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function j(t){return j[" "](t),t}j[" "]=f;var q,V,B=O(N,"Opera"),K=O(N,"Trident")||O(N,"MSIE"),W=O(N,"Edge"),G=W||K,H=O(N,"Gecko")&&!(O(N.toLowerCase(),"webkit")&&!O(N,"Edge"))&&!(O(N,"Trident")||O(N,"MSIE"))&&!O(N,"Edge"),z=O(N.toLowerCase(),"webkit")&&!O(N,"Edge");function Q(){var t=h.document;return t?t.documentMode:void 0}t:{var Y="",X=(V=N,H?/rv:([^\);]+)(\)|;)/.exec(V):W?/Edge\/([\d\.]+)/.exec(V):K?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(V):z?/WebKit\/(\S+)/.exec(V):B?/(?:Version)[ \/]?(\S+)/.exec(V):void 0);if(X&&(Y=X?X[1]:""),K){var J=Q();if(null!=J&&J>parseFloat(Y)){q=String(J);break t}}q=Y}var $,Z={};function tt(t){return function(t,e){var n=Z;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e()}(t,(function(){for(var e=0,n=P(String(q)).split("."),r=P(String(t)).split("."),i=Math.max(n.length,r.length),o=0;0==e&&o<i;o++){var a=n[o]||"",s=r[o]||"";do{if(a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==a[0].length&&0==s[0].length)break;e=R(0==a[1].length?0:parseInt(a[1],10),0==s[1].length?0:parseInt(s[1],10))||R(0==a[2].length,0==s[2].length)||R(a[2],s[2]),a=a[3],s=s[3]}while(0==e)}return 0<=e}))}h.document&&K?$=Q()||parseInt(q,10)||void 0:$=void 0;var et=$,nt=!K||9<=Number(et),rt=K&&!tt("9"),it=function(){if(!h.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{h.addEventListener("test",f,e),h.removeEventListener("test",f,e)}catch(t){}return t}();function ot(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function at(t,e){if(ot.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(H){t:{try{j(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:st[t.pointerType]||"",this.c=t,t.defaultPrevented&&this.b()}}ot.prototype.b=function(){this.defaultPrevented=!0},I(at,ot);var st={2:"touch",3:"pen",4:"mouse"};at.prototype.b=function(){at.X.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,rt)try{(t.ctrlKey||112<=t.keyCode&&123>=t.keyCode)&&(t.keyCode=-1)}catch(t){}};var ut="closure_listenable_"+(1e6*Math.random()|0),ct=0;function lt(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++ct,this.Y=this.Z=!1}function ht(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function ft(t){this.src=t,this.a={},this.b=0}function pt(t,e){var n=e.type;if(n in t.a){var r,i=t.a[n],o=E(i,e);(r=0<=o)&&Array.prototype.splice.call(i,o,1),r&&(ht(e),0==t.a[n].length&&(delete t.a[n],t.b--))}}function dt(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}ft.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var a=dt(t,e,r,i);return-1<a?(e=t[a],n||(e.Z=!1)):((e=new lt(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var vt="closure_lm_"+(1e6*Math.random()|0),gt={};function yt(t,e,n,r,i){if(r&&r.once)return bt(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)yt(t,e[o],n,r,i);return null}return n=kt(n),t&&t[ut]?t.va(e,n,d(r)?!!r.capture:!!r,i):mt(t,e,n,!1,r,i)}function mt(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var a=d(i)?!!i.capture:!!i;if(a&&!nt)return null;var s=St(t);if(s||(t[vt]=s=new ft(t)),(n=s.add(e,n,r,a,o)).proxy)return n;if(r=function(){var t=Et,e=nt?function(n){return t.call(e.src,e.listener,n)}:function(n){if(!(n=t.call(e.src,e.listener,n)))return n};return e}(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)it||(i=a),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(It(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function bt(t,e,n,r,i){if(Array.isArray(e)){for(var o=0;o<e.length;o++)bt(t,e[o],n,r,i);return null}return n=kt(n),t&&t[ut]?t.wa(e,n,d(r)?!!r.capture:!!r,i):mt(t,e,n,!0,r,i)}function _t(t,e,n,r,i){if(Array.isArray(e))for(var o=0;o<e.length;o++)_t(t,e[o],n,r,i);else r=d(r)?!!r.capture:!!r,n=kt(n),t&&t[ut]?(t=t.c,(e=String(e).toString())in t.a&&-1<(n=dt(o=t.a[e],n,r,i))&&(ht(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete t.a[e],t.b--))):t&&(t=St(t))&&(e=t.a[e.toString()],t=-1,e&&(t=dt(e,n,r,i)),(n=-1<t?e[t]:null)&&wt(n))}function wt(t){if("number"!=typeof t&&t&&!t.Y){var e=t.src;if(e&&e[ut])pt(e.c,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(It(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=St(e))?(pt(n,t),0==n.b&&(n.src=null,e[vt]=null)):ht(t)}}}function It(t){return t in gt?gt[t]:gt[t]="on"+t}function Tt(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&wt(t),n.call(r,e)}function Et(t,e){if(t.Y)return!0;if(!nt){if(!e)t:{e=["window","event"];for(var n=h,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return Tt(t,e=new at(e,this))}return Tt(t,new at(e,this))}function St(t){return(t=t[vt])instanceof ft?t:null}var Ct="__closure_events_fn_"+(1e9*Math.random()>>>0);function kt(t){return"function"==typeof t?t:(t[Ct]||(t[Ct]=function(e){return t.handleEvent(e)}),t[Ct])}function At(){T.call(this),this.c=new ft(this),this.J=this,this.C=null}function Nt(t,e){var n,r=t.C;if(r)for(n=[];r;r=r.C)n.push(r);if(t=t.J,r=e.type||e,"string"==typeof e)e=new ot(e,t);else if(e instanceof ot)e.target=e.target||t;else{var i=e;U(e=new ot(r,t),i)}if(i=!0,n)for(var o=n.length-1;0<=o;o--){var a=e.a=n[o];i=Pt(a,r,!0,e)&&i}if(i=Pt(a=e.a=t,r,!0,e)&&i,i=Pt(a,r,!1,e)&&i,n)for(o=0;o<n.length;o++)i=Pt(a=e.a=n[o],r,!1,e)&&i}function Pt(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var a=e[o];if(a&&!a.Y&&a.capture==n){var s=a.listener,u=a.ca||a.src;a.Z&&pt(t.c,a),i=!1!==s.call(u,r)&&i}}return i&&!r.defaultPrevented}I(At,T),At.prototype[ut]=!0,(u=At.prototype).addEventListener=function(t,e,n,r){yt(this,t,e,n,r)},u.removeEventListener=function(t,e,n,r){_t(this,t,e,n,r)},u.G=function(){if(At.X.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)ht(n[r]);delete e.a[t],e.b--}}this.C=null},u.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},u.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var Ot=h.JSON.stringify;function Rt(){this.b=this.a=null}var xt,Dt=new(function(){function t(t,e){this.c=t,this.f=e,this.b=0,this.a=null}return t.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},t}())((function(){return new Mt}),(function(t){t.reset()}));function Lt(){var t=qt,e=null;return t.a&&(e=t.a,t.a=t.a.next,t.a||(t.b=null),e.next=null),e}function Mt(){this.next=this.b=this.a=null}function Ft(t){h.setTimeout((function(){throw t}),0)}function Ut(t,e){xt||function(){var t=h.Promise.resolve(void 0);xt=function(){t.then(Vt)}}(),jt||(xt(),jt=!0),qt.add(t,e)}Rt.prototype.add=function(t,e){var n=Dt.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Mt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null},Mt.prototype.reset=function(){this.next=this.b=this.a=null};var jt=!1,qt=new Rt;function Vt(){for(var t;t=Lt();){try{t.a.call(t.b)}catch(t){Ft(t)}var e=Dt;e.f(t),100>e.b&&(e.b++,t.next=e.a,e.a=t)}jt=!1}function Bt(t,e){At.call(this),this.b=t||1,this.a=e||h,this.f=b(this.Za,this),this.g=w()}function Kt(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function Wt(t,e,n){if("function"==typeof t)n&&(t=b(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=b(t.handleEvent,t)}return 2147483647<Number(e)?-1:h.setTimeout(t,e||0)}function Gt(t){t.a=Wt((function(){t.a=null,t.c&&(t.c=!1,Gt(t))}),t.h);var e=t.b;t.b=null,t.g.apply(null,e)}I(Bt,At),(u=Bt.prototype).aa=!1,u.M=null,u.Za=function(){if(this.aa){var t=w()-this.g;0<t&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),Nt(this,"tick"),this.aa&&(Kt(this),this.start()))}},u.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=w())},u.G=function(){Bt.X.G.call(this),Kt(this),delete this.a};var Ht=function(t){function e(e,n){var r=t.call(this)||this;return r.g=e,r.h=n,r.b=null,r.c=!1,r.a=null,r}return function(t,e){function n(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:Gt(this)},e.prototype.G=function(){t.prototype.G.call(this),this.a&&(h.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},e}(T);function zt(t){T.call(this),this.b=t,this.a={}}I(zt,T);var Qt=[];function Yt(t,e,n,r){Array.isArray(n)||(n&&(Qt[0]=n.toString()),n=Qt);for(var i=0;i<n.length;i++){var o=yt(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function Xt(t){L(t.a,(function(t,e){this.a.hasOwnProperty(e)&&wt(t)}),t),t.a={}}function Jt(){this.a=!0}function $t(t,e,n,r){t.info((function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var o=i[0];if("noop"!=o&&"stop"!=o&&"close"!=o)for(var a=1;a<i.length;a++)i[a]=""}}}return Ot(n)}catch(t){return e}}(t,n)+(r?" "+r:"")}))}zt.prototype.G=function(){zt.X.G.call(this),Xt(this)},zt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},Jt.prototype.info=function(){};var Zt={},te=null;function ee(){return te=te||new At}function ne(t){ot.call(this,Zt.Fa,t)}function re(t){var e=ee();Nt(e,new ne(e,t))}function ie(t,e){ot.call(this,Zt.STAT_EVENT,t),this.stat=e}function oe(t){var e=ee();Nt(e,new ie(e,t))}function ae(t){ot.call(this,Zt.Ga,t)}function se(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return h.setTimeout((function(){t()}),e)}Zt.Fa="serverreachability",I(ne,ot),Zt.STAT_EVENT="statevent",I(ie,ot),Zt.Ga="timingevent",I(ae,ot);var ue={NO_ERROR:0,$a:1,nb:2,mb:3,hb:4,lb:5,ob:6,Da:7,TIMEOUT:8,rb:9},ce={fb:"complete",Bb:"success",Ea:"error",Da:"abort",tb:"ready",ub:"readystatechange",TIMEOUT:"timeout",pb:"incrementaldata",sb:"progress",ib:"downloadprogress",Jb:"uploadprogress"};function le(){}function he(t){var e;return(e=t.a)||(e=t.a={}),e}function fe(){}le.prototype.a=null;var pe,de={OPEN:"a",eb:"b",Ea:"c",qb:"d"};function ve(){ot.call(this,"d")}function ge(){ot.call(this,"c")}function ye(){}function me(t,e,n,r){this.g=t,this.c=e,this.f=n,this.S=r||1,this.J=new zt(this),this.P=be,t=G?125:void 0,this.R=new Bt(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.T=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.V=this.C=this.U=this.I=!1}I(ve,ot),I(ge,ot),I(ye,le),pe=new ye;var be=45e3,_e={},we={};function Ie(t,e,n){t.H=1,t.i=We(Ue(e)),t.j=n,t.I=!0,Te(t,null)}function Te(t,e){t.u=w(),Ce(t),t.l=Ue(t.i);var n=t.l,r=t.S;Array.isArray(r)||(r=[String(r)]),rn(n.b,"t",r),t.D=0,t.a=$n(t.g,t.g.C?e:null),0<t.O&&(t.F=new Ht(b(t.Ca,t,t.a),t.O)),Yt(t.J,t.a,"readystatechange",t.Xa),e=t.B?M(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),re(1),function(t,e,n,r,i,o){t.info((function(){if(t.a)if(o)for(var a="",s=o.split("&"),u=0;u<s.length;u++){var c=s[u].split("=");if(1<c.length){var l=c[0];c=c[1];var h=l.split("_");a=2<=h.length&&"type"==h[1]?a+(l+"=")+c+"&":a+(l+"=redacted&")}}else a=null;else a=o;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+"\n"+n+"\n"+a}))}(t.c,t.m,t.l,t.f,t.S,t.j)}function Ee(t,e,n){for(var r=!0;!t.A&&t.D<n.length;){var i=Se(t,n);if(i==we){4==e&&(t.h=4,oe(14),r=!1),$t(t.c,t.f,null,"[Incomplete Response]");break}if(i==_e){t.h=4,oe(15),$t(t.c,t.f,n,"[Invalid Chunk]"),r=!1;break}$t(t.c,t.f,i,null),Oe(t,i)}4==e&&0==n.length&&(t.h=1,oe(16),r=!1),t.b=t.b&&r,r?0<n.length&&!t.V&&(t.V=!0,(e=t.g).a==t&&e.U&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),Wn(e),e.F=!0,oe(11))):($t(t.c,t.f,n,"[Invalid Chunked Response]"),Pe(t),Ne(t))}function Se(t,e){var n=t.D,r=e.indexOf("\n",n);return-1==r?we:(n=Number(e.substring(n,r)),isNaN(n)?_e:(r+=1)+n>e.length?we:(e=e.substr(r,n),t.D=r+n,e))}function Ce(t){t.T=w()+t.P,ke(t,t.P)}function ke(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=se(b(t.Va,t),e)}function Ae(t){t.o&&(h.clearTimeout(t.o),t.o=null)}function Ne(t){0==t.g.v||t.A||zn(t.g,t)}function Pe(t){Ae(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,Kt(t.R),Xt(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function Oe(t,e){try{var n=t.g;if(0!=n.v&&(n.a==t||hn(n.b,t)))if(n.I=t.N,!t.C&&hn(n.b,t)&&3==n.v){try{var r=n.ka.a.parse(e)}catch(t){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){t:if(!n.j){if(n.a){if(!(n.a.u+3e3<t.u))break t;Hn(n),Ln(n)}Kn(n),oe(18)}}else n.oa=i[1],0<n.oa-n.P&&37500>i[2]&&n.H&&0==n.o&&!n.m&&(n.m=se(b(n.Sa,n),6e3));if(1>=ln(n.b)&&n.ea){try{n.ea()}catch(t){}n.ea=void 0}}else Yn(n,11)}else if((t.C||n.a==t)&&Hn(n),!A(e))for(e=r=n.ka.a.parse(e),r=0;r<e.length;r++)if(i=e[r],n.P=i[0],i=i[1],2==n.v)if("c"==i[0]){n.J=i[1],n.ga=i[2];var o=i[3];null!=o&&(n.ha=o,n.c.info("VER="+n.ha));var a=i[4];null!=a&&(n.pa=a,n.c.info("SVER="+n.pa));var s=i[5];if(null!=s&&"number"==typeof s&&0<s){var u=1.5*s;n.D=u,n.c.info("backChannelRequestTimeoutMs_="+u)}u=n;var c=t.a;if(c){var l=c.a?c.a.getResponseHeader("X-Client-Wire-Protocol"):null;if(l){var h=u.b;!h.a&&(O(l,"spdy")||O(l,"quic")||O(l,"h2"))&&(h.f=h.g,h.a=new Set,h.b&&(fn(h,h.b),h.b=null))}if(u.A){var f=c.a?c.a.getResponseHeader("X-HTTP-Session-Id"):null;f&&(u.na=f,Ke(u.B,u.A,f))}}n.v=3,n.f&&n.f.ta(),n.U&&(n.N=w()-t.u,n.c.info("Handshake RTT: "+n.N+"ms"));var p=t;if((u=n).la=Jn(u,u.C?u.ga:null,u.fa),p.C){pn(u.b,p);var d=p,v=u.D;v&&d.setTimeout(v),d.o&&(Ae(d),Ce(d)),u.a=p}else Bn(u);0<n.g.length&&Un(n)}else"stop"!=i[0]&&"close"!=i[0]||Yn(n,7);else 3==n.v&&("stop"==i[0]||"close"==i[0]?"stop"==i[0]?Yn(n,7):Dn(n):"noop"!=i[0]&&n.f&&n.f.sa(i),n.o=0);re(4)}catch(t){}}function Re(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(p(t)||"string"==typeof t)S(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(p(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(p(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function xe(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof xe)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function De(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];Le(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){var i={};for(n=e=0;e<t.a.length;)Le(i,r=t.a[e])||(t.a[n++]=r,i[r]=1),e++;t.a.length=n}}function Le(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(u=me.prototype).setTimeout=function(t){this.P=t},u.Xa=function(t){t=t.target;var e=this.F;e&&3==Pn(t)?e.f():this.Ca(t)},u.Ca=function(t){try{if(t==this.a)t:{var e=Pn(this.a),n=this.a.ua(),r=this.a.W();if(!(3>e||3==e&&!G&&!this.a.$())){this.A||4!=e||7==n||re(8==n||0>=r?3:2),Ae(this);var i=this.a.W();this.N=i;var o=this.a.$();if(this.b=200==i,function(t,e,n,r,i,o,a){t.info((function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+"\n"+n+"\n"+o+" "+a}))}(this.c,this.m,this.l,this.f,this.S,e,i),this.b){if(this.U&&!this.C){e:{if(this.a){var a,s=this.a;if((a=s.a?s.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!A(a)){var u=a;break e}}u=null}if(!u){this.b=!1,this.h=3,oe(12),Pe(this),Ne(this);break t}$t(this.c,this.f,u,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,Oe(this,u)}this.I?(Ee(this,e,o),G&&this.b&&3==e&&(Yt(this.J,this.R,"tick",this.Wa),this.R.start())):($t(this.c,this.f,o,null),Oe(this,o)),4==e&&Pe(this),this.b&&!this.A&&(4==e?zn(this.g,this):(this.b=!1,Ce(this)))}else 400==i&&0<o.indexOf("Unknown SID")?(this.h=3,oe(12)):(this.h=0,oe(13)),Pe(this),Ne(this)}}}catch(t){}},u.Wa=function(){if(this.a){var t=Pn(this.a),e=this.a.$();this.D<e.length&&(Ae(this),Ee(this,t,e),this.b&&4!=t&&Ce(this))}},u.cancel=function(){this.A=!0,Pe(this)},u.Va=function(){this.o=null;var t=w();0<=t-this.T?(function(t,e){t.info((function(){return"TIMEOUT: "+e}))}(this.c,this.l),2!=this.H&&(re(3),oe(17)),Pe(this),this.h=2,Ne(this)):ke(this,this.T-t)},(u=xe.prototype).K=function(){De(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},u.L=function(){return De(this),this.a.concat()},u.get=function(t,e){return Le(this.b,t)?this.b[t]:e},u.set=function(t,e){Le(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},u.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var Me=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Fe(t,e){if(this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof Fe){this.a=void 0!==e?e:t.a,je(this,t.f),this.j=t.j,qe(this,t.c),Ve(this,t.h),this.g=t.g,e=t.b;var n=new Ze;n.c=e.c,e.a&&(n.a=new xe(e.a),n.b=e.b),Be(this,n),this.i=t.i}else t&&(n=String(t).match(Me))?(this.a=!!e,je(this,n[1]||"",!0),this.j=Ge(n[2]||""),qe(this,n[3]||"",!0),Ve(this,n[4]),this.g=Ge(n[5]||"",!0),Be(this,n[6]||"",!0),this.i=Ge(n[7]||"")):(this.a=!!e,this.b=new Ze(null,this.a))}function Ue(t){return new Fe(t)}function je(t,e,n){t.f=n?Ge(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function qe(t,e,n){t.c=n?Ge(e,!0):e}function Ve(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.h=e}else t.h=null}function Be(t,e,n){e instanceof Ze?(t.b=e,function(t,e){e&&!t.f&&(tn(t),t.c=null,t.a.forEach((function(t,e){var n=e.toLowerCase();e!=n&&(en(this,e),rn(this,n,t))}),t)),t.f=e}(t.b,t.a)):(n||(e=He(e,Je)),t.b=new Ze(e,t.a))}function Ke(t,e,n){t.b.set(e,n)}function We(t){return Ke(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^w()).toString(36)),t}function Ge(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function He(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,ze),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function ze(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Fe.prototype.toString=function(){var t=[],e=this.f;e&&t.push(He(e,Qe,!0),":");var n=this.c;return(n||"file"==e)&&(t.push("//"),(e=this.j)&&t.push(He(e,Qe,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(He(n,"/"==n.charAt(0)?Xe:Ye,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",He(n,$e)),t.join("")};var Qe=/[#\/\?@]/g,Ye=/[#\?:]/g,Xe=/[#\?]/g,Je=/[#\?@]/g,$e=/#/g;function Ze(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function tn(t){t.a||(t.a=new xe,t.b=0,t.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(t.c,(function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)})))}function en(t,e){tn(t),e=on(t,e),Le(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Le((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&De(t)))}function nn(t,e){return tn(t),e=on(t,e),Le(t.a.b,e)}function rn(t,e,n){en(t,e),0<n.length&&(t.c=null,t.a.set(on(t,e),k(n)),t.b+=n.length)}function on(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}(u=Ze.prototype).add=function(t,e){tn(this),this.c=null,t=on(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},u.forEach=function(t,e){tn(this),this.a.forEach((function(n,r){S(n,(function(n){t.call(e,n,r,this)}),this)}),this)},u.L=function(){tn(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},u.K=function(t){tn(this);var e=[];if("string"==typeof t)nn(this,t)&&(e=C(e,this.a.get(on(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=C(e,t[n])}return e},u.set=function(t,e){return tn(this),this.c=null,nn(this,t=on(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},u.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},u.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.K(r);for(var o=0;o<r.length;o++){var a=i;""!==r[o]&&(a+="="+encodeURIComponent(String(r[o]))),t.push(a)}}return this.c=t.join("&")};var an=function(t,e){this.b=t,this.a=e};function sn(t){this.g=t||un,t=h.PerformanceNavigationTiming?0<(t=h.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(h.ia&&h.ia.ya&&h.ia.ya()&&h.ia.ya().Lb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}var un=10;function cn(t){return!!t.b||!!t.a&&t.a.size>=t.f}function ln(t){return t.b?1:t.a?t.a.size:0}function hn(t,e){return t.b?t.b==e:!!t.a&&t.a.has(e)}function fn(t,e){t.a?t.a.add(e):t.b=e}function pn(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function dn(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null!=t.a&&0!==t.a.size){var r=t.c;try{for(var i=s(t.a.values()),o=i.next();!o.done;o=i.next()){var a=o.value;r=r.concat(a.s)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}return k(t.c)}function vn(){}function gn(){this.a=new vn}function yn(t,e,n){var r=n||"";try{Re(t,(function(t,n){var i=t;d(t)&&(i=Ot(t)),e.push(r+n+"="+encodeURIComponent(i))}))}catch(t){throw e.push(r+"type="+encodeURIComponent("_badmap")),t}}function mn(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}sn.prototype.cancel=function(){var t,e;if(this.c=dn(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=s(this.a.values()),r=n.next();!r.done;r=n.next())r.value.cancel()}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.a.clear()}},vn.prototype.stringify=function(t){return h.JSON.stringify(t,void 0)},vn.prototype.parse=function(t){return h.JSON.parse(t,void 0)};var bn=h.JSON.parse;function _n(t){At.call(this),this.headers=new xe,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=wn,this.D=this.F=!1}I(_n,At);var wn="",In=/^https?$/i,Tn=["POST","PUT"];function En(t){return"content-type"==t.toLowerCase()}function Sn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,Cn(t),An(t)}function Cn(t){t.u||(t.u=!0,Nt(t,"complete"),Nt(t,"error"))}function kn(t){if(t.b&&void 0!==l&&(!t.s[1]||4!=Pn(t)||2!=t.W()))if(t.l&&4==Pn(t))Wt(t.za,0,t);else if(Nt(t,"readystatechange"),4==Pn(t)){t.b=!1;try{var e,n=t.W();t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}if(!(e=r)){var i;if(i=0===n){var o=String(t.B).match(Me)[1]||null;if(!o&&h.self&&h.self.location){var a=h.self.location.protocol;o=a.substr(0,a.length-1)}i=!In.test(o?o.toLowerCase():"")}e=i}if(e)Nt(t,"complete"),Nt(t,"success");else{t.h=6;try{var s=2<Pn(t)?t.a.statusText:""}catch(n){s=""}t.f=s+" ["+t.W()+"]",Cn(t)}}finally{An(t)}}}function An(t,e){if(t.a){Nn(t);var n=t.a,r=t.s[0]?f:null;t.a=null,t.s=null,e||Nt(t,"ready");try{n.onreadystatechange=r}catch(t){}}}function Nn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(h.clearTimeout(t.m),t.m=null)}function Pn(t){return t.a?t.a.readyState:0}function On(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}r||(n=function(t){var e="";return L(t,(function(t,n){e+=n,e+=":",e+=t,e+="\r\n"})),e}(n),"string"==typeof t?null!=n&&encodeURIComponent(String(n)):Ke(t,e,n))}function Rn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function xn(t){this.pa=0,this.g=[],this.c=new Jt,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.V=this.i=this.O=this.l=null,this.Oa=this.R=0,this.La=Rn("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.S=!0,this.I=this.oa=this.P=-1,this.T=this.o=this.u=0,this.Ha=Rn("baseRetryDelayMs",5e3,t),this.Ra=Rn("retryDelaySeedMs",1e4,t),this.Ma=Rn("forwardChannelMaxRetries",2,t),this.ma=Rn("forwardChannelRequestTimeoutMs",2e4,t),this.Na=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new sn(t&&t.concurrentRequestLimit),this.ka=new gn,this.da=t&&t.fastHandshake||!1,this.Ia=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.S=!1),this.U=!this.da&&this.S&&t&&t.detectBufferingProxy||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null,(this.Ka=t&&t.c||!1)&&this.c.info("Opt-in to enable Chrome Origin Trials.")}function Dn(t){if(Mn(t),3==t.v){var e=t.R++,n=Ue(t.B);Ke(n,"SID",t.J),Ke(n,"RID",e),Ke(n,"TYPE","terminate"),qn(t,n),(e=new me(t,t.c,e,void 0)).H=2,e.i=We(Ue(n)),n=!1,h.navigator&&h.navigator.sendBeacon&&(n=h.navigator.sendBeacon(e.i.toString(),"")),!n&&h.Image&&((new Image).src=e.i,n=!0),n||(e.a=$n(e.g,null),e.a.ba(e.i)),e.u=w(),Ce(e)}Xn(t)}function Ln(t){t.a&&(Wn(t),t.a.cancel(),t.a=null)}function Mn(t){Ln(t),t.j&&(h.clearTimeout(t.j),t.j=null),Hn(t),t.b.cancel(),t.h&&("number"==typeof t.h&&h.clearTimeout(t.h),t.h=null)}function Fn(t,e){t.g.push(new an(t.Oa++,e)),3==t.v&&Un(t)}function Un(t){cn(t.b)||t.h||(t.h=!0,Ut(t.Ba,t),t.u=0)}function jn(t,e){var n;n=e?e.f:t.R++;var r=Ue(t.B);Ke(r,"SID",t.J),Ke(r,"RID",n),Ke(r,"AID",t.P),qn(t,r),t.i&&t.l&&On(r,t.i,t.l),n=new me(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=Vn(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),fn(t.b,n),Ie(n,r,e)}function qn(t,e){t.f&&Re({},(function(t,n){Ke(e,n,t)}))}function Vn(t,e,n){n=Math.min(t.g.length,n);var r=t.f?b(t.f.Ja,t.f,t):null;t:for(var i=t.g,o=-1;;){var a=["count="+n];-1==o?0<n?(o=i[0].b,a.push("ofs="+o)):o=0:a.push("ofs="+o);for(var s=!0,u=0;u<n;u++){var c=i[u].b,l=i[u].a;if(0>(c-=o))o=Math.max(0,i[u].b-100),s=!1;else try{yn(l,a,"req"+c+"_")}catch(t){r&&r(l)}}if(s){r=a.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function Bn(t){t.a||t.j||(t.T=1,Ut(t.Aa,t),t.o=0)}function Kn(t){return!(t.a||t.j||3<=t.o||(t.T++,t.j=se(b(t.Aa,t),Qn(t,t.o)),t.o++,0))}function Wn(t){null!=t.s&&(h.clearTimeout(t.s),t.s=null)}function Gn(t){t.a=new me(t,t.c,"rpc",t.T),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=Ue(t.la);Ke(e,"RID","rpc"),Ke(e,"SID",t.J),Ke(e,"CI",t.H?"0":"1"),Ke(e,"AID",t.P),qn(t,e),Ke(e,"TYPE","xmlhttp"),t.i&&t.l&&On(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=We(Ue(e)),n.j=null,n.I=!0,Te(n,t)}function Hn(t){null!=t.m&&(h.clearTimeout(t.m),t.m=null)}function zn(t,e){var n=null;if(t.a==e){Hn(t),Wn(t),t.a=null;var r=2}else{if(!hn(t.b,e))return;n=e.s,pn(t.b,e),r=1}if(t.I=e.N,0!=t.v)if(e.b)if(1==r){n=e.j?e.j.length:0,e=w()-e.u;var i=t.u;Nt(r=ee(),new ae(r,n,e,i)),Un(t)}else Bn(t);else if(3==(i=e.h)||0==i&&0<t.I||!(1==r&&function(t,e){return!(ln(t.b)>=t.b.f-(t.h?1:0)||(t.h?(t.g=e.s.concat(t.g),0):1==t.v||2==t.v||t.u>=(t.La?0:t.Ma)||(t.h=se(b(t.Ba,t,e),Qn(t,t.u)),t.u++,0)))}(t,e)||2==r&&Kn(t)))switch(n&&0<n.length&&(e=t.b,e.c=e.c.concat(n)),i){case 1:Yn(t,5);break;case 4:Yn(t,10);break;case 3:Yn(t,6);break;default:Yn(t,2)}}function Qn(t,e){var n=t.Ha+Math.floor(Math.random()*t.Ra);return t.f||(n*=2),n*e}function Yn(t,e){if(t.c.info("Error code "+e),2==e){var n=null;t.f&&(n=null);var r=b(t.Ya,t);n||(n=new Fe("//www.google.com/images/cleardot.gif"),h.location&&"http"==h.location.protocol||je(n,"https"),We(n)),function(t,e){var n=new Jt;if(h.Image){var r=new Image;r.onload=_(mn,n,r,"TestLoadImage: loaded",!0,e),r.onerror=_(mn,n,r,"TestLoadImage: error",!1,e),r.onabort=_(mn,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=_(mn,n,r,"TestLoadImage: timeout",!1,e),h.setTimeout((function(){r.ontimeout&&r.ontimeout()}),1e4),r.src=t}else e(!1)}(n.toString(),r)}else oe(2);t.v=0,t.f&&t.f.ra(e),Xn(t),Mn(t)}function Xn(t){t.v=0,t.I=-1,t.f&&(0==dn(t.b).length&&0==t.g.length||(t.b.c.length=0,k(t.g),t.g.length=0),t.f.qa())}function Jn(t,e,n){var r=function(t){return t instanceof Fe?Ue(t):new Fe(t,void 0)}(n);if(""!=r.c)e&&qe(r,e+"."+r.c),Ve(r,r.h);else{var i=h.location;r=function(t,e,n,r){var i=new Fe(null,void 0);return t&&je(i,t),e&&qe(i,e),n&&Ve(i,n),r&&(i.g=r),i}(i.protocol,e?e+"."+i.hostname:i.hostname,+i.port,n)}return t.V&&L(t.V,(function(t,e){Ke(r,e,t)})),e=t.A,n=t.na,e&&n&&Ke(r,e,n),Ke(r,"VER",t.ha),qn(t,r),r}function $n(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new _n(t.Na)).F=t.C,e}function Zn(){}function tr(){if(K&&!(10<=Number(et)))throw Error("Environmental error: no available transport.")}function er(t,e){At.call(this),this.a=new xn(e),this.o=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!A(t)&&(this.a.i=t),this.m=e&&e.supportsCrossDomainXhr||!1,this.l=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!A(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&e in(t=this.b)&&delete t[e]),this.f=new ir(this)}function nr(t){ve.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function rr(){ge.call(this),this.status=1}function ir(t){this.a=t}(u=_n.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?he(this.H):he(pe),this.a.onreadystatechange=b(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(t){return void Sn(this,t)}t=n||"";var i=new xe(this.headers);r&&Re(r,(function(t,e){i.set(e,t)})),r=function(t){t:{for(var e=En,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return 0>e?null:"string"==typeof t?t.charAt(e):t[e]}(i.L()),n=h.FormData&&t instanceof h.FormData,!(0<=E(Tn,e))||r||n||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach((function(t,e){this.a.setRequestHeader(e,t)}),this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{Nn(this),0<this.o&&((this.D=function(t){return K&&tt(9)&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(this.a))?(this.a.timeout=this.o,this.a.ontimeout=b(this.xa,this)):this.m=Wt(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){Sn(this,t)}},u.xa=function(){void 0!==l&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,Nt(this,"timeout"),this.abort(8))},u.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,Nt(this,"complete"),Nt(this,"abort"),An(this))},u.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),An(this,!0)),_n.X.G.call(this)},u.za=function(){this.j||(this.A||this.l||this.g?kn(this):this.Ua())},u.Ua=function(){kn(this)},u.W=function(){try{return 2<Pn(this)?this.a.status:-1}catch(t){return-1}},u.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},u.Pa=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),bn(e)}},u.ua=function(){return this.h},u.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(u=xn.prototype).ha=8,u.v=1,u.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new me(this,this.c,t,void 0),r=this.l;if(this.O&&(r?U(r=M(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if(void 0===(o="__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=Vn(this,n,e),Ke(i=Ue(this.B),"RID",t),Ke(i,"CVER",22),this.A&&Ke(i,"X-HTTP-Session-Id",this.A),qn(this,i),this.i&&r&&On(i,this.i,r),fn(this.b,n),this.Ia&&Ke(i,"TYPE","init"),this.da?(Ke(i,"$req",e),Ke(i,"SID","null"),n.U=!0,Ie(n,i,null)):Ie(n,i,e),this.v=2}}else 3==this.v&&(t?jn(this,t):0==this.g.length||cn(this.b)||jn(this))},u.Aa=function(){if(this.j=null,Gn(this),this.U&&!(this.F||null==this.a||0>=this.N)){var t=2*this.N;this.c.info("BP detection timer enabled: "+t),this.s=se(b(this.Ta,this),t)}},u.Ta=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,oe(10),Ln(this),Gn(this))},u.Sa=function(){null!=this.m&&(this.m=null,Ln(this),Kn(this),oe(19))},u.Ya=function(t){t?(this.c.info("Successfully pinged google.com"),oe(2)):(this.c.info("Failed to ping google.com"),oe(1))},(u=Zn.prototype).ta=function(){},u.sa=function(){},u.ra=function(){},u.qa=function(){},u.Ja=function(){},tr.prototype.a=function(t,e){return new er(t,e)},I(er,At),er.prototype.g=function(){this.a.f=this.f,this.m&&(this.a.C=!0);var t=this.a,e=this.o,n=this.b||void 0;oe(0),t.fa=e,t.V=n||{},t.H=t.S,t.B=Jn(t,null,t.fa),Un(t)},er.prototype.close=function(){Dn(this.a)},er.prototype.h=function(t){if("string"==typeof t){var e={};e.__data__=t,Fn(this.a,e)}else this.l?((e={}).__data__=Ot(t),Fn(this.a,e)):Fn(this.a,t)},er.prototype.G=function(){this.a.f=null,delete this.f,Dn(this.a),delete this.a,er.X.G.call(this)},I(nr,ve),I(rr,ge),I(ir,Zn),ir.prototype.ta=function(){Nt(this.a,"a")},ir.prototype.sa=function(t){Nt(this.a,new nr(t))},ir.prototype.ra=function(t){Nt(this.a,new rr(t))},ir.prototype.qa=function(){Nt(this.a,"b")},tr.prototype.createWebChannel=tr.prototype.a,er.prototype.send=er.prototype.h,er.prototype.open=er.prototype.g,er.prototype.close=er.prototype.close,ue.NO_ERROR=0,ue.TIMEOUT=8,ue.HTTP_ERROR=6,ce.COMPLETE="complete",fe.EventType=de,de.OPEN="a",de.CLOSE="b",de.ERROR="c",de.MESSAGE="d",At.prototype.listen=At.prototype.va,_n.prototype.listenOnce=_n.prototype.wa,_n.prototype.getLastError=_n.prototype.Qa,_n.prototype.getLastErrorCode=_n.prototype.ua,_n.prototype.getStatus=_n.prototype.W,_n.prototype.getResponseJson=_n.prototype.Pa,_n.prototype.getResponseText=_n.prototype.$,_n.prototype.send=_n.prototype.ba;var or=ue,ar=ce,sr=Zt,ur=10,cr=11,lr=fe,hr=_n,fr=function(t,e){return(fr=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function pr(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}fr(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function dr(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))}function vr(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}function gr(t,e){for(var n=0,r=e.length,i=t.length;n<r;n++,i++)t[i]=e[n];return t}Object.create,Object.create;var yr=function(){function t(t,e){var n=this;this.previousValue=t,e&&(e.sequenceNumberHandler=function(t){return n.t(t)},this.i=function(t){return e.writeSequenceNumber(t)})}return t.prototype.t=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},t.prototype.next=function(){var t=++this.previousValue;return this.i&&this.i(t),t},t}();yr.o=-1;var mr={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},br=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).code=e,r.message=n,r.name="FirebaseError",r.toString=function(){return r.name+": [code="+r.code+"]: "+r.message},r}return pr(e,t),e}(Error),_r=new o.Logger("@firebase/firestore");function wr(){return _r.logLevel}function Ir(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(_r.logLevel<=o.LogLevel.DEBUG){var r=e.map(Sr);_r.debug.apply(_r,gr(["Firestore (8.6.2): "+t],r))}}function Tr(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(_r.logLevel<=o.LogLevel.ERROR){var r=e.map(Sr);_r.error.apply(_r,gr(["Firestore (8.6.2): "+t],r))}}function Er(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(_r.logLevel<=o.LogLevel.WARN){var r=e.map(Sr);_r.warn.apply(_r,gr(["Firestore (8.6.2): "+t],r))}}function Sr(t){if("string"==typeof t)return t;try{return e=t,JSON.stringify(e)}catch(e){return t}var e}function Cr(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE (8.6.2) INTERNAL ASSERTION FAILED: "+t;throw Tr(e),new Error(e)}function kr(t,e){t||Cr()}function Ar(t,e){return t}function Nr(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}var Pr=function(){function t(){}return t.u=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=Nr(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},t}();function Or(t,e){return t<e?-1:t>e?1:0}function Rr(t,e,n){return t.length===e.length&&t.every((function(t,r){return n(t,e[r])}))}function xr(t){return t+"\0"}var Dr=function(){function t(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new br(mr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new br(mr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new br(mr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new br(mr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}return t.now=function(){return t.fromMillis(Date.now())},t.fromDate=function(e){return t.fromMillis(e.getTime())},t.fromMillis=function(e){var n=Math.floor(e/1e3);return new t(n,Math.floor(1e6*(e-1e3*n)))},t.prototype.toDate=function(){return new Date(this.toMillis())},t.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},t.prototype._compareTo=function(t){return this.seconds===t.seconds?Or(this.nanoseconds,t.nanoseconds):Or(this.seconds,t.seconds)},t.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},t.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},t.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},t.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},t}(),Lr=function(){function t(t){this.timestamp=t}return t.fromTimestamp=function(e){return new t(e)},t.min=function(){return new t(new Dr(0,0))},t.prototype.compareTo=function(t){return this.timestamp._compareTo(t.timestamp)},t.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},t.prototype.toMicroseconds=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},t.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},t.prototype.toTimestamp=function(){return this.timestamp},t}();function Mr(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Fr(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Ur(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var jr=function(){function t(t,e,n){void 0===e?e=0:e>t.length&&Cr(),void 0===n?n=t.length-e:n>t.length-e&&Cr(),this.segments=t,this.offset=e,this.len=n}return Object.defineProperty(t.prototype,"length",{get:function(){return this.len},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return 0===t.comparator(this,e)},t.prototype.child=function(e){var n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach((function(t){n.push(t)})):n.push(e),this.construct(n)},t.prototype.limit=function(){return this.offset+this.length},t.prototype.popFirst=function(t){return t=void 0===t?1:t,this.construct(this.segments,this.offset+t,this.length-t)},t.prototype.popLast=function(){return this.construct(this.segments,this.offset,this.length-1)},t.prototype.firstSegment=function(){return this.segments[this.offset]},t.prototype.lastSegment=function(){return this.get(this.length-1)},t.prototype.get=function(t){return this.segments[this.offset+t]},t.prototype.isEmpty=function(){return 0===this.length},t.prototype.isPrefixOf=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.isImmediateParentOf=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},t.prototype.toArray=function(){return this.segments.slice(this.offset,this.limit())},t.comparator=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(i>o)return 1}return t.length<e.length?-1:t.length>e.length?1:0},t}(),qr=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return pr(e,t),e.prototype.construct=function(t,n,r){return new e(t,n,r)},e.prototype.canonicalString=function(){return this.toArray().join("/")},e.prototype.toString=function(){return this.canonicalString()},e.fromString=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(var r=[],i=0,o=t;i<o.length;i++){var a=o[i];if(a.indexOf("//")>=0)throw new br(mr.INVALID_ARGUMENT,"Invalid segment ("+a+"). Paths must not contain // in them.");r.push.apply(r,a.split("/").filter((function(t){return t.length>0})))}return new e(r)},e.emptyPath=function(){return new e([])},e}(jr),Vr=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Br=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return pr(e,t),e.prototype.construct=function(t,n,r){return new e(t,n,r)},e.isValidIdentifier=function(t){return Vr.test(t)},e.prototype.canonicalString=function(){return this.toArray().map((function(t){return t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),e.isValidIdentifier(t)||(t="`"+t+"`"),t})).join(".")},e.prototype.toString=function(){return this.canonicalString()},e.prototype.isKeyField=function(){return 1===this.length&&"__name__"===this.get(0)},e.keyField=function(){return new e(["__name__"])},e.fromServerFormat=function(t){for(var n=[],r="",i=0,o=function(){if(0===r.length)throw new br(mr.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");n.push(r),r=""},a=!1;i<t.length;){var s=t[i];if("\\"===s){if(i+1===t.length)throw new br(mr.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[i+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new br(mr.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=u,i+=2}else"`"===s?(a=!a,i++):"."!==s||a?(r+=s,i++):(o(),i++)}if(o(),a)throw new br(mr.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new e(n)},e.emptyPath=function(){return new e([])},e}(jr),Kr=function(){function t(t){this.fields=t,t.sort(Br.comparator)}return t.prototype.covers=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].isPrefixOf(t))return!0;return!1},t.prototype.isEqual=function(t){return Rr(this.fields,t.fields,(function(t,e){return t.isEqual(e)}))},t}(),Wr=function(){function t(t){this.binaryString=t}return t.fromBase64String=function(e){return new t(atob(e))},t.fromUint8Array=function(e){return new t(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(e))},t.prototype.toBase64=function(){return t=this.binaryString,btoa(t);var t},t.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.binaryString)},t.prototype.approximateByteSize=function(){return 2*this.binaryString.length},t.prototype.compareTo=function(t){return Or(this.binaryString,t.binaryString)},t.prototype.isEqual=function(t){return this.binaryString===t.binaryString},t}();Wr.EMPTY_BYTE_STRING=new Wr("");var Gr=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Hr(t){if(kr(!!t),"string"==typeof t){var e=0,n=Gr.exec(t);if(kr(!!n),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}var i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:zr(t.seconds),nanos:zr(t.nanos)}}function zr(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function Qr(t){return"string"==typeof t?Wr.fromBase64String(t):Wr.fromUint8Array(t)}function Yr(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function Xr(t){var e=t.mapValue.fields.__previous_value__;return Yr(e)?Xr(e):e}function Jr(t){var e=Hr(t.mapValue.fields.__local_write_time__.timestampValue);return new Dr(e.seconds,e.nanos)}function $r(t){return null==t}function Zr(t){return 0===t&&1/t==-1/0}function ti(t){return"number"==typeof t&&Number.isInteger(t)&&!Zr(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}var ei=function(){function t(t){this.path=t}return t.fromPath=function(e){return new t(qr.fromString(e))},t.fromName=function(e){return new t(qr.fromString(e).popFirst(5))},t.prototype.hasCollectionId=function(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t},t.prototype.isEqual=function(t){return null!==t&&0===qr.comparator(this.path,t.path)},t.prototype.toString=function(){return this.path.toString()},t.comparator=function(t,e){return qr.comparator(t.path,e.path)},t.isDocumentKey=function(t){return t.length%2==0},t.fromSegments=function(e){return new t(new qr(e.slice()))},t}();function ni(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Yr(t)?4:10:Cr()}function ri(t,e){var n=ni(t);if(n!==ni(e))return!1;switch(n){case 0:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Jr(t).isEqual(Jr(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;var n=Hr(t.timestampValue),r=Hr(e.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return Qr(t.bytesValue).isEqual(Qr(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return zr(t.geoPointValue.latitude)===zr(e.geoPointValue.latitude)&&zr(t.geoPointValue.longitude)===zr(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return zr(t.integerValue)===zr(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=zr(t.doubleValue),r=zr(e.doubleValue);return n===r?Zr(n)===Zr(r):isNaN(n)&&isNaN(r)}return!1}(t,e);case 9:return Rr(t.arrayValue.values||[],e.arrayValue.values||[],ri);case 10:return function(t,e){var n=t.mapValue.fields||{},r=e.mapValue.fields||{};if(Mr(n)!==Mr(r))return!1;for(var i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!ri(n[i],r[i])))return!1;return!0}(t,e);default:return Cr()}}function ii(t,e){return void 0!==(t.values||[]).find((function(t){return ri(t,e)}))}function oi(t,e){var n=ni(t),r=ni(e);if(n!==r)return Or(n,r);switch(n){case 0:return 0;case 1:return Or(t.booleanValue,e.booleanValue);case 2:return function(t,e){var n=zr(t.integerValue||t.doubleValue),r=zr(e.integerValue||e.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(t,e);case 3:return ai(t.timestampValue,e.timestampValue);case 4:return ai(Jr(t),Jr(e));case 5:return Or(t.stringValue,e.stringValue);case 6:return function(t,e){var n=Qr(t),r=Qr(e);return n.compareTo(r)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=Or(n[i],r[i]);if(0!==o)return o}return Or(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){var n=Or(zr(t.latitude),zr(e.latitude));return 0!==n?n:Or(zr(t.longitude),zr(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=oi(n[i],r[i]);if(o)return o}return Or(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var a=0;a<r.length&&a<o.length;++a){var s=Or(r[a],o[a]);if(0!==s)return s;var u=oi(n[r[a]],i[o[a]]);if(0!==u)return u}return Or(r.length,o.length)}(t.mapValue,e.mapValue);default:throw Cr()}}function ai(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Or(t,e);var n=Hr(t),r=Hr(e),i=Or(n.seconds,r.seconds);return 0!==i?i:Or(n.nanos,r.nanos)}function si(t){return ui(t)}function ui(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){var e=Hr(t);return"time("+e.seconds+","+e.nanos+")"}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?Qr(t.bytesValue).toBase64():"referenceValue"in t?(n=t.referenceValue,ei.fromName(n).toString()):"geoPointValue"in t?"geo("+(e=t.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in t?function(t){for(var e="[",n=!0,r=0,i=t.values||[];r<i.length;r++)n?n=!1:e+=",",e+=ui(i[r]);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+ui(t.fields[o])}return e+"}"}(t.mapValue):Cr();var e,n}function ci(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.canonicalString()}}function li(t){return!!t&&"integerValue"in t}function hi(t){return!!t&&"arrayValue"in t}function fi(t){return!!t&&"nullValue"in t}function pi(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function di(t){return!!t&&"mapValue"in t}var vi=function(){function t(t){this.overlayMap=new Map,this.partialValue=t}return t.empty=function(){return new t({mapValue:{}})},t.prototype.field=function(e){return t.extractNestedValue(this.buildProto(),e)},t.prototype.toProto=function(){return this.field(Br.emptyPath())},t.prototype.set=function(t,e){this.setOverlay(t,e)},t.prototype.setAll=function(t){var e=this;t.forEach((function(t,n){t?e.set(n,t):e.delete(n)}))},t.prototype.delete=function(t){this.setOverlay(t,null)},t.prototype.isEqual=function(t){return ri(this.buildProto(),t.buildProto())},t.prototype.setOverlay=function(t,e){for(var n=this.overlayMap,r=0;r<t.length-1;++r){var i=t.get(r),o=n.get(i);o instanceof Map?n=o:o&&10===ni(o)?(o=new Map(Object.entries(o.mapValue.fields||{})),n.set(i,o),n=o):(o=new Map,n.set(i,o),n=o)}n.set(t.lastSegment(),e)},t.prototype.applyOverlay=function(e,n){var r=this,i=!1,o=t.extractNestedValue(this.partialValue,e),a=di(o)?Object.assign({},o.mapValue.fields):{};return n.forEach((function(t,n){if(t instanceof Map){var o=r.applyOverlay(e.child(n),t);null!=o&&(a[n]=o,i=!0)}else null!==t?(a[n]=t,i=!0):a.hasOwnProperty(n)&&(delete a[n],i=!0)})),i?{mapValue:{fields:a}}:null},t.prototype.buildProto=function(){var t=this.applyOverlay(Br.emptyPath(),this.overlayMap);return null!=t&&(this.partialValue=t,this.overlayMap.clear()),this.partialValue},t.extractNestedValue=function(t,e){if(e.isEmpty())return t;for(var n=t,r=0;r<e.length-1;++r){if(!n.mapValue.fields)return null;if(!di(n=n.mapValue.fields[e.get(r)]))return null}return(n=(n.mapValue.fields||{})[e.lastSegment()])||null},t.prototype.clone=function(){return new t(this.buildProto())},t}();function gi(t){var e=[];return Fr(t.fields||{},(function(t,n){var r=new Br([t]);if(di(n)){var i=gi(n.mapValue).fields;if(0===i.length)e.push(r);else for(var o=0,a=i;o<a.length;o++){var s=a[o];e.push(r.child(s))}}else e.push(r)})),new Kr(e)}var yi=function(){function t(t,e,n,r,i){this.key=t,this.documentType=e,this.version=n,this.data=r,this.documentState=i}return t.newInvalidDocument=function(e){return new t(e,0,Lr.min(),vi.empty(),0)},t.newFoundDocument=function(e,n,r){return new t(e,1,n,r,0)},t.newNoDocument=function(e,n){return new t(e,2,n,vi.empty(),0)},t.newUnknownDocument=function(e,n){return new t(e,3,n,vi.empty(),2)},t.prototype.convertToFoundDocument=function(t,e){return this.version=t,this.documentType=1,this.data=e,this.documentState=0,this},t.prototype.convertToNoDocument=function(t){return this.version=t,this.documentType=2,this.data=vi.empty(),this.documentState=0,this},t.prototype.convertToUnknownDocument=function(t){return this.version=t,this.documentType=3,this.data=vi.empty(),this.documentState=2,this},t.prototype.setHasCommittedMutations=function(){return this.documentState=2,this},t.prototype.setHasLocalMutations=function(){return this.documentState=1,this},Object.defineProperty(t.prototype,"hasLocalMutations",{get:function(){return 1===this.documentState},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasCommittedMutations",{get:function(){return 2===this.documentState},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return this.hasLocalMutations||this.hasCommittedMutations},enumerable:!1,configurable:!0}),t.prototype.isValidDocument=function(){return 0!==this.documentType},t.prototype.isFoundDocument=function(){return 1===this.documentType},t.prototype.isNoDocument=function(){return 2===this.documentType},t.prototype.isUnknownDocument=function(){return 3===this.documentType},t.prototype.isEqual=function(e){return e instanceof t&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)},t.prototype.clone=function(){return new t(this.key,this.documentType,this.version,this.data.clone(),this.documentState)},t.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+JSON.stringify(this.data.toProto())+", {documentType: "+this.documentType+"}), {documentState: "+this.documentState+"})"},t}(),mi=function(t,e,n,r,i,o,a){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===a&&(a=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=a,this.h=null};function bi(t,e,n,r,i,o,a){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===a&&(a=null),new mi(t,e,n,r,i,o,a)}function _i(t){var e=Ar(t);if(null===e.h){var n=e.path.canonicalString();null!==e.collectionGroup&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map((function(t){return function(t){return t.field.canonicalString()+t.op.toString()+si(t.value)}(t)})).join(","),n+="|ob:",n+=e.orderBy.map((function(t){return function(t){return t.field.canonicalString()+t.dir}(t)})).join(","),$r(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=xi(e.startAt)),e.endAt&&(n+="|ub:",n+=xi(e.endAt)),e.h=n}return e.h}function wi(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n=0;n<t.orderBy.length;n++)if(!Li(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(var r=0;r<t.filters.length;r++)if(i=t.filters[r],o=e.filters[r],i.op!==o.op||!i.field.isEqual(o.field)||!ri(i.value,o.value))return!1;var i,o;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Fi(t.startAt,e.startAt)&&Fi(t.endAt,e.endAt)}function Ii(t){return ei.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}var Ti=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).field=e,i.op=n,i.value=r,i}return pr(e,t),e.create=function(t,n,r){return t.isKeyField()?"in"===n||"not-in"===n?this.l(t,n,r):new Ei(t,n,r):"array-contains"===n?new Ai(t,r):"in"===n?new Ni(t,r):"not-in"===n?new Pi(t,r):"array-contains-any"===n?new Oi(t,r):new e(t,n,r)},e.l=function(t,e,n){return"in"===e?new Si(t,n):new Ci(t,n)},e.prototype.matches=function(t){var e=t.data.field(this.field);return"!="===this.op?null!==e&&this.m(oi(e,this.value)):null!==e&&ni(this.value)===ni(e)&&this.m(oi(e,this.value))},e.prototype.m=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return Cr()}},e.prototype.g=function(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0},e}((function(){})),Ei=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,r)||this).key=ei.fromName(r.referenceValue),i}return pr(e,t),e.prototype.matches=function(t){var e=ei.comparator(t.key,this.key);return this.m(e)},e}(Ti),Si=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"in",n)||this).keys=ki(0,n),r}return pr(e,t),e.prototype.matches=function(t){return this.keys.some((function(e){return e.isEqual(t.key)}))},e}(Ti),Ci=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"not-in",n)||this).keys=ki(0,n),r}return pr(e,t),e.prototype.matches=function(t){return!this.keys.some((function(e){return e.isEqual(t.key)}))},e}(Ti);function ki(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map((function(t){return ei.fromName(t.referenceValue)}))}var Ai=function(t){function e(e,n){return t.call(this,e,"array-contains",n)||this}return pr(e,t),e.prototype.matches=function(t){var e=t.data.field(this.field);return hi(e)&&ii(e.arrayValue,this.value)},e}(Ti),Ni=function(t){function e(e,n){return t.call(this,e,"in",n)||this}return pr(e,t),e.prototype.matches=function(t){var e=t.data.field(this.field);return null!==e&&ii(this.value.arrayValue,e)},e}(Ti),Pi=function(t){function e(e,n){return t.call(this,e,"not-in",n)||this}return pr(e,t),e.prototype.matches=function(t){if(ii(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;var e=t.data.field(this.field);return null!==e&&!ii(this.value.arrayValue,e)},e}(Ti),Oi=function(t){function e(e,n){return t.call(this,e,"array-contains-any",n)||this}return pr(e,t),e.prototype.matches=function(t){var e=this,n=t.data.field(this.field);return!(!hi(n)||!n.arrayValue.values)&&n.arrayValue.values.some((function(t){return ii(e.value.arrayValue,t)}))},e}(Ti),Ri=function(t,e){this.position=t,this.before=e};function xi(t){return(t.before?"b":"a")+":"+t.position.map((function(t){return si(t)})).join(",")}var Di=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function Li(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}function Mi(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],a=t.position[i];if(r=o.field.isKeyField()?ei.comparator(ei.fromName(a.referenceValue),n.key):oi(a,n.data.field(o.field)),"desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function Fi(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!ri(t.position[n],e.position[n]))return!1;return!0}var Ui=function(t,e,n,r,i,o,a,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===a&&(a=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=a,this.endAt=s,this.p=null,this.T=null,this.startAt,this.endAt};function ji(t,e,n,r,i,o,a,s){return new Ui(t,e,n,r,i,o,a,s)}function qi(t){return new Ui(t)}function Vi(t){return!$r(t.limit)&&"F"===t.limitType}function Bi(t){return!$r(t.limit)&&"L"===t.limitType}function Ki(t){return t.explicitOrderBy.length>0?t.explicitOrderBy[0].field:null}function Wi(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.g())return r.field}return null}function Gi(t){return null!==t.collectionGroup}function Hi(t){var e=Ar(t);if(null===e.p){e.p=[];var n=Wi(e),r=Ki(e);if(null!==n&&null===r)n.isKeyField()||e.p.push(new Di(n)),e.p.push(new Di(Br.keyField(),"asc"));else{for(var i=!1,o=0,a=e.explicitOrderBy;o<a.length;o++){var s=a[o];e.p.push(s),s.field.isKeyField()&&(i=!0)}if(!i){var u=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.p.push(new Di(Br.keyField(),u))}}}return e.p}function zi(t){var e=Ar(t);if(!e.T)if("F"===e.limitType)e.T=bi(e.path,e.collectionGroup,Hi(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=Hi(e);r<i.length;r++){var o=i[r],a="desc"===o.dir?"asc":"desc";n.push(new Di(o.field,a))}var s=e.endAt?new Ri(e.endAt.position,!e.endAt.before):null,u=e.startAt?new Ri(e.startAt.position,!e.startAt.before):null;e.T=bi(e.path,e.collectionGroup,n,e.filters,e.limit,s,u)}return e.T}function Qi(t,e,n){return new Ui(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Yi(t,e){return wi(zi(t),zi(e))&&t.limitType===e.limitType}function Xi(t){return _i(zi(t))+"|lt:"+t.limitType}function Ji(t){return"Query(target="+function(t){var e=t.path.canonicalString();return null!==t.collectionGroup&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=", filters: ["+t.filters.map((function(t){return(e=t).field.canonicalString()+" "+e.op+" "+si(e.value);var e})).join(", ")+"]"),$r(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=", orderBy: ["+t.orderBy.map((function(t){return function(t){return t.field.canonicalString()+" ("+t.dir+")"}(t)})).join(", ")+"]"),t.startAt&&(e+=", startAt: "+xi(t.startAt)),t.endAt&&(e+=", endAt: "+xi(t.endAt)),"Target("+e+")"}(zi(t))+"; limitType="+t.limitType+")"}function $i(t,e){return e.isFoundDocument()&&function(t,e){var n=e.key.path;return null!==t.collectionGroup?e.key.hasCollectionId(t.collectionGroup)&&t.path.isPrefixOf(n):ei.isDocumentKey(t.path)?t.path.isEqual(n):t.path.isImmediateParentOf(n)}(t,e)&&function(t,e){for(var n=0,r=t.explicitOrderBy;n<r.length;n++){var i=r[n];if(!i.field.isKeyField()&&null===e.data.field(i.field))return!1}return!0}(t,e)&&function(t,e){for(var n=0,r=t.filters;n<r.length;n++)if(!r[n].matches(e))return!1;return!0}(t,e)&&function(t,e){return!(t.startAt&&!Mi(t.startAt,Hi(t),e)||t.endAt&&Mi(t.endAt,Hi(t),e))}(t,e)}function Zi(t){return function(e,n){for(var r=!1,i=0,o=Hi(t);i<o.length;i++){var a=o[i],s=to(a,e,n);if(0!==s)return s;r=r||a.field.isKeyField()}return 0}}function to(t,e,n){var r=t.field.isKeyField()?ei.comparator(e.key,n.key):function(t,e,n){var r=e.data.field(t),i=n.data.field(t);return null!==r&&null!==i?oi(r,i):Cr()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return Cr()}}function eo(t,e){if(t.I){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Zr(e)?"-0":e}}function no(t){return{integerValue:""+t}}function ro(t,e){return ti(e)?no(e):eo(t,e)}var io=function(){this._=void 0};function oo(t,e,n){return t instanceof uo?function(t,e){var n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}}}};return e&&(n.fields.__previous_value__=e),{mapValue:n}}(n,e):t instanceof co?lo(t,e):t instanceof ho?fo(t,e):function(t,e){var n=so(t,e),r=vo(n)+vo(t.A);return li(n)&&li(t.A)?no(r):eo(t.R,r)}(t,e)}function ao(t,e,n){return t instanceof co?lo(t,e):t instanceof ho?fo(t,e):n}function so(t,e){return t instanceof po?li(n=e)||function(t){return!!t&&"doubleValue"in t}(n)?e:{integerValue:0}:null;var n}var uo=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return pr(e,t),e}(io),co=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return pr(e,t),e}(io);function lo(t,e){for(var n=go(e),r=function(t){n.some((function(e){return ri(e,t)}))||n.push(t)},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var ho=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return pr(e,t),e}(io);function fo(t,e){for(var n=go(e),r=function(t){n=n.filter((function(e){return!ri(e,t)}))},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var po=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).R=e,r.A=n,r}return pr(e,t),e}(io);function vo(t){return zr(t.integerValue||t.doubleValue)}function go(t){return hi(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var yo=function(t,e){this.field=t,this.transform=e},mo=function(t,e){this.version=t,this.transformResults=e},bo=function(){function t(t,e){this.updateTime=t,this.exists=e}return t.none=function(){return new t},t.exists=function(e){return new t(void 0,e)},t.updateTime=function(e){return new t(e)},Object.defineProperty(t.prototype,"isNone",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},t}();function _o(t,e){return void 0!==t.updateTime?e.isFoundDocument()&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e.isFoundDocument()}var wo=function(){};function Io(t,e,n){t instanceof ko?function(t,e,n){var r=t.value.clone(),i=Po(t.fieldTransforms,e,n.transformResults);r.setAll(i),e.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(t,e,n):t instanceof Ao?function(t,e,n){if(_o(t.precondition,e)){var r=Po(t.fieldTransforms,e,n.transformResults),i=e.data;i.setAll(No(t)),i.setAll(r),e.convertToFoundDocument(n.version,i).setHasCommittedMutations()}else e.convertToUnknownDocument(n.version)}(t,e,n):function(t,e,n){e.convertToNoDocument(n.version).setHasCommittedMutations()}(0,e,n)}function To(t,e,n){t instanceof ko?function(t,e,n){if(_o(t.precondition,e)){var r=t.value.clone(),i=Oo(t.fieldTransforms,n,e);r.setAll(i),e.convertToFoundDocument(Co(e),r).setHasLocalMutations()}}(t,e,n):t instanceof Ao?function(t,e,n){if(_o(t.precondition,e)){var r=Oo(t.fieldTransforms,n,e),i=e.data;i.setAll(No(t)),i.setAll(r),e.convertToFoundDocument(Co(e),i).setHasLocalMutations()}}(t,e,n):function(t,e){_o(t.precondition,e)&&e.convertToNoDocument(Lr.min())}(t,e)}function Eo(t,e){for(var n=null,r=0,i=t.fieldTransforms;r<i.length;r++){var o=i[r],a=e.data.field(o.field),s=so(o.transform,a||null);null!=s&&(null==n&&(n=vi.empty()),n.set(o.field,s))}return n||null}function So(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(t,e){return void 0===t&&void 0===e||!(!t||!e)&&Rr(t,e,(function(t,e){return function(t,e){return t.field.isEqual(e.field)&&function(t,e){return t instanceof co&&e instanceof co||t instanceof ho&&e instanceof ho?Rr(t.elements,e.elements,ri):t instanceof po&&e instanceof po?ri(t.A,e.A):t instanceof uo&&e instanceof uo}(t.transform,e.transform)}(t,e)}))}(t.fieldTransforms,e.fieldTransforms)&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}function Co(t){return t.isFoundDocument()?t.version:Lr.min()}var ko=function(t){function e(e,n,r,i){void 0===i&&(i=[]);var o=this;return(o=t.call(this)||this).key=e,o.value=n,o.precondition=r,o.fieldTransforms=i,o.type=0,o}return pr(e,t),e}(wo),Ao=function(t){function e(e,n,r,i,o){void 0===o&&(o=[]);var a=this;return(a=t.call(this)||this).key=e,a.data=n,a.fieldMask=r,a.precondition=i,a.fieldTransforms=o,a.type=1,a}return pr(e,t),e}(wo);function No(t){var e=new Map;return t.fieldMask.fields.forEach((function(n){if(!n.isEmpty()){var r=t.data.field(n);e.set(n,r)}})),e}function Po(t,e,n){var r=new Map;kr(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],a=o.transform,s=e.data.field(o.field);r.set(o.field,ao(a,s,n[i]))}return r}function Oo(t,e,n){for(var r=new Map,i=0,o=t;i<o.length;i++){var a=o[i],s=a.transform,u=n.data.field(a.field);r.set(a.field,oo(s,u,e))}return r}var Ro,xo,Do=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.precondition=n,r.type=2,r.fieldTransforms=[],r}return pr(e,t),e}(wo),Lo=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.precondition=n,r.type=3,r.fieldTransforms=[],r}return pr(e,t),e}(wo),Mo=function(t){this.count=t};function Fo(t){switch(t){case mr.OK:return Cr();case mr.CANCELLED:case mr.UNKNOWN:case mr.DEADLINE_EXCEEDED:case mr.RESOURCE_EXHAUSTED:case mr.INTERNAL:case mr.UNAVAILABLE:case mr.UNAUTHENTICATED:return!1;case mr.INVALID_ARGUMENT:case mr.NOT_FOUND:case mr.ALREADY_EXISTS:case mr.PERMISSION_DENIED:case mr.FAILED_PRECONDITION:case mr.ABORTED:case mr.OUT_OF_RANGE:case mr.UNIMPLEMENTED:case mr.DATA_LOSS:return!0;default:return Cr()}}function Uo(t){if(void 0===t)return Tr("GRPC error has no .code"),mr.UNKNOWN;switch(t){case Ro.OK:return mr.OK;case Ro.CANCELLED:return mr.CANCELLED;case Ro.UNKNOWN:return mr.UNKNOWN;case Ro.DEADLINE_EXCEEDED:return mr.DEADLINE_EXCEEDED;case Ro.RESOURCE_EXHAUSTED:return mr.RESOURCE_EXHAUSTED;case Ro.INTERNAL:return mr.INTERNAL;case Ro.UNAVAILABLE:return mr.UNAVAILABLE;case Ro.UNAUTHENTICATED:return mr.UNAUTHENTICATED;case Ro.INVALID_ARGUMENT:return mr.INVALID_ARGUMENT;case Ro.NOT_FOUND:return mr.NOT_FOUND;case Ro.ALREADY_EXISTS:return mr.ALREADY_EXISTS;case Ro.PERMISSION_DENIED:return mr.PERMISSION_DENIED;case Ro.FAILED_PRECONDITION:return mr.FAILED_PRECONDITION;case Ro.ABORTED:return mr.ABORTED;case Ro.OUT_OF_RANGE:return mr.OUT_OF_RANGE;case Ro.UNIMPLEMENTED:return mr.UNIMPLEMENTED;case Ro.DATA_LOSS:return mr.DATA_LOSS;default:return Cr()}}(xo=Ro||(Ro={}))[xo.OK=0]="OK",xo[xo.CANCELLED=1]="CANCELLED",xo[xo.UNKNOWN=2]="UNKNOWN",xo[xo.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",xo[xo.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",xo[xo.NOT_FOUND=5]="NOT_FOUND",xo[xo.ALREADY_EXISTS=6]="ALREADY_EXISTS",xo[xo.PERMISSION_DENIED=7]="PERMISSION_DENIED",xo[xo.UNAUTHENTICATED=16]="UNAUTHENTICATED",xo[xo.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",xo[xo.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",xo[xo.ABORTED=10]="ABORTED",xo[xo.OUT_OF_RANGE=11]="OUT_OF_RANGE",xo[xo.UNIMPLEMENTED=12]="UNIMPLEMENTED",xo[xo.INTERNAL=13]="INTERNAL",xo[xo.UNAVAILABLE=14]="UNAVAILABLE",xo[xo.DATA_LOSS=15]="DATA_LOSS";var jo=function(){function t(t,e){this.comparator=t,this.root=e||Vo.EMPTY}return t.prototype.insert=function(e,n){return new t(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Vo.BLACK,null,null))},t.prototype.remove=function(e){return new t(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Vo.BLACK,null,null))},t.prototype.get=function(t){for(var e=this.root;!e.isEmpty();){var n=this.comparator(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null},t.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.isEmpty();){var r=this.comparator(t,n.key);if(0===r)return e+n.left.size;r<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1},t.prototype.isEmpty=function(){return this.root.isEmpty()},Object.defineProperty(t.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),t.prototype.minKey=function(){return this.root.minKey()},t.prototype.maxKey=function(){return this.root.maxKey()},t.prototype.inorderTraversal=function(t){return this.root.inorderTraversal(t)},t.prototype.forEach=function(t){this.inorderTraversal((function(e,n){return t(e,n),!1}))},t.prototype.toString=function(){var t=[];return this.inorderTraversal((function(e,n){return t.push(e+":"+n),!1})),"{"+t.join(", ")+"}"},t.prototype.reverseTraversal=function(t){return this.root.reverseTraversal(t)},t.prototype.getIterator=function(){return new qo(this.root,null,this.comparator,!1)},t.prototype.getIteratorFrom=function(t){return new qo(this.root,t,this.comparator,!1)},t.prototype.getReverseIterator=function(){return new qo(this.root,null,this.comparator,!0)},t.prototype.getReverseIteratorFrom=function(t){return new qo(this.root,t,this.comparator,!0)},t}(),qo=function(){function t(t,e,n,r){this.isReverse=r,this.nodeStack=[];for(var i=1;!t.isEmpty();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.isReverse?t.left:t.right;else{if(0===i){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}return t.prototype.getNext=function(){var t=this.nodeStack.pop(),e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e},t.prototype.hasNext=function(){return this.nodeStack.length>0},t.prototype.peek=function(){if(0===this.nodeStack.length)return null;var t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}},t}(),Vo=function(){function t(e,n,r,i,o){this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:t.EMPTY,this.right=null!=o?o:t.EMPTY,this.size=this.left.size+1+this.right.size}return t.prototype.copy=function(e,n,r,i,o){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},t.prototype.isEmpty=function(){return!1},t.prototype.inorderTraversal=function(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)},t.prototype.reverseTraversal=function(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)},t.prototype.min=function(){return this.left.isEmpty()?this:this.left.min()},t.prototype.minKey=function(){return this.min().key},t.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},t.prototype.insert=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.insert(t,e,n))).fixUp()},t.prototype.removeMin=function(){if(this.left.isEmpty())return t.EMPTY;var e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),(e=e.copy(null,null,null,e.left.removeMin(),null)).fixUp()},t.prototype.remove=function(e,n){var r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===n(e,i.key)){if(i.right.isEmpty())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()},t.prototype.isRed=function(){return this.color},t.prototype.fixUp=function(){var t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t},t.prototype.moveRedLeft=function(){var t=this.colorFlip();return t.right.left.isRed()&&(t=(t=(t=t.copy(null,null,null,null,t.right.rotateRight())).rotateLeft()).colorFlip()),t},t.prototype.moveRedRight=function(){var t=this.colorFlip();return t.left.left.isRed()&&(t=(t=t.rotateRight()).colorFlip()),t},t.prototype.rotateLeft=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.rotateRight=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.colorFlip=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},t.prototype.checkMaxDepth=function(){var t=this.check();return Math.pow(2,t)<=this.size+1},t.prototype.check=function(){if(this.isRed()&&this.left.isRed())throw Cr();if(this.right.isRed())throw Cr();var t=this.left.check();if(t!==this.right.check())throw Cr();return t+(this.isRed()?0:1)},t}();Vo.EMPTY=null,Vo.RED=!0,Vo.BLACK=!1,Vo.EMPTY=new(function(){function t(){this.size=0}return Object.defineProperty(t.prototype,"key",{get:function(){throw Cr()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){throw Cr()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){throw Cr()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){throw Cr()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){throw Cr()},enumerable:!1,configurable:!0}),t.prototype.copy=function(t,e,n,r,i){return this},t.prototype.insert=function(t,e,n){return new Vo(t,e)},t.prototype.remove=function(t,e){return this},t.prototype.isEmpty=function(){return!0},t.prototype.inorderTraversal=function(t){return!1},t.prototype.reverseTraversal=function(t){return!1},t.prototype.minKey=function(){return null},t.prototype.maxKey=function(){return null},t.prototype.isRed=function(){return!1},t.prototype.checkMaxDepth=function(){return!0},t.prototype.check=function(){return 0},t}());var Bo=function(){function t(t){this.comparator=t,this.data=new jo(this.comparator)}return t.prototype.has=function(t){return null!==this.data.get(t)},t.prototype.first=function(){return this.data.minKey()},t.prototype.last=function(){return this.data.maxKey()},Object.defineProperty(t.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),t.prototype.indexOf=function(t){return this.data.indexOf(t)},t.prototype.forEach=function(t){this.data.inorderTraversal((function(e,n){return t(e),!1}))},t.prototype.forEachInRange=function(t,e){for(var n=this.data.getIteratorFrom(t[0]);n.hasNext();){var r=n.getNext();if(this.comparator(r.key,t[1])>=0)return;e(r.key)}},t.prototype.forEachWhile=function(t,e){var n;for(n=void 0!==e?this.data.getIteratorFrom(e):this.data.getIterator();n.hasNext();)if(!t(n.getNext().key))return},t.prototype.firstAfterOrEqual=function(t){var e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null},t.prototype.getIterator=function(){return new Ko(this.data.getIterator())},t.prototype.getIteratorFrom=function(t){return new Ko(this.data.getIteratorFrom(t))},t.prototype.add=function(t){return this.copy(this.data.remove(t).insert(t,!0))},t.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},t.prototype.isEmpty=function(){return this.data.isEmpty()},t.prototype.unionWith=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach((function(t){e=e.add(t)})),e},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.data.getIterator(),r=e.data.getIterator();n.hasNext();){var i=n.getNext().key,o=r.getNext().key;if(0!==this.comparator(i,o))return!1}return!0},t.prototype.toArray=function(){var t=[];return this.forEach((function(e){t.push(e)})),t},t.prototype.toString=function(){var t=[];return this.forEach((function(e){return t.push(e)})),"SortedSet("+t.toString()+")"},t.prototype.copy=function(e){var n=new t(this.comparator);return n.data=e,n},t}(),Ko=function(){function t(t){this.iter=t}return t.prototype.getNext=function(){return this.iter.getNext().key},t.prototype.hasNext=function(){return this.iter.hasNext()},t}(),Wo=new jo(ei.comparator);function Go(){return Wo}var Ho=new jo(ei.comparator);function zo(){return Ho}var Qo=new jo(ei.comparator);function Yo(){return Qo}var Xo=new Bo(ei.comparator);function Jo(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=Xo,r=0,i=t;r<i.length;r++){var o=i[r];n=n.add(o)}return n}var $o=new Bo(Or);function Zo(){return $o}var ta=function(){function t(t,e,n,r,i){this.snapshotVersion=t,this.targetChanges=e,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}return t.createSynthesizedRemoteEventForCurrentChange=function(e,n){var r=new Map;return r.set(e,ea.createSynthesizedTargetChangeForCurrentChange(e,n)),new t(Lr.min(),r,Zo(),Go(),Jo())},t}(),ea=function(){function t(t,e,n,r,i){this.resumeToken=t,this.current=e,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}return t.createSynthesizedTargetChangeForCurrentChange=function(e,n){return new t(Wr.EMPTY_BYTE_STRING,n,Jo(),Jo(),Jo())},t}(),na=function(t,e,n,r){this.v=t,this.removedTargetIds=e,this.key=n,this.P=r},ra=function(t,e){this.targetId=t,this.V=e},ia=function(t,e,n,r){void 0===n&&(n=Wr.EMPTY_BYTE_STRING),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},oa=function(){function t(){this.S=0,this.D=ua(),this.C=Wr.EMPTY_BYTE_STRING,this.N=!1,this.F=!0}return Object.defineProperty(t.prototype,"current",{get:function(){return this.N},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"resumeToken",{get:function(){return this.C},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"k",{get:function(){return 0!==this.S},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"O",{get:function(){return this.F},enumerable:!1,configurable:!0}),t.prototype.$=function(t){t.approximateByteSize()>0&&(this.F=!0,this.C=t)},t.prototype.M=function(){var t=Jo(),e=Jo(),n=Jo();return this.D.forEach((function(r,i){switch(i){case 0:t=t.add(r);break;case 2:e=e.add(r);break;case 1:n=n.add(r);break;default:Cr()}})),new ea(this.C,this.N,t,e,n)},t.prototype.L=function(){this.F=!1,this.D=ua()},t.prototype.B=function(t,e){this.F=!0,this.D=this.D.insert(t,e)},t.prototype.q=function(t){this.F=!0,this.D=this.D.remove(t)},t.prototype.U=function(){this.S+=1},t.prototype.K=function(){this.S-=1},t.prototype.j=function(){this.F=!0,this.N=!0},t}(),aa=function(){function t(t){this.W=t,this.G=new Map,this.H=Go(),this.J=sa(),this.Y=new Bo(Or)}return t.prototype.X=function(t){for(var e=0,n=t.v;e<n.length;e++){var r=n[e];t.P&&t.P.isFoundDocument()?this.Z(r,t.P):this.tt(r,t.key,t.P)}for(var i=0,o=t.removedTargetIds;i<o.length;i++)r=o[i],this.tt(r,t.key,t.P)},t.prototype.et=function(t){var e=this;this.forEachTarget(t,(function(n){var r=e.nt(n);switch(t.state){case 0:e.st(n)&&r.$(t.resumeToken);break;case 1:r.K(),r.k||r.L(),r.$(t.resumeToken);break;case 2:r.K(),r.k||e.removeTarget(n);break;case 3:e.st(n)&&(r.j(),r.$(t.resumeToken));break;case 4:e.st(n)&&(e.it(n),r.$(t.resumeToken));break;default:Cr()}}))},t.prototype.forEachTarget=function(t,e){var n=this;t.targetIds.length>0?t.targetIds.forEach(e):this.G.forEach((function(t,r){n.st(r)&&e(r)}))},t.prototype.rt=function(t){var e=t.targetId,n=t.V.count,r=this.ot(e);if(r){var i=r.target;if(Ii(i))if(0===n){var o=new ei(i.path);this.tt(e,o,yi.newNoDocument(o,Lr.min()))}else kr(1===n);else this.ct(e)!==n&&(this.it(e),this.Y=this.Y.add(e))}},t.prototype.at=function(t){var e=this,n=new Map;this.G.forEach((function(r,i){var o=e.ot(i);if(o){if(r.current&&Ii(o.target)){var a=new ei(o.target.path);null!==e.H.get(a)||e.ut(i,a)||e.tt(i,a,yi.newNoDocument(a,t))}r.O&&(n.set(i,r.M()),r.L())}}));var r=Jo();this.J.forEach((function(t,n){var i=!0;n.forEachWhile((function(t){var n=e.ot(t);return!n||2===n.purpose||(i=!1,!1)})),i&&(r=r.add(t))}));var i=new ta(t,n,this.Y,this.H,r);return this.H=Go(),this.J=sa(),this.Y=new Bo(Or),i},t.prototype.Z=function(t,e){if(this.st(t)){var n=this.ut(t,e.key)?2:0;this.nt(t).B(e.key,n),this.H=this.H.insert(e.key,e),this.J=this.J.insert(e.key,this.ht(e.key).add(t))}},t.prototype.tt=function(t,e,n){if(this.st(t)){var r=this.nt(t);this.ut(t,e)?r.B(e,1):r.q(e),this.J=this.J.insert(e,this.ht(e).delete(t)),n&&(this.H=this.H.insert(e,n))}},t.prototype.removeTarget=function(t){this.G.delete(t)},t.prototype.ct=function(t){var e=this.nt(t).M();return this.W.getRemoteKeysForTarget(t).size+e.addedDocuments.size-e.removedDocuments.size},t.prototype.U=function(t){this.nt(t).U()},t.prototype.nt=function(t){var e=this.G.get(t);return e||(e=new oa,this.G.set(t,e)),e},t.prototype.ht=function(t){var e=this.J.get(t);return e||(e=new Bo(Or),this.J=this.J.insert(t,e)),e},t.prototype.st=function(t){var e=null!==this.ot(t);return e||Ir("WatchChangeAggregator","Detected inactive target",t),e},t.prototype.ot=function(t){var e=this.G.get(t);return e&&e.k?null:this.W.lt(t)},t.prototype.it=function(t){var e=this;this.G.set(t,new oa),this.W.getRemoteKeysForTarget(t).forEach((function(n){e.tt(t,n,null)}))},t.prototype.ut=function(t,e){return this.W.getRemoteKeysForTarget(t).has(e)},t}();function sa(){return new jo(ei.comparator)}function ua(){return new jo(ei.comparator)}var ca={asc:"ASCENDING",desc:"DESCENDING"},la={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},ha=function(t,e){this.databaseId=t,this.I=e};function fa(t,e){return t.I?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function pa(t,e){return t.I?e.toBase64():e.toUint8Array()}function da(t,e){return fa(t,e.toTimestamp())}function va(t){return kr(!!t),Lr.fromTimestamp(function(t){var e=Hr(t);return new Dr(e.seconds,e.nanos)}(t))}function ga(t,e){return function(t){return new qr(["projects",t.projectId,"databases",t.database])}(t).child("documents").child(e).canonicalString()}function ya(t){var e=qr.fromString(t);return kr(Va(e)),e}function ma(t,e){return ga(t.databaseId,e.path)}function ba(t,e){var n=ya(e);if(n.get(1)!==t.databaseId.projectId)throw new br(mr.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new br(mr.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new ei(Ta(n))}function _a(t,e){return ga(t.databaseId,e)}function wa(t){var e=ya(t);return 4===e.length?qr.emptyPath():Ta(e)}function Ia(t){return new qr(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function Ta(t){return kr(t.length>4&&"documents"===t.get(4)),t.popFirst(5)}function Ea(t,e,n){return{name:ma(t,e),fields:n.toProto().mapValue.fields}}function Sa(t,e,n){var r=ba(t,e.name),i=va(e.updateTime),o=new vi({mapValue:{fields:e.fields}}),a=yi.newFoundDocument(r,i,o);return n&&a.setHasCommittedMutations(),n?a.setHasCommittedMutations():a}function Ca(t,e){var n;if(e instanceof ko)n={update:Ea(t,e.key,e.value)};else if(e instanceof Do)n={delete:ma(t,e.key)};else if(e instanceof Ao)n={update:Ea(t,e.key,e.data),updateMask:qa(e.fieldMask)};else{if(!(e instanceof Lo))return Cr();n={verify:ma(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map((function(t){return function(t,e){var n=e.transform;if(n instanceof uo)return{fieldPath:e.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof co)return{fieldPath:e.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof ho)return{fieldPath:e.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof po)return{fieldPath:e.field.canonicalString(),increment:n.A};throw Cr()}(0,t)}))),e.precondition.isNone||(n.currentDocument=function(t,e){return void 0!==e.updateTime?{updateTime:da(t,e.updateTime)}:void 0!==e.exists?{exists:e.exists}:Cr()}(t,e.precondition)),n}function ka(t,e){var n=e.currentDocument?function(t){return void 0!==t.updateTime?bo.updateTime(va(t.updateTime)):void 0!==t.exists?bo.exists(t.exists):bo.none()}(e.currentDocument):bo.none(),r=e.updateTransforms?e.updateTransforms.map((function(e){return function(t,e){var n=null;if("setToServerValue"in e)kr("REQUEST_TIME"===e.setToServerValue),n=new uo;else if("appendMissingElements"in e){var r=e.appendMissingElements.values||[];n=new co(r)}else if("removeAllFromArray"in e){var i=e.removeAllFromArray.values||[];n=new ho(i)}else"increment"in e?n=new po(t,e.increment):Cr();var o=Br.fromServerFormat(e.fieldPath);return new yo(o,n)}(t,e)})):[];if(e.update){e.update.name;var i=ba(t,e.update.name),o=new vi({mapValue:{fields:e.update.fields}});if(e.updateMask){var a=function(t){var e=t.fieldPaths||[];return new Kr(e.map((function(t){return Br.fromServerFormat(t)})))}(e.updateMask);return new Ao(i,o,a,n,r)}return new ko(i,o,n,r)}if(e.delete){var s=ba(t,e.delete);return new Do(s,n)}if(e.verify){var u=ba(t,e.verify);return new Lo(u,n)}return Cr()}function Aa(t,e){return{documents:[_a(t,e.path)]}}function Na(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=_a(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=_a(t,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);var i=function(t){if(0!==t.length){var e=t.map((function(t){return function(t){if("=="===t.op){if(pi(t.value))return{unaryFilter:{field:Ma(t.field),op:"IS_NAN"}};if(fi(t.value))return{unaryFilter:{field:Ma(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(pi(t.value))return{unaryFilter:{field:Ma(t.field),op:"IS_NOT_NAN"}};if(fi(t.value))return{unaryFilter:{field:Ma(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ma(t.field),op:La(t.op),value:t.value}}}(t)}));return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}}(e.filters);i&&(n.structuredQuery.where=i);var o=function(t){if(0!==t.length)return t.map((function(t){return function(t){return{field:Ma(t.field),direction:Da(t.dir)}}(t)}))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);var a=function(t,e){return t.I||$r(e)?e:{value:e}}(t,e.limit);return null!==a&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=Ra(e.startAt)),e.endAt&&(n.structuredQuery.endAt=Ra(e.endAt)),n}function Pa(t){var e=wa(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){kr(1===r);var o=n.from[0];o.allDescendants?i=o.collectionId:e=e.child(o.collectionId)}var a=[];n.where&&(a=Oa(n.where));var s=[];n.orderBy&&(s=n.orderBy.map((function(t){return function(t){return new Di(Fa(t.field),function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction))}(t)})));var u=null;n.limit&&(u=function(t){var e;return $r(e="object"==typeof t?t.value:t)?null:e}(n.limit));var c=null;n.startAt&&(c=xa(n.startAt));var l=null;return n.endAt&&(l=xa(n.endAt)),ji(e,i,s,a,u,"F",c,l)}function Oa(t){return t?void 0!==t.unaryFilter?[ja(t)]:void 0!==t.fieldFilter?[Ua(t)]:void 0!==t.compositeFilter?t.compositeFilter.filters.map((function(t){return Oa(t)})).reduce((function(t,e){return t.concat(e)})):Cr():[]}function Ra(t){return{before:t.before,values:t.position}}function xa(t){var e=!!t.before,n=t.values||[];return new Ri(n,e)}function Da(t){return ca[t]}function La(t){return la[t]}function Ma(t){return{fieldPath:t.canonicalString()}}function Fa(t){return Br.fromServerFormat(t.fieldPath)}function Ua(t){return Ti.create(Fa(t.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return Cr()}}(t.fieldFilter.op),t.fieldFilter.value)}function ja(t){switch(t.unaryFilter.op){case"IS_NAN":var e=Fa(t.unaryFilter.field);return Ti.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=Fa(t.unaryFilter.field);return Ti.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var r=Fa(t.unaryFilter.field);return Ti.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":var i=Fa(t.unaryFilter.field);return Ti.create(i,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return Cr()}}function qa(t){var e=[];return t.fields.forEach((function(t){return e.push(t.canonicalString())})),{fieldPaths:e}}function Va(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}function Ba(t){for(var e="",n=0;n<t.length;n++)e.length>0&&(e=Wa(e)),e=Ka(t.get(n),e);return Wa(e)}function Ka(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+="";break;case"":n+="";break;default:n+=o}}return n}function Wa(t){return t+""}function Ga(t){var e=t.length;if(kr(e>=2),2===e)return kr(""===t.charAt(0)&&""===t.charAt(1)),qr.emptyPath();for(var n=e-2,r=[],i="",o=0;o<e;){var a=t.indexOf("",o);switch((a<0||a>n)&&Cr(),t.charAt(a+1)){case"":var s=t.substring(o,a),u=void 0;0===i.length?u=s:(u=i+=s,i=""),r.push(u);break;case"":i+=t.substring(o,a),i+="\0";break;case"":i+=t.substring(o,a+1);break;default:Cr()}o=a+2}return new qr(r)}var Ha=function(t,e){this.seconds=t,this.nanoseconds=e},za=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};za.store="owner",za.key="owner";var Qa=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};Qa.store="mutationQueues",Qa.keyPath="userId";var Ya=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};Ya.store="mutations",Ya.keyPath="batchId",Ya.userMutationsIndex="userMutationsIndex",Ya.userMutationsKeyPath=["userId","batchId"];var Xa=function(){function t(){}return t.prefixForUser=function(t){return[t]},t.prefixForPath=function(t,e){return[t,Ba(e)]},t.key=function(t,e,n){return[t,Ba(e),n]},t}();Xa.store="documentMutations",Xa.PLACEHOLDER=new Xa;var Ja=function(t,e){this.path=t,this.readTime=e},$a=function(t,e){this.path=t,this.version=e},Za=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};Za.store="remoteDocuments",Za.readTimeIndex="readTimeIndex",Za.readTimeIndexPath="readTime",Za.collectionReadTimeIndex="collectionReadTimeIndex",Za.collectionReadTimeIndexPath=["parentPath","readTime"];var ts=function(t){this.byteSize=t};ts.store="remoteDocumentGlobal",ts.key="remoteDocumentGlobalKey";var es=function(t,e,n,r,i,o,a){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=a};es.store="targets",es.keyPath="targetId",es.queryTargetsIndexName="queryTargetsIndex",es.queryTargetsKeyPath=["canonicalId","targetId"];var ns=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};ns.store="targetDocuments",ns.keyPath=["targetId","path"],ns.documentTargetsIndex="documentTargetsIndex",ns.documentTargetsKeyPath=["path","targetId"];var rs=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};rs.key="targetGlobalKey",rs.store="targetGlobal";var is=function(t,e){this.collectionId=t,this.parent=e};is.store="collectionParents",is.keyPath=["collectionId","parent"];var os=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};os.store="clientMetadata",os.keyPath="clientId";var as=function(t,e,n){this.bundleId=t,this.createTime=e,this.version=n};as.store="bundles",as.keyPath="bundleId";var ss=function(t,e,n){this.name=t,this.readTime=e,this.bundledQuery=n};ss.store="namedQueries",ss.keyPath="name";var us=gr(gr([],gr(gr([],gr(gr([],gr(gr([],[Qa.store,Ya.store,Xa.store,Za.store,es.store,za.store,rs.store,ns.store]),[os.store])),[ts.store])),[is.store])),[as.store,ss.store]),cs="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",ls=function(){function t(){this.onCommittedListeners=[]}return t.prototype.addOnCommittedListener=function(t){this.onCommittedListeners.push(t)},t.prototype.raiseOnCommittedEvent=function(){this.onCommittedListeners.forEach((function(t){return t()}))},t}(),hs=function(){var t=this;this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))},fs=function(){function t(t){var e=this;this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t((function(t){e.isDone=!0,e.result=t,e.nextCallback&&e.nextCallback(t)}),(function(t){e.isDone=!0,e.error=t,e.catchCallback&&e.catchCallback(t)}))}return t.prototype.catch=function(t){return this.next(void 0,t)},t.prototype.next=function(e,n){var r=this;return this.callbackAttached&&Cr(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new t((function(t,i){r.nextCallback=function(n){r.wrapSuccess(e,n).next(t,i)},r.catchCallback=function(e){r.wrapFailure(n,e).next(t,i)}}))},t.prototype.toPromise=function(){var t=this;return new Promise((function(e,n){t.next(e,n)}))},t.prototype.wrapUserFunction=function(e){try{var n=e();return n instanceof t?n:t.resolve(n)}catch(e){return t.reject(e)}},t.prototype.wrapSuccess=function(e,n){return e?this.wrapUserFunction((function(){return e(n)})):t.resolve(n)},t.prototype.wrapFailure=function(e,n){return e?this.wrapUserFunction((function(){return e(n)})):t.reject(n)},t.resolve=function(e){return new t((function(t,n){t(e)}))},t.reject=function(e){return new t((function(t,n){n(e)}))},t.waitFor=function(e){return new t((function(t,n){var r=0,i=0,o=!1;e.forEach((function(e){++r,e.next((function(){++i,o&&i===r&&t()}),(function(t){return n(t)}))})),o=!0,i===r&&t()}))},t.or=function(e){for(var n=t.resolve(!1),r=function(e){n=n.next((function(n){return n?t.resolve(n):e()}))},i=0,o=e;i<o.length;i++)r(o[i]);return n},t.forEach=function(t,e){var n=this,r=[];return t.forEach((function(t,i){r.push(e.call(n,t,i))})),this.waitFor(r)},t}(),ps=function(){function t(t,e){var n=this;this.action=t,this.transaction=e,this.aborted=!1,this.ft=new hs,this.transaction.oncomplete=function(){n.ft.resolve()},this.transaction.onabort=function(){e.error?n.ft.reject(new gs(t,e.error)):n.ft.resolve()},this.transaction.onerror=function(e){var r=ws(e.target.error);n.ft.reject(new gs(t,r))}}return t.open=function(e,n,r,i){try{return new t(n,e.transaction(i,r))}catch(e){throw new gs(n,e)}},Object.defineProperty(t.prototype,"dt",{get:function(){return this.ft.promise},enumerable:!1,configurable:!0}),t.prototype.abort=function(t){t&&this.ft.reject(t),this.aborted||(Ir("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},t.prototype.store=function(t){var e=this.transaction.objectStore(t);return new ms(e)},t}(),ds=function(){function t(e,n,r){this.name=e,this.version=n,this.wt=r,12.2===t._t((0,i.getUA)())&&Tr("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}return t.delete=function(t){return Ir("SimpleDb","Removing database:",t),bs(window.indexedDB.deleteDatabase(t)).toPromise()},t.yt=function(){if("undefined"==typeof indexedDB)return!1;if(t.gt())return!0;var e=(0,i.getUA)(),n=t._t(e),r=0<n&&n<10,o=t.Et(e),a=0<o&&o<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||a)},t.gt=function(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.env)||void 0===t?void 0:t.Tt)},t.It=function(t,e){return t.store(e)},t._t=function(t){var e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)},t.Et=function(t){var e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)},t.prototype.At=function(t){return dr(this,void 0,void 0,(function(){var e,n=this;return vr(this,(function(r){switch(r.label){case 0:return this.db?[3,2]:(Ir("SimpleDb","Opening database:",this.name),e=this,[4,new Promise((function(e,r){var i=indexedDB.open(n.name,n.version);i.onsuccess=function(t){var n=t.target.result;e(n)},i.onblocked=function(){r(new gs(t,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=function(e){var n=e.target.error;"VersionError"===n.name?r(new br(mr.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):r(new gs(t,n))},i.onupgradeneeded=function(t){Ir("SimpleDb",'Database "'+n.name+'" requires upgrade from version:',t.oldVersion);var e=t.target.result;n.wt.Rt(e,i.transaction,t.oldVersion,n.version).next((function(){Ir("SimpleDb","Database upgrade to version "+n.version+" complete")}))}}))]);case 1:e.db=r.sent(),r.label=2;case 2:return[2,(this.bt&&(this.db.onversionchange=function(t){return n.bt(t)}),this.db)]}}))}))},t.prototype.vt=function(t){this.bt=t,this.db&&(this.db.onversionchange=function(e){return t(e)})},t.prototype.runTransaction=function(t,e,n,r){return dr(this,void 0,void 0,(function(){var i,o,a,s,u;return vr(this,(function(c){switch(c.label){case 0:i="readonly"===e,o=0,a=function(){var e,a,u,c,l;return vr(this,(function(h){switch(h.label){case 0:++o,h.label=1;case 1:return h.trys.push([1,4,,5]),[4,s.At(t)];case 2:return s.db=h.sent(),e=ps.open(s.db,t,i?"readonly":"readwrite",n),a=r(e).catch((function(t){return e.abort(t),fs.reject(t)})).toPromise(),u={},a.catch((function(){})),[4,e.dt];case 3:return[2,(u.value=(h.sent(),a),u)];case 4:return c=h.sent(),l="FirebaseError"!==c.name&&o<3,Ir("SimpleDb","Transaction failed with error:",c.message,"Retrying:",l),s.close(),l?[3,5]:[2,{value:Promise.reject(c)}];case 5:return[2]}}))},s=this,c.label=1;case 1:return[5,a()];case 2:if("object"==typeof(u=c.sent()))return[2,u.value];c.label=3;case 3:return[3,1];case 4:return[2]}}))}))},t.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},t}(),vs=function(){function t(t){this.Pt=t,this.Vt=!1,this.St=null}return Object.defineProperty(t.prototype,"isDone",{get:function(){return this.Vt},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Dt",{get:function(){return this.St},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cursor",{set:function(t){this.Pt=t},enumerable:!1,configurable:!0}),t.prototype.done=function(){this.Vt=!0},t.prototype.Ct=function(t){this.St=t},t.prototype.delete=function(){return bs(this.Pt.delete())},t}(),gs=function(t){function e(e,n){var r=this;return(r=t.call(this,mr.UNAVAILABLE,"IndexedDB transaction '"+e+"' failed: "+n)||this).name="IndexedDbTransactionError",r}return pr(e,t),e}(br);function ys(t){return"IndexedDbTransactionError"===t.name}var ms=function(){function t(t){this.store=t}return t.prototype.put=function(t,e){var n;return void 0!==e?(Ir("SimpleDb","PUT",this.store.name,t,e),n=this.store.put(e,t)):(Ir("SimpleDb","PUT",this.store.name,"<auto-key>",t),n=this.store.put(t)),bs(n)},t.prototype.add=function(t){return Ir("SimpleDb","ADD",this.store.name,t,t),bs(this.store.add(t))},t.prototype.get=function(t){var e=this;return bs(this.store.get(t)).next((function(n){return void 0===n&&(n=null),Ir("SimpleDb","GET",e.store.name,t,n),n}))},t.prototype.delete=function(t){return Ir("SimpleDb","DELETE",this.store.name,t),bs(this.store.delete(t))},t.prototype.count=function(){return Ir("SimpleDb","COUNT",this.store.name),bs(this.store.count())},t.prototype.Nt=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.xt(n,(function(t,e){r.push(e)})).next((function(){return r}))},t.prototype.Ft=function(t,e){Ir("SimpleDb","DELETE ALL",this.store.name);var n=this.options(t,e);n.kt=!1;var r=this.cursor(n);return this.xt(r,(function(t,e,n){return n.delete()}))},t.prototype.Ot=function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.xt(r,e)},t.prototype.$t=function(t){var e=this.cursor({});return new fs((function(n,r){e.onerror=function(t){var e=ws(t.target.error);r(e)},e.onsuccess=function(e){var r=e.target.result;r?t(r.primaryKey,r.value).next((function(t){t?r.continue():n()})):n()}}))},t.prototype.xt=function(t,e){var n=[];return new fs((function(r,i){t.onerror=function(t){i(t.target.error)},t.onsuccess=function(t){var i=t.target.result;if(i){var o=new vs(i),a=e(i.primaryKey,i.value,o);if(a instanceof fs){var s=a.catch((function(t){return o.done(),fs.reject(t)}));n.push(s)}o.isDone?r():null===o.Dt?i.continue():i.continue(o.Dt)}else r()}})).next((function(){return fs.waitFor(n)}))},t.prototype.options=function(t,e){var n;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},t.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.kt?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},t}();function bs(t){return new fs((function(e,n){t.onsuccess=function(t){var n=t.target.result;e(n)},t.onerror=function(t){var e=ws(t.target.error);n(e)}}))}var _s=!1;function ws(t){var e=ds._t((0,i.getUA)());if(e>=12.2&&e<13){var n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){var r=new br("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+n+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return _s||(_s=!0,setTimeout((function(){throw r}),0)),r}}return t}var Is=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Mt=e,r.currentSequenceNumber=n,r}return pr(e,t),e}(ls);function Ts(t,e){var n=Ar(t);return ds.It(n.Mt,e)}var Es=function(){function t(t,e,n,r){this.batchId=t,this.localWriteTime=e,this.baseMutations=n,this.mutations=r}return t.prototype.applyToRemoteDocument=function(t,e){for(var n=e.mutationResults,r=0;r<this.mutations.length;r++){var i=this.mutations[r];i.key.isEqual(t.key)&&Io(i,t,n[r])}},t.prototype.applyToLocalView=function(t){for(var e=0,n=this.baseMutations;e<n.length;e++)(o=n[e]).key.isEqual(t.key)&&To(o,t,this.localWriteTime);for(var r=0,i=this.mutations;r<i.length;r++){var o;(o=i[r]).key.isEqual(t.key)&&To(o,t,this.localWriteTime)}},t.prototype.applyToLocalDocumentSet=function(t){var e=this;this.mutations.forEach((function(n){var r=t.get(n.key),i=r;e.applyToLocalView(i),r.isValidDocument()||i.convertToNoDocument(Lr.min())}))},t.prototype.keys=function(){return this.mutations.reduce((function(t,e){return t.add(e.key)}),Jo())},t.prototype.isEqual=function(t){return this.batchId===t.batchId&&Rr(this.mutations,t.mutations,(function(t,e){return So(t,e)}))&&Rr(this.baseMutations,t.baseMutations,(function(t,e){return So(t,e)}))},t}(),Ss=function(){function t(t,e,n,r){this.batch=t,this.commitVersion=e,this.mutationResults=n,this.docVersions=r}return t.from=function(e,n,r){kr(e.mutations.length===r.length);for(var i=Yo(),o=e.mutations,a=0;a<o.length;a++)i=i.insert(o[a].key,r[a].version);return new t(e,n,r,i)},t}(),Cs=function(){function t(t,e,n,r,i,o,a){void 0===i&&(i=Lr.min()),void 0===o&&(o=Lr.min()),void 0===a&&(a=Wr.EMPTY_BYTE_STRING),this.target=t,this.targetId=e,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a}return t.prototype.withSequenceNumber=function(e){return new t(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)},t.prototype.withResumeToken=function(e,n){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e)},t.prototype.withLastLimboFreeSnapshotVersion=function(e){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken)},t}(),ks=function(t){this.Lt=t};function As(t,e){if(e.document)return Sa(t.Lt,e.document,!!e.hasCommittedMutations);if(e.noDocument){var n=ei.fromSegments(e.noDocument.path),r=xs(e.noDocument.readTime),i=yi.newNoDocument(n,r);return e.hasCommittedMutations?i.setHasCommittedMutations():i}if(e.unknownDocument){var o=ei.fromSegments(e.unknownDocument.path);return r=xs(e.unknownDocument.version),yi.newUnknownDocument(o,r)}return Cr()}function Ns(t,e,n){var r=Ps(n),i=e.key.path.popLast().toArray();if(e.isFoundDocument()){var o=function(t,e){return{name:ma(t,e.key),fields:e.data.toProto().mapValue.fields,updateTime:fa(t,e.version.toTimestamp())}}(t.Lt,e),a=e.hasCommittedMutations;return new Za(null,null,o,a,r,i)}if(e.isNoDocument()){var s=e.key.path.toArray(),u=Rs(e.version);return a=e.hasCommittedMutations,new Za(null,new Ja(s,u),null,a,r,i)}if(e.isUnknownDocument()){var c=e.key.path.toArray(),l=Rs(e.version);return new Za(new $a(c,l),null,null,!0,r,i)}return Cr()}function Ps(t){var e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function Os(t){var e=new Dr(t[0],t[1]);return Lr.fromTimestamp(e)}function Rs(t){var e=t.toTimestamp();return new Ha(e.seconds,e.nanoseconds)}function xs(t){var e=new Dr(t.seconds,t.nanoseconds);return Lr.fromTimestamp(e)}function Ds(t,e){for(var n=(e.baseMutations||[]).map((function(e){return ka(t.Lt,e)})),r=0;r<e.mutations.length-1;++r){var i=e.mutations[r];if(r+1<e.mutations.length&&void 0!==e.mutations[r+1].transform){var o=e.mutations[r+1];i.updateTransforms=o.transform.fieldTransforms,e.mutations.splice(r+1,1),++r}}var a=e.mutations.map((function(e){return ka(t.Lt,e)})),s=Dr.fromMillis(e.localWriteTimeMs);return new Es(e.batchId,s,n,a)}function Ls(t){var e,n,r=xs(t.readTime),i=void 0!==t.lastLimboFreeSnapshotVersion?xs(t.lastLimboFreeSnapshotVersion):Lr.min();return void 0!==t.query.documents?(kr(1===(n=t.query).documents.length),e=zi(qi(wa(n.documents[0])))):e=function(t){return zi(Pa(t))}(t.query),new Cs(e,t.targetId,0,t.lastListenSequenceNumber,r,i,Wr.fromBase64String(t.resumeToken))}function Ms(t,e){var n,r=Rs(e.snapshotVersion),i=Rs(e.lastLimboFreeSnapshotVersion);n=Ii(e.target)?Aa(t.Lt,e.target):Na(t.Lt,e.target);var o=e.resumeToken.toBase64();return new es(e.targetId,_i(e.target),r,o,e.sequenceNumber,i,n)}function Fs(t){var e=Pa({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?Qi(e,e.limit,"L"):e}var Us=function(){function t(){}return t.prototype.getBundleMetadata=function(t,e){return js(t).get(e).next((function(t){if(t)return{id:(e=t).bundleId,createTime:xs(e.createTime),version:e.version};var e}))},t.prototype.saveBundleMetadata=function(t,e){return js(t).put({bundleId:(n=e).id,createTime:Rs(va(n.createTime)),version:n.version});var n},t.prototype.getNamedQuery=function(t,e){return qs(t).get(e).next((function(t){if(t)return{name:(e=t).name,query:Fs(e.bundledQuery),readTime:xs(e.readTime)};var e}))},t.prototype.saveNamedQuery=function(t,e){return qs(t).put(function(t){return{name:t.name,readTime:Rs(va(t.readTime)),bundledQuery:t.bundledQuery}}(e))},t}();function js(t){return Ts(t,as.store)}function qs(t){return Ts(t,ss.store)}var Vs=function(){function t(){this.Bt=new Bs}return t.prototype.addToCollectionParentIndex=function(t,e){return this.Bt.add(e),fs.resolve()},t.prototype.getCollectionParents=function(t,e){return fs.resolve(this.Bt.getEntries(e))},t}(),Bs=function(){function t(){this.index={}}return t.prototype.add=function(t){var e=t.lastSegment(),n=t.popLast(),r=this.index[e]||new Bo(qr.comparator),i=!r.has(n);return this.index[e]=r.add(n),i},t.prototype.has=function(t){var e=t.lastSegment(),n=t.popLast(),r=this.index[e];return r&&r.has(n)},t.prototype.getEntries=function(t){return(this.index[t]||new Bo(qr.comparator)).toArray()},t}(),Ks=function(){function t(){this.qt=new Bs}return t.prototype.addToCollectionParentIndex=function(t,e){var n=this;if(!this.qt.has(e)){var r=e.lastSegment(),i=e.popLast();t.addOnCommittedListener((function(){n.qt.add(e)}));var o={collectionId:r,parent:Ba(i)};return Ws(t).put(o)}return fs.resolve()},t.prototype.getCollectionParents=function(t,e){var n=[],r=IDBKeyRange.bound([e,""],[xr(e),""],!1,!0);return Ws(t).Nt(r).next((function(t){for(var r=0,i=t;r<i.length;r++){var o=i[r];if(o.collectionId!==e)break;n.push(Ga(o.parent))}return n}))},t}();function Ws(t){return Ts(t,is.store)}var Gs={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Hs=function(){function t(t,e,n){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=n}return t.withCacheSize=function(e){return new t(e,t.DEFAULT_COLLECTION_PERCENTILE,t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)},t}();function zs(t,e,n){var r=t.store(Ya.store),i=t.store(Xa.store),o=[],a=IDBKeyRange.only(n.batchId),s=0,u=r.Ot({range:a},(function(t,e,n){return s++,n.delete()}));o.push(u.next((function(){kr(1===s)})));for(var c=[],l=0,h=n.mutations;l<h.length;l++){var f=h[l],p=Xa.key(e,f.key.path,n.batchId);o.push(i.delete(p)),c.push(f.key)}return fs.waitFor(o).next((function(){return c}))}function Qs(t){if(!t)return 0;var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw Cr();e=t.noDocument}return JSON.stringify(e).length}Hs.DEFAULT_COLLECTION_PERCENTILE=10,Hs.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Hs.DEFAULT=new Hs(41943040,Hs.DEFAULT_COLLECTION_PERCENTILE,Hs.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Hs.DISABLED=new Hs(-1,0,0);var Ys=function(){function t(t,e,n,r){this.userId=t,this.R=e,this.Ut=n,this.referenceDelegate=r,this.Qt={}}return t.Kt=function(e,n,r,i){return kr(""!==e.uid),new t(e.isAuthenticated()?e.uid:"",n,r,i)},t.prototype.checkEmpty=function(t){var e=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Js(t).Ot({index:Ya.userMutationsIndex,range:n},(function(t,n,r){e=!1,r.done()})).next((function(){return e}))},t.prototype.addMutationBatch=function(t,e,n,r){var i=this,o=$s(t),a=Js(t);return a.add({}).next((function(s){kr("number"==typeof s);for(var u=new Es(s,e,n,r),c=function(t,e,n){var r=n.baseMutations.map((function(e){return Ca(t.Lt,e)})),i=n.mutations.map((function(e){return Ca(t.Lt,e)}));return new Ya(e,n.batchId,n.localWriteTime.toMillis(),r,i)}(i.R,i.userId,u),l=[],h=new Bo((function(t,e){return Or(t.canonicalString(),e.canonicalString())})),f=0,p=r;f<p.length;f++){var d=p[f],v=Xa.key(i.userId,d.key.path,s);h=h.add(d.key.path.popLast()),l.push(a.put(c)),l.push(o.put(v,Xa.PLACEHOLDER))}return h.forEach((function(e){l.push(i.Ut.addToCollectionParentIndex(t,e))})),t.addOnCommittedListener((function(){i.Qt[s]=u.keys()})),fs.waitFor(l).next((function(){return u}))}))},t.prototype.lookupMutationBatch=function(t,e){var n=this;return Js(t).get(e).next((function(t){return t?(kr(t.userId===n.userId),Ds(n.R,t)):null}))},t.prototype.jt=function(t,e){var n=this;return this.Qt[e]?fs.resolve(this.Qt[e]):this.lookupMutationBatch(t,e).next((function(t){if(t){var r=t.keys();return n.Qt[e]=r,r}return null}))},t.prototype.getNextMutationBatchAfterBatchId=function(t,e){var n=this,r=e+1,i=IDBKeyRange.lowerBound([this.userId,r]),o=null;return Js(t).Ot({index:Ya.userMutationsIndex,range:i},(function(t,e,i){e.userId===n.userId&&(kr(e.batchId>=r),o=Ds(n.R,e)),i.done()})).next((function(){return o}))},t.prototype.getHighestUnacknowledgedBatchId=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=-1;return Js(t).Ot({index:Ya.userMutationsIndex,range:e,reverse:!0},(function(t,e,r){n=e.batchId,r.done()})).next((function(){return n}))},t.prototype.getAllMutationBatches=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Js(t).Nt(Ya.userMutationsIndex,n).next((function(t){return t.map((function(t){return Ds(e.R,t)}))}))},t.prototype.getAllMutationBatchesAffectingDocumentKey=function(t,e){var n=this,r=Xa.prefixForPath(this.userId,e.path),i=IDBKeyRange.lowerBound(r),o=[];return $s(t).Ot({range:i},(function(r,i,a){var s=r[0],u=r[1],c=r[2],l=Ga(u);if(s===n.userId&&e.path.isEqual(l))return Js(t).get(c).next((function(t){if(!t)throw Cr();kr(t.userId===n.userId),o.push(Ds(n.R,t))}));a.done()})).next((function(){return o}))},t.prototype.getAllMutationBatchesAffectingDocumentKeys=function(t,e){var n=this,r=new Bo(Or),i=[];return e.forEach((function(e){var o=Xa.prefixForPath(n.userId,e.path),a=IDBKeyRange.lowerBound(o),s=$s(t).Ot({range:a},(function(t,i,o){var a=t[0],s=t[1],u=t[2],c=Ga(s);a===n.userId&&e.path.isEqual(c)?r=r.add(u):o.done()}));i.push(s)})),fs.waitFor(i).next((function(){return n.Wt(t,r)}))},t.prototype.getAllMutationBatchesAffectingQuery=function(t,e){var n=this,r=e.path,i=r.length+1,o=Xa.prefixForPath(this.userId,r),a=IDBKeyRange.lowerBound(o),s=new Bo(Or);return $s(t).Ot({range:a},(function(t,e,o){var a=t[0],u=t[1],c=t[2],l=Ga(u);a===n.userId&&r.isPrefixOf(l)?l.length===i&&(s=s.add(c)):o.done()})).next((function(){return n.Wt(t,s)}))},t.prototype.Wt=function(t,e){var n=this,r=[],i=[];return e.forEach((function(e){i.push(Js(t).get(e).next((function(t){if(null===t)throw Cr();kr(t.userId===n.userId),r.push(Ds(n.R,t))})))})),fs.waitFor(i).next((function(){return r}))},t.prototype.removeMutationBatch=function(t,e){var n=this;return zs(t.Mt,this.userId,e).next((function(r){return t.addOnCommittedListener((function(){n.Gt(e.batchId)})),fs.forEach(r,(function(e){return n.referenceDelegate.markPotentiallyOrphaned(t,e)}))}))},t.prototype.Gt=function(t){delete this.Qt[t]},t.prototype.performConsistencyCheck=function(t){var e=this;return this.checkEmpty(t).next((function(n){if(!n)return fs.resolve();var r=IDBKeyRange.lowerBound(Xa.prefixForUser(e.userId)),i=[];return $s(t).Ot({range:r},(function(t,n,r){if(t[0]===e.userId){var o=Ga(t[1]);i.push(o)}else r.done()})).next((function(){kr(0===i.length)}))}))},t.prototype.containsKey=function(t,e){return Xs(t,this.userId,e)},t.prototype.zt=function(t){var e=this;return Zs(t).get(this.userId).next((function(t){return t||new Qa(e.userId,-1,"")}))},t}();function Xs(t,e,n){var r=Xa.prefixForPath(e,n.path),i=r[1],o=IDBKeyRange.lowerBound(r),a=!1;return $s(t).Ot({range:o,kt:!0},(function(t,n,r){var o=t[0],s=t[1];t[2],o===e&&s===i&&(a=!0),r.done()})).next((function(){return a}))}function Js(t){return Ts(t,Ya.store)}function $s(t){return Ts(t,Xa.store)}function Zs(t){return Ts(t,Qa.store)}var tu=function(){function t(t){this.Ht=t}return t.prototype.next=function(){return this.Ht+=2,this.Ht},t.Jt=function(){return new t(0)},t.Yt=function(){return new t(-1)},t}(),eu=function(){function t(t,e){this.referenceDelegate=t,this.R=e}return t.prototype.allocateTargetId=function(t){var e=this;return this.Xt(t).next((function(n){var r=new tu(n.highestTargetId);return n.highestTargetId=r.next(),e.Zt(t,n).next((function(){return n.highestTargetId}))}))},t.prototype.getLastRemoteSnapshotVersion=function(t){return this.Xt(t).next((function(t){return Lr.fromTimestamp(new Dr(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))}))},t.prototype.getHighestSequenceNumber=function(t){return this.Xt(t).next((function(t){return t.highestListenSequenceNumber}))},t.prototype.setTargetsMetadata=function(t,e,n){var r=this;return this.Xt(t).next((function(i){return i.highestListenSequenceNumber=e,n&&(i.lastRemoteSnapshotVersion=n.toTimestamp()),e>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=e),r.Zt(t,i)}))},t.prototype.addTargetData=function(t,e){var n=this;return this.te(t,e).next((function(){return n.Xt(t).next((function(r){return r.targetCount+=1,n.ee(e,r),n.Zt(t,r)}))}))},t.prototype.updateTargetData=function(t,e){return this.te(t,e)},t.prototype.removeTargetData=function(t,e){var n=this;return this.removeMatchingKeysForTargetId(t,e.targetId).next((function(){return nu(t).delete(e.targetId)})).next((function(){return n.Xt(t)})).next((function(e){return kr(e.targetCount>0),e.targetCount-=1,n.Zt(t,e)}))},t.prototype.removeTargets=function(t,e,n){var r=this,i=0,o=[];return nu(t).Ot((function(a,s){var u=Ls(s);u.sequenceNumber<=e&&null===n.get(u.targetId)&&(i++,o.push(r.removeTargetData(t,u)))})).next((function(){return fs.waitFor(o)})).next((function(){return i}))},t.prototype.forEachTarget=function(t,e){return nu(t).Ot((function(t,n){var r=Ls(n);e(r)}))},t.prototype.Xt=function(t){return ru(t).get(rs.key).next((function(t){return kr(null!==t),t}))},t.prototype.Zt=function(t,e){return ru(t).put(rs.key,e)},t.prototype.te=function(t,e){return nu(t).put(Ms(this.R,e))},t.prototype.ee=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},t.prototype.getTargetCount=function(t){return this.Xt(t).next((function(t){return t.targetCount}))},t.prototype.getTargetData=function(t,e){var n=_i(e),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]),i=null;return nu(t).Ot({range:r,index:es.queryTargetsIndexName},(function(t,n,r){var o=Ls(n);wi(e,o.target)&&(i=o,r.done())})).next((function(){return i}))},t.prototype.addMatchingKeys=function(t,e,n){var r=this,i=[],o=iu(t);return e.forEach((function(e){var a=Ba(e.path);i.push(o.put(new ns(n,a))),i.push(r.referenceDelegate.addReference(t,n,e))})),fs.waitFor(i)},t.prototype.removeMatchingKeys=function(t,e,n){var r=this,i=iu(t);return fs.forEach(e,(function(e){var o=Ba(e.path);return fs.waitFor([i.delete([n,o]),r.referenceDelegate.removeReference(t,n,e)])}))},t.prototype.removeMatchingKeysForTargetId=function(t,e){var n=iu(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return n.delete(r)},t.prototype.getMatchingKeysForTargetId=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=iu(t),i=Jo();return r.Ot({range:n,kt:!0},(function(t,e,n){var r=Ga(t[1]),o=new ei(r);i=i.add(o)})).next((function(){return i}))},t.prototype.containsKey=function(t,e){var n=Ba(e.path),r=IDBKeyRange.bound([n],[xr(n)],!1,!0),i=0;return iu(t).Ot({index:ns.documentTargetsIndex,kt:!0,range:r},(function(t,e,n){var r=t[0];t[1],0!==r&&(i++,n.done())})).next((function(){return i>0}))},t.prototype.lt=function(t,e){return nu(t).get(e).next((function(t){return t?Ls(t):null}))},t}();function nu(t){return Ts(t,es.store)}function ru(t){return Ts(t,rs.store)}function iu(t){return Ts(t,ns.store)}function ou(t){return dr(this,void 0,void 0,(function(){return vr(this,(function(e){if(t.code!==mr.FAILED_PRECONDITION||t.message!==cs)throw t;return Ir("LocalStore","Unexpectedly lost primary lease"),[2]}))}))}function au(t,e){var n=t[0],r=t[1],i=e[0],o=e[1],a=Or(n,i);return 0===a?Or(r,o):a}var su=function(){function t(t){this.ne=t,this.buffer=new Bo(au),this.se=0}return t.prototype.ie=function(){return++this.se},t.prototype.re=function(t){var e=[t,this.ie()];if(this.buffer.size<this.ne)this.buffer=this.buffer.add(e);else{var n=this.buffer.last();au(e,n)<0&&(this.buffer=this.buffer.delete(n).add(e))}},Object.defineProperty(t.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),t}(),uu=function(){function t(t,e){this.garbageCollector=t,this.asyncQueue=e,this.oe=!1,this.ce=null}return t.prototype.start=function(t){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.ae(t)},t.prototype.stop=function(){this.ce&&(this.ce.cancel(),this.ce=null)},Object.defineProperty(t.prototype,"started",{get:function(){return null!==this.ce},enumerable:!1,configurable:!0}),t.prototype.ae=function(t){var e=this,n=this.oe?3e5:6e4;Ir("LruGarbageCollector","Garbage collection scheduled in "+n+"ms"),this.ce=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",n,(function(){return dr(e,void 0,void 0,(function(){var e;return vr(this,(function(n){switch(n.label){case 0:this.ce=null,this.oe=!0,n.label=1;case 1:return n.trys.push([1,3,,7]),[4,t.collectGarbage(this.garbageCollector)];case 2:return n.sent(),[3,7];case 3:return ys(e=n.sent())?(Ir("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,ou(e)];case 5:n.sent(),n.label=6;case 6:return[3,7];case 7:return[4,this.ae(t)];case 8:return n.sent(),[2]}}))}))}))},t}(),cu=function(){function t(t,e){this.ue=t,this.params=e}return t.prototype.calculateTargetCount=function(t,e){return this.ue.he(t).next((function(t){return Math.floor(e/100*t)}))},t.prototype.nthSequenceNumber=function(t,e){var n=this;if(0===e)return fs.resolve(yr.o);var r=new su(e);return this.ue.forEachTarget(t,(function(t){return r.re(t.sequenceNumber)})).next((function(){return n.ue.le(t,(function(t){return r.re(t)}))})).next((function(){return r.maxValue}))},t.prototype.removeTargets=function(t,e,n){return this.ue.removeTargets(t,e,n)},t.prototype.removeOrphanedDocuments=function(t,e){return this.ue.removeOrphanedDocuments(t,e)},t.prototype.collect=function(t,e){var n=this;return-1===this.params.cacheSizeCollectionThreshold?(Ir("LruGarbageCollector","Garbage collection skipped; disabled"),fs.resolve(Gs)):this.getCacheSize(t).next((function(r){return r<n.params.cacheSizeCollectionThreshold?(Ir("LruGarbageCollector","Garbage collection skipped; Cache size "+r+" is lower than threshold "+n.params.cacheSizeCollectionThreshold),Gs):n.fe(t,e)}))},t.prototype.getCacheSize=function(t){return this.ue.getCacheSize(t)},t.prototype.fe=function(t,e){var n,r,i,a,s,u,c,l=this,h=Date.now();return this.calculateTargetCount(t,this.params.percentileToCollect).next((function(e){return e>l.params.maximumSequenceNumbersToCollect?(Ir("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+l.params.maximumSequenceNumbersToCollect+" from "+e),r=l.params.maximumSequenceNumbersToCollect):r=e,a=Date.now(),l.nthSequenceNumber(t,r)})).next((function(r){return n=r,s=Date.now(),l.removeTargets(t,n,e)})).next((function(e){return i=e,u=Date.now(),l.removeOrphanedDocuments(t,n)})).next((function(t){return c=Date.now(),wr()<=o.LogLevel.DEBUG&&Ir("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(a-h)+"ms\n\tDetermined least recently used "+r+" in "+(s-a)+"ms\n\tRemoved "+i+" targets in "+(u-s)+"ms\n\tRemoved "+t+" documents in "+(c-u)+"ms\nTotal Duration: "+(c-h)+"ms"),fs.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:t})}))},t}(),lu=function(){function t(t,e){this.db=t,this.garbageCollector=function(t,e){return new cu(t,e)}(this,e)}return t.prototype.he=function(t){var e=this.de(t);return this.db.getTargetCache().getTargetCount(t).next((function(t){return e.next((function(e){return t+e}))}))},t.prototype.de=function(t){var e=0;return this.le(t,(function(t){e++})).next((function(){return e}))},t.prototype.forEachTarget=function(t,e){return this.db.getTargetCache().forEachTarget(t,e)},t.prototype.le=function(t,e){return this.we(t,(function(t,n){return e(n)}))},t.prototype.addReference=function(t,e,n){return hu(t,n)},t.prototype.removeReference=function(t,e,n){return hu(t,n)},t.prototype.removeTargets=function(t,e,n){return this.db.getTargetCache().removeTargets(t,e,n)},t.prototype.markPotentiallyOrphaned=function(t,e){return hu(t,e)},t.prototype._e=function(t,e){return function(t,e){var n=!1;return Zs(t).$t((function(r){return Xs(t,r,e).next((function(t){return t&&(n=!0),fs.resolve(!t)}))})).next((function(){return n}))}(t,e)},t.prototype.removeOrphanedDocuments=function(t,e){var n=this,r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[],o=0;return this.we(t,(function(a,s){if(s<=e){var u=n._e(t,a).next((function(e){if(!e)return o++,r.getEntry(t,a).next((function(){return r.removeEntry(a),iu(t).delete([0,Ba(a.path)])}))}));i.push(u)}})).next((function(){return fs.waitFor(i)})).next((function(){return r.apply(t)})).next((function(){return o}))},t.prototype.removeTarget=function(t,e){var n=e.withSequenceNumber(t.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(t,n)},t.prototype.updateLimboDocument=function(t,e){return hu(t,e)},t.prototype.we=function(t,e){var n,r=iu(t),i=yr.o;return r.Ot({index:ns.documentTargetsIndex},(function(t,r){var o=t[0],a=(t[1],r.path),s=r.sequenceNumber;0===o?(i!==yr.o&&e(new ei(Ga(n)),i),i=s,n=a):i=yr.o})).next((function(){i!==yr.o&&e(new ei(Ga(n)),i)}))},t.prototype.getCacheSize=function(t){return this.db.getRemoteDocumentCache().getSize(t)},t}();function hu(t,e){return iu(t).put(function(t,e){return new ns(0,Ba(t.path),e)}(e,t.currentSequenceNumber))}var fu=function(){function t(t,e){this.mapKeyFn=t,this.equalsFn=e,this.inner={}}return t.prototype.get=function(t){var e=this.mapKeyFn(t),n=this.inner[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],a=o[0],s=o[1];if(this.equalsFn(a,t))return s}},t.prototype.has=function(t){return void 0!==this.get(t)},t.prototype.set=function(t,e){var n=this.mapKeyFn(t),r=this.inner[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.equalsFn(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.inner[n]=[[t,e]]},t.prototype.delete=function(t){var e=this.mapKeyFn(t),n=this.inner[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.equalsFn(n[r][0],t))return 1===n.length?delete this.inner[e]:n.splice(r,1),!0;return!1},t.prototype.forEach=function(t){Fr(this.inner,(function(e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r],a=o[0],s=o[1];t(a,s)}}))},t.prototype.isEmpty=function(){return Ur(this.inner)},t}(),pu=function(){function t(){this.changes=new fu((function(t){return t.toString()}),(function(t,e){return t.isEqual(e)})),this.changesApplied=!1}return t.prototype.getReadTime=function(t){var e=this.changes.get(t);return e?e.readTime:Lr.min()},t.prototype.addEntry=function(t,e){this.assertNotApplied(),this.changes.set(t.key,{document:t,readTime:e})},t.prototype.removeEntry=function(t,e){void 0===e&&(e=null),this.assertNotApplied(),this.changes.set(t,{document:yi.newInvalidDocument(t),readTime:e})},t.prototype.getEntry=function(t,e){this.assertNotApplied();var n=this.changes.get(e);return void 0!==n?fs.resolve(n.document):this.getFromCache(t,e)},t.prototype.getEntries=function(t,e){return this.getAllFromCache(t,e)},t.prototype.apply=function(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)},t.prototype.assertNotApplied=function(){},t}(),du=function(){function t(t,e){this.R=t,this.Ut=e}return t.prototype.addEntry=function(t,e,n){return yu(t).put(mu(e),n)},t.prototype.removeEntry=function(t,e){var n=yu(t),r=mu(e);return n.delete(r)},t.prototype.updateMetadata=function(t,e){var n=this;return this.getMetadata(t).next((function(r){return r.byteSize+=e,n.me(t,r)}))},t.prototype.getEntry=function(t,e){var n=this;return yu(t).get(mu(e)).next((function(t){return n.ye(e,t)}))},t.prototype.ge=function(t,e){var n=this;return yu(t).get(mu(e)).next((function(t){return{document:n.ye(e,t),size:Qs(t)}}))},t.prototype.getEntries=function(t,e){var n=this,r=Go();return this.pe(t,e,(function(t,e){var i=n.ye(t,e);r=r.insert(t,i)})).next((function(){return r}))},t.prototype.Ee=function(t,e){var n=this,r=Go(),i=new jo(ei.comparator);return this.pe(t,e,(function(t,e){var o=n.ye(t,e);r=r.insert(t,o),i=i.insert(t,Qs(e))})).next((function(){return{documents:r,Te:i}}))},t.prototype.pe=function(t,e,n){if(e.isEmpty())return fs.resolve();var r=IDBKeyRange.bound(e.first().path.toArray(),e.last().path.toArray()),i=e.getIterator(),o=i.getNext();return yu(t).Ot({range:r},(function(t,e,r){for(var a=ei.fromSegments(t);o&&ei.comparator(o,a)<0;)n(o,null),o=i.getNext();o&&o.isEqual(a)&&(n(o,e),o=i.hasNext()?i.getNext():null),o?r.Ct(o.path.toArray()):r.done()})).next((function(){for(;o;)n(o,null),o=i.hasNext()?i.getNext():null}))},t.prototype.getDocumentsMatchingQuery=function(t,e,n){var r=this,i=Go(),o=e.path.length+1,a={};if(n.isEqual(Lr.min())){var s=e.path.toArray();a.range=IDBKeyRange.lowerBound(s)}else{var u=e.path.toArray(),c=Ps(n);a.range=IDBKeyRange.lowerBound([u,c],!0),a.index=Za.collectionReadTimeIndex}return yu(t).Ot(a,(function(t,n,a){if(t.length===o){var s=As(r.R,n);e.path.isPrefixOf(s.key.path)?$i(e,s)&&(i=i.insert(s.key,s)):a.done()}})).next((function(){return i}))},t.prototype.newChangeBuffer=function(t){return new vu(this,!!t&&t.trackRemovals)},t.prototype.getSize=function(t){return this.getMetadata(t).next((function(t){return t.byteSize}))},t.prototype.getMetadata=function(t){return gu(t).get(ts.key).next((function(t){return kr(!!t),t}))},t.prototype.me=function(t,e){return gu(t).put(ts.key,e)},t.prototype.ye=function(t,e){if(e){var n=As(this.R,e);if(!n.isNoDocument()||!n.version.isEqual(Lr.min()))return n}return yi.newInvalidDocument(t)},t}(),vu=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Ie=e,r.trackRemovals=n,r.Ae=new fu((function(t){return t.toString()}),(function(t,e){return t.isEqual(e)})),r}return pr(e,t),e.prototype.applyChanges=function(t){var e=this,n=[],r=0,i=new Bo((function(t,e){return Or(t.canonicalString(),e.canonicalString())}));return this.changes.forEach((function(o,a){var s=e.Ae.get(o);if(a.document.isValidDocument()){var u=Ns(e.Ie.R,a.document,e.getReadTime(o));i=i.add(o.path.popLast());var c=Qs(u);r+=c-s,n.push(e.Ie.addEntry(t,o,u))}else if(r-=s,e.trackRemovals){var l=Ns(e.Ie.R,yi.newNoDocument(o,Lr.min()),e.getReadTime(o));n.push(e.Ie.addEntry(t,o,l))}else n.push(e.Ie.removeEntry(t,o))})),i.forEach((function(r){n.push(e.Ie.Ut.addToCollectionParentIndex(t,r))})),n.push(this.Ie.updateMetadata(t,r)),fs.waitFor(n)},e.prototype.getFromCache=function(t,e){var n=this;return this.Ie.ge(t,e).next((function(t){return n.Ae.set(e,t.size),t.document}))},e.prototype.getAllFromCache=function(t,e){var n=this;return this.Ie.Ee(t,e).next((function(t){var e=t.documents;return t.Te.forEach((function(t,e){n.Ae.set(t,e)})),e}))},e}(pu);function gu(t){return Ts(t,ts.store)}function yu(t){return Ts(t,Za.store)}function mu(t){return t.path.toArray()}var bu=function(){function t(t){this.R=t}return t.prototype.Rt=function(t,e,n,r){var i=this;kr(n<r&&n>=0&&r<=11);var o=new ps("createOrUpgrade",e);n<1&&r>=1&&(function(t){t.createObjectStore(za.store)}(t),function(t){t.createObjectStore(Qa.store,{keyPath:Qa.keyPath}),t.createObjectStore(Ya.store,{keyPath:Ya.keyPath,autoIncrement:!0}).createIndex(Ya.userMutationsIndex,Ya.userMutationsKeyPath,{unique:!0}),t.createObjectStore(Xa.store)}(t),_u(t),function(t){t.createObjectStore(Za.store)}(t));var a=fs.resolve();return n<3&&r>=3&&(0!==n&&(function(t){t.deleteObjectStore(ns.store),t.deleteObjectStore(es.store),t.deleteObjectStore(rs.store)}(t),_u(t)),a=a.next((function(){return function(t){var e=t.store(rs.store),n=new rs(0,0,Lr.min().toTimestamp(),0);return e.put(rs.key,n)}(o)}))),n<4&&r>=4&&(0!==n&&(a=a.next((function(){return function(t,e){return e.store(Ya.store).Nt().next((function(n){t.deleteObjectStore(Ya.store),t.createObjectStore(Ya.store,{keyPath:Ya.keyPath,autoIncrement:!0}).createIndex(Ya.userMutationsIndex,Ya.userMutationsKeyPath,{unique:!0});var r=e.store(Ya.store),i=n.map((function(t){return r.put(t)}));return fs.waitFor(i)}))}(t,o)}))),a=a.next((function(){!function(t){t.createObjectStore(os.store,{keyPath:os.keyPath})}(t)}))),n<5&&r>=5&&(a=a.next((function(){return i.Re(o)}))),n<6&&r>=6&&(a=a.next((function(){return function(t){t.createObjectStore(ts.store)}(t),i.be(o)}))),n<7&&r>=7&&(a=a.next((function(){return i.ve(o)}))),n<8&&r>=8&&(a=a.next((function(){return i.Pe(t,o)}))),n<9&&r>=9&&(a=a.next((function(){!function(t){t.objectStoreNames.contains("remoteDocumentChanges")&&t.deleteObjectStore("remoteDocumentChanges")}(t),function(t){var e=t.objectStore(Za.store);e.createIndex(Za.readTimeIndex,Za.readTimeIndexPath,{unique:!1}),e.createIndex(Za.collectionReadTimeIndex,Za.collectionReadTimeIndexPath,{unique:!1})}(e)}))),n<10&&r>=10&&(a=a.next((function(){return i.Ve(o)}))),n<11&&r>=11&&(a=a.next((function(){!function(t){t.createObjectStore(as.store,{keyPath:as.keyPath})}(t),function(t){t.createObjectStore(ss.store,{keyPath:ss.keyPath})}(t)}))),a},t.prototype.be=function(t){var e=0;return t.store(Za.store).Ot((function(t,n){e+=Qs(n)})).next((function(){var n=new ts(e);return t.store(ts.store).put(ts.key,n)}))},t.prototype.Re=function(t){var e=this,n=t.store(Qa.store),r=t.store(Ya.store);return n.Nt().next((function(n){return fs.forEach(n,(function(n){var i=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return r.Nt(Ya.userMutationsIndex,i).next((function(r){return fs.forEach(r,(function(r){kr(r.userId===n.userId);var i=Ds(e.R,r);return zs(t,n.userId,i).next((function(){}))}))}))}))}))},t.prototype.ve=function(t){var e=t.store(ns.store),n=t.store(Za.store);return t.store(rs.store).get(rs.key).next((function(t){var r=[];return n.Ot((function(n,i){var o=new qr(n),a=function(t){return[0,Ba(t)]}(o);r.push(e.get(a).next((function(n){return n?fs.resolve():function(n){return e.put(new ns(0,Ba(n),t.highestListenSequenceNumber))}(o)})))})).next((function(){return fs.waitFor(r)}))}))},t.prototype.Pe=function(t,e){t.createObjectStore(is.store,{keyPath:is.keyPath});var n=e.store(is.store),r=new Bs,i=function(t){if(r.add(t)){var e=t.lastSegment(),i=t.popLast();return n.put({collectionId:e,parent:Ba(i)})}};return e.store(Za.store).Ot({kt:!0},(function(t,e){var n=new qr(t);return i(n.popLast())})).next((function(){return e.store(Xa.store).Ot({kt:!0},(function(t,e){t[0];var n=t[1],r=(t[2],Ga(n));return i(r.popLast())}))}))},t.prototype.Ve=function(t){var e=this,n=t.store(es.store);return n.Ot((function(t,r){var i=Ls(r),o=Ms(e.R,i);return n.put(o)}))},t}();function _u(t){t.createObjectStore(ns.store,{keyPath:ns.keyPath}).createIndex(ns.documentTargetsIndex,ns.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(es.store,{keyPath:es.keyPath}).createIndex(es.queryTargetsIndexName,es.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(rs.store)}var wu="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",Iu=function(){function t(e,n,r,i,o,a,s,u,c,l){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.Se=o,this.window=a,this.document=s,this.De=c,this.Ce=l,this.Ne=null,this.xe=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Fe=null,this.inForeground=!1,this.ke=null,this.Oe=null,this.$e=Number.NEGATIVE_INFINITY,this.Me=function(t){return Promise.resolve()},!t.yt())throw new br(mr.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new lu(this,i),this.Le=n+"main",this.R=new ks(u),this.Be=new ds(this.Le,11,new bu(this.R)),this.qe=new eu(this.referenceDelegate,this.R),this.Ut=new Ks,this.Ue=function(t,e){return new du(t,e)}(this.R,this.Ut),this.Qe=new Us,this.window&&this.window.localStorage?this.Ke=this.window.localStorage:(this.Ke=null,!1===l&&Tr("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}return t.prototype.start=function(){var t=this;return this.je().then((function(){if(!t.isPrimary&&!t.allowTabSynchronization)throw new br(mr.FAILED_PRECONDITION,wu);return t.We(),t.Ge(),t.ze(),t.runTransaction("getHighestListenSequenceNumber","readonly",(function(e){return t.qe.getHighestSequenceNumber(e)}))})).then((function(e){t.Ne=new yr(e,t.De)})).then((function(){t.xe=!0})).catch((function(e){return t.Be&&t.Be.close(),Promise.reject(e)}))},t.prototype.He=function(t){var e=this;return this.Me=function(n){return dr(e,void 0,void 0,(function(){return vr(this,(function(e){return this.started?[2,t(n)]:[2]}))}))},t(this.isPrimary)},t.prototype.setDatabaseDeletedListener=function(t){var e=this;this.Be.vt((function(n){return dr(e,void 0,void 0,(function(){return vr(this,(function(e){switch(e.label){case 0:return null===n.newVersion?[4,t()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))}))},t.prototype.setNetworkEnabled=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.Se.enqueueAndForget((function(){return dr(e,void 0,void 0,(function(){return vr(this,(function(t){switch(t.label){case 0:return this.started?[4,this.je()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))})))},t.prototype.je=function(){var t=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(function(e){return Eu(e).put(new os(t.clientId,Date.now(),t.networkEnabled,t.inForeground)).next((function(){if(t.isPrimary)return t.Je(e).next((function(e){e||(t.isPrimary=!1,t.Se.enqueueRetryable((function(){return t.Me(!1)})))}))})).next((function(){return t.Ye(e)})).next((function(n){return t.isPrimary&&!n?t.Xe(e).next((function(){return!1})):!!n&&t.Ze(e).next((function(){return!0}))}))})).catch((function(e){if(ys(e))return Ir("IndexedDbPersistence","Failed to extend owner lease: ",e),t.isPrimary;if(!t.allowTabSynchronization)throw e;return Ir("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1})).then((function(e){t.isPrimary!==e&&t.Se.enqueueRetryable((function(){return t.Me(e)})),t.isPrimary=e}))},t.prototype.Je=function(t){var e=this;return Tu(t).get(za.key).next((function(t){return fs.resolve(e.tn(t))}))},t.prototype.en=function(t){return Eu(t).delete(this.clientId)},t.prototype.nn=function(){return dr(this,void 0,void 0,(function(){var t,e,n,r,i=this;return vr(this,(function(o){switch(o.label){case 0:return!this.isPrimary||this.sn(this.$e,18e5)?[3,2]:(this.$e=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(function(t){var e=Ts(t,os.store);return e.Nt().next((function(t){var n=i.rn(t,18e5),r=t.filter((function(t){return-1===n.indexOf(t)}));return fs.forEach(r,(function(t){return e.delete(t.clientId)})).next((function(){return r}))}))})).catch((function(){return[]}))]);case 1:if(t=o.sent(),this.Ke)for(e=0,n=t;e<n.length;e++)r=n[e],this.Ke.removeItem(this.on(r.clientId));o.label=2;case 2:return[2]}}))}))},t.prototype.ze=function(){var t=this;this.Oe=this.Se.enqueueAfterDelay("client_metadata_refresh",4e3,(function(){return t.je().then((function(){return t.nn()})).then((function(){return t.ze()}))}))},t.prototype.tn=function(t){return!!t&&t.ownerId===this.clientId},t.prototype.Ye=function(t){var e=this;return this.Ce?fs.resolve(!0):Tu(t).get(za.key).next((function(n){if(null!==n&&e.sn(n.leaseTimestampMs,5e3)&&!e.cn(n.ownerId)){if(e.tn(n)&&e.networkEnabled)return!0;if(!e.tn(n)){if(!n.allowTabSynchronization)throw new br(mr.FAILED_PRECONDITION,wu);return!1}}return!(!e.networkEnabled||!e.inForeground)||Eu(t).Nt().next((function(t){return void 0===e.rn(t,5e3).find((function(t){if(e.clientId!==t.clientId){var n=!e.networkEnabled&&t.networkEnabled,r=!e.inForeground&&t.inForeground,i=e.networkEnabled===t.networkEnabled;if(n||r&&i)return!0}return!1}))}))})).next((function(t){return e.isPrimary!==t&&Ir("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t}))},t.prototype.shutdown=function(){return dr(this,void 0,void 0,(function(){var t=this;return vr(this,(function(e){switch(e.label){case 0:return this.xe=!1,this.an(),this.Oe&&(this.Oe.cancel(),this.Oe=null),this.un(),this.hn(),[4,this.Be.runTransaction("shutdown","readwrite",[za.store,os.store],(function(e){var n=new Is(e,yr.o);return t.Xe(n).next((function(){return t.en(n)}))}))];case 1:return e.sent(),this.Be.close(),this.ln(),[2]}}))}))},t.prototype.rn=function(t,e){var n=this;return t.filter((function(t){return n.sn(t.updateTimeMs,e)&&!n.cn(t.clientId)}))},t.prototype.fn=function(){var t=this;return this.runTransaction("getActiveClients","readonly",(function(e){return Eu(e).Nt().next((function(e){return t.rn(e,18e5).map((function(t){return t.clientId}))}))}))},Object.defineProperty(t.prototype,"started",{get:function(){return this.xe},enumerable:!1,configurable:!0}),t.prototype.getMutationQueue=function(t){return Ys.Kt(t,this.R,this.Ut,this.referenceDelegate)},t.prototype.getTargetCache=function(){return this.qe},t.prototype.getRemoteDocumentCache=function(){return this.Ue},t.prototype.getIndexManager=function(){return this.Ut},t.prototype.getBundleCache=function(){return this.Qe},t.prototype.runTransaction=function(t,e,n){var r=this;Ir("IndexedDbPersistence","Starting transaction:",t);var i,o="readonly"===e?"readonly":"readwrite";return this.Be.runTransaction(t,o,us,(function(o){return i=new Is(o,r.Ne?r.Ne.next():yr.o),"readwrite-primary"===e?r.Je(i).next((function(t){return!!t||r.Ye(i)})).next((function(e){if(!e)throw Tr("Failed to obtain primary lease for action '"+t+"'."),r.isPrimary=!1,r.Se.enqueueRetryable((function(){return r.Me(!1)})),new br(mr.FAILED_PRECONDITION,cs);return n(i)})).next((function(t){return r.Ze(i).next((function(){return t}))})):r.dn(i).next((function(){return n(i)}))})).then((function(t){return i.raiseOnCommittedEvent(),t}))},t.prototype.dn=function(t){var e=this;return Tu(t).get(za.key).next((function(t){if(null!==t&&e.sn(t.leaseTimestampMs,5e3)&&!e.cn(t.ownerId)&&!e.tn(t)&&!(e.Ce||e.allowTabSynchronization&&t.allowTabSynchronization))throw new br(mr.FAILED_PRECONDITION,wu)}))},t.prototype.Ze=function(t){var e=new za(this.clientId,this.allowTabSynchronization,Date.now());return Tu(t).put(za.key,e)},t.yt=function(){return ds.yt()},t.prototype.Xe=function(t){var e=this,n=Tu(t);return n.get(za.key).next((function(t){return e.tn(t)?(Ir("IndexedDbPersistence","Releasing primary lease."),n.delete(za.key)):fs.resolve()}))},t.prototype.sn=function(t,e){var n=Date.now();return!(t<n-e||t>n&&(Tr("Detected an update time that is in the future: "+t+" > "+n),1))},t.prototype.We=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.ke=function(){t.Se.enqueueAndForget((function(){return t.inForeground="visible"===t.document.visibilityState,t.je()}))},this.document.addEventListener("visibilitychange",this.ke),this.inForeground="visible"===this.document.visibilityState)},t.prototype.un=function(){this.ke&&(this.document.removeEventListener("visibilitychange",this.ke),this.ke=null)},t.prototype.Ge=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.Fe=function(){e.an(),e.Se.enqueueAndForget((function(){return e.shutdown()}))},this.window.addEventListener("pagehide",this.Fe))},t.prototype.hn=function(){this.Fe&&(this.window.removeEventListener("pagehide",this.Fe),this.Fe=null)},t.prototype.cn=function(t){var e;try{var n=null!==(null===(e=this.Ke)||void 0===e?void 0:e.getItem(this.on(t)));return Ir("IndexedDbPersistence","Client '"+t+"' "+(n?"is":"is not")+" zombied in LocalStorage"),n}catch(t){return Tr("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},t.prototype.an=function(){if(this.Ke)try{this.Ke.setItem(this.on(this.clientId),String(Date.now()))}catch(t){Tr("Failed to set zombie client id.",t)}},t.prototype.ln=function(){if(this.Ke)try{this.Ke.removeItem(this.on(this.clientId))}catch(t){}},t.prototype.on=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},t}();function Tu(t){return Ts(t,za.store)}function Eu(t){return Ts(t,os.store)}function Su(t,e){var n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var Cu=function(t,e){this.progress=t,this.wn=e},ku=function(){function t(t,e,n){this.Ue=t,this._n=e,this.Ut=n}return t.prototype.mn=function(t,e){var n=this;return this._n.getAllMutationBatchesAffectingDocumentKey(t,e).next((function(r){return n.yn(t,e,r)}))},t.prototype.yn=function(t,e,n){return this.Ue.getEntry(t,e).next((function(t){for(var e=0,r=n;e<r.length;e++)r[e].applyToLocalView(t);return t}))},t.prototype.gn=function(t,e){t.forEach((function(t,n){for(var r=0,i=e;r<i.length;r++)i[r].applyToLocalView(n)}))},t.prototype.pn=function(t,e){var n=this;return this.Ue.getEntries(t,e).next((function(e){return n.En(t,e).next((function(){return e}))}))},t.prototype.En=function(t,e){var n=this;return this._n.getAllMutationBatchesAffectingDocumentKeys(t,e).next((function(t){return n.gn(e,t)}))},t.prototype.getDocumentsMatchingQuery=function(t,e,n){return function(t){return ei.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}(e)?this.Tn(t,e.path):Gi(e)?this.In(t,e,n):this.An(t,e,n)},t.prototype.Tn=function(t,e){return this.mn(t,new ei(e)).next((function(t){var e=zo();return t.isFoundDocument()&&(e=e.insert(t.key,t)),e}))},t.prototype.In=function(t,e,n){var r=this,i=e.collectionGroup,o=zo();return this.Ut.getCollectionParents(t,i).next((function(a){return fs.forEach(a,(function(a){var s=function(t,e){return new Ui(e,null,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(e,a.child(i));return r.An(t,s,n).next((function(t){t.forEach((function(t,e){o=o.insert(t,e)}))}))})).next((function(){return o}))}))},t.prototype.An=function(t,e,n){var r,i,o=this;return this.Ue.getDocumentsMatchingQuery(t,e,n).next((function(n){return r=n,o._n.getAllMutationBatchesAffectingQuery(t,e)})).next((function(e){return i=e,o.Rn(t,i,r).next((function(t){r=t;for(var e=0,n=i;e<n.length;e++)for(var o=n[e],a=0,s=o.mutations;a<s.length;a++){var u=s[a],c=u.key,l=r.get(c);null==l&&(l=yi.newInvalidDocument(c),r=r.insert(c,l)),To(u,l,o.localWriteTime),l.isFoundDocument()||(r=r.remove(c))}}))})).next((function(){return r.forEach((function(t,n){$i(e,n)||(r=r.remove(t))})),r}))},t.prototype.Rn=function(t,e,n){for(var r=Jo(),i=0,o=e;i<o.length;i++)for(var a=0,s=o[i].mutations;a<s.length;a++){var u=s[a];u instanceof Ao&&null===n.get(u.key)&&(r=r.add(u.key))}var c=n;return this.Ue.getEntries(t,r).next((function(t){return t.forEach((function(t,e){e.isFoundDocument()&&(c=c.insert(t,e))})),c}))},t}(),Au=function(){function t(t,e,n,r){this.targetId=t,this.fromCache=e,this.bn=n,this.vn=r}return t.Pn=function(e,n){for(var r=Jo(),i=Jo(),o=0,a=n.docChanges;o<a.length;o++){var s=a[o];switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}}return new t(e,n.fromCache,r,i)},t}(),Nu=function(){function t(){}return t.prototype.Vn=function(t){this.Sn=t},t.prototype.getDocumentsMatchingQuery=function(t,e,n,r){var i=this;return function(t){return 0===t.filters.length&&null===t.limit&&null==t.startAt&&null==t.endAt&&(0===t.explicitOrderBy.length||1===t.explicitOrderBy.length&&t.explicitOrderBy[0].field.isKeyField())}(e)||n.isEqual(Lr.min())?this.Dn(t,e):this.Sn.pn(t,r).next((function(a){var s=i.Cn(e,a);return(Vi(e)||Bi(e))&&i.Nn(e.limitType,s,r,n)?i.Dn(t,e):(wr()<=o.LogLevel.DEBUG&&Ir("QueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),Ji(e)),i.Sn.getDocumentsMatchingQuery(t,e,n).next((function(t){return s.forEach((function(e){t=t.insert(e.key,e)})),t})))}))},t.prototype.Cn=function(t,e){var n=new Bo(Zi(t));return e.forEach((function(e,r){$i(t,r)&&(n=n.add(r))})),n},t.prototype.Nn=function(t,e,n,r){if(n.size!==e.size)return!0;var i="F"===t?e.last():e.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)},t.prototype.Dn=function(t,e){return wr()<=o.LogLevel.DEBUG&&Ir("QueryEngine","Using full collection scan to execute query:",Ji(e)),this.Sn.getDocumentsMatchingQuery(t,e,Lr.min())},t}(),Pu=function(){function t(t,e,n,r){this.persistence=t,this.xn=e,this.R=r,this.Fn=new jo(Or),this.kn=new fu((function(t){return _i(t)}),wi),this.On=Lr.min(),this._n=t.getMutationQueue(n),this.$n=t.getRemoteDocumentCache(),this.qe=t.getTargetCache(),this.Mn=new ku(this.$n,this._n,this.persistence.getIndexManager()),this.Qe=t.getBundleCache(),this.xn.Vn(this.Mn)}return t.prototype.collectGarbage=function(t){var e=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",(function(n){return t.collect(n,e.Fn)}))},t}();function Ou(t,e,n,r){return new Pu(t,e,n,r)}function Ru(t,e){return dr(this,void 0,void 0,(function(){var n,r,i,o;return vr(this,(function(a){switch(a.label){case 0:return n=Ar(t),r=n._n,i=n.Mn,[4,n.persistence.runTransaction("Handle user change","readonly",(function(t){var o;return n._n.getAllMutationBatches(t).next((function(a){return o=a,r=n.persistence.getMutationQueue(e),i=new ku(n.$n,r,n.persistence.getIndexManager()),r.getAllMutationBatches(t)})).next((function(e){for(var n=[],r=[],a=Jo(),s=0,u=o;s<u.length;s++){var c=u[s];n.push(c.batchId);for(var l=0,h=c.mutations;l<h.length;l++){var f=h[l];a=a.add(f.key)}}for(var p=0,d=e;p<d.length;p++){var v=d[p];r.push(v.batchId);for(var g=0,y=v.mutations;g<y.length;g++){var m=y[g];a=a.add(m.key)}}return i.pn(t,a).next((function(t){return{Ln:t,removedBatchIds:n,addedBatchIds:r}}))}))}))];case 1:return o=a.sent(),[2,(n._n=r,n.Mn=i,n.xn.Vn(n.Mn),o)]}}))}))}function xu(t,e){var n=Ar(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(function(t){var r=e.batch.keys(),i=n.$n.newChangeBuffer({trackRemovals:!0});return function(t,e,n,r){var i=n.batch,o=i.keys(),a=fs.resolve();return o.forEach((function(t){a=a.next((function(){return r.getEntry(e,t)})).next((function(e){var o=n.docVersions.get(t);kr(null!==o),e.version.compareTo(o)<0&&(i.applyToRemoteDocument(e,n),e.isValidDocument()&&r.addEntry(e,n.commitVersion))}))})),a.next((function(){return t._n.removeMutationBatch(e,i)}))}(n,t,e,i).next((function(){return i.apply(t)})).next((function(){return n._n.performConsistencyCheck(t)})).next((function(){return n.Mn.pn(t,r)}))}))}function Du(t){var e=Ar(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(function(t){return e.qe.getLastRemoteSnapshotVersion(t)}))}function Lu(t,e){var n=Ar(t),r=e.snapshotVersion,i=n.Fn;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(function(t){var o=n.$n.newChangeBuffer({trackRemovals:!0});i=n.Fn;var a=[];e.targetChanges.forEach((function(e,o){var s=i.get(o);if(s){a.push(n.qe.removeMatchingKeys(t,e.removedDocuments,o).next((function(){return n.qe.addMatchingKeys(t,e.addedDocuments,o)})));var u=e.resumeToken;if(u.approximateByteSize()>0){var c=s.withResumeToken(u,r).withSequenceNumber(t.currentSequenceNumber);i=i.insert(o,c),function(t,e,n){return kr(e.resumeToken.approximateByteSize()>0),0===t.resumeToken.approximateByteSize()||e.snapshotVersion.toMicroseconds()-t.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0}(s,c,e)&&a.push(n.qe.updateTargetData(t,c))}}}));var s=Go();if(e.documentUpdates.forEach((function(r,i){e.resolvedLimboDocuments.has(r)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(t,r))})),a.push(Mu(t,o,e.documentUpdates,r,void 0).next((function(t){s=t}))),!r.isEqual(Lr.min())){var u=n.qe.getLastRemoteSnapshotVersion(t).next((function(e){return n.qe.setTargetsMetadata(t,t.currentSequenceNumber,r)}));a.push(u)}return fs.waitFor(a).next((function(){return o.apply(t)})).next((function(){return n.Mn.En(t,s)})).next((function(){return s}))})).then((function(t){return n.Fn=i,t}))}function Mu(t,e,n,r,i){var o=Jo();return n.forEach((function(t){return o=o.add(t)})),e.getEntries(t,o).next((function(t){var o=Go();return n.forEach((function(n,a){var s=t.get(n),u=(null==i?void 0:i.get(n))||r;a.isNoDocument()&&a.version.isEqual(Lr.min())?(e.removeEntry(n,u),o=o.insert(n,a)):!s.isValidDocument()||a.version.compareTo(s.version)>0||0===a.version.compareTo(s.version)&&s.hasPendingWrites?(e.addEntry(a,u),o=o.insert(n,a)):Ir("LocalStore","Ignoring outdated watch update for ",n,". Current version:",s.version," Watch version:",a.version)})),o}))}function Fu(t,e){var n=Ar(t);return n.persistence.runTransaction("Get next mutation batch","readonly",(function(t){return void 0===e&&(e=-1),n._n.getNextMutationBatchAfterBatchId(t,e)}))}function Uu(t,e){var n=Ar(t);return n.persistence.runTransaction("Allocate target","readwrite",(function(t){var r;return n.qe.getTargetData(t,e).next((function(i){return i?(r=i,fs.resolve(r)):n.qe.allocateTargetId(t).next((function(i){return r=new Cs(e,i,0,t.currentSequenceNumber),n.qe.addTargetData(t,r).next((function(){return r}))}))}))})).then((function(t){var r=n.Fn.get(t.targetId);return(null===r||t.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.Fn=n.Fn.insert(t.targetId,t),n.kn.set(e,t.targetId)),t}))}function ju(t,e,n){return dr(this,void 0,void 0,(function(){var r,i,o,a;return vr(this,(function(s){switch(s.label){case 0:r=Ar(t),i=r.Fn.get(e),o=n?"readwrite":"readwrite-primary",s.label=1;case 1:return s.trys.push([1,4,,5]),n?[3,3]:[4,r.persistence.runTransaction("Release target",o,(function(t){return r.persistence.referenceDelegate.removeTarget(t,i)}))];case 2:s.sent(),s.label=3;case 3:return[3,5];case 4:if(!ys(a=s.sent()))throw a;return Ir("LocalStore","Failed to update sequence numbers for target "+e+": "+a),[3,5];case 5:return r.Fn=r.Fn.remove(e),r.kn.delete(i.target),[2]}}))}))}function qu(t,e,n){var r=Ar(t),i=Lr.min(),o=Jo();return r.persistence.runTransaction("Execute query","readonly",(function(t){return function(t,e,n){var r=Ar(t),i=r.kn.get(n);return void 0!==i?fs.resolve(r.Fn.get(i)):r.qe.getTargetData(e,n)}(r,t,zi(e)).next((function(e){if(e)return i=e.lastLimboFreeSnapshotVersion,r.qe.getMatchingKeysForTargetId(t,e.targetId).next((function(t){o=t}))})).next((function(){return r.xn.getDocumentsMatchingQuery(t,e,n?i:Lr.min(),n?o:Jo())})).next((function(t){return{documents:t,Bn:o}}))}))}function Vu(t,e){var n=Ar(t),r=Ar(n.qe),i=n.Fn.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",(function(t){return r.lt(t,e).next((function(t){return t?t.target:null}))}))}function Bu(t){var e=Ar(t);return e.persistence.runTransaction("Get new document changes","readonly",(function(t){return function(t,e,n){var r=Ar(t),i=Go(),o=Ps(n),a=yu(e),s=IDBKeyRange.lowerBound(o,!0);return a.Ot({index:Za.readTimeIndex,range:s},(function(t,e){var n=As(r.R,e);i=i.insert(n.key,n),o=e.readTime})).next((function(){return{wn:i,readTime:Os(o)}}))}(e.$n,t,e.On)})).then((function(t){var n=t.wn,r=t.readTime;return e.On=r,n}))}function Ku(t){return dr(this,void 0,void 0,(function(){var e;return vr(this,(function(n){return[2,(e=Ar(t)).persistence.runTransaction("Synchronize last document change read time","readonly",(function(t){return function(t){var e=yu(t),n=Lr.min();return e.Ot({index:Za.readTimeIndex,reverse:!0},(function(t,e,r){e.readTime&&(n=Os(e.readTime)),r.done()})).next((function(){return n}))}(t)})).then((function(t){e.On=t}))]}))}))}function Wu(t,e,n,r){return dr(this,void 0,void 0,(function(){var i,o,a,s,u,c,l,h,f,p;return vr(this,(function(d){switch(d.label){case 0:for(i=Ar(t),o=Jo(),a=Go(),s=Yo(),u=0,c=n;u<c.length;u++)l=c[u],h=e.qn(l.metadata.name),l.document&&(o=o.add(h)),a=a.insert(h,e.Un(l)),s=s.insert(h,e.Qn(l.metadata.readTime));return f=i.$n.newChangeBuffer({trackRemovals:!0}),[4,Uu(i,function(t){return zi(qi(qr.fromString("__bundle__/docs/"+t)))}(r))];case 1:return p=d.sent(),[2,i.persistence.runTransaction("Apply bundle documents","readwrite",(function(t){return Mu(t,f,a,Lr.min(),s).next((function(e){return f.apply(t),e})).next((function(e){return i.qe.removeMatchingKeysForTargetId(t,p.targetId).next((function(){return i.qe.addMatchingKeys(t,o,p.targetId)})).next((function(){return i.Mn.En(t,e)})).next((function(){return e}))}))}))]}}))}))}function Gu(t,e,n){return void 0===n&&(n=Jo()),dr(this,void 0,void 0,(function(){var r,i;return vr(this,(function(o){switch(o.label){case 0:return[4,Uu(t,zi(Fs(e.bundledQuery)))];case 1:return r=o.sent(),[2,(i=Ar(t)).persistence.runTransaction("Save named query","readwrite",(function(t){var o=va(e.readTime);if(r.snapshotVersion.compareTo(o)>=0)return i.Qe.saveNamedQuery(t,e);var a=r.withResumeToken(Wr.EMPTY_BYTE_STRING,o);return i.Fn=i.Fn.insert(a.targetId,a),i.qe.updateTargetData(t,a).next((function(){return i.qe.removeMatchingKeysForTargetId(t,r.targetId)})).next((function(){return i.qe.addMatchingKeys(t,n,r.targetId)})).next((function(){return i.Qe.saveNamedQuery(t,e)}))}))]}}))}))}var Hu=function(){function t(t){this.R=t,this.Kn=new Map,this.jn=new Map}return t.prototype.getBundleMetadata=function(t,e){return fs.resolve(this.Kn.get(e))},t.prototype.saveBundleMetadata=function(t,e){var n;return this.Kn.set(e.id,{id:(n=e).id,version:n.version,createTime:va(n.createTime)}),fs.resolve()},t.prototype.getNamedQuery=function(t,e){return fs.resolve(this.jn.get(e))},t.prototype.saveNamedQuery=function(t,e){return this.jn.set(e.name,function(t){return{name:t.name,query:Fs(t.bundledQuery),readTime:va(t.readTime)}}(e)),fs.resolve()},t}(),zu=function(){function t(){this.Wn=new Bo(Qu.Gn),this.zn=new Bo(Qu.Hn)}return t.prototype.isEmpty=function(){return this.Wn.isEmpty()},t.prototype.addReference=function(t,e){var n=new Qu(t,e);this.Wn=this.Wn.add(n),this.zn=this.zn.add(n)},t.prototype.Jn=function(t,e){var n=this;t.forEach((function(t){return n.addReference(t,e)}))},t.prototype.removeReference=function(t,e){this.Yn(new Qu(t,e))},t.prototype.Xn=function(t,e){var n=this;t.forEach((function(t){return n.removeReference(t,e)}))},t.prototype.Zn=function(t){var e=this,n=new ei(new qr([])),r=new Qu(n,t),i=new Qu(n,t+1),o=[];return this.zn.forEachInRange([r,i],(function(t){e.Yn(t),o.push(t.key)})),o},t.prototype.ts=function(){var t=this;this.Wn.forEach((function(e){return t.Yn(e)}))},t.prototype.Yn=function(t){this.Wn=this.Wn.delete(t),this.zn=this.zn.delete(t)},t.prototype.es=function(t){var e=new ei(new qr([])),n=new Qu(e,t),r=new Qu(e,t+1),i=Jo();return this.zn.forEachInRange([n,r],(function(t){i=i.add(t.key)})),i},t.prototype.containsKey=function(t){var e=new Qu(t,0),n=this.Wn.firstAfterOrEqual(e);return null!==n&&t.isEqual(n.key)},t}(),Qu=function(){function t(t,e){this.key=t,this.ns=e}return t.Gn=function(t,e){return ei.comparator(t.key,e.key)||Or(t.ns,e.ns)},t.Hn=function(t,e){return Or(t.ns,e.ns)||ei.comparator(t.key,e.key)},t}(),Yu=function(){function t(t,e){this.Ut=t,this.referenceDelegate=e,this._n=[],this.ss=1,this.rs=new Bo(Qu.Gn)}return t.prototype.checkEmpty=function(t){return fs.resolve(0===this._n.length)},t.prototype.addMutationBatch=function(t,e,n,r){var i=this.ss;this.ss++,this._n.length>0&&this._n[this._n.length-1];var o=new Es(i,e,n,r);this._n.push(o);for(var a=0,s=r;a<s.length;a++){var u=s[a];this.rs=this.rs.add(new Qu(u.key,i)),this.Ut.addToCollectionParentIndex(t,u.key.path.popLast())}return fs.resolve(o)},t.prototype.lookupMutationBatch=function(t,e){return fs.resolve(this.os(e))},t.prototype.getNextMutationBatchAfterBatchId=function(t,e){var n=e+1,r=this.cs(n),i=r<0?0:r;return fs.resolve(this._n.length>i?this._n[i]:null)},t.prototype.getHighestUnacknowledgedBatchId=function(){return fs.resolve(0===this._n.length?-1:this.ss-1)},t.prototype.getAllMutationBatches=function(t){return fs.resolve(this._n.slice())},t.prototype.getAllMutationBatchesAffectingDocumentKey=function(t,e){var n=this,r=new Qu(e,0),i=new Qu(e,Number.POSITIVE_INFINITY),o=[];return this.rs.forEachInRange([r,i],(function(t){var e=n.os(t.ns);o.push(e)})),fs.resolve(o)},t.prototype.getAllMutationBatchesAffectingDocumentKeys=function(t,e){var n=this,r=new Bo(Or);return e.forEach((function(t){var e=new Qu(t,0),i=new Qu(t,Number.POSITIVE_INFINITY);n.rs.forEachInRange([e,i],(function(t){r=r.add(t.ns)}))})),fs.resolve(this.us(r))},t.prototype.getAllMutationBatchesAffectingQuery=function(t,e){var n=e.path,r=n.length+1,i=n;ei.isDocumentKey(i)||(i=i.child(""));var o=new Qu(new ei(i),0),a=new Bo(Or);return this.rs.forEachWhile((function(t){var e=t.key.path;return!!n.isPrefixOf(e)&&(e.length===r&&(a=a.add(t.ns)),!0)}),o),fs.resolve(this.us(a))},t.prototype.us=function(t){var e=this,n=[];return t.forEach((function(t){var r=e.os(t);null!==r&&n.push(r)})),n},t.prototype.removeMutationBatch=function(t,e){var n=this;kr(0===this.hs(e.batchId,"removed")),this._n.shift();var r=this.rs;return fs.forEach(e.mutations,(function(i){var o=new Qu(i.key,e.batchId);return r=r.delete(o),n.referenceDelegate.markPotentiallyOrphaned(t,i.key)})).next((function(){n.rs=r}))},t.prototype.Gt=function(t){},t.prototype.containsKey=function(t,e){var n=new Qu(e,0),r=this.rs.firstAfterOrEqual(n);return fs.resolve(e.isEqual(r&&r.key))},t.prototype.performConsistencyCheck=function(t){return this._n.length,fs.resolve()},t.prototype.hs=function(t,e){return this.cs(t)},t.prototype.cs=function(t){return 0===this._n.length?0:t-this._n[0].batchId},t.prototype.os=function(t){var e=this.cs(t);return e<0||e>=this._n.length?null:this._n[e]},t}(),Xu=function(){function t(t,e){this.Ut=t,this.ls=e,this.docs=new jo(ei.comparator),this.size=0}return t.prototype.addEntry=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,a=this.ls(e);return this.docs=this.docs.insert(r,{document:e.clone(),size:a,readTime:n}),this.size+=a-o,this.Ut.addToCollectionParentIndex(t,r.path.popLast())},t.prototype.removeEntry=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},t.prototype.getEntry=function(t,e){var n=this.docs.get(e);return fs.resolve(n?n.document.clone():yi.newInvalidDocument(e))},t.prototype.getEntries=function(t,e){var n=this,r=Go();return e.forEach((function(t){var e=n.docs.get(t);r=r.insert(t,e?e.document.clone():yi.newInvalidDocument(t))})),fs.resolve(r)},t.prototype.getDocumentsMatchingQuery=function(t,e,n){for(var r=Go(),i=new ei(e.path.child("")),o=this.docs.getIteratorFrom(i);o.hasNext();){var a=o.getNext(),s=a.key,u=a.value,c=u.document,l=u.readTime;if(!e.path.isPrefixOf(s.path))break;l.compareTo(n)<=0||$i(e,c)&&(r=r.insert(c.key,c.clone()))}return fs.resolve(r)},t.prototype.fs=function(t,e){return fs.forEach(this.docs,(function(t){return e(t)}))},t.prototype.newChangeBuffer=function(t){return new Ju(this)},t.prototype.getSize=function(t){return fs.resolve(this.size)},t}(),Ju=function(t){function e(e){var n=this;return(n=t.call(this)||this).Ie=e,n}return pr(e,t),e.prototype.applyChanges=function(t){var e=this,n=[];return this.changes.forEach((function(r,i){i.document.isValidDocument()?n.push(e.Ie.addEntry(t,i.document,e.getReadTime(r))):e.Ie.removeEntry(r)})),fs.waitFor(n)},e.prototype.getFromCache=function(t,e){return this.Ie.getEntry(t,e)},e.prototype.getAllFromCache=function(t,e){return this.Ie.getEntries(t,e)},e}(pu),$u=function(){function t(t){this.persistence=t,this.ds=new fu((function(t){return _i(t)}),wi),this.lastRemoteSnapshotVersion=Lr.min(),this.highestTargetId=0,this.ws=0,this._s=new zu,this.targetCount=0,this.ys=tu.Jt()}return t.prototype.forEachTarget=function(t,e){return this.ds.forEach((function(t,n){return e(n)})),fs.resolve()},t.prototype.getLastRemoteSnapshotVersion=function(t){return fs.resolve(this.lastRemoteSnapshotVersion)},t.prototype.getHighestSequenceNumber=function(t){return fs.resolve(this.ws)},t.prototype.allocateTargetId=function(t){return this.highestTargetId=this.ys.next(),fs.resolve(this.highestTargetId)},t.prototype.setTargetsMetadata=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.ws&&(this.ws=e),fs.resolve()},t.prototype.te=function(t){this.ds.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.ys=new tu(e),this.highestTargetId=e),t.sequenceNumber>this.ws&&(this.ws=t.sequenceNumber)},t.prototype.addTargetData=function(t,e){return this.te(e),this.targetCount+=1,fs.resolve()},t.prototype.updateTargetData=function(t,e){return this.te(e),fs.resolve()},t.prototype.removeTargetData=function(t,e){return this.ds.delete(e.target),this._s.Zn(e.targetId),this.targetCount-=1,fs.resolve()},t.prototype.removeTargets=function(t,e,n){var r=this,i=0,o=[];return this.ds.forEach((function(a,s){s.sequenceNumber<=e&&null===n.get(s.targetId)&&(r.ds.delete(a),o.push(r.removeMatchingKeysForTargetId(t,s.targetId)),i++)})),fs.waitFor(o).next((function(){return i}))},t.prototype.getTargetCount=function(t){return fs.resolve(this.targetCount)},t.prototype.getTargetData=function(t,e){var n=this.ds.get(e)||null;return fs.resolve(n)},t.prototype.addMatchingKeys=function(t,e,n){return this._s.Jn(e,n),fs.resolve()},t.prototype.removeMatchingKeys=function(t,e,n){this._s.Xn(e,n);var r=this.persistence.referenceDelegate,i=[];return r&&e.forEach((function(e){i.push(r.markPotentiallyOrphaned(t,e))})),fs.waitFor(i)},t.prototype.removeMatchingKeysForTargetId=function(t,e){return this._s.Zn(e),fs.resolve()},t.prototype.getMatchingKeysForTargetId=function(t,e){var n=this._s.es(e);return fs.resolve(n)},t.prototype.containsKey=function(t,e){return fs.resolve(this._s.containsKey(e))},t}(),Zu=function(){function t(t,e){var n=this;this.gs={},this.Ne=new yr(0),this.xe=!1,this.xe=!0,this.referenceDelegate=t(this),this.qe=new $u(this),this.Ut=new Vs,this.Ue=function(t,e){return new Xu(t,(function(t){return n.referenceDelegate.ps(t)}))}(this.Ut),this.R=new ks(e),this.Qe=new Hu(this.R)}return t.prototype.start=function(){return Promise.resolve()},t.prototype.shutdown=function(){return this.xe=!1,Promise.resolve()},Object.defineProperty(t.prototype,"started",{get:function(){return this.xe},enumerable:!1,configurable:!0}),t.prototype.setDatabaseDeletedListener=function(){},t.prototype.setNetworkEnabled=function(){},t.prototype.getIndexManager=function(){return this.Ut},t.prototype.getMutationQueue=function(t){var e=this.gs[t.toKey()];return e||(e=new Yu(this.Ut,this.referenceDelegate),this.gs[t.toKey()]=e),e},t.prototype.getTargetCache=function(){return this.qe},t.prototype.getRemoteDocumentCache=function(){return this.Ue},t.prototype.getBundleCache=function(){return this.Qe},t.prototype.runTransaction=function(t,e,n){var r=this;Ir("MemoryPersistence","Starting transaction:",t);var i=new tc(this.Ne.next());return this.referenceDelegate.Es(),n(i).next((function(t){return r.referenceDelegate.Ts(i).next((function(){return t}))})).toPromise().then((function(t){return i.raiseOnCommittedEvent(),t}))},t.prototype.Is=function(t,e){return fs.or(Object.values(this.gs).map((function(n){return function(){return n.containsKey(t,e)}})))},t}(),tc=function(t){function e(e){var n=this;return(n=t.call(this)||this).currentSequenceNumber=e,n}return pr(e,t),e}(ls),ec=function(){function t(t){this.persistence=t,this.As=new zu,this.Rs=null}return t.bs=function(e){return new t(e)},Object.defineProperty(t.prototype,"vs",{get:function(){if(this.Rs)return this.Rs;throw Cr()},enumerable:!1,configurable:!0}),t.prototype.addReference=function(t,e,n){return this.As.addReference(n,e),this.vs.delete(n.toString()),fs.resolve()},t.prototype.removeReference=function(t,e,n){return this.As.removeReference(n,e),this.vs.add(n.toString()),fs.resolve()},t.prototype.markPotentiallyOrphaned=function(t,e){return this.vs.add(e.toString()),fs.resolve()},t.prototype.removeTarget=function(t,e){var n=this;this.As.Zn(e.targetId).forEach((function(t){return n.vs.add(t.toString())}));var r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(t,e.targetId).next((function(t){t.forEach((function(t){return n.vs.add(t.toString())}))})).next((function(){return r.removeTargetData(t,e)}))},t.prototype.Es=function(){this.Rs=new Set},t.prototype.Ts=function(t){var e=this,n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return fs.forEach(this.vs,(function(r){var i=ei.fromPath(r);return e.Ps(t,i).next((function(t){t||n.removeEntry(i)}))})).next((function(){return e.Rs=null,n.apply(t)}))},t.prototype.updateLimboDocument=function(t,e){var n=this;return this.Ps(t,e).next((function(t){t?n.vs.delete(e.toString()):n.vs.add(e.toString())}))},t.prototype.ps=function(t){return 0},t.prototype.Ps=function(t,e){var n=this;return fs.or([function(){return fs.resolve(n.As.containsKey(e))},function(){return n.persistence.getTargetCache().containsKey(t,e)},function(){return n.persistence.Is(t,e)}])},t}(),nc=function(){function t(t){this.uid=t}return t.prototype.isAuthenticated=function(){return null!=this.uid},t.prototype.toKey=function(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"},t.prototype.isEqual=function(t){return t.uid===this.uid},t}();function rc(t,e){return"firestore_clients_"+t+"_"+e}function ic(t,e,n){var r="firestore_mutations_"+t+"_"+n;return e.isAuthenticated()&&(r+="_"+e.uid),r}function oc(t,e){return"firestore_targets_"+t+"_"+e}nc.UNAUTHENTICATED=new nc(null),nc.GOOGLE_CREDENTIALS=new nc("google-credentials-uid"),nc.FIRST_PARTY=new nc("first-party-uid");var ac=function(){function t(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}return t.Vs=function(e,n,r){var i,o=JSON.parse(r),a="object"==typeof o&&-1!==["pending","acknowledged","rejected"].indexOf(o.state)&&(void 0===o.error||"object"==typeof o.error);return a&&o.error&&(a="string"==typeof o.error.message&&"string"==typeof o.error.code)&&(i=new br(o.error.code,o.error.message)),a?new t(e,n,o.state,i):(Tr("SharedClientState","Failed to parse mutation state for ID '"+n+"': "+r),null)},t.prototype.Ss=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),sc=function(){function t(t,e,n){this.targetId=t,this.state=e,this.error=n}return t.Vs=function(e,n){var r,i=JSON.parse(n),o="object"==typeof i&&-1!==["not-current","current","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error);return o&&i.error&&(o="string"==typeof i.error.message&&"string"==typeof i.error.code)&&(r=new br(i.error.code,i.error.message)),o?new t(e,i.state,r):(Tr("SharedClientState","Failed to parse target state for ID '"+e+"': "+n),null)},t.prototype.Ss=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),uc=function(){function t(t,e){this.clientId=t,this.activeTargetIds=e}return t.Vs=function(e,n){for(var r=JSON.parse(n),i="object"==typeof r&&r.activeTargetIds instanceof Array,o=Zo(),a=0;i&&a<r.activeTargetIds.length;++a)i=ti(r.activeTargetIds[a]),o=o.add(r.activeTargetIds[a]);return i?new t(e,o):(Tr("SharedClientState","Failed to parse client data for instance '"+e+"': "+n),null)},t}(),cc=function(){function t(t,e){this.clientId=t,this.onlineState=e}return t.Vs=function(e){var n=JSON.parse(e);return"object"==typeof n&&-1!==["Unknown","Online","Offline"].indexOf(n.onlineState)&&"string"==typeof n.clientId?new t(n.clientId,n.onlineState):(Tr("SharedClientState","Failed to parse online state: "+e),null)},t}(),lc=function(){function t(){this.activeTargetIds=Zo()}return t.prototype.Ds=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},t.prototype.Cs=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},t.prototype.Ss=function(){var t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)},t}(),hc=function(){function t(t,e,n,r,i){this.window=t,this.Se=e,this.persistenceKey=n,this.Ns=r,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.xs=this.Fs.bind(this),this.ks=new jo(Or),this.started=!1,this.Os=[];var o=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.$s=rc(this.persistenceKey,this.Ns),this.Ms=function(t){return"firestore_sequence_number_"+t}(this.persistenceKey),this.ks=this.ks.insert(this.Ns,new lc),this.Ls=new RegExp("^firestore_clients_"+o+"_([^_]*)$"),this.Bs=new RegExp("^firestore_mutations_"+o+"_(\\d+)(?:_(.*))?$"),this.qs=new RegExp("^firestore_targets_"+o+"_(\\d+)$"),this.Us=function(t){return"firestore_online_state_"+t}(this.persistenceKey),this.Qs=function(t){return"firestore_bundle_loaded_"+t}(this.persistenceKey),this.window.addEventListener("storage",this.xs)}return t.yt=function(t){return!(!t||!t.localStorage)},t.prototype.start=function(){return dr(this,void 0,void 0,(function(){var t,e,n,r,i,o,a,s,u,c,l,h=this;return vr(this,(function(f){switch(f.label){case 0:return[4,this.syncEngine.fn()];case 1:for(t=f.sent(),e=0,n=t;e<n.length;e++)(r=n[e])!==this.Ns&&(i=this.getItem(rc(this.persistenceKey,r)))&&(o=uc.Vs(r,i))&&(this.ks=this.ks.insert(o.clientId,o));for(this.Ks(),(a=this.storage.getItem(this.Us))&&(s=this.js(a))&&this.Ws(s),u=0,c=this.Os;u<c.length;u++)l=c[u],this.Fs(l);return this.Os=[],this.window.addEventListener("pagehide",(function(){return h.shutdown()})),this.started=!0,[2]}}))}))},t.prototype.writeSequenceNumber=function(t){this.setItem(this.Ms,JSON.stringify(t))},t.prototype.getAllActiveQueryTargets=function(){return this.Gs(this.ks)},t.prototype.isActiveQueryTarget=function(t){var e=!1;return this.ks.forEach((function(n,r){r.activeTargetIds.has(t)&&(e=!0)})),e},t.prototype.addPendingMutation=function(t){this.zs(t,"pending")},t.prototype.updateMutationState=function(t,e,n){this.zs(t,e,n),this.Hs(t)},t.prototype.addLocalQueryTarget=function(t){var e="not-current";if(this.isActiveQueryTarget(t)){var n=this.storage.getItem(oc(this.persistenceKey,t));if(n){var r=sc.Vs(t,n);r&&(e=r.state)}}return this.Js.Ds(t),this.Ks(),e},t.prototype.removeLocalQueryTarget=function(t){this.Js.Cs(t),this.Ks()},t.prototype.isLocalQueryTarget=function(t){return this.Js.activeTargetIds.has(t)},t.prototype.clearQueryState=function(t){this.removeItem(oc(this.persistenceKey,t))},t.prototype.updateQueryState=function(t,e,n){this.Ys(t,e,n)},t.prototype.handleUserChange=function(t,e,n){var r=this;e.forEach((function(t){r.Hs(t)})),this.currentUser=t,n.forEach((function(t){r.addPendingMutation(t)}))},t.prototype.setOnlineState=function(t){this.Xs(t)},t.prototype.notifyBundleLoaded=function(){this.Zs()},t.prototype.shutdown=function(){this.started&&(this.window.removeEventListener("storage",this.xs),this.removeItem(this.$s),this.started=!1)},t.prototype.getItem=function(t){var e=this.storage.getItem(t);return Ir("SharedClientState","READ",t,e),e},t.prototype.setItem=function(t,e){Ir("SharedClientState","SET",t,e),this.storage.setItem(t,e)},t.prototype.removeItem=function(t){Ir("SharedClientState","REMOVE",t),this.storage.removeItem(t)},t.prototype.Fs=function(t){var e=this,n=t;if(n.storageArea===this.storage){if(Ir("SharedClientState","EVENT",n.key,n.newValue),n.key===this.$s)return void Tr("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Se.enqueueRetryable((function(){return dr(e,void 0,void 0,(function(){var t,e,r,i,o,a;return vr(this,(function(s){if(this.started){if(null!==n.key)if(this.Ls.test(n.key)){if(null==n.newValue)return t=this.ti(n.key),[2,this.ei(t,null)];if(e=this.ni(n.key,n.newValue))return[2,this.ei(e.clientId,e)]}else if(this.Bs.test(n.key)){if(null!==n.newValue&&(r=this.si(n.key,n.newValue)))return[2,this.ii(r)]}else if(this.qs.test(n.key)){if(null!==n.newValue&&(i=this.ri(n.key,n.newValue)))return[2,this.oi(i)]}else if(n.key===this.Us){if(null!==n.newValue&&(o=this.js(n.newValue)))return[2,this.Ws(o)]}else if(n.key===this.Ms)(a=function(t){var e=yr.o;if(null!=t)try{var n=JSON.parse(t);kr("number"==typeof n),e=n}catch(t){Tr("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(n.newValue))!==yr.o&&this.sequenceNumberHandler(a);else if(n.key===this.Qs)return[2,this.syncEngine.ci()]}else this.Os.push(n);return[2]}))}))}))}},Object.defineProperty(t.prototype,"Js",{get:function(){return this.ks.get(this.Ns)},enumerable:!1,configurable:!0}),t.prototype.Ks=function(){this.setItem(this.$s,this.Js.Ss())},t.prototype.zs=function(t,e,n){var r=new ac(this.currentUser,t,e,n),i=ic(this.persistenceKey,this.currentUser,t);this.setItem(i,r.Ss())},t.prototype.Hs=function(t){var e=ic(this.persistenceKey,this.currentUser,t);this.removeItem(e)},t.prototype.Xs=function(t){var e={clientId:this.Ns,onlineState:t};this.storage.setItem(this.Us,JSON.stringify(e))},t.prototype.Ys=function(t,e,n){var r=oc(this.persistenceKey,t),i=new sc(t,e,n);this.setItem(r,i.Ss())},t.prototype.Zs=function(){this.setItem(this.Qs,"value-not-used")},t.prototype.ti=function(t){var e=this.Ls.exec(t);return e?e[1]:null},t.prototype.ni=function(t,e){var n=this.ti(t);return uc.Vs(n,e)},t.prototype.si=function(t,e){var n=this.Bs.exec(t),r=Number(n[1]),i=void 0!==n[2]?n[2]:null;return ac.Vs(new nc(i),r,e)},t.prototype.ri=function(t,e){var n=this.qs.exec(t),r=Number(n[1]);return sc.Vs(r,e)},t.prototype.js=function(t){return cc.Vs(t)},t.prototype.ii=function(t){return dr(this,void 0,void 0,(function(){return vr(this,(function(e){return t.user.uid===this.currentUser.uid?[2,this.syncEngine.ai(t.batchId,t.state,t.error)]:(Ir("SharedClientState","Ignoring mutation for non-active user "+t.user.uid),[2])}))}))},t.prototype.oi=function(t){return this.syncEngine.ui(t.targetId,t.state,t.error)},t.prototype.ei=function(t,e){var n=this,r=e?this.ks.insert(t,e):this.ks.remove(t),i=this.Gs(this.ks),o=this.Gs(r),a=[],s=[];return o.forEach((function(t){i.has(t)||a.push(t)})),i.forEach((function(t){o.has(t)||s.push(t)})),this.syncEngine.hi(a,s).then((function(){n.ks=r}))},t.prototype.Ws=function(t){this.ks.get(t.clientId)&&this.onlineStateHandler(t.onlineState)},t.prototype.Gs=function(t){var e=Zo();return t.forEach((function(t,n){e=e.unionWith(n.activeTargetIds)})),e},t}(),fc=function(){function t(){this.li=new lc,this.fi={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}return t.prototype.addPendingMutation=function(t){},t.prototype.updateMutationState=function(t,e,n){},t.prototype.addLocalQueryTarget=function(t){return this.li.Ds(t),this.fi[t]||"not-current"},t.prototype.updateQueryState=function(t,e,n){this.fi[t]=e},t.prototype.removeLocalQueryTarget=function(t){this.li.Cs(t)},t.prototype.isLocalQueryTarget=function(t){return this.li.activeTargetIds.has(t)},t.prototype.clearQueryState=function(t){delete this.fi[t]},t.prototype.getAllActiveQueryTargets=function(){return this.li.activeTargetIds},t.prototype.isActiveQueryTarget=function(t){return this.li.activeTargetIds.has(t)},t.prototype.start=function(){return this.li=new lc,Promise.resolve()},t.prototype.handleUserChange=function(t,e,n){},t.prototype.setOnlineState=function(t){},t.prototype.shutdown=function(){},t.prototype.writeSequenceNumber=function(t){},t.prototype.notifyBundleLoaded=function(){},t}(),pc=function(){function t(){}return t.prototype.di=function(t){},t.prototype.shutdown=function(){},t}(),dc=function(){function t(){var t=this;this.wi=function(){return t._i()},this.mi=function(){return t.yi()},this.gi=[],this.pi()}return t.prototype.di=function(t){this.gi.push(t)},t.prototype.shutdown=function(){window.removeEventListener("online",this.wi),window.removeEventListener("offline",this.mi)},t.prototype.pi=function(){window.addEventListener("online",this.wi),window.addEventListener("offline",this.mi)},t.prototype._i=function(){Ir("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.gi;t<e.length;t++)(0,e[t])(0)},t.prototype.yi=function(){Ir("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.gi;t<e.length;t++)(0,e[t])(1)},t.yt=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},t}(),vc={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},gc=function(){function t(t){this.Ei=t.Ei,this.Ti=t.Ti}return t.prototype.Ii=function(t){this.Ai=t},t.prototype.Ri=function(t){this.bi=t},t.prototype.onMessage=function(t){this.vi=t},t.prototype.close=function(){this.Ti()},t.prototype.send=function(t){this.Ei(t)},t.prototype.Pi=function(){this.Ai()},t.prototype.Vi=function(t){this.bi(t)},t.prototype.Si=function(t){this.vi(t)},t}(),yc=function(t){function e(e){var n=this;return(n=t.call(this,e)||this).forceLongPolling=e.forceLongPolling,n.autoDetectLongPolling=e.autoDetectLongPolling,n}return pr(e,t),e.prototype.ki=function(t,e,n,r){return new Promise((function(i,o){var a=new hr;a.listenOnce(ar.COMPLETE,(function(){try{switch(a.getLastErrorCode()){case or.NO_ERROR:var e=a.getResponseJson();Ir("Connection","XHR received:",JSON.stringify(e)),i(e);break;case or.TIMEOUT:Ir("Connection",'RPC "'+t+'" timed out'),o(new br(mr.DEADLINE_EXCEEDED,"Request time out"));break;case or.HTTP_ERROR:var n=a.getStatus();if(Ir("Connection",'RPC "'+t+'" failed with status:',n,"response text:",a.getResponseText()),n>0){var r=a.getResponseJson().error;if(r&&r.status&&r.message){var s=function(t){var e=t.toLowerCase().replace(/_/g,"-");return Object.values(mr).indexOf(e)>=0?e:mr.UNKNOWN}(r.status);o(new br(s,r.message))}else o(new br(mr.UNKNOWN,"Server responded with status "+a.getStatus()))}else o(new br(mr.UNAVAILABLE,"Connection failed."));break;default:Cr()}}finally{Ir("Connection",'RPC "'+t+'" completed.')}}));var s=JSON.stringify(r);a.send(e,"POST",s,n,15)}))},e.prototype.$i=function(t,e){var n=[this.Di,"/","google.firestore.v1.Firestore","/",t,"/channel"],r=new tr,o=ee(),a={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.Fi(a.initMessageHeaders,e),(0,i.isMobileCordova)()||(0,i.isReactNative)()||(0,i.isElectron)()||(0,i.isIE)()||(0,i.isUWP)()||(0,i.isBrowserExtension)()||(a.httpHeadersOverwriteParam="$httpHeaders");var s=n.join("");Ir("Connection","Creating WebChannel: "+s,a);var u=r.createWebChannel(s,a),c=!1,l=!1,h=new gc({Ei:function(t){l?Ir("Connection","Not sending because WebChannel is closed:",t):(c||(Ir("Connection","Opening WebChannel transport."),u.open(),c=!0),Ir("Connection","WebChannel sending:",t),u.send(t))},Ti:function(){return u.close()}}),f=function(t,e,n){t.listen(e,(function(t){try{n(t)}catch(t){setTimeout((function(){throw t}),0)}}))};return f(u,lr.EventType.OPEN,(function(){l||Ir("Connection","WebChannel transport opened.")})),f(u,lr.EventType.CLOSE,(function(){l||(l=!0,Ir("Connection","WebChannel transport closed"),h.Vi())})),f(u,lr.EventType.ERROR,(function(t){l||(l=!0,Er("Connection","WebChannel transport errored:",t),h.Vi(new br(mr.UNAVAILABLE,"The operation could not be completed")))})),f(u,lr.EventType.MESSAGE,(function(t){var e;if(!l){var n=t.data[0];kr(!!n);var r=n,i=r.error||(null===(e=r[0])||void 0===e?void 0:e.error);if(i){Ir("Connection","WebChannel received error:",i);var o=i.status,a=function(t){var e=Ro[t];if(void 0!==e)return Uo(e)}(o),s=i.message;void 0===a&&(a=mr.INTERNAL,s="Unknown error status: "+o+" with message "+i.message),l=!0,h.Vi(new br(a,s)),u.close()}else Ir("Connection","WebChannel received:",n),h.Si(n)}})),f(o,sr.STAT_EVENT,(function(t){t.stat===ur?Ir("Connection","Detected buffering proxy"):t.stat===cr&&Ir("Connection","Detected no buffering proxy")})),setTimeout((function(){h.Pi()}),0),h},e}(function(){function t(t){this.databaseInfo=t,this.databaseId=t.databaseId;var e=t.ssl?"https":"http";this.Di=e+"://"+t.host,this.Ci="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}return t.prototype.Ni=function(t,e,n,r){var i=this.xi(t,e);Ir("RestConnection","Sending: ",i,n);var o={};return this.Fi(o,r),this.ki(t,i,o,n).then((function(t){return Ir("RestConnection","Received: ",t),t}),(function(e){throw Er("RestConnection",t+" failed with error: ",e,"url: ",i,"request:",n),e}))},t.prototype.Oi=function(t,e,n,r){return this.Ni(t,e,n,r)},t.prototype.Fi=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.6.2",t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),e)for(var n in e.authHeaders)e.authHeaders.hasOwnProperty(n)&&(t[n]=e.authHeaders[n])},t.prototype.xi=function(t,e){var n=vc[t];return this.Di+"/v1/"+e+":"+n},t}());function mc(){return"undefined"!=typeof window?window:null}function bc(){return"undefined"!=typeof document?document:null}function _c(t){return new ha(t,!0)}var wc=function(){function t(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.Se=t,this.timerId=e,this.Mi=n,this.Li=r,this.Bi=i,this.qi=0,this.Ui=null,this.Qi=Date.now(),this.reset()}return t.prototype.reset=function(){this.qi=0},t.prototype.Ki=function(){this.qi=this.Bi},t.prototype.ji=function(t){var e=this;this.cancel();var n=Math.floor(this.qi+this.Wi()),r=Math.max(0,Date.now()-this.Qi),i=Math.max(0,n-r);i>0&&Ir("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.qi+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.Ui=this.Se.enqueueAfterDelay(this.timerId,i,(function(){return e.Qi=Date.now(),t()})),this.qi*=this.Li,this.qi<this.Mi&&(this.qi=this.Mi),this.qi>this.Bi&&(this.qi=this.Bi)},t.prototype.Gi=function(){null!==this.Ui&&(this.Ui.skipDelay(),this.Ui=null)},t.prototype.cancel=function(){null!==this.Ui&&(this.Ui.cancel(),this.Ui=null)},t.prototype.Wi=function(){return(Math.random()-.5)*this.qi},t}(),Ic=function(){function t(t,e,n,r,i,o){this.Se=t,this.zi=n,this.Hi=r,this.Ji=i,this.listener=o,this.state=0,this.Yi=0,this.Xi=null,this.stream=null,this.Zi=new wc(t,e)}return t.prototype.tr=function(){return 1===this.state||2===this.state||4===this.state},t.prototype.er=function(){return 2===this.state},t.prototype.start=function(){3!==this.state?this.auth():this.nr()},t.prototype.stop=function(){return dr(this,void 0,void 0,(function(){return vr(this,(function(t){switch(t.label){case 0:return this.tr()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))},t.prototype.sr=function(){this.state=0,this.Zi.reset()},t.prototype.ir=function(){var t=this;this.er()&&null===this.Xi&&(this.Xi=this.Se.enqueueAfterDelay(this.zi,6e4,(function(){return t.rr()})))},t.prototype.cr=function(t){this.ar(),this.stream.send(t)},t.prototype.rr=function(){return dr(this,void 0,void 0,(function(){return vr(this,(function(t){return this.er()?[2,this.close(0)]:[2]}))}))},t.prototype.ar=function(){this.Xi&&(this.Xi.cancel(),this.Xi=null)},t.prototype.close=function(t,e){return dr(this,void 0,void 0,(function(){return vr(this,(function(n){switch(n.label){case 0:return this.ar(),this.Zi.cancel(),this.Yi++,3!==t?this.Zi.reset():e&&e.code===mr.RESOURCE_EXHAUSTED?(Tr(e.toString()),Tr("Using maximum backoff delay to prevent overloading the backend."),this.Zi.Ki()):e&&e.code===mr.UNAUTHENTICATED&&this.Ji.invalidateToken(),null!==this.stream&&(this.ur(),this.stream.close(),this.stream=null),this.state=t,[4,this.listener.Ri(e)];case 1:return n.sent(),[2]}}))}))},t.prototype.ur=function(){},t.prototype.auth=function(){var t=this;this.state=1;var e=this.hr(this.Yi),n=this.Yi;this.Ji.getToken().then((function(e){t.Yi===n&&t.lr(e)}),(function(n){e((function(){var e=new br(mr.UNKNOWN,"Fetching auth token failed: "+n.message);return t.dr(e)}))}))},t.prototype.lr=function(t){var e=this,n=this.hr(this.Yi);this.stream=this.wr(t),this.stream.Ii((function(){n((function(){return e.state=2,e.listener.Ii()}))})),this.stream.Ri((function(t){n((function(){return e.dr(t)}))})),this.stream.onMessage((function(t){n((function(){return e.onMessage(t)}))}))},t.prototype.nr=function(){var t=this;this.state=4,this.Zi.ji((function(){return dr(t,void 0,void 0,(function(){return vr(this,(function(t){return this.state=0,this.start(),[2]}))}))}))},t.prototype.dr=function(t){return Ir("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},t.prototype.hr=function(t){var e=this;return function(n){e.Se.enqueueAndForget((function(){return e.Yi===t?n():(Ir("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())}))}},t}(),Tc=function(t){function e(e,n,r,i,o){var a=this;return(a=t.call(this,e,"listen_stream_connection_backoff","listen_stream_idle",n,r,o)||this).R=i,a}return pr(e,t),e.prototype.wr=function(t){return this.Hi.$i("Listen",t)},e.prototype.onMessage=function(t){this.Zi.reset();var e=function(t,e){var n;if("targetChange"in e){e.targetChange;var r=function(t){return"NO_CHANGE"===t?0:"ADD"===t?1:"REMOVE"===t?2:"CURRENT"===t?3:"RESET"===t?4:Cr()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=function(t,e){return t.I?(kr(void 0===e||"string"==typeof e),Wr.fromBase64String(e||"")):(kr(void 0===e||e instanceof Uint8Array),Wr.fromUint8Array(e||new Uint8Array))}(t,e.targetChange.resumeToken),a=(s=e.targetChange.cause)&&function(t){var e=void 0===t.code?mr.UNKNOWN:Uo(t.code);return new br(e,t.message||"")}(s);n=new ia(r,i,o,a||null)}else if("documentChange"in e){e.documentChange,(r=e.documentChange).document,r.document.name,r.document.updateTime,i=ba(t,r.document.name),o=va(r.document.updateTime);var s=new vi({mapValue:{fields:r.document.fields}}),u=(a=yi.newFoundDocument(i,o,s),r.targetIds||[]),c=r.removedTargetIds||[];n=new na(u,c,a.key,a)}else if("documentDelete"in e)e.documentDelete,(r=e.documentDelete).document,i=ba(t,r.document),o=r.readTime?va(r.readTime):Lr.min(),s=yi.newNoDocument(i,o),a=r.removedTargetIds||[],n=new na([],a,s.key,s);else if("documentRemove"in e)e.documentRemove,(r=e.documentRemove).document,i=ba(t,r.document),o=r.removedTargetIds||[],n=new na([],o,i,null);else{if(!("filter"in e))return Cr();e.filter;var l=e.filter;l.targetId,r=l.count||0,i=new Mo(r),o=l.targetId,n=new ra(o,i)}return n}(this.R,t),n=function(t){if(!("targetChange"in t))return Lr.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length?Lr.min():e.readTime?va(e.readTime):Lr.min()}(t);return this.listener._r(e,n)},e.prototype.mr=function(t){var e={};e.database=Ia(this.R),e.addTarget=function(t,e){var n,r=e.target;return(n=Ii(r)?{documents:Aa(t,r)}:{query:Na(t,r)}).targetId=e.targetId,e.resumeToken.approximateByteSize()>0?n.resumeToken=pa(t,e.resumeToken):e.snapshotVersion.compareTo(Lr.min())>0&&(n.readTime=fa(t,e.snapshotVersion.toTimestamp())),n}(this.R,t);var n=function(t,e){var n=function(t,e){switch(e){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Cr()}}(0,e.purpose);return null==n?null:{"goog-listen-tags":n}}(this.R,t);n&&(e.labels=n),this.cr(e)},e.prototype.yr=function(t){var e={};e.database=Ia(this.R),e.removeTarget=t,this.cr(e)},e}(Ic),Ec=function(t){function e(e,n,r,i,o){var a=this;return(a=t.call(this,e,"write_stream_connection_backoff","write_stream_idle",n,r,o)||this).R=i,a.gr=!1,a}return pr(e,t),Object.defineProperty(e.prototype,"pr",{get:function(){return this.gr},enumerable:!1,configurable:!0}),e.prototype.start=function(){this.gr=!1,this.lastStreamToken=void 0,t.prototype.start.call(this)},e.prototype.ur=function(){this.gr&&this.Er([])},e.prototype.wr=function(t){return this.Hi.$i("Write",t)},e.prototype.onMessage=function(t){if(kr(!!t.streamToken),this.lastStreamToken=t.streamToken,this.gr){this.Zi.reset();var e=function(t,e){return t&&t.length>0?(kr(void 0!==e),t.map((function(t){return function(t,e){var n=t.updateTime?va(t.updateTime):va(e);return n.isEqual(Lr.min())&&(n=va(e)),new mo(n,t.transformResults||[])}(t,e)}))):[]}(t.writeResults,t.commitTime),n=va(t.commitTime);return this.listener.Tr(n,e)}return kr(!t.writeResults||0===t.writeResults.length),this.gr=!0,this.listener.Ir()},e.prototype.Ar=function(){var t={};t.database=Ia(this.R),this.cr(t)},e.prototype.Er=function(t){var e=this,n={streamToken:this.lastStreamToken,writes:t.map((function(t){return Ca(e.R,t)}))};this.cr(n)},e}(Ic),Sc=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).credentials=e,i.Hi=n,i.R=r,i.Rr=!1,i}return pr(e,t),e.prototype.br=function(){if(this.Rr)throw new br(mr.FAILED_PRECONDITION,"The client has already been terminated.")},e.prototype.Ni=function(t,e,n){var r=this;return this.br(),this.credentials.getToken().then((function(i){return r.Hi.Ni(t,e,n,i)})).catch((function(t){throw"FirebaseError"===t.name?(t.code===mr.UNAUTHENTICATED&&r.credentials.invalidateToken(),t):new br(mr.UNKNOWN,t.toString())}))},e.prototype.Oi=function(t,e,n){var r=this;return this.br(),this.credentials.getToken().then((function(i){return r.Hi.Oi(t,e,n,i)})).catch((function(t){throw"FirebaseError"===t.name?(t.code===mr.UNAUTHENTICATED&&r.credentials.invalidateToken(),t):new br(mr.UNKNOWN,t.toString())}))},e.prototype.terminate=function(){this.Rr=!0},e}((function(){})),Cc=function(){function t(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state="Unknown",this.vr=0,this.Pr=null,this.Vr=!0}return t.prototype.Sr=function(){var t=this;0===this.vr&&(this.Dr("Unknown"),this.Pr=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(function(){return t.Pr=null,t.Cr("Backend didn't respond within 10 seconds."),t.Dr("Offline"),Promise.resolve()})))},t.prototype.Nr=function(t){"Online"===this.state?this.Dr("Unknown"):(this.vr++,this.vr>=1&&(this.Fr(),this.Cr("Connection failed 1 times. Most recent error: "+t.toString()),this.Dr("Offline")))},t.prototype.set=function(t){this.Fr(),this.vr=0,"Online"===t&&(this.Vr=!1),this.Dr(t)},t.prototype.Dr=function(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))},t.prototype.Cr=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.Vr?(Tr(e),this.Vr=!1):Ir("OnlineStateTracker",e)},t.prototype.Fr=function(){null!==this.Pr&&(this.Pr.cancel(),this.Pr=null)},t}(),kc=function(t,e,n,r,i){var o=this;this.localStore=t,this.datastore=e,this.asyncQueue=n,this.remoteSyncer={},this.kr=[],this.Or=new Map,this.$r=new Set,this.Mr=[],this.Lr=i,this.Lr.di((function(t){n.enqueueAndForget((function(){return dr(o,void 0,void 0,(function(){return vr(this,(function(t){switch(t.label){case 0:return Mc(this)?(Ir("RemoteStore","Restarting streams for network reachability change."),[4,function(t){return dr(this,void 0,void 0,(function(){var e;return vr(this,(function(n){switch(n.label){case 0:return(e=Ar(t)).$r.add(4),[4,Nc(e)];case 1:return n.sent(),e.Br.set("Unknown"),e.$r.delete(4),[4,Ac(e)];case 2:return n.sent(),[2]}}))}))}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))}))})),this.Br=new Cc(n,r)};function Ac(t){return dr(this,void 0,void 0,(function(){var e,n;return vr(this,(function(r){switch(r.label){case 0:if(!Mc(t))return[3,4];e=0,n=t.Mr,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}}))}))}function Nc(t){return dr(this,void 0,void 0,(function(){var e,n;return vr(this,(function(r){switch(r.label){case 0:e=0,n=t.Mr,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}}))}))}function Pc(t,e){var n=Ar(t);n.Or.has(e.targetId)||(n.Or.set(e.targetId,e),Lc(n)?Dc(n):Jc(n).er()&&Rc(n,e))}function Oc(t,e){var n=Ar(t),r=Jc(n);n.Or.delete(e),r.er()&&xc(n,e),0===n.Or.size&&(r.er()?r.ir():Mc(n)&&n.Br.set("Unknown"))}function Rc(t,e){t.qr.U(e.targetId),Jc(t).mr(e)}function xc(t,e){t.qr.U(e),Jc(t).yr(e)}function Dc(t){t.qr=new aa({getRemoteKeysForTarget:function(e){return t.remoteSyncer.getRemoteKeysForTarget(e)},lt:function(e){return t.Or.get(e)||null}}),Jc(t).start(),t.Br.Sr()}function Lc(t){return Mc(t)&&!Jc(t).tr()&&t.Or.size>0}function Mc(t){return 0===Ar(t).$r.size}function Fc(t){t.qr=void 0}function Uc(t){return dr(this,void 0,void 0,(function(){return vr(this,(function(e){return t.Or.forEach((function(e,n){Rc(t,e)})),[2]}))}))}function jc(t,e){return dr(this,void 0,void 0,(function(){return vr(this,(function(n){return Fc(t),Lc(t)?(t.Br.Nr(e),Dc(t)):t.Br.set("Unknown"),[2]}))}))}function qc(t,e,n){return dr(this,void 0,void 0,(function(){var r,i,o;return vr(this,(function(a){switch(a.label){case 0:if(t.Br.set("Online"),!(e instanceof ia&&2===e.state&&e.cause))return[3,6];a.label=1;case 1:return a.trys.push([1,3,,5]),[4,function(t,e){return dr(this,void 0,void 0,(function(){var n,r,i,o;return vr(this,(function(a){switch(a.label){case 0:n=e.cause,r=0,i=e.targetIds,a.label=1;case 1:return r<i.length?(o=i[r],t.Or.has(o)?[4,t.remoteSyncer.rejectListen(o,n)]:[3,3]):[3,5];case 2:a.sent(),t.Or.delete(o),t.qr.removeTarget(o),a.label=3;case 3:a.label=4;case 4:return r++,[3,1];case 5:return[2]}}))}))}(t,e)];case 2:return a.sent(),[3,5];case 3:return r=a.sent(),Ir("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),[4,Vc(t,r)];case 4:return a.sent(),[3,5];case 5:return[3,13];case 6:if(e instanceof na?t.qr.X(e):e instanceof ra?t.qr.rt(e):t.qr.et(e),n.isEqual(Lr.min()))return[3,13];a.label=7;case 7:return a.trys.push([7,11,,13]),[4,Du(t.localStore)];case 8:return i=a.sent(),n.compareTo(i)>=0?[4,function(t,e){var n=t.qr.at(e);return n.targetChanges.forEach((function(n,r){if(n.resumeToken.approximateByteSize()>0){var i=t.Or.get(r);i&&t.Or.set(r,i.withResumeToken(n.resumeToken,e))}})),n.targetMismatches.forEach((function(e){var n=t.Or.get(e);if(n){t.Or.set(e,n.withResumeToken(Wr.EMPTY_BYTE_STRING,n.snapshotVersion)),xc(t,e);var r=new Cs(n.target,e,1,n.sequenceNumber);Rc(t,r)}})),t.remoteSyncer.applyRemoteEvent(n)}(t,n)]:[3,10];case 9:a.sent(),a.label=10;case 10:return[3,13];case 11:return Ir("RemoteStore","Failed to raise snapshot:",o=a.sent()),[4,Vc(t,o)];case 12:return a.sent(),[3,13];case 13:return[2]}}))}))}function Vc(t,e,n){return dr(this,void 0,void 0,(function(){var r=this;return vr(this,(function(i){switch(i.label){case 0:if(!ys(e))throw e;return t.$r.add(1),[4,Nc(t)];case 1:return i.sent(),t.Br.set("Offline"),n||(n=function(){return Du(t.localStore)}),t.asyncQueue.enqueueRetryable((function(){return dr(r,void 0,void 0,(function(){return vr(this,(function(e){switch(e.label){case 0:return Ir("RemoteStore","Retrying IndexedDB access"),[4,n()];case 1:return e.sent(),t.$r.delete(1),[4,Ac(t)];case 2:return e.sent(),[2]}}))}))})),[2]}}))}))}function Bc(t,e){return e().catch((function(n){return Vc(t,n,e)}))}function Kc(t){return dr(this,void 0,void 0,(function(){var e,n,r,i,o;return vr(this,(function(a){switch(a.label){case 0:e=Ar(t),n=$c(e),r=e.kr.length>0?e.kr[e.kr.length-1].batchId:-1,a.label=1;case 1:if(!function(t){return Mc(t)&&t.kr.length<10}(e))return[3,7];a.label=2;case 2:return a.trys.push([2,4,,6]),[4,Fu(e.localStore,r)];case 3:return null===(i=a.sent())?(0===e.kr.length&&n.ir(),[3,7]):(r=i.batchId,function(t,e){t.kr.push(e);var n=$c(t);n.er()&&n.pr&&n.Er(e.mutations)}(e,i),[3,6]);case 4:return o=a.sent(),[4,Vc(e,o)];case 5:return a.sent(),[3,6];case 6:return[3,1];case 7:return Wc(e)&&Gc(e),[2]}}))}))}function Wc(t){return Mc(t)&&!$c(t).tr()&&t.kr.length>0}function Gc(t){$c(t).start()}function Hc(t){return dr(this,void 0,void 0,(function(){return vr(this,(function(e){return $c(t).Ar(),[2]}))}))}function zc(t){return dr(this,void 0,void 0,(function(){var e,n,r,i;return vr(this,(function(o){for(e=$c(t),n=0,r=t.kr;n<r.length;n++)i=r[n],e.Er(i.mutations);return[2]}))}))}function Qc(t,e,n){return dr(this,void 0,void 0,(function(){var r,i;return vr(this,(function(o){switch(o.label){case 0:return r=t.kr.shift(),i=Ss.from(r,e,n),[4,Bc(t,(function(){return t.remoteSyncer.applySuccessfulWrite(i)}))];case 1:return o.sent(),[4,Kc(t)];case 2:return o.sent(),[2]}}))}))}function Yc(t,e){return dr(this,void 0,void 0,(function(){return vr(this,(function(n){switch(n.label){case 0:return e&&$c(t).pr?[4,function(t,e){return dr(this,void 0,void 0,(function(){var n,r;return vr(this,(function(i){switch(i.label){case 0:return Fo(r=e.code)&&r!==mr.ABORTED?(n=t.kr.shift(),$c(t).sr(),[4,Bc(t,(function(){return t.remoteSyncer.rejectFailedWrite(n.batchId,e)}))]):[3,3];case 1:return i.sent(),[4,Kc(t)];case 2:i.sent(),i.label=3;case 3:return[2]}}))}))}(t,e)]:[3,2];case 1:n.sent(),n.label=2;case 2:return Wc(t)&&Gc(t),[2]}}))}))}function Xc(t,e){return dr(this,void 0,void 0,(function(){var n;return vr(this,(function(r){switch(r.label){case 0:return n=Ar(t),e?(n.$r.delete(2),[4,Ac(n)]):[3,2];case 1:return r.sent(),[3,5];case 2:return e?[3,4]:(n.$r.add(2),[4,Nc(n)]);case 3:r.sent(),n.Br.set("Unknown"),r.label=4;case 4:r.label=5;case 5:return[2]}}))}))}function Jc(t){var e=this;return t.Ur||(t.Ur=function(t,e,n){var r=Ar(t);return r.br(),new Tc(e,r.Hi,r.credentials,r.R,n)}(t.datastore,t.asyncQueue,{Ii:Uc.bind(null,t),Ri:jc.bind(null,t),_r:qc.bind(null,t)}),t.Mr.push((function(n){return dr(e,void 0,void 0,(function(){return vr(this,(function(e){switch(e.label){case 0:return n?(t.Ur.sr(),Lc(t)?Dc(t):t.Br.set("Unknown"),[3,3]):[3,1];case 1:return[4,t.Ur.stop()];case 2:e.sent(),Fc(t),e.label=3;case 3:return[2]}}))}))}))),t.Ur}function $c(t){var e=this;return t.Qr||(t.Qr=function(t,e,n){var r=Ar(t);return r.br(),new Ec(e,r.Hi,r.credentials,r.R,n)}(t.datastore,t.asyncQueue,{Ii:Hc.bind(null,t),Ri:Yc.bind(null,t),Ir:zc.bind(null,t),Tr:Qc.bind(null,t)}),t.Mr.push((function(n){return dr(e,void 0,void 0,(function(){return vr(this,(function(e){switch(e.label){case 0:return n?(t.Qr.sr(),[4,Kc(t)]):[3,2];case 1:return e.sent(),[3,4];case 2:return[4,t.Qr.stop()];case 3:e.sent(),t.kr.length>0&&(Ir("RemoteStore","Stopping write stream with "+t.kr.length+" pending writes"),t.kr=[]),e.label=4;case 4:return[2]}}))}))}))),t.Qr}var Zc=function(){function t(t,e,n,r,i){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new hs,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((function(t){}))}return t.createAndSchedule=function(e,n,r,i,o){var a=new t(e,n,Date.now()+r,i,o);return a.start(r),a},t.prototype.start=function(t){var e=this;this.timerHandle=setTimeout((function(){return e.handleDelayElapsed()}),t)},t.prototype.skipDelay=function(){return this.handleDelayElapsed()},t.prototype.cancel=function(t){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new br(mr.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},t.prototype.handleDelayElapsed=function(){var t=this;this.asyncQueue.enqueueAndForget((function(){return null!==t.timerHandle?(t.clearTimeout(),t.op().then((function(e){return t.deferred.resolve(e)}))):Promise.resolve()}))},t.prototype.clearTimeout=function(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)},t}();function tl(t,e){if(Tr("AsyncQueue",e+": "+t),ys(t))return new br(mr.UNAVAILABLE,e+": "+t);throw t}var el=function(){function t(t){this.comparator=t?function(e,n){return t(e,n)||ei.comparator(e.key,n.key)}:function(t,e){return ei.comparator(t.key,e.key)},this.keyedMap=zo(),this.sortedSet=new jo(this.comparator)}return t.emptySet=function(e){return new t(e.comparator)},t.prototype.has=function(t){return null!=this.keyedMap.get(t)},t.prototype.get=function(t){return this.keyedMap.get(t)},t.prototype.first=function(){return this.sortedSet.minKey()},t.prototype.last=function(){return this.sortedSet.maxKey()},t.prototype.isEmpty=function(){return this.sortedSet.isEmpty()},t.prototype.indexOf=function(t){var e=this.keyedMap.get(t);return e?this.sortedSet.indexOf(e):-1},Object.defineProperty(t.prototype,"size",{get:function(){return this.sortedSet.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t){this.sortedSet.inorderTraversal((function(e,n){return t(e),!1}))},t.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.keyedMap.insert(t.key,t),e.sortedSet.insert(t,null))},t.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(e)):this},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();n.hasNext();){var i=n.getNext().key,o=r.getNext().key;if(!i.isEqual(o))return!1}return!0},t.prototype.toString=function(){var t=[];return this.forEach((function(e){t.push(e.toString())})),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"},t.prototype.copy=function(e,n){var r=new t;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r},t}(),nl=function(){function t(){this.Kr=new jo(ei.comparator)}return t.prototype.track=function(t){var e=t.doc.key,n=this.Kr.get(e);n?0!==t.type&&3===n.type?this.Kr=this.Kr.insert(e,t):3===t.type&&1!==n.type?this.Kr=this.Kr.insert(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.Kr=this.Kr.insert(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.Kr=this.Kr.insert(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.Kr=this.Kr.remove(e):1===t.type&&2===n.type?this.Kr=this.Kr.insert(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.Kr=this.Kr.insert(e,{type:2,doc:t.doc}):Cr():this.Kr=this.Kr.insert(e,t)},t.prototype.jr=function(){var t=[];return this.Kr.inorderTraversal((function(e,n){t.push(n)})),t},t}(),rl=function(){function t(t,e,n,r,i,o,a,s){this.query=t,this.docs=e,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=s}return t.fromInitialDocuments=function(e,n,r,i){var o=[];return n.forEach((function(t){o.push({type:0,doc:t})})),new t(e,n,el.emptySet(n),o,r,i,!0,!1)},Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return!this.mutatedKeys.isEmpty()},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&Yi(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},t}(),il=function(){this.Wr=void 0,this.listeners=[]},ol=function(){this.queries=new fu((function(t){return Xi(t)}),Yi),this.onlineState="Unknown",this.Gr=new Set};function al(t,e){return dr(this,void 0,void 0,(function(){var n,r,i,o,a,s,u;return vr(this,(function(c){switch(c.label){case 0:if(n=Ar(t),r=e.query,i=!1,(o=n.queries.get(r))||(i=!0,o=new il),!i)return[3,4];c.label=1;case 1:return c.trys.push([1,3,,4]),a=o,[4,n.onListen(r)];case 2:return a.Wr=c.sent(),[3,4];case 3:return s=c.sent(),u=tl(s,"Initialization of query '"+Ji(e.query)+"' failed"),[2,void e.onError(u)];case 4:return n.queries.set(r,o),o.listeners.push(e),e.zr(n.onlineState),o.Wr&&e.Hr(o.Wr)&&ll(n),[2]}}))}))}function sl(t,e){return dr(this,void 0,void 0,(function(){var n,r,i,o,a;return vr(this,(function(s){return n=Ar(t),r=e.query,i=!1,(o=n.queries.get(r))&&(a=o.listeners.indexOf(e))>=0&&(o.listeners.splice(a,1),i=0===o.listeners.length),i?[2,(n.queries.delete(r),n.onUnlisten(r))]:[2]}))}))}function ul(t,e){for(var n=Ar(t),r=!1,i=0,o=e;i<o.length;i++){var a=o[i],s=a.query,u=n.queries.get(s);if(u){for(var c=0,l=u.listeners;c<l.length;c++)l[c].Hr(a)&&(r=!0);u.Wr=a}}r&&ll(n)}function cl(t,e,n){var r=Ar(t),i=r.queries.get(e);if(i)for(var o=0,a=i.listeners;o<a.length;o++)a[o].onError(n);r.queries.delete(e)}function ll(t){t.Gr.forEach((function(t){t.next()}))}var hl=function(){function t(t,e,n){this.query=t,this.Jr=e,this.Yr=!1,this.Xr=null,this.onlineState="Unknown",this.options=n||{}}return t.prototype.Hr=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new rl(t.query,t.docs,t.oldDocs,e,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0)}var o=!1;return this.Yr?this.Zr(t)&&(this.Jr.next(t),o=!0):this.eo(t,this.onlineState)&&(this.no(t),o=!0),this.Xr=t,o},t.prototype.onError=function(t){this.Jr.error(t)},t.prototype.zr=function(t){this.onlineState=t;var e=!1;return this.Xr&&!this.Yr&&this.eo(this.Xr,t)&&(this.no(this.Xr),e=!0),e},t.prototype.eo=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.so&&n||t.docs.isEmpty()&&"Offline"!==e)},t.prototype.Zr=function(t){if(t.docChanges.length>0)return!0;var e=this.Xr&&this.Xr.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!e)&&!0===this.options.includeMetadataChanges},t.prototype.no=function(t){t=rl.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache),this.Yr=!0,this.Jr.next(t)},t}(),fl=function(){function t(t,e){this.payload=t,this.byteLength=e}return t.prototype.io=function(){return"metadata"in this.payload},t}(),pl=function(){function t(t){this.R=t}return t.prototype.qn=function(t){return ba(this.R,t)},t.prototype.Un=function(t){return t.metadata.exists?Sa(this.R,t.document,!1):yi.newNoDocument(this.qn(t.metadata.name),this.Qn(t.metadata.readTime))},t.prototype.Qn=function(t){return va(t)},t}(),dl=function(){function t(t,e,n){this.ro=t,this.localStore=e,this.R=n,this.queries=[],this.documents=[],this.progress=vl(t)}return t.prototype.oo=function(t){this.progress.bytesLoaded+=t.byteLength;var e=this.progress.documentsLoaded;return t.payload.namedQuery?this.queries.push(t.payload.namedQuery):t.payload.documentMetadata?(this.documents.push({metadata:t.payload.documentMetadata}),t.payload.documentMetadata.exists||++e):t.payload.document&&(this.documents[this.documents.length-1].document=t.payload.document,++e),e!==this.progress.documentsLoaded?(this.progress.documentsLoaded=e,Object.assign({},this.progress)):null},t.prototype.co=function(t){for(var e=new Map,n=new pl(this.R),r=0,i=t;r<i.length;r++){var o=i[r];if(o.metadata.queries)for(var a=n.qn(o.metadata.name),s=0,u=o.metadata.queries;s<u.length;s++){var c=u[s],l=(e.get(c)||Jo()).add(a);e.set(c,l)}}return e},t.prototype.complete=function(){return dr(this,void 0,void 0,(function(){var t,e,n,r,i;return vr(this,(function(o){switch(o.label){case 0:return[4,Wu(this.localStore,new pl(this.R),this.documents,this.ro.id)];case 1:t=o.sent(),e=this.co(this.documents),n=0,r=this.queries,o.label=2;case 2:return n<r.length?(i=r[n],[4,Gu(this.localStore,i,e.get(i.name))]):[3,5];case 3:o.sent(),o.label=4;case 4:return n++,[3,2];case 5:return[2,(this.progress.taskState="Success",new Cu(Object.assign({},this.progress),t))]}}))}))},t}();function vl(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}var gl=function(t){this.key=t},yl=function(t){this.key=t},ml=function(){function t(t,e){this.query=t,this.ao=e,this.uo=null,this.current=!1,this.ho=Jo(),this.mutatedKeys=Jo(),this.lo=Zi(t),this.fo=new el(this.lo)}return Object.defineProperty(t.prototype,"wo",{get:function(){return this.ao},enumerable:!1,configurable:!0}),t.prototype._o=function(t,e){var n=this,r=e?e.mo:new nl,i=e?e.fo:this.fo,o=e?e.mutatedKeys:this.mutatedKeys,a=i,s=!1,u=Vi(this.query)&&i.size===this.query.limit?i.last():null,c=Bi(this.query)&&i.size===this.query.limit?i.first():null;if(t.inorderTraversal((function(t,e){var l=i.get(t),h=$i(n.query,e)?e:null,f=!!l&&n.mutatedKeys.has(l.key),p=!!h&&(h.hasLocalMutations||n.mutatedKeys.has(h.key)&&h.hasCommittedMutations),d=!1;l&&h?l.data.isEqual(h.data)?f!==p&&(r.track({type:3,doc:h}),d=!0):n.yo(l,h)||(r.track({type:2,doc:h}),d=!0,(u&&n.lo(h,u)>0||c&&n.lo(h,c)<0)&&(s=!0)):!l&&h?(r.track({type:0,doc:h}),d=!0):l&&!h&&(r.track({type:1,doc:l}),d=!0,(u||c)&&(s=!0)),d&&(h?(a=a.add(h),o=p?o.add(t):o.delete(t)):(a=a.delete(t),o=o.delete(t)))})),Vi(this.query)||Bi(this.query))for(;a.size>this.query.limit;){var l=Vi(this.query)?a.last():a.first();a=a.delete(l.key),o=o.delete(l.key),r.track({type:1,doc:l})}return{fo:a,mo:r,Nn:s,mutatedKeys:o}},t.prototype.yo=function(t,e){return t.hasLocalMutations&&e.hasCommittedMutations&&!e.hasLocalMutations},t.prototype.applyChanges=function(t,e,n){var r=this,i=this.fo;this.fo=t.fo,this.mutatedKeys=t.mutatedKeys;var o=t.mo.jr();o.sort((function(t,e){return function(t,e){var n=function(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Cr()}};return n(t)-n(e)}(t.type,e.type)||r.lo(t.doc,e.doc)})),this.po(n);var a=e?this.Eo():[],s=0===this.ho.size&&this.current?1:0,u=s!==this.uo;return this.uo=s,0!==o.length||u?{snapshot:new rl(this.query,t.fo,i,o,t.mutatedKeys,0===s,u,!1),To:a}:{To:a}},t.prototype.zr=function(t){return this.current&&"Offline"===t?(this.current=!1,this.applyChanges({fo:this.fo,mo:new nl,mutatedKeys:this.mutatedKeys,Nn:!1},!1)):{To:[]}},t.prototype.Io=function(t){return!this.ao.has(t)&&!!this.fo.has(t)&&!this.fo.get(t).hasLocalMutations},t.prototype.po=function(t){var e=this;t&&(t.addedDocuments.forEach((function(t){return e.ao=e.ao.add(t)})),t.modifiedDocuments.forEach((function(t){})),t.removedDocuments.forEach((function(t){return e.ao=e.ao.delete(t)})),this.current=t.current)},t.prototype.Eo=function(){var t=this;if(!this.current)return[];var e=this.ho;this.ho=Jo(),this.fo.forEach((function(e){t.Io(e.key)&&(t.ho=t.ho.add(e.key))}));var n=[];return e.forEach((function(e){t.ho.has(e)||n.push(new yl(e))})),this.ho.forEach((function(t){e.has(t)||n.push(new gl(t))})),n},t.prototype.Ao=function(t){this.ao=t.Bn,this.ho=Jo();var e=this._o(t.documents);return this.applyChanges(e,!0)},t.prototype.Ro=function(){return rl.fromInitialDocuments(this.query,this.fo,this.mutatedKeys,0===this.uo)},t}(),bl=function(t,e,n){this.query=t,this.targetId=e,this.view=n},_l=function(t){this.key=t,this.bo=!1},wl=function(){function t(t,e,n,r,i,o){this.localStore=t,this.remoteStore=e,this.eventManager=n,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.vo={},this.Po=new fu((function(t){return Xi(t)}),Yi),this.Vo=new Map,this.So=new Set,this.Do=new jo(ei.comparator),this.Co=new Map,this.No=new zu,this.xo={},this.Fo=new Map,this.ko=tu.Yt(),this.onlineState="Unknown",this.Oo=void 0}return Object.defineProperty(t.prototype,"isPrimaryClient",{get:function(){return!0===this.Oo},enumerable:!1,configurable:!0}),t}();function Il(t,e){return dr(this,void 0,void 0,(function(){var n,r,i,o,a,s;return vr(this,(function(u){switch(u.label){case 0:return n=Jl(t),(o=n.Po.get(e))?(r=o.targetId,n.sharedClientState.addLocalQueryTarget(r),i=o.view.Ro(),[3,4]):[3,1];case 1:return[4,Uu(n.localStore,zi(e))];case 2:return a=u.sent(),s=n.sharedClientState.addLocalQueryTarget(a.targetId),r=a.targetId,[4,Tl(n,e,r,"current"===s)];case 3:i=u.sent(),n.isPrimaryClient&&Pc(n.remoteStore,a),u.label=4;case 4:return[2,i]}}))}))}function Tl(t,e,n,r){return dr(this,void 0,void 0,(function(){var i,o,a,s,u,c;return vr(this,(function(l){switch(l.label){case 0:return t.$o=function(e,n,r){return function(t,e,n,r){return dr(this,void 0,void 0,(function(){var i,o,a;return vr(this,(function(s){switch(s.label){case 0:return(i=e.view._o(n)).Nn?[4,qu(t.localStore,e.query,!1).then((function(t){var n=t.documents;return e.view._o(n,i)}))]:[3,2];case 1:i=s.sent(),s.label=2;case 2:return o=r&&r.targetChanges.get(e.targetId),a=e.view.applyChanges(i,t.isPrimaryClient,o),[2,(Ml(t,e.targetId,a.To),a.snapshot)]}}))}))}(t,e,n,r)},[4,qu(t.localStore,e,!0)];case 1:return i=l.sent(),o=new ml(e,i.Bn),a=o._o(i.documents),s=ea.createSynthesizedTargetChangeForCurrentChange(n,r&&"Offline"!==t.onlineState),u=o.applyChanges(a,t.isPrimaryClient,s),Ml(t,n,u.To),c=new bl(e,n,o),[2,(t.Po.set(e,c),t.Vo.has(n)?t.Vo.get(n).push(e):t.Vo.set(n,[e]),u.snapshot)]}}))}))}function El(t,e){return dr(this,void 0,void 0,(function(){var n,r,i;return vr(this,(function(o){switch(o.label){case 0:return n=Ar(t),r=n.Po.get(e),(i=n.Vo.get(r.targetId)).length>1?[2,(n.Vo.set(r.targetId,i.filter((function(t){return!Yi(t,e)}))),void n.Po.delete(e))]:n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)?[3,2]:[4,ju(n.localStore,r.targetId,!1).then((function(){n.sharedClientState.clearQueryState(r.targetId),Oc(n.remoteStore,r.targetId),Dl(n,r.targetId)})).catch(ou)]):[3,3];case 1:o.sent(),o.label=2;case 2:return[3,5];case 3:return Dl(n,r.targetId),[4,ju(n.localStore,r.targetId,!0)];case 4:o.sent(),o.label=5;case 5:return[2]}}))}))}function Sl(t,e,n){return dr(this,void 0,void 0,(function(){var r,i,o,a;return vr(this,(function(s){switch(s.label){case 0:r=$l(t),s.label=1;case 1:return s.trys.push([1,5,,6]),[4,function(t,e){var n,r=Ar(t),i=Dr.now(),o=e.reduce((function(t,e){return t.add(e.key)}),Jo());return r.persistence.runTransaction("Locally write mutations","readwrite",(function(t){return r.Mn.pn(t,o).next((function(o){n=o;for(var a=[],s=0,u=e;s<u.length;s++){var c=u[s],l=Eo(c,n.get(c.key));null!=l&&a.push(new Ao(c.key,l,gi(l.toProto().mapValue),bo.exists(!0)))}return r._n.addMutationBatch(t,i,a,e)}))})).then((function(t){return t.applyToLocalDocumentSet(n),{batchId:t.batchId,changes:n}}))}(r.localStore,e)];case 2:return i=s.sent(),r.sharedClientState.addPendingMutation(i.batchId),function(t,e,n){var r=t.xo[t.currentUser.toKey()];r||(r=new jo(Or)),r=r.insert(e,n),t.xo[t.currentUser.toKey()]=r}(r,i.batchId,n),[4,jl(r,i.changes)];case 3:return s.sent(),[4,Kc(r.remoteStore)];case 4:return s.sent(),[3,6];case 5:return o=s.sent(),a=tl(o,"Failed to persist write"),n.reject(a),[3,6];case 6:return[2]}}))}))}function Cl(t,e){return dr(this,void 0,void 0,(function(){var n,r;return vr(this,(function(i){switch(i.label){case 0:n=Ar(t),i.label=1;case 1:return i.trys.push([1,4,,6]),[4,Lu(n.localStore,e)];case 2:return r=i.sent(),e.targetChanges.forEach((function(t,e){var r=n.Co.get(e);r&&(kr(t.addedDocuments.size+t.modifiedDocuments.size+t.removedDocuments.size<=1),t.addedDocuments.size>0?r.bo=!0:t.modifiedDocuments.size>0?kr(r.bo):t.removedDocuments.size>0&&(kr(r.bo),r.bo=!1))})),[4,jl(n,r,e)];case 3:return i.sent(),[3,6];case 4:return[4,ou(i.sent())];case 5:return i.sent(),[3,6];case 6:return[2]}}))}))}function kl(t,e,n){var r=Ar(t);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){var i=[];r.Po.forEach((function(t,n){var r=n.view.zr(e);r.snapshot&&i.push(r.snapshot)})),function(t,e){var n=Ar(t);n.onlineState=e;var r=!1;n.queries.forEach((function(t,n){for(var i=0,o=n.listeners;i<o.length;i++)o[i].zr(e)&&(r=!0)})),r&&ll(n)}(r.eventManager,e),i.length&&r.vo._r(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function Al(t,e,n){return dr(this,void 0,void 0,(function(){var r,i,o,a,s,u;return vr(this,(function(c){switch(c.label){case 0:return(r=Ar(t)).sharedClientState.updateQueryState(e,"rejected",n),i=r.Co.get(e),(o=i&&i.key)?(a=(a=new jo(ei.comparator)).insert(o,yi.newNoDocument(o,Lr.min())),s=Jo().add(o),u=new ta(Lr.min(),new Map,new Bo(Or),a,s),[4,Cl(r,u)]):[3,2];case 1:return c.sent(),r.Do=r.Do.remove(o),r.Co.delete(e),Ul(r),[3,4];case 2:return[4,ju(r.localStore,e,!1).then((function(){return Dl(r,e,n)})).catch(ou)];case 3:c.sent(),c.label=4;case 4:return[2]}}))}))}function Nl(t,e){return dr(this,void 0,void 0,(function(){var n,r,i;return vr(this,(function(o){switch(o.label){case 0:n=Ar(t),r=e.batch.batchId,o.label=1;case 1:return o.trys.push([1,4,,6]),[4,xu(n.localStore,e)];case 2:return i=o.sent(),xl(n,r,null),Rl(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),[4,jl(n,i)];case 3:return o.sent(),[3,6];case 4:return[4,ou(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}}))}))}function Pl(t,e,n){return dr(this,void 0,void 0,(function(){var r,i;return vr(this,(function(o){switch(o.label){case 0:r=Ar(t),o.label=1;case 1:return o.trys.push([1,4,,6]),[4,function(t,e){var n=Ar(t);return n.persistence.runTransaction("Reject batch","readwrite-primary",(function(t){var r;return n._n.lookupMutationBatch(t,e).next((function(e){return kr(null!==e),r=e.keys(),n._n.removeMutationBatch(t,e)})).next((function(){return n._n.performConsistencyCheck(t)})).next((function(){return n.Mn.pn(t,r)}))}))}(r.localStore,e)];case 2:return i=o.sent(),xl(r,e,n),Rl(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),[4,jl(r,i)];case 3:return o.sent(),[3,6];case 4:return[4,ou(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}}))}))}function Ol(t,e){return dr(this,void 0,void 0,(function(){var n,r,i,o,a;return vr(this,(function(s){switch(s.label){case 0:Mc((n=Ar(t)).remoteStore)||Ir("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),s.label=1;case 1:return s.trys.push([1,3,,4]),[4,function(t){var e=Ar(t);return e.persistence.runTransaction("Get highest unacknowledged batch id","readonly",(function(t){return e._n.getHighestUnacknowledgedBatchId(t)}))}(n.localStore)];case 2:return-1===(r=s.sent())?[2,void e.resolve()]:((i=n.Fo.get(r)||[]).push(e),n.Fo.set(r,i),[3,4]);case 3:return o=s.sent(),a=tl(o,"Initialization of waitForPendingWrites() operation failed"),e.reject(a),[3,4];case 4:return[2]}}))}))}function Rl(t,e){(t.Fo.get(e)||[]).forEach((function(t){t.resolve()})),t.Fo.delete(e)}function xl(t,e,n){var r=Ar(t),i=r.xo[r.currentUser.toKey()];if(i){var o=i.get(e);o&&(n?o.reject(n):o.resolve(),i=i.remove(e)),r.xo[r.currentUser.toKey()]=i}}function Dl(t,e,n){void 0===n&&(n=null),t.sharedClientState.removeLocalQueryTarget(e);for(var r=0,i=t.Vo.get(e);r<i.length;r++){var o=i[r];t.Po.delete(o),n&&t.vo.Mo(o,n)}t.Vo.delete(e),t.isPrimaryClient&&t.No.Zn(e).forEach((function(e){t.No.containsKey(e)||Ll(t,e)}))}function Ll(t,e){t.So.delete(e.path.canonicalString());var n=t.Do.get(e);null!==n&&(Oc(t.remoteStore,n),t.Do=t.Do.remove(e),t.Co.delete(n),Ul(t))}function Ml(t,e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];o instanceof gl?(t.No.addReference(o.key,e),Fl(t,o)):o instanceof yl?(Ir("SyncEngine","Document no longer in limbo: "+o.key),t.No.removeReference(o.key,e),t.No.containsKey(o.key)||Ll(t,o.key)):Cr()}}function Fl(t,e){var n=e.key,r=n.path.canonicalString();t.Do.get(n)||t.So.has(r)||(Ir("SyncEngine","New document in limbo: "+n),t.So.add(r),Ul(t))}function Ul(t){for(;t.So.size>0&&t.Do.size<t.maxConcurrentLimboResolutions;){var e=t.So.values().next().value;t.So.delete(e);var n=new ei(qr.fromString(e)),r=t.ko.next();t.Co.set(r,new _l(n)),t.Do=t.Do.insert(n,r),Pc(t.remoteStore,new Cs(zi(qi(n.path)),r,2,yr.o))}}function jl(t,e,n){return dr(this,void 0,void 0,(function(){var r,i,o,a;return vr(this,(function(s){switch(s.label){case 0:return r=Ar(t),i=[],o=[],a=[],r.Po.isEmpty()?[3,3]:(r.Po.forEach((function(t,s){a.push(r.$o(s,e,n).then((function(t){if(t){r.isPrimaryClient&&r.sharedClientState.updateQueryState(s.targetId,t.fromCache?"not-current":"current"),i.push(t);var e=Au.Pn(s.targetId,t);o.push(e)}})))})),[4,Promise.all(a)]);case 1:return s.sent(),r.vo._r(i),[4,function(t,e){return dr(this,void 0,void 0,(function(){var n,r,i,o,a,s,u,c,l;return vr(this,(function(h){switch(h.label){case 0:n=Ar(t),h.label=1;case 1:return h.trys.push([1,3,,4]),[4,n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(function(t){return fs.forEach(e,(function(e){return fs.forEach(e.bn,(function(r){return n.persistence.referenceDelegate.addReference(t,e.targetId,r)})).next((function(){return fs.forEach(e.vn,(function(r){return n.persistence.referenceDelegate.removeReference(t,e.targetId,r)}))}))}))}))];case 2:return h.sent(),[3,4];case 3:if(!ys(r=h.sent()))throw r;return Ir("LocalStore","Failed to update sequence numbers: "+r),[3,4];case 4:for(i=0,o=e;i<o.length;i++)a=o[i],s=a.targetId,a.fromCache||(u=n.Fn.get(s),c=u.snapshotVersion,l=u.withLastLimboFreeSnapshotVersion(c),n.Fn=n.Fn.insert(s,l));return[2]}}))}))}(r.localStore,o)];case 2:s.sent(),s.label=3;case 3:return[2]}}))}))}function ql(t,e){return dr(this,void 0,void 0,(function(){var n,r;return vr(this,(function(i){switch(i.label){case 0:return(n=Ar(t)).currentUser.isEqual(e)?[3,3]:(Ir("SyncEngine","User change. New user:",e.toKey()),[4,Ru(n.localStore,e)]);case 1:return r=i.sent(),n.currentUser=e,function(t,e){t.Fo.forEach((function(t){t.forEach((function(t){t.reject(new br(mr.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))}))})),t.Fo.clear()}(n),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),[4,jl(n,r.Ln)];case 2:i.sent(),i.label=3;case 3:return[2]}}))}))}function Vl(t,e){var n=Ar(t),r=n.Co.get(e);if(r&&r.bo)return Jo().add(r.key);var i=Jo(),o=n.Vo.get(e);if(!o)return i;for(var a=0,s=o;a<s.length;a++){var u=s[a],c=n.Po.get(u);i=i.unionWith(c.view.wo)}return i}function Bl(t,e){return dr(this,void 0,void 0,(function(){var n,r,i;return vr(this,(function(o){switch(o.label){case 0:return[4,qu((n=Ar(t)).localStore,e.query,!0)];case 1:return r=o.sent(),i=e.view.Ao(r),[2,(n.isPrimaryClient&&Ml(n,e.targetId,i.To),i)]}}))}))}function Kl(t){return dr(this,void 0,void 0,(function(){var e;return vr(this,(function(n){return[2,Bu((e=Ar(t)).localStore).then((function(t){return jl(e,t)}))]}))}))}function Wl(t,e,n,r){return dr(this,void 0,void 0,(function(){var i,o;return vr(this,(function(a){switch(a.label){case 0:return[4,function(t,e){var n=Ar(t),r=Ar(n._n);return n.persistence.runTransaction("Lookup mutation documents","readonly",(function(t){return r.jt(t,e).next((function(e){return e?n.Mn.pn(t,e):fs.resolve(null)}))}))}((i=Ar(t)).localStore,e)];case 1:return null===(o=a.sent())?[3,6]:"pending"!==n?[3,3]:[4,Kc(i.remoteStore)];case 2:return a.sent(),[3,4];case 3:"acknowledged"===n||"rejected"===n?(xl(i,e,r||null),Rl(i,e),function(t,e){Ar(Ar(t)._n).Gt(e)}(i.localStore,e)):Cr(),a.label=4;case 4:return[4,jl(i,o)];case 5:return a.sent(),[3,7];case 6:Ir("SyncEngine","Cannot apply mutation batch with id: "+e),a.label=7;case 7:return[2]}}))}))}function Gl(t,e){return dr(this,void 0,void 0,(function(){var n,r,i,o,a,s,u,c;return vr(this,(function(l){switch(l.label){case 0:return Jl(n=Ar(t)),$l(n),!0!==e||!0===n.Oo?[3,3]:(r=n.sharedClientState.getAllActiveQueryTargets(),[4,Hl(n,r.toArray())]);case 1:return i=l.sent(),n.Oo=!0,[4,Xc(n.remoteStore,!0)];case 2:for(l.sent(),o=0,a=i;o<a.length;o++)s=a[o],Pc(n.remoteStore,s);return[3,7];case 3:return!1!==e||!1===n.Oo?[3,7]:(u=[],c=Promise.resolve(),n.Vo.forEach((function(t,e){n.sharedClientState.isLocalQueryTarget(e)?u.push(e):c=c.then((function(){return Dl(n,e),ju(n.localStore,e,!0)})),Oc(n.remoteStore,e)})),[4,c]);case 4:return l.sent(),[4,Hl(n,u)];case 5:return l.sent(),function(t){var e=Ar(t);e.Co.forEach((function(t,n){Oc(e.remoteStore,n)})),e.No.ts(),e.Co=new Map,e.Do=new jo(ei.comparator)}(n),n.Oo=!1,[4,Xc(n.remoteStore,!1)];case 6:l.sent(),l.label=7;case 7:return[2]}}))}))}function Hl(t,e,n){return dr(this,void 0,void 0,(function(){var n,r,i,o,a,s,u,c,l,h,f,p,d,v;return vr(this,(function(g){switch(g.label){case 0:n=Ar(t),r=[],i=[],o=0,a=e,g.label=1;case 1:return o<a.length?(s=a[o],u=void 0,(c=n.Vo.get(s))&&0!==c.length?[4,Uu(n.localStore,zi(c[0]))]:[3,7]):[3,13];case 2:u=g.sent(),l=0,h=c,g.label=3;case 3:return l<h.length?(f=h[l],p=n.Po.get(f),[4,Bl(n,p)]):[3,6];case 4:(d=g.sent()).snapshot&&i.push(d.snapshot),g.label=5;case 5:return l++,[3,3];case 6:return[3,11];case 7:return[4,Vu(n.localStore,s)];case 8:return v=g.sent(),[4,Uu(n.localStore,v)];case 9:return u=g.sent(),[4,Tl(n,zl(v),s,!1)];case 10:g.sent(),g.label=11;case 11:r.push(u),g.label=12;case 12:return o++,[3,1];case 13:return[2,(n.vo._r(i),r)]}}))}))}function zl(t){return ji(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function Ql(t){var e=Ar(t);return Ar(Ar(e.localStore).persistence).fn()}function Yl(t,e,n,r){return dr(this,void 0,void 0,(function(){var i,o,a;return vr(this,(function(s){switch(s.label){case 0:return(i=Ar(t)).Oo?(Ir("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!i.Vo.has(e))return[3,8];switch(n){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,Bu(i.localStore)];case 3:return o=s.sent(),a=ta.createSynthesizedRemoteEventForCurrentChange(e,"current"===n),[4,jl(i,o,a)];case 4:return s.sent(),[3,8];case 5:return[4,ju(i.localStore,e,!0)];case 6:return s.sent(),Dl(i,e,r),[3,8];case 7:Cr(),s.label=8;case 8:return[2]}}))}))}function Xl(t,e,n){return dr(this,void 0,void 0,(function(){var r,i,o,a,s,u,c,l,h,f;return vr(this,(function(p){switch(p.label){case 0:if(!(r=Jl(t)).Oo)return[3,10];i=0,o=e,p.label=1;case 1:return i<o.length?(a=o[i],r.Vo.has(a)?(Ir("SyncEngine","Adding an already active target "+a),[3,5]):[4,Vu(r.localStore,a)]):[3,6];case 2:return s=p.sent(),[4,Uu(r.localStore,s)];case 3:return u=p.sent(),[4,Tl(r,zl(s),u.targetId,!1)];case 4:p.sent(),Pc(r.remoteStore,u),p.label=5;case 5:return i++,[3,1];case 6:c=function(t){return vr(this,(function(e){switch(e.label){case 0:return r.Vo.has(t)?[4,ju(r.localStore,t,!1).then((function(){Oc(r.remoteStore,t),Dl(r,t)})).catch(ou)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))},l=0,h=n,p.label=7;case 7:return l<h.length?(f=h[l],[5,c(f)]):[3,10];case 8:p.sent(),p.label=9;case 9:return l++,[3,7];case 10:return[2]}}))}))}function Jl(t){var e=Ar(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=Cl.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Vl.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=Al.bind(null,e),e.vo._r=ul.bind(null,e.eventManager),e.vo.Mo=cl.bind(null,e.eventManager),e}function $l(t){var e=Ar(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=Nl.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Pl.bind(null,e),e}function Zl(t,e,n){var r=Ar(t);(function(t,e,n){return dr(this,void 0,void 0,(function(){var r,i,o,a,s,u;return vr(this,(function(c){switch(c.label){case 0:return c.trys.push([0,14,,15]),[4,e.getMetadata()];case 1:return r=c.sent(),[4,function(t,e){var n=Ar(t),r=va(e.createTime);return n.persistence.runTransaction("hasNewerBundle","readonly",(function(t){return n.Qe.getBundleMetadata(t,e.id)})).then((function(t){return!!t&&t.createTime.compareTo(r)>=0}))}(t.localStore,r)];case 2:return c.sent()?[4,e.close()]:[3,4];case 3:return[2,(c.sent(),void n._completeWith(function(t){return{taskState:"Success",documentsLoaded:t.totalDocuments,bytesLoaded:t.totalBytes,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}(r)))];case 4:return n._updateProgress(vl(r)),i=new dl(r,t.localStore,e.R),[4,e.Lo()];case 5:o=c.sent(),c.label=6;case 6:return o?[4,i.oo(o)]:[3,10];case 7:return(a=c.sent())&&n._updateProgress(a),[4,e.Lo()];case 8:o=c.sent(),c.label=9;case 9:return[3,6];case 10:return[4,i.complete()];case 11:return s=c.sent(),[4,jl(t,s.wn,void 0)];case 12:return c.sent(),[4,function(t,e){var n=Ar(t);return n.persistence.runTransaction("Save bundle","readwrite",(function(t){return n.Qe.saveBundleMetadata(t,e)}))}(t.localStore,r)];case 13:return c.sent(),n._completeWith(s.progress),[3,15];case 14:return Er("SyncEngine","Loading bundle failed with "+(u=c.sent())),n._failWith(u),[3,15];case 15:return[2]}}))}))})(r,e,n).then((function(){r.sharedClientState.notifyBundleLoaded()}))}var th=function(){function t(){this.synchronizeTabs=!1}return t.prototype.initialize=function(t){return dr(this,void 0,void 0,(function(){return vr(this,(function(e){switch(e.label){case 0:return this.R=_c(t.databaseInfo.databaseId),this.sharedClientState=this.Bo(t),this.persistence=this.qo(t),[4,this.persistence.start()];case 1:return e.sent(),this.gcScheduler=this.Uo(t),this.localStore=this.Qo(t),[2]}}))}))},t.prototype.Uo=function(t){return null},t.prototype.Qo=function(t){return Ou(this.persistence,new Nu,t.initialUser,this.R)},t.prototype.qo=function(t){return new Zu(ec.bs,this.R)},t.prototype.Bo=function(t){return new fc},t.prototype.terminate=function(){return dr(this,void 0,void 0,(function(){return vr(this,(function(t){switch(t.label){case 0:return this.gcScheduler&&this.gcScheduler.stop(),[4,this.sharedClientState.shutdown()];case 1:return t.sent(),[4,this.persistence.shutdown()];case 2:return t.sent(),[2]}}))}))},t}(),eh=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).Ko=e,i.cacheSizeBytes=n,i.forceOwnership=r,i.synchronizeTabs=!1,i}return pr(e,t),e.prototype.initialize=function(e){return dr(this,void 0,void 0,(function(){return vr(this,(function(n){switch(n.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return n.sent(),[4,Ku(this.localStore)];case 2:return n.sent(),[4,this.Ko.initialize(this,e)];case 3:return n.sent(),[4,$l(this.Ko.syncEngine)];case 4:return n.sent(),[4,Kc(this.Ko.remoteStore)];case 5:return n.sent(),[2]}}))}))},e.prototype.Qo=function(t){return Ou(this.persistence,new Nu,t.initialUser,this.R)},e.prototype.Uo=function(t){var e=this.persistence.referenceDelegate.garbageCollector;return new uu(e,t.asyncQueue)},e.prototype.qo=function(t){var e=Su(t.databaseInfo.databaseId,t.databaseInfo.persistenceKey),n=void 0!==this.cacheSizeBytes?Hs.withCacheSize(this.cacheSizeBytes):Hs.DEFAULT;return new Iu(this.synchronizeTabs,e,t.clientId,n,t.asyncQueue,mc(),bc(),this.R,this.sharedClientState,!!this.forceOwnership)},e.prototype.Bo=function(t){return new fc},e}(th),nh=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n,!1)||this).Ko=e,r.cacheSizeBytes=n,r.synchronizeTabs=!0,r}return pr(e,t),e.prototype.initialize=function(e){return dr(this,void 0,void 0,(function(){var n,r=this;return vr(this,(function(i){switch(i.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return i.sent(),n=this.Ko.syncEngine,this.sharedClientState instanceof hc?(this.sharedClientState.syncEngine={ai:Wl.bind(null,n),ui:Yl.bind(null,n),hi:Xl.bind(null,n),fn:Ql.bind(null,n),ci:Kl.bind(null,n)},[4,this.sharedClientState.start()]):[3,3];case 2:i.sent(),i.label=3;case 3:return[4,this.persistence.He((function(t){return dr(r,void 0,void 0,(function(){return vr(this,(function(e){switch(e.label){case 0:return[4,Gl(this.Ko.syncEngine,t)];case 1:return e.sent(),this.gcScheduler&&(t&&!this.gcScheduler.started?this.gcScheduler.start(this.localStore):t||this.gcScheduler.stop()),[2]}}))}))}))];case 4:return i.sent(),[2]}}))}))},e.prototype.Bo=function(t){var e=mc();if(!hc.yt(e))throw new br(mr.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=Su(t.databaseInfo.databaseId,t.databaseInfo.persistenceKey);return new hc(e,t.asyncQueue,n,t.clientId,t.initialUser)},e}(eh),rh=function(){function t(){}return t.prototype.initialize=function(t,e){return dr(this,void 0,void 0,(function(){var n=this;return vr(this,(function(r){switch(r.label){case 0:return this.localStore?[3,2]:(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(e),this.remoteStore=this.createRemoteStore(e),this.eventManager=this.createEventManager(e),this.syncEngine=this.createSyncEngine(e,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=function(t){return kl(n.syncEngine,t,1)},this.remoteStore.remoteSyncer.handleCredentialChange=ql.bind(null,this.syncEngine),[4,Xc(this.remoteStore,this.syncEngine.isPrimaryClient)]);case 1:r.sent(),r.label=2;case 2:return[2]}}))}))},t.prototype.createEventManager=function(t){return new ol},t.prototype.createDatastore=function(t){var e,n=_c(t.databaseInfo.databaseId),r=(e=t.databaseInfo,new yc(e));return function(t,e,n){return new Sc(t,e,n)}(t.credentials,r,n)},t.prototype.createRemoteStore=function(t){var e,n,r,i,o,a=this;return e=this.localStore,n=this.datastore,r=t.asyncQueue,i=function(t){return kl(a.syncEngine,t,0)},o=dc.yt()?new dc:new pc,new kc(e,n,r,i,o)},t.prototype.createSyncEngine=function(t,e){return function(t,e,n,r,i,o,a){var s=new wl(t,e,n,r,i,o);return a&&(s.Oo=!0),s}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,e)},t.prototype.terminate=function(){return function(t){return dr(this,void 0,void 0,(function(){var e;return vr(this,(function(n){switch(n.label){case 0:return e=Ar(t),Ir("RemoteStore","RemoteStore shutting down."),e.$r.add(5),[4,Nc(e)];case 1:return n.sent(),e.Lr.shutdown(),e.Br.set("Unknown"),[2]}}))}))}(this.remoteStore)},t}();function ih(t,e){void 0===e&&(e=10240);var n=0;return{read:function(){return dr(this,void 0,void 0,(function(){var r;return vr(this,(function(i){return n<t.byteLength?(r={value:t.slice(n,n+e),done:!1},[2,(n+=e,r)]):[2,{done:!0}]}))}))},cancel:function(){return dr(this,void 0,void 0,(function(){return vr(this,(function(t){return[2]}))}))},releaseLock:function(){},closed:Promise.reject("unimplemented")}}var oh=function(){function t(t){this.observer=t,this.muted=!1}return t.prototype.next=function(t){this.observer.next&&this.jo(this.observer.next,t)},t.prototype.error=function(t){this.observer.error?this.jo(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},t.prototype.Wo=function(){this.muted=!0},t.prototype.jo=function(t,e){var n=this;this.muted||setTimeout((function(){n.muted||t(e)}),0)},t}(),ah=function(){function t(t,e){var n=this;this.Go=t,this.R=e,this.metadata=new hs,this.buffer=new Uint8Array,this.zo=new TextDecoder("utf-8"),this.Ho().then((function(t){t&&t.io()?n.metadata.resolve(t.payload.metadata):n.metadata.reject(new Error("The first element of the bundle is not a metadata, it is\n             "+JSON.stringify(null==t?void 0:t.payload)))}),(function(t){return n.metadata.reject(t)}))}return t.prototype.close=function(){return this.Go.cancel()},t.prototype.getMetadata=function(){return dr(this,void 0,void 0,(function(){return vr(this,(function(t){return[2,this.metadata.promise]}))}))},t.prototype.Lo=function(){return dr(this,void 0,void 0,(function(){return vr(this,(function(t){switch(t.label){case 0:return[4,this.getMetadata()];case 1:return[2,(t.sent(),this.Ho())]}}))}))},t.prototype.Ho=function(){return dr(this,void 0,void 0,(function(){var t,e,n,r;return vr(this,(function(i){switch(i.label){case 0:return[4,this.Jo()];case 1:return null===(t=i.sent())?[2,null]:(e=this.zo.decode(t),n=Number(e),isNaN(n)&&this.Yo("length string ("+e+") is not valid number"),[4,this.Xo(n)]);case 2:return r=i.sent(),[2,new fl(JSON.parse(r),t.length+n)]}}))}))},t.prototype.Zo=function(){return this.buffer.findIndex((function(t){return t==="{".charCodeAt(0)}))},t.prototype.Jo=function(){return dr(this,void 0,void 0,(function(){var t,e;return vr(this,(function(n){switch(n.label){case 0:return this.Zo()<0?[4,this.tc()]:[3,3];case 1:if(n.sent())return[3,3];n.label=2;case 2:return[3,0];case 3:return 0===this.buffer.length?[2,null]:((t=this.Zo())<0&&this.Yo("Reached the end of bundle when a length string is expected."),e=this.buffer.slice(0,t),[2,(this.buffer=this.buffer.slice(t),e)])}}))}))},t.prototype.Xo=function(t){return dr(this,void 0,void 0,(function(){var e;return vr(this,(function(n){switch(n.label){case 0:return this.buffer.length<t?[4,this.tc()]:[3,3];case 1:n.sent()&&this.Yo("Reached the end of bundle when more is expected."),n.label=2;case 2:return[3,0];case 3:return e=this.zo.decode(this.buffer.slice(0,t)),[2,(this.buffer=this.buffer.slice(t),e)]}}))}))},t.prototype.Yo=function(t){throw this.Go.cancel(),new Error("Invalid bundle format: "+t)},t.prototype.tc=function(){return dr(this,void 0,void 0,(function(){var t,e;return vr(this,(function(n){switch(n.label){case 0:return[4,this.Go.read()];case 1:return(t=n.sent()).done||((e=new Uint8Array(this.buffer.length+t.value.length)).set(this.buffer),e.set(t.value,this.buffer.length),this.buffer=e),[2,t.done]}}))}))},t}(),sh=function(){function t(t){this.datastore=t,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}return t.prototype.lookup=function(t){return dr(this,void 0,void 0,(function(){var e,n=this;return vr(this,(function(r){switch(r.label){case 0:if(this.ensureCommitNotCalled(),this.mutations.length>0)throw new br(mr.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(t,e){return dr(this,void 0,void 0,(function(){var n,r,i,o,a,s;return vr(this,(function(u){switch(u.label){case 0:return n=Ar(t),r=Ia(n.R)+"/documents",i={documents:e.map((function(t){return ma(n.R,t)}))},[4,n.Oi("BatchGetDocuments",r,i)];case 1:return o=u.sent(),a=new Map,o.forEach((function(t){var e=function(t,e){return"found"in e?function(t,e){kr(!!e.found),e.found.name,e.found.updateTime;var n=ba(t,e.found.name),r=va(e.found.updateTime),i=new vi({mapValue:{fields:e.found.fields}});return yi.newFoundDocument(n,r,i)}(t,e):"missing"in e?function(t,e){kr(!!e.missing),kr(!!e.readTime);var n=ba(t,e.missing),r=va(e.readTime);return yi.newNoDocument(n,r)}(t,e):Cr()}(n.R,t);a.set(e.key.toString(),e)})),s=[],[2,(e.forEach((function(t){var e=a.get(t.toString());kr(!!e),s.push(e)})),s)]}}))}))}(this.datastore,t)];case 1:return[2,((e=r.sent()).forEach((function(t){return n.recordVersion(t)})),e)]}}))}))},t.prototype.set=function(t,e){this.write(e.toMutation(t,this.precondition(t))),this.writtenDocs.add(t.toString())},t.prototype.update=function(t,e){try{this.write(e.toMutation(t,this.preconditionForUpdate(t)))}catch(t){this.lastWriteError=t}this.writtenDocs.add(t.toString())},t.prototype.delete=function(t){this.write(new Do(t,this.precondition(t))),this.writtenDocs.add(t.toString())},t.prototype.commit=function(){return dr(this,void 0,void 0,(function(){var t,e=this;return vr(this,(function(n){switch(n.label){case 0:if(this.ensureCommitNotCalled(),this.lastWriteError)throw this.lastWriteError;return t=this.readVersions,this.mutations.forEach((function(e){t.delete(e.key.toString())})),t.forEach((function(t,n){var r=ei.fromPath(n);e.mutations.push(new Lo(r,e.precondition(r)))})),[4,function(t,e){return dr(this,void 0,void 0,(function(){var n,r,i;return vr(this,(function(o){switch(o.label){case 0:return n=Ar(t),r=Ia(n.R)+"/documents",i={writes:e.map((function(t){return Ca(n.R,t)}))},[4,n.Ni("Commit",r,i)];case 1:return o.sent(),[2]}}))}))}(this.datastore,this.mutations)];case 1:return n.sent(),this.committed=!0,[2]}}))}))},t.prototype.recordVersion=function(t){var e;if(t.isFoundDocument())e=t.version;else{if(!t.isNoDocument())throw Cr();e=Lr.min()}var n=this.readVersions.get(t.key.toString());if(n){if(!e.isEqual(n))throw new br(mr.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(t.key.toString(),e)},t.prototype.precondition=function(t){var e=this.readVersions.get(t.toString());return!this.writtenDocs.has(t.toString())&&e?bo.updateTime(e):bo.none()},t.prototype.preconditionForUpdate=function(t){var e=this.readVersions.get(t.toString());if(!this.writtenDocs.has(t.toString())&&e){if(e.isEqual(Lr.min()))throw new br(mr.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return bo.updateTime(e)}return bo.exists(!0)},t.prototype.write=function(t){this.ensureCommitNotCalled(),this.mutations.push(t)},t.prototype.ensureCommitNotCalled=function(){},t}(),uh=function(){function t(t,e,n,r){this.asyncQueue=t,this.datastore=e,this.updateFunction=n,this.deferred=r,this.ec=5,this.Zi=new wc(this.asyncQueue,"transaction_retry")}return t.prototype.run=function(){this.nc()},t.prototype.nc=function(){var t=this;this.Zi.ji((function(){return dr(t,void 0,void 0,(function(){var t,e,n=this;return vr(this,(function(r){return t=new sh(this.datastore),(e=this.sc(t))&&e.then((function(e){n.asyncQueue.enqueueAndForget((function(){return t.commit().then((function(){n.deferred.resolve(e)})).catch((function(t){n.ic(t)}))}))})).catch((function(t){n.ic(t)})),[2]}))}))}))},t.prototype.sc=function(t){try{var e=this.updateFunction(t);return!$r(e)&&e.catch&&e.then?e:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}},t.prototype.ic=function(t){var e=this;this.ec>0&&this.rc(t)?(this.ec-=1,this.asyncQueue.enqueueAndForget((function(){return e.nc(),Promise.resolve()}))):this.deferred.reject(t)},t.prototype.rc=function(t){if("FirebaseError"===t.name){var e=t.code;return"aborted"===e||"failed-precondition"===e||!Fo(e)}return!1},t}(),ch=function(){function t(t,e,n){var r=this;this.credentials=t,this.asyncQueue=e,this.databaseInfo=n,this.user=nc.UNAUTHENTICATED,this.clientId=Pr.u(),this.credentialListener=function(){return Promise.resolve()},this.credentials.setChangeListener(e,(function(t){return dr(r,void 0,void 0,(function(){return vr(this,(function(e){switch(e.label){case 0:return Ir("FirestoreClient","Received user=",t.uid),[4,this.credentialListener(t)];case 1:return e.sent(),this.user=t,[2]}}))}))}))}return t.prototype.getConfiguration=function(){return dr(this,void 0,void 0,(function(){return vr(this,(function(t){return[2,{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,credentials:this.credentials,initialUser:this.user,maxConcurrentLimboResolutions:100}]}))}))},t.prototype.setCredentialChangeListener=function(t){this.credentialListener=t},t.prototype.verifyNotTerminated=function(){if(this.asyncQueue.isShuttingDown)throw new br(mr.FAILED_PRECONDITION,"The client has already been terminated.")},t.prototype.terminate=function(){var t=this;this.asyncQueue.enterRestrictedMode();var e=new hs;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((function(){return dr(t,void 0,void 0,(function(){var t,n;return vr(this,(function(r){switch(r.label){case 0:return r.trys.push([0,5,,6]),this.onlineComponents?[4,this.onlineComponents.terminate()]:[3,2];case 1:r.sent(),r.label=2;case 2:return this.offlineComponents?[4,this.offlineComponents.terminate()]:[3,4];case 3:r.sent(),r.label=4;case 4:return this.credentials.removeChangeListener(),e.resolve(),[3,6];case 5:return t=r.sent(),n=tl(t,"Failed to shutdown persistence"),e.reject(n),[3,6];case 6:return[2]}}))}))})),e.promise},t}();function lh(t,e){return dr(this,void 0,void 0,(function(){var n,r,i=this;return vr(this,(function(o){switch(o.label){case 0:return t.asyncQueue.verifyOperationInProgress(),Ir("FirestoreClient","Initializing OfflineComponentProvider"),[4,t.getConfiguration()];case 1:return n=o.sent(),[4,e.initialize(n)];case 2:return o.sent(),r=n.initialUser,t.setCredentialChangeListener((function(t){return dr(i,void 0,void 0,(function(){return vr(this,(function(n){switch(n.label){case 0:return r.isEqual(t)?[3,2]:[4,Ru(e.localStore,t)];case 1:n.sent(),r=t,n.label=2;case 2:return[2]}}))}))})),e.persistence.setDatabaseDeletedListener((function(){return t.terminate()})),t.offlineComponents=e,[2]}}))}))}function hh(t,e){return dr(this,void 0,void 0,(function(){var n,r;return vr(this,(function(i){switch(i.label){case 0:return t.asyncQueue.verifyOperationInProgress(),[4,fh(t)];case 1:return n=i.sent(),Ir("FirestoreClient","Initializing OnlineComponentProvider"),[4,t.getConfiguration()];case 2:return r=i.sent(),[4,e.initialize(n,r)];case 3:return i.sent(),t.setCredentialChangeListener((function(t){return function(t,e){return dr(this,void 0,void 0,(function(){var n,r;return vr(this,(function(i){switch(i.label){case 0:return(n=Ar(t)).asyncQueue.verifyOperationInProgress(),Ir("RemoteStore","RemoteStore received new credentials"),r=Mc(n),n.$r.add(3),[4,Nc(n)];case 1:return i.sent(),r&&n.Br.set("Unknown"),[4,n.remoteSyncer.handleCredentialChange(e)];case 2:return i.sent(),n.$r.delete(3),[4,Ac(n)];case 3:return i.sent(),[2]}}))}))}(e.remoteStore,t)})),t.onlineComponents=e,[2]}}))}))}function fh(t){return dr(this,void 0,void 0,(function(){return vr(this,(function(e){switch(e.label){case 0:return t.offlineComponents?[3,2]:(Ir("FirestoreClient","Using default OfflineComponentProvider"),[4,lh(t,new th)]);case 1:e.sent(),e.label=2;case 2:return[2,t.offlineComponents]}}))}))}function ph(t){return dr(this,void 0,void 0,(function(){return vr(this,(function(e){switch(e.label){case 0:return t.onlineComponents?[3,2]:(Ir("FirestoreClient","Using default OnlineComponentProvider"),[4,hh(t,new rh)]);case 1:e.sent(),e.label=2;case 2:return[2,t.onlineComponents]}}))}))}function dh(t){return fh(t).then((function(t){return t.persistence}))}function vh(t){return fh(t).then((function(t){return t.localStore}))}function gh(t){return ph(t).then((function(t){return t.remoteStore}))}function yh(t){return ph(t).then((function(t){return t.syncEngine}))}function mh(t){return dr(this,void 0,void 0,(function(){var e,n;return vr(this,(function(r){switch(r.label){case 0:return[4,ph(t)];case 1:return e=r.sent(),[2,((n=e.eventManager).onListen=Il.bind(null,e.syncEngine),n.onUnlisten=El.bind(null,e.syncEngine),n)]}}))}))}function bh(t,e,n){var r=this;void 0===n&&(n={});var i=new hs;return t.asyncQueue.enqueueAndForget((function(){return dr(r,void 0,void 0,(function(){var r;return vr(this,(function(o){switch(o.label){case 0:return r=function(t,e,n,r,i){var o=new oh({next:function(o){e.enqueueAndForget((function(){return sl(t,a)}));var s=o.docs.has(n);!s&&o.fromCache?i.reject(new br(mr.UNAVAILABLE,"Failed to get document because the client is offline.")):s&&o.fromCache&&r&&"server"===r.source?i.reject(new br(mr.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(o)},error:function(t){return i.reject(t)}}),a=new hl(qi(n.path),o,{includeMetadataChanges:!0,so:!0});return al(t,a)},[4,mh(t)];case 1:return[2,r.apply(void 0,[o.sent(),t.asyncQueue,e,n,i])]}}))}))})),i.promise}function _h(t,e,n){var r=this;void 0===n&&(n={});var i=new hs;return t.asyncQueue.enqueueAndForget((function(){return dr(r,void 0,void 0,(function(){var r;return vr(this,(function(o){switch(o.label){case 0:return r=function(t,e,n,r,i){var o=new oh({next:function(n){e.enqueueAndForget((function(){return sl(t,a)})),n.fromCache&&"server"===r.source?i.reject(new br(mr.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:function(t){return i.reject(t)}}),a=new hl(n,o,{includeMetadataChanges:!0,so:!0});return al(t,a)},[4,mh(t)];case 1:return[2,r.apply(void 0,[o.sent(),t.asyncQueue,e,n,i])]}}))}))})),i.promise}var wh=function(t,e,n,r,i,o,a){this.databaseId=t,this.appId=e,this.persistenceKey=n,this.host=r,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=a},Ih=function(){function t(t,e){this.projectId=t,this.database=e||"(default)"}return Object.defineProperty(t.prototype,"isDefaultDatabase",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database},t}(),Th=new Map,Eh=function(t,e){this.user=e,this.type="OAuth",this.authHeaders={},this.authHeaders.Authorization="Bearer "+t},Sh=function(){function t(){this.changeListener=null}return t.prototype.getToken=function(){return Promise.resolve(null)},t.prototype.invalidateToken=function(){},t.prototype.setChangeListener=function(t,e){this.changeListener=e,t.enqueueRetryable((function(){return e(nc.UNAUTHENTICATED)}))},t.prototype.removeChangeListener=function(){this.changeListener=null},t}(),Ch=function(){function t(t){this.token=t,this.changeListener=null}return t.prototype.getToken=function(){return Promise.resolve(this.token)},t.prototype.invalidateToken=function(){},t.prototype.setChangeListener=function(t,e){var n=this;this.changeListener=e,t.enqueueRetryable((function(){return e(n.token.user)}))},t.prototype.removeChangeListener=function(){this.changeListener=null},t}(),kh=function(){function t(t){var e=this;this.currentUser=nc.UNAUTHENTICATED,this.oc=new hs,this.cc=0,this.changeListener=function(){return Promise.resolve()},this.ac=!1,this.forceRefresh=!1,this.auth=null,this.asyncQueue=null,this.uc=function(){e.cc++,e.currentUser=e.hc(),e.oc.resolve(),e.ac&&e.asyncQueue.enqueueRetryable((function(){return e.changeListener(e.currentUser)}))};var n=function(t){Ir("FirebaseCredentialsProvider","Auth detected"),e.auth=t,e.lc(),e.auth.addAuthTokenListener(e.uc)};t.onInit((function(t){return n(t)})),setTimeout((function(){if(!e.auth){var r=t.getImmediate({optional:!0});r?n(r):e.ac&&(Ir("FirebaseCredentialsProvider","Auth not yet detected"),e.asyncQueue.enqueueRetryable((function(){return e.changeListener(e.currentUser)})))}}),0)}return t.prototype.getToken=function(){var t=this,e=this.cc,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then((function(n){return t.cc!==e?(Ir("FirebaseCredentialsProvider","getToken aborted due to token change."),t.getToken()):n?(kr("string"==typeof n.accessToken),new Eh(n.accessToken,t.currentUser)):null})):Promise.resolve(null)},t.prototype.invalidateToken=function(){this.forceRefresh=!0},t.prototype.setChangeListener=function(t,e){this.ac=!0,this.asyncQueue=t,this.changeListener=e},t.prototype.removeChangeListener=function(){this.auth&&this.auth.removeAuthTokenListener(this.uc),this.changeListener=function(){return Promise.resolve()}},t.prototype.hc=function(){var t=this.auth&&this.auth.getUid();return kr(null===t||"string"==typeof t),new nc(t)},t.prototype.lc=function(){var t=this;this.ac&&(this.ac=!1,this.asyncQueue.enqueueRetryable((function(){return dr(t,void 0,void 0,(function(){return vr(this,(function(t){switch(t.label){case 0:return[4,this.oc.promise];case 1:return t.sent(),[4,this.changeListener(this.currentUser)];case 2:return t.sent(),this.ac=!0,[2]}}))}))})))},t}(),Ah=function(){function t(t,e,n){this.fc=t,this.dc=e,this.wc=n,this.type="FirstParty",this.user=nc.FIRST_PARTY}return Object.defineProperty(t.prototype,"authHeaders",{get:function(){var t={"X-Goog-AuthUser":this.dc},e=this.fc.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),this.wc&&(t["X-Goog-Iam-Authorization-Token"]=this.wc),t},enumerable:!1,configurable:!0}),t}(),Nh=function(){function t(t,e,n){this.fc=t,this.dc=e,this.wc=n}return t.prototype.getToken=function(){return Promise.resolve(new Ah(this.fc,this.dc,this.wc))},t.prototype.setChangeListener=function(t,e){t.enqueueRetryable((function(){return e(nc.FIRST_PARTY)}))},t.prototype.removeChangeListener=function(){},t.prototype.invalidateToken=function(){},t}();function Ph(t,e,n){if(!n)throw new br(mr.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function Oh(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new br(mr.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function Rh(t,e,n,r){if(!0===e&&!0===r)throw new br(mr.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function xh(t){if(!ei.isDocumentKey(t))throw new br(mr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t+" has "+t.length+".")}function Dh(t){if(ei.isDocumentKey(t))throw new br(mr.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t+" has "+t.length+".")}function Lh(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=t.substring(0,20)+"..."),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";var e=function(t){if(t.constructor){var e=/function\s+([^\s(]+)\s*\(/.exec(t.constructor.toString());if(e&&e.length>1)return e[1]}return null}(t);return e?"a custom "+e+" object":"an object"}return"function"==typeof t?"a function":Cr()}function Mh(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new br(mr.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");var n=Lh(t);throw new br(mr.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+n)}return t}function Fh(t,e){if(e<=0)throw new br(mr.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}var Uh=function(){function t(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new br(mr.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new br(mr.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,Rh("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}return t.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},t}(),jh=function(){function t(t,e){this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Uh({}),this._settingsFrozen=!1,t instanceof Ih?(this._databaseId=t,this._credentials=new Sh):(this._app=t,this._databaseId=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new br(mr.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Ih(t.options.projectId)}(t),this._credentials=new kh(e))}return Object.defineProperty(t.prototype,"app",{get:function(){if(!this._app)throw new br(mr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_initialized",{get:function(){return this._settingsFrozen},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_terminated",{get:function(){return void 0!==this._terminateTask},enumerable:!1,configurable:!0}),t.prototype._setSettings=function(t){if(this._settingsFrozen)throw new br(mr.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Uh(t),void 0!==t.credentials&&(this._credentials=function(t){if(!t)return new Sh;switch(t.type){case"gapi":var e=t.client;return kr(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Nh(e,t.sessionIndex||"0",t.iamToken||null);case"provider":return t.client;default:throw new br(mr.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},t.prototype._getSettings=function(){return this._settings},t.prototype._freezeSettings=function(){return this._settingsFrozen=!0,this._settings},t.prototype._delete=function(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask},t.prototype.toJSON=function(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}},t.prototype._terminate=function(){return(t=Th.get(this))&&(Ir("ComponentProvider","Removing Datastore"),Th.delete(this),t.terminate()),Promise.resolve();var t},t}(),qh=function(){function t(t,e,n){this.converter=e,this._key=n,this.type="document",this.firestore=t}return Object.defineProperty(t.prototype,"_path",{get:function(){return this._key.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this._key.path.canonicalString()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new Bh(this.firestore,this.converter,this._key.path.popLast())},enumerable:!1,configurable:!0}),t.prototype.withConverter=function(e){return new t(this.firestore,e,this._key)},t}(),Vh=function(){function t(t,e,n){this.converter=e,this._query=n,this.type="query",this.firestore=t}return t.prototype.withConverter=function(e){return new t(this.firestore,e,this._query)},t}(),Bh=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,qi(r))||this)._path=r,i.type="collection",i}return pr(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this._query.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._query.path.canonicalString()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this._path.popLast();return t.isEmpty()?null:new qh(this.firestore,null,new ei(t))},enumerable:!1,configurable:!0}),e.prototype.withConverter=function(t){return new e(this.firestore,t,this._path)},e}(Vh);function Kh(t,e){for(var n,r=[],o=2;o<arguments.length;o++)r[o-2]=arguments[o];if(t=(0,i.getModularInstance)(t),Ph("collection","path",e),t instanceof jh)return Dh(n=qr.fromString.apply(qr,gr([e],r))),new Bh(t,null,n);if(!(t instanceof qh||t instanceof Bh))throw new br(mr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return Dh(n=qr.fromString.apply(qr,gr([t.path],r)).child(qr.fromString(e))),new Bh(t.firestore,null,n)}function Wh(t,e){for(var n,r=[],o=2;o<arguments.length;o++)r[o-2]=arguments[o];if(t=(0,i.getModularInstance)(t),1===arguments.length&&(e=Pr.u()),Ph("doc","path",e),t instanceof jh)return xh(n=qr.fromString.apply(qr,gr([e],r))),new qh(t,null,new ei(n));if(!(t instanceof qh||t instanceof Bh))throw new br(mr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return xh(n=t._path.child(qr.fromString.apply(qr,gr([e],r)))),new qh(t.firestore,t instanceof Bh?t.converter:null,new ei(n))}function Gh(t,e){return t=(0,i.getModularInstance)(t),e=(0,i.getModularInstance)(e),(t instanceof qh||t instanceof Bh)&&(e instanceof qh||e instanceof Bh)&&t.firestore===e.firestore&&t.path===e.path&&t.converter===e.converter}function Hh(t,e){return t=(0,i.getModularInstance)(t),e=(0,i.getModularInstance)(e),t instanceof Vh&&e instanceof Vh&&t.firestore===e.firestore&&Yi(t._query,e._query)&&t.converter===e.converter}var zh=function(){function t(){var t=this;this._c=Promise.resolve(),this.mc=[],this.yc=!1,this.gc=[],this.Ec=null,this.Tc=!1,this.Ic=[],this.Zi=new wc(this,"async_queue_retry"),this.Ac=function(){var e=bc();e&&Ir("AsyncQueue","Visibility state changed to "+e.visibilityState),t.Zi.Gi()};var e=bc();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Ac)}return Object.defineProperty(t.prototype,"isShuttingDown",{get:function(){return this.yc},enumerable:!1,configurable:!0}),t.prototype.enqueueAndForget=function(t){this.enqueue(t)},t.prototype.enqueueAndForgetEvenWhileRestricted=function(t){this.Rc(),this.bc(t)},t.prototype.enterRestrictedMode=function(){if(!this.yc){this.yc=!0;var t=bc();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Ac)}},t.prototype.enqueue=function(t){return this.Rc(),this.yc?new Promise((function(t){})):this.bc(t)},t.prototype.enqueueRetryable=function(t){var e=this;this.enqueueAndForget((function(){return e.mc.push(t),e.vc()}))},t.prototype.vc=function(){return dr(this,void 0,void 0,(function(){var t,e=this;return vr(this,(function(n){switch(n.label){case 0:if(0===this.mc.length)return[3,5];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.mc[0]()];case 2:return n.sent(),this.mc.shift(),this.Zi.reset(),[3,4];case 3:if(!ys(t=n.sent()))throw t;return Ir("AsyncQueue","Operation failed with retryable error: "+t),[3,4];case 4:this.mc.length>0&&this.Zi.ji((function(){return e.vc()})),n.label=5;case 5:return[2]}}))}))},t.prototype.bc=function(t){var e=this,n=this._c.then((function(){return e.Tc=!0,t().catch((function(t){throw e.Ec=t,e.Tc=!1,Tr("INTERNAL UNHANDLED ERROR: ",function(t){var e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack),e}(t)),t})).then((function(t){return e.Tc=!1,t}))}));return this._c=n,n},t.prototype.enqueueAfterDelay=function(t,e,n){var r=this;this.Rc(),this.Ic.indexOf(t)>-1&&(e=0);var i=Zc.createAndSchedule(this,t,e,n,(function(t){return r.Pc(t)}));return this.gc.push(i),i},t.prototype.Rc=function(){this.Ec&&Cr()},t.prototype.verifyOperationInProgress=function(){},t.prototype.Vc=function(){return dr(this,void 0,void 0,(function(){var t;return vr(this,(function(e){switch(e.label){case 0:return[4,t=this._c];case 1:e.sent(),e.label=2;case 2:if(t!==this._c)return[3,0];e.label=3;case 3:return[2]}}))}))},t.prototype.Sc=function(t){for(var e=0,n=this.gc;e<n.length;e++)if(n[e].timerId===t)return!0;return!1},t.prototype.Dc=function(t){var e=this;return this.Vc().then((function(){e.gc.sort((function(t,e){return t.targetTimeMs-e.targetTimeMs}));for(var n=0,r=e.gc;n<r.length;n++){var i=r[n];if(i.skipDelay(),"all"!==t&&i.timerId===t)break}return e.Vc()}))},t.prototype.Cc=function(t){this.Ic.push(t)},t.prototype.Pc=function(t){var e=this.gc.indexOf(t);this.gc.splice(e,1)},t}();function Qh(t){return function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=t,r=0,i=["next","error","complete"];r<i.length;r++){var o=i[r];if(o in n&&"function"==typeof n[o])return!0}return!1}(t)}var Yh=function(){function t(){this._progressObserver={},this._taskCompletionResolver=new hs,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}return t.prototype.onProgress=function(t,e,n){this._progressObserver={next:t,error:e,complete:n}},t.prototype.catch=function(t){return this._taskCompletionResolver.promise.catch(t)},t.prototype.then=function(t,e){return this._taskCompletionResolver.promise.then(t,e)},t.prototype._completeWith=function(t){this._updateProgress(t),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(t)},t.prototype._failWith=function(t){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(t),this._taskCompletionResolver.reject(t)},t.prototype._updateProgress=function(t){this._lastProgress=t,this._progressObserver.next&&this._progressObserver.next(t)},t}(),Xh=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).type="firestore",r._queue=new zh,r._persistenceKey="name"in e?e.name:"[DEFAULT]",r}return pr(e,t),e.prototype._terminate=function(){return this._firestoreClient||$h(this),this._firestoreClient.terminate()},e}(jh);function Jh(t){return t._firestoreClient||$h(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function $h(t){var e,n=t._freezeSettings(),r=function(t,e,n,r){return new wh(t,e,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling)}(t._databaseId,(null===(e=t._app)||void 0===e?void 0:e.options.appId)||"",t._persistenceKey,n);t._firestoreClient=new ch(t._credentials,t._queue,r)}function Zh(t,e,n){var r=this,i=new hs;return t.asyncQueue.enqueue((function(){return dr(r,void 0,void 0,(function(){var r;return vr(this,(function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),[4,lh(t,n)];case 1:return o.sent(),[4,hh(t,e)];case 2:return o.sent(),i.resolve(),[3,4];case 3:if(!function(t){return"FirebaseError"===t.name?t.code===mr.FAILED_PRECONDITION||t.code===mr.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code}(r=o.sent()))throw r;return console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+r),i.reject(r),[3,4];case 4:return[2]}}))}))})).then((function(){return i.promise}))}function tf(t){if(t._initialized||t._terminated)throw new br(mr.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}var ef=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0;n<t.length;++n)if(0===t[n].length)throw new br(mr.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Br(t)}return t.prototype.isEqual=function(t){return this._internalPath.isEqual(t._internalPath)},t}(),nf=function(){function t(t){this._byteString=t}return t.fromBase64String=function(e){try{return new t(Wr.fromBase64String(e))}catch(e){throw new br(mr.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}},t.fromUint8Array=function(e){return new t(Wr.fromUint8Array(e))},t.prototype.toBase64=function(){return this._byteString.toBase64()},t.prototype.toUint8Array=function(){return this._byteString.toUint8Array()},t.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},t.prototype.isEqual=function(t){return this._byteString.isEqual(t._byteString)},t}(),rf=function(t){this._methodName=t},of=function(){function t(t,e){if(!isFinite(t)||t<-90||t>90)throw new br(mr.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new br(mr.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}return Object.defineProperty(t.prototype,"latitude",{get:function(){return this._lat},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"longitude",{get:function(){return this._long},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this._lat===t._lat&&this._long===t._long},t.prototype.toJSON=function(){return{latitude:this._lat,longitude:this._long}},t.prototype._compareTo=function(t){return Or(this._lat,t._lat)||Or(this._long,t._long)},t}(),af=/^__.*__$/,sf=function(){function t(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}return t.prototype.toMutation=function(t,e){return null!==this.fieldMask?new Ao(t,this.data,this.fieldMask,e,this.fieldTransforms):new ko(t,this.data,e,this.fieldTransforms)},t}(),uf=function(){function t(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}return t.prototype.toMutation=function(t,e){return new Ao(t,this.data,this.fieldMask,e,this.fieldTransforms)},t}();function cf(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Cr()}}var lf=function(){function t(t,e,n,r,i,o){this.settings=t,this.databaseId=e,this.R=n,this.ignoreUndefinedProperties=r,void 0===i&&this.Nc(),this.fieldTransforms=i||[],this.fieldMask=o||[]}return Object.defineProperty(t.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"xc",{get:function(){return this.settings.xc},enumerable:!1,configurable:!0}),t.prototype.Fc=function(e){return new t(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.R,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)},t.prototype.kc=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.Fc({path:n,Oc:!1});return r.$c(t),r},t.prototype.Mc=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.Fc({path:n,Oc:!1});return r.Nc(),r},t.prototype.Lc=function(t){return this.Fc({path:void 0,Oc:!0})},t.prototype.Bc=function(t){return Pf(t,this.settings.methodName,this.settings.qc||!1,this.path,this.settings.Uc)},t.prototype.contains=function(t){return void 0!==this.fieldMask.find((function(e){return t.isPrefixOf(e)}))||void 0!==this.fieldTransforms.find((function(e){return t.isPrefixOf(e.field)}))},t.prototype.Nc=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.$c(this.path.get(t))},t.prototype.$c=function(t){if(0===t.length)throw this.Bc("Document fields must not be empty");if(cf(this.xc)&&af.test(t))throw this.Bc('Document fields cannot begin and end with "__"')},t}(),hf=function(){function t(t,e,n){this.databaseId=t,this.ignoreUndefinedProperties=e,this.R=n||_c(t)}return t.prototype.Qc=function(t,e,n,r){return void 0===r&&(r=!1),new lf({xc:t,methodName:e,Uc:n,path:Br.emptyPath(),Oc:!1,qc:r},this.databaseId,this.R,this.ignoreUndefinedProperties)},t}();function ff(t){var e=t._freezeSettings(),n=_c(t._databaseId);return new hf(t._databaseId,!!e.ignoreUndefinedProperties,n)}function pf(t,e,n,r,i,o){void 0===o&&(o={});var a=t.Qc(o.merge||o.mergeFields?2:0,e,n,i);Cf("Data must be an object, but it was:",a,r);var s,u,c=Ef(r,a);if(o.merge)s=new Kr(a.fieldMask),u=a.fieldTransforms;else if(o.mergeFields){for(var l=[],h=0,f=o.mergeFields;h<f.length;h++){var p=kf(e,f[h],n);if(!a.contains(p))throw new br(mr.INVALID_ARGUMENT,"Field '"+p+"' is specified in your field mask but missing from your input data.");Of(l,p)||l.push(p)}s=new Kr(l),u=a.fieldTransforms.filter((function(t){return s.covers(t.field)}))}else s=null,u=a.fieldTransforms;return new sf(new vi(c),s,u)}var df=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return pr(e,t),e.prototype._toFieldTransform=function(t){if(2!==t.xc)throw 1===t.xc?t.Bc(this._methodName+"() can only appear at the top level of your update data"):t.Bc(this._methodName+"() cannot be used with set() unless you pass {merge:true}");return t.fieldMask.push(t.path),null},e.prototype.isEqual=function(t){return t instanceof e},e}(rf);function vf(t,e,n){return new lf({xc:3,Uc:e.settings.Uc,methodName:t._methodName,Oc:n},e.databaseId,e.R,e.ignoreUndefinedProperties)}var gf=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return pr(e,t),e.prototype._toFieldTransform=function(t){return new yo(t.path,new uo)},e.prototype.isEqual=function(t){return t instanceof e},e}(rf),yf=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).Kc=n,r}return pr(e,t),e.prototype._toFieldTransform=function(t){var e=vf(this,t,!0),n=this.Kc.map((function(t){return Tf(t,e)})),r=new co(n);return new yo(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(rf),mf=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).Kc=n,r}return pr(e,t),e.prototype._toFieldTransform=function(t){var e=vf(this,t,!0),n=this.Kc.map((function(t){return Tf(t,e)})),r=new ho(n);return new yo(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(rf),bf=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).jc=n,r}return pr(e,t),e.prototype._toFieldTransform=function(t){var e=new po(t.R,ro(t.R,this.jc));return new yo(t.path,e)},e.prototype.isEqual=function(t){return this===t},e}(rf);function _f(t,e,n,r){var o=t.Qc(1,e,n);Cf("Data must be an object, but it was:",o,r);var a=[],s=vi.empty();Fr(r,(function(t,r){var u=Nf(e,t,n);r=(0,i.getModularInstance)(r);var c=o.Mc(u);if(r instanceof df)a.push(u);else{var l=Tf(r,c);null!=l&&(a.push(u),s.set(u,l))}}));var u=new Kr(a);return new uf(s,u,o.fieldTransforms)}function wf(t,e,n,r,o,a){var s=t.Qc(1,e,n),u=[kf(e,r,n)],c=[o];if(a.length%2!=0)throw new br(mr.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var l=0;l<a.length;l+=2)u.push(kf(e,a[l])),c.push(a[l+1]);for(var h=[],f=vi.empty(),p=u.length-1;p>=0;--p)if(!Of(h,u[p])){var d=u[p],v=c[p];v=(0,i.getModularInstance)(v);var g=s.Mc(d);if(v instanceof df)h.push(d);else{var y=Tf(v,g);null!=y&&(h.push(d),f.set(d,y))}}var m=new Kr(h);return new uf(f,m,s.fieldTransforms)}function If(t,e,n,r){return void 0===r&&(r=!1),Tf(n,t.Qc(r?4:3,e))}function Tf(t,e){if(Sf(t=(0,i.getModularInstance)(t)))return Cf("Unsupported field value:",e,t),Ef(t,e);if(t instanceof rf)return function(t,e){if(!cf(e.xc))throw e.Bc(t._methodName+"() can only be used with update() and set()");if(!e.path)throw e.Bc(t._methodName+"() is not currently supported inside arrays");var n=t._toFieldTransform(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(void 0===t&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.Oc&&4!==e.xc)throw e.Bc("Nested arrays are not supported");return function(t,e){for(var n=[],r=0,i=0,o=t;i<o.length;i++){var a=Tf(o[i],e.Lc(r));null==a&&(a={nullValue:"NULL_VALUE"}),n.push(a),r++}return{arrayValue:{values:n}}}(t,e)}return function(t,e){if(null===(t=(0,i.getModularInstance)(t)))return{nullValue:"NULL_VALUE"};if("number"==typeof t)return ro(e.R,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=Dr.fromDate(t);return{timestampValue:fa(e.R,n)}}if(t instanceof Dr)return n=new Dr(t.seconds,1e3*Math.floor(t.nanoseconds/1e3)),{timestampValue:fa(e.R,n)};if(t instanceof of)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof nf)return{bytesValue:pa(e.R,t._byteString)};if(t instanceof qh){n=e.databaseId;var r=t.firestore._databaseId;if(!r.isEqual(n))throw e.Bc("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:ga(t.firestore._databaseId||e.databaseId,t._key.path)}}throw e.Bc("Unsupported field value: "+Lh(t))}(t,e)}function Ef(t,e){var n={};return Ur(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Fr(t,(function(t,r){var i=Tf(r,e.kc(t));null!=i&&(n[t]=i)})),{mapValue:{fields:n}}}function Sf(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Dr||t instanceof of||t instanceof nf||t instanceof qh||t instanceof rf)}function Cf(t,e,n){if(!Sf(n)||!function(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}(n)){var r=Lh(n);throw"an object"===r?e.Bc(t+" a custom object"):e.Bc(t+" "+r)}}function kf(t,e,n){if((e=(0,i.getModularInstance)(e))instanceof ef)return e._internalPath;if("string"==typeof e)return Nf(t,e);throw Pf("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}var Af=new RegExp("[~\\*/\\[\\]]");function Nf(t,e,n){if(e.search(Af)>=0)throw Pf("Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'",t,!1,void 0,n);try{return(new(ef.bind.apply(ef,gr([void 0],e.split(".")))))._internalPath}catch(r){throw Pf("Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'",t,!1,void 0,n)}}function Pf(t,e,n,r,i){var o=r&&!r.isEmpty(),a=void 0!==i,s="Function "+e+"() called with invalid data";n&&(s+=" (via `toFirestore()`)");var u="";return(o||a)&&(u+=" (found",o&&(u+=" in field "+r),a&&(u+=" in document "+i),u+=")"),new br(mr.INVALID_ARGUMENT,(s+=". ")+t+u)}function Of(t,e){return t.some((function(t){return t.isEqual(e)}))}var Rf=function(){function t(t,e,n,r,i){this._firestore=t,this._userDataWriter=e,this._key=n,this._document=r,this._converter=i}return Object.defineProperty(t.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ref",{get:function(){return new qh(this._firestore,this._converter,this._key)},enumerable:!1,configurable:!0}),t.prototype.exists=function(){return null!==this._document},t.prototype.data=function(){if(this._document){if(this._converter){var t=new xf(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.toProto())}},t.prototype.get=function(t){if(this._document){var e=this._document.data.field(Df("DocumentSnapshot.get",t));if(null!==e)return this._userDataWriter.convertValue(e)}},t}(),xf=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return pr(e,t),e.prototype.data=function(){return t.prototype.data.call(this)},e}(Rf);function Df(t,e){return"string"==typeof e?Nf(t,e):e instanceof ef?e._internalPath:e._delegate._internalPath}var Lf=function(){function t(t,e){this.hasPendingWrites=t,this.fromCache=e}return t.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},t}(),Mf=function(t){function e(e,n,r,i,o,a){var s=this;return(s=t.call(this,e,n,r,i,a)||this)._firestore=e,s._firestoreImpl=e,s.metadata=o,s}return pr(e,t),e.prototype.exists=function(){return t.prototype.exists.call(this)},e.prototype.data=function(t){if(void 0===t&&(t={}),this._document){if(this._converter){var e=new Ff(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(e,t)}return this._userDataWriter.convertValue(this._document.data.toProto(),t.serverTimestamps)}},e.prototype.get=function(t,e){if(void 0===e&&(e={}),this._document){var n=this._document.data.field(Df("DocumentSnapshot.get",t));if(null!==n)return this._userDataWriter.convertValue(n,e.serverTimestamps)}},e}(Rf),Ff=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return pr(e,t),e.prototype.data=function(e){return void 0===e&&(e={}),t.prototype.data.call(this,e)},e}(Mf),Uf=function(){function t(t,e,n,r){this._firestore=t,this._userDataWriter=e,this._snapshot=r,this.metadata=new Lf(r.hasPendingWrites,r.fromCache),this.query=n}return Object.defineProperty(t.prototype,"docs",{get:function(){var t=[];return this.forEach((function(e){return t.push(e)})),t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._snapshot.docs.size},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return 0===this.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t,e){var n=this;this._snapshot.docs.forEach((function(r){t.call(e,new Ff(n._firestore,n._userDataWriter,r.key,r,new Lf(n._snapshot.mutatedKeys.has(r.key),n._snapshot.fromCache),n.query.converter))}))},t.prototype.docChanges=function(t){void 0===t&&(t={});var e=!!t.includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new br(mr.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(t,e){if(t._snapshot.oldDocs.isEmpty()){var n=0;return t._snapshot.docChanges.map((function(e){var r=new Ff(t._firestore,t._userDataWriter,e.doc.key,e.doc,new Lf(t._snapshot.mutatedKeys.has(e.doc.key),t._snapshot.fromCache),t.query.converter);return e.doc,{type:"added",doc:r,oldIndex:-1,newIndex:n++}}))}var r=t._snapshot.oldDocs;return t._snapshot.docChanges.filter((function(t){return e||3!==t.type})).map((function(e){var n=new Ff(t._firestore,t._userDataWriter,e.doc.key,e.doc,new Lf(t._snapshot.mutatedKeys.has(e.doc.key),t._snapshot.fromCache),t.query.converter),i=-1,o=-1;return 0!==e.type&&(i=r.indexOf(e.doc.key),r=r.delete(e.doc.key)),1!==e.type&&(o=(r=r.add(e.doc)).indexOf(e.doc.key)),{type:jf(e.type),doc:n,oldIndex:i,newIndex:o}}))}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges},t}();function jf(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Cr()}}function qf(t,e){return t instanceof Mf&&e instanceof Mf?t._firestore===e._firestore&&t._key.isEqual(e._key)&&(null===t._document?null===e._document:t._document.isEqual(e._document))&&t._converter===e._converter:t instanceof Uf&&e instanceof Uf&&t._firestore===e._firestore&&Hh(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t._snapshot.isEqual(e._snapshot)}function Vf(t){if(Bi(t)&&0===t.explicitOrderBy.length)throw new br(mr.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Bf=function(){};function Kf(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0,i=e;r<i.length;r++){var o=i[r];t=o._apply(t)}return t}var Wf=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).Wc=e,i.Gc=n,i.zc=r,i.type="where",i}return pr(e,t),e.prototype._apply=function(t){var e=ff(t.firestore),n=function(t,e,n,r,i,o,a){var s;if(i.isKeyField()){if("array-contains"===o||"array-contains-any"===o)throw new br(mr.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+o+"' queries on FieldPath.documentId().");if("in"===o||"not-in"===o){Jf(a,o);for(var u=[],c=0,l=a;c<l.length;c++){var h=l[c];u.push(Xf(r,t,h))}s={arrayValue:{values:u}}}else s=Xf(r,t,a)}else"in"!==o&&"not-in"!==o&&"array-contains-any"!==o||Jf(a,o),s=If(n,"where",a,"in"===o||"not-in"===o);var f=Ti.create(i,o,s);return function(t,e){if(e.g()){var n=Wi(t);if(null!==n&&!n.isEqual(e.field))throw new br(mr.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");var r=Ki(t);null!==r&&$f(0,e.field,r)}var i=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(e.indexOf(i.op)>=0)return i.op}return null}(t,function(t){switch(t){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(null!==i)throw i===e.op?new br(mr.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new br(mr.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+i.toString()+"' filters.")}(t,f),f}(t._query,0,e,t.firestore._databaseId,this.Wc,this.Gc,this.zc);return new Vh(t.firestore,t.converter,function(t,e){var n=t.filters.concat([e]);return new Ui(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}(t._query,n))},e}(Bf),Gf=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Wc=e,r.Hc=n,r.type="orderBy",r}return pr(e,t),e.prototype._apply=function(t){var e=function(t,e,n){if(null!==t.startAt)throw new br(mr.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new br(mr.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new Di(e,n);return function(t,e){if(null===Ki(t)){var n=Wi(t);null!==n&&$f(0,n,e.field)}}(t,r),r}(t._query,this.Wc,this.Hc);return new Vh(t.firestore,t.converter,function(t,e){var n=t.explicitOrderBy.concat([e]);return new Ui(t.path,t.collectionGroup,n,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(t._query,e))},e}(Bf),Hf=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.Jc=n,i.Yc=r,i}return pr(e,t),e.prototype._apply=function(t){return new Vh(t.firestore,t.converter,Qi(t._query,this.Jc,this.Yc))},e}(Bf),zf=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.Xc=n,i.Zc=r,i}return pr(e,t),e.prototype._apply=function(t){var e=Yf(t,this.type,this.Xc,this.Zc);return new Vh(t.firestore,t.converter,function(t,e){return new Ui(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,e,t.endAt)}(t._query,e))},e}(Bf),Qf=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.Xc=n,i.Zc=r,i}return pr(e,t),e.prototype._apply=function(t){var e=Yf(t,this.type,this.Xc,this.Zc);return new Vh(t.firestore,t.converter,function(t,e){return new Ui(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,e)}(t._query,e))},e}(Bf);function Yf(t,e,n,r){if(n[0]=(0,i.getModularInstance)(n[0]),n[0]instanceof Rf)return function(t,e,n,r,i){if(!r)throw new br(mr.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+n+"().");for(var o=[],a=0,s=Hi(t);a<s.length;a++){var u=s[a];if(u.field.isKeyField())o.push(ci(e,r.key));else{var c=r.data.field(u.field);if(Yr(c))throw new br(mr.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===c){var l=u.field.canonicalString();throw new br(mr.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+l+"' (used as the orderBy) does not exist.")}o.push(c)}}return new Ri(o,i)}(t._query,t.firestore._databaseId,e,n[0]._document,r);var o=ff(t.firestore);return function(t,e,n,r,i,o){var a=t.explicitOrderBy;if(i.length>a.length)throw new br(mr.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var s=[],u=0;u<i.length;u++){var c=i[u];if(a[u].field.isKeyField()){if("string"!=typeof c)throw new br(mr.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!Gi(t)&&-1!==c.indexOf("/"))throw new br(mr.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var l=t.path.child(qr.fromString(c));if(!ei.isDocumentKey(l))throw new br(mr.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+l+"' is not because it contains an odd number of segments.");var h=new ei(l);s.push(ci(e,h))}else{var f=If(n,r,c);s.push(f)}}return new Ri(s,o)}(t._query,t.firestore._databaseId,o,e,n,r)}function Xf(t,e,n){if("string"==typeof(n=(0,i.getModularInstance)(n))){if(""===n)throw new br(mr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!Gi(e)&&-1!==n.indexOf("/"))throw new br(mr.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");var r=e.path.child(qr.fromString(n));if(!ei.isDocumentKey(r))throw new br(mr.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+r+"' is not because it has an odd number of segments ("+r.length+").");return ci(t,new ei(r))}if(n instanceof qh)return ci(t,n._key);throw new br(mr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+Lh(n)+".")}function Jf(t,e){if(!Array.isArray(t)||0===t.length)throw new br(mr.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(t.length>10)throw new br(mr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function $f(t,e,n){if(!n.isEqual(e))throw new br(mr.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first argument to orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}var Zf=function(){function t(){}return t.prototype.convertValue=function(t,e){switch(void 0===e&&(e="none"),ni(t)){case 0:return null;case 1:return t.booleanValue;case 2:return zr(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,e);case 5:return t.stringValue;case 6:return this.convertBytes(Qr(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,e);case 10:return this.convertObject(t.mapValue,e);default:throw Cr()}},t.prototype.convertObject=function(t,e){var n=this,r={};return Fr(t.fields||{},(function(t,i){r[t]=n.convertValue(i,e)})),r},t.prototype.convertGeoPoint=function(t){return new of(zr(t.latitude),zr(t.longitude))},t.prototype.convertArray=function(t,e){var n=this;return(t.values||[]).map((function(t){return n.convertValue(t,e)}))},t.prototype.convertServerTimestamp=function(t,e){switch(e){case"previous":var n=Xr(t);return null==n?null:this.convertValue(n,e);case"estimate":return this.convertTimestamp(Jr(t));default:return null}},t.prototype.convertTimestamp=function(t){var e=Hr(t);return new Dr(e.seconds,e.nanos)},t.prototype.convertDocumentKey=function(t,e){var n=qr.fromString(t);kr(Va(n));var r=new Ih(n.get(1),n.get(3)),i=new ei(n.popFirst(5));return r.isEqual(e)||Tr("Document "+i+" contains a document reference within a different database ("+r.projectId+"/"+r.database+") which is not supported. It will be treated as a reference in the current database ("+e.projectId+"/"+e.database+") instead."),i},t}();function tp(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var ep=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return pr(e,t),e.prototype.convertBytes=function(t){return new nf(t)},e.prototype.convertReference=function(t){var e=this.convertDocumentKey(t,this.firestore._databaseId);return new qh(this.firestore,null,e)},e}(Zf),np=function(){function t(t,e){this._firestore=t,this._commitHandler=e,this._mutations=[],this._committed=!1,this._dataReader=ff(t)}return t.prototype.set=function(t,e,n){this._verifyNotCommitted();var r=rp(t,this._firestore),i=tp(r.converter,e,n),o=pf(this._dataReader,"WriteBatch.set",r._key,i,null!==r.converter,n);return this._mutations.push(o.toMutation(r._key,bo.none())),this},t.prototype.update=function(t,e,n){for(var r=[],o=3;o<arguments.length;o++)r[o-3]=arguments[o];this._verifyNotCommitted();var a,s=rp(t,this._firestore);return a="string"==typeof(e=(0,i.getModularInstance)(e))||e instanceof ef?wf(this._dataReader,"WriteBatch.update",s._key,e,n,r):_f(this._dataReader,"WriteBatch.update",s._key,e),this._mutations.push(a.toMutation(s._key,bo.exists(!0))),this},t.prototype.delete=function(t){this._verifyNotCommitted();var e=rp(t,this._firestore);return this._mutations=this._mutations.concat(new Do(e._key,bo.none())),this},t.prototype.commit=function(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()},t.prototype._verifyNotCommitted=function(){if(this._committed)throw new br(mr.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},t}();function rp(t,e){if((t=(0,i.getModularInstance)(t)).firestore!==e)throw new br(mr.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}var ip=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return pr(e,t),e.prototype.convertBytes=function(t){return new nf(t)},e.prototype.convertReference=function(t){var e=this.convertDocumentKey(t,this.firestore._databaseId);return new qh(this.firestore,null,e)},e}(Zf);function op(t,e,n){for(var r=[],o=3;o<arguments.length;o++)r[o-3]=arguments[o];t=Mh(t,qh);var a=Mh(t.firestore,Xh),s=ff(a);return sp(a,[("string"==typeof(e=(0,i.getModularInstance)(e))||e instanceof ef?wf(s,"updateDoc",t._key,e,n,r):_f(s,"updateDoc",t._key,e)).toMutation(t._key,bo.exists(!0))])}function ap(t){for(var e,n,r,o=[],a=1;a<arguments.length;a++)o[a-1]=arguments[a];t=(0,i.getModularInstance)(t);var s={includeMetadataChanges:!1},u=0;"object"!=typeof o[u]||Qh(o[u])||(s=o[u],u++);var c,l,h,f={includeMetadataChanges:s.includeMetadataChanges};if(Qh(o[u])){var p=o[u];o[u]=null===(e=p.next)||void 0===e?void 0:e.bind(p),o[u+1]=null===(n=p.error)||void 0===n?void 0:n.bind(p),o[u+2]=null===(r=p.complete)||void 0===r?void 0:r.bind(p)}if(t instanceof qh)l=Mh(t.firestore,Xh),h=qi(t._key.path),c={next:function(e){o[u]&&o[u](up(l,t,e))},error:o[u+1],complete:o[u+2]};else{var d=Mh(t,Vh);l=Mh(d.firestore,Xh),h=d._query;var v=new ip(l);c={next:function(t){o[u]&&o[u](new Uf(l,v,d,t))},error:o[u+1],complete:o[u+2]},Vf(t._query)}return function(t,e,n,r){var i=this,o=new oh(r),a=new hl(e,o,n);return t.asyncQueue.enqueueAndForget((function(){return dr(i,void 0,void 0,(function(){var e;return vr(this,(function(n){switch(n.label){case 0:return e=al,[4,mh(t)];case 1:return[2,e.apply(void 0,[n.sent(),a])]}}))}))})),function(){o.Wo(),t.asyncQueue.enqueueAndForget((function(){return dr(i,void 0,void 0,(function(){var e;return vr(this,(function(n){switch(n.label){case 0:return e=sl,[4,mh(t)];case 1:return[2,e.apply(void 0,[n.sent(),a])]}}))}))}))}}(Jh(l),h,f,c)}function sp(t,e){return function(t,e){var n=this,r=new hs;return t.asyncQueue.enqueueAndForget((function(){return dr(n,void 0,void 0,(function(){var n;return vr(this,(function(i){switch(i.label){case 0:return n=Sl,[4,yh(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}}))}))})),r.promise}(Jh(t),e)}function up(t,e,n){var r=n.docs.get(e._key),i=new ip(t);return new Mf(t,i,e._key,r,new Lf(n.hasPendingWrites,n.fromCache),e.converter)}var cp=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this)._firestore=e,r}return pr(e,t),e.prototype.get=function(e){var n=this,r=rp(e,this._firestore),i=new ip(this._firestore);return t.prototype.get.call(this,e).then((function(t){return new Mf(n._firestore,i,r._key,t._document,new Lf(!1,!1),r.converter)}))},e}(function(){function t(t,e){this._firestore=t,this._transaction=e,this._dataReader=ff(t)}return t.prototype.get=function(t){var e=this,n=rp(t,this._firestore),r=new ep(this._firestore);return this._transaction.lookup([n._key]).then((function(t){if(!t||1!==t.length)return Cr();var i=t[0];if(i.isFoundDocument())return new Rf(e._firestore,r,i.key,i,n.converter);if(i.isNoDocument())return new Rf(e._firestore,r,n._key,null,n.converter);throw Cr()}))},t.prototype.set=function(t,e,n){var r=rp(t,this._firestore),i=tp(r.converter,e,n),o=pf(this._dataReader,"Transaction.set",r._key,i,null!==r.converter,n);return this._transaction.set(r._key,o),this},t.prototype.update=function(t,e,n){for(var r=[],o=3;o<arguments.length;o++)r[o-3]=arguments[o];var a,s=rp(t,this._firestore);return a="string"==typeof(e=(0,i.getModularInstance)(e))||e instanceof ef?wf(this._dataReader,"Transaction.update",s._key,e,n,r):_f(this._dataReader,"Transaction.update",s._key,e),this._transaction.update(s._key,a),this},t.prototype.delete=function(t){var e=rp(t,this._firestore);return this._transaction.delete(e._key),this},t}());function lp(){if("undefined"==typeof Uint8Array)throw new br(mr.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function hp(){if("undefined"==typeof atob)throw new br(mr.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var fp=function(){function t(t){this._delegate=t}return t.fromBase64String=function(e){return hp(),new t(nf.fromBase64String(e))},t.fromUint8Array=function(e){return lp(),new t(nf.fromUint8Array(e))},t.prototype.toBase64=function(){return hp(),this._delegate.toBase64()},t.prototype.toUint8Array=function(){return lp(),this._delegate.toUint8Array()},t.prototype.isEqual=function(t){return this._delegate.isEqual(t._delegate)},t.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},t}(),pp=function(){function t(){}return t.prototype.enableIndexedDbPersistence=function(t,e){return function(t,e){tf(t=Mh(t,Xh));var n=Jh(t),r=t._freezeSettings(),i=new rh;return Zh(n,i,new eh(i,r.cacheSizeBytes,null==e?void 0:e.forceOwnership))}(t._delegate,{forceOwnership:e})},t.prototype.enableMultiTabIndexedDbPersistence=function(t){return function(t){tf(t=Mh(t,Xh));var e=Jh(t),n=t._freezeSettings(),r=new rh;return Zh(e,r,new nh(r,n.cacheSizeBytes))}(t._delegate)},t.prototype.clearIndexedDbPersistence=function(t){return function(t){var e=this;if(t._initialized&&!t._terminated)throw new br(mr.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");var n=new hs;return t._queue.enqueueAndForgetEvenWhileRestricted((function(){return dr(e,void 0,void 0,(function(){var e;return vr(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,function(t){return dr(this,void 0,void 0,(function(){var e;return vr(this,(function(n){switch(n.label){case 0:return ds.yt()?(e=t+"main",[4,ds.delete(e)]):[2,Promise.resolve()];case 1:return n.sent(),[2]}}))}))}(Su(t._databaseId,t._persistenceKey))];case 1:return r.sent(),n.resolve(),[3,3];case 2:return e=r.sent(),n.reject(e),[3,3];case 3:return[2]}}))}))})),n.promise}(t._delegate)},t}(),dp=function(){function t(t,e,n){var r=this;this._delegate=e,this.ta=n,this.INTERNAL={delete:function(){return r.terminate()}},t instanceof Ih||(this.ea=t)}return Object.defineProperty(t.prototype,"_databaseId",{get:function(){return this._delegate._databaseId},enumerable:!1,configurable:!0}),t.prototype.settings=function(t){t.merge&&delete(t=Object.assign(Object.assign({},this._delegate._getSettings()),t)).merge,this._delegate._setSettings(t)},t.prototype.useEmulator=function(t,e,n){void 0===n&&(n={}),function(t,e,n,r){void 0===r&&(r={});var o=(t=Mh(t,jh))._getSettings();if("firestore.googleapis.com"!==o.host&&o.host!==e&&Er("Host has been set in both settings() and useEmulator(), emulator host will be used"),t._setSettings(Object.assign(Object.assign({},o),{host:e+":"+n,ssl:!1})),r.mockUserToken){var a=(0,i.createMockUserToken)(r.mockUserToken),s=r.mockUserToken.sub||r.mockUserToken.user_id;if(!s)throw new br(mr.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");t._credentials=new Ch(new Eh(a,new nc(s)))}}(this._delegate,t,e,n)},t.prototype.enableNetwork=function(){return function(t){var e=this;return t.asyncQueue.enqueue((function(){return dr(e,void 0,void 0,(function(){var e,n;return vr(this,(function(r){switch(r.label){case 0:return[4,dh(t)];case 1:return e=r.sent(),[4,gh(t)];case 2:return n=r.sent(),[2,(e.setNetworkEnabled(!0),function(t){var e=Ar(t);return e.$r.delete(0),Ac(e)}(n))]}}))}))}))}(Jh(Mh(this._delegate,Xh)))},t.prototype.disableNetwork=function(){return function(t){var e=this;return t.asyncQueue.enqueue((function(){return dr(e,void 0,void 0,(function(){var e,n;return vr(this,(function(r){switch(r.label){case 0:return[4,dh(t)];case 1:return e=r.sent(),[4,gh(t)];case 2:return n=r.sent(),[2,(e.setNetworkEnabled(!1),function(t){return dr(this,void 0,void 0,(function(){var e;return vr(this,(function(n){switch(n.label){case 0:return(e=Ar(t)).$r.add(0),[4,Nc(e)];case 1:return n.sent(),e.Br.set("Offline"),[2]}}))}))}(n))]}}))}))}))}(Jh(Mh(this._delegate,Xh)))},t.prototype.enablePersistence=function(t){var e=!1,n=!1;return t&&Rh("synchronizeTabs",e=!!t.synchronizeTabs,"experimentalForceOwningTab",n=!!t.experimentalForceOwningTab),e?this.ta.enableMultiTabIndexedDbPersistence(this):this.ta.enableIndexedDbPersistence(this,n)},t.prototype.clearPersistence=function(){return this.ta.clearIndexedDbPersistence(this)},t.prototype.terminate=function(){return this.ea&&(this.ea._removeServiceInstance("firestore"),this.ea._removeServiceInstance("firestore-exp")),this._delegate._delete()},t.prototype.waitForPendingWrites=function(){return function(t){var e=this,n=new hs;return t.asyncQueue.enqueueAndForget((function(){return dr(e,void 0,void 0,(function(){var e;return vr(this,(function(r){switch(r.label){case 0:return e=Ol,[4,yh(t)];case 1:return[2,e.apply(void 0,[r.sent(),n])]}}))}))})),n.promise}(Jh(Mh(this._delegate,Xh)))},t.prototype.onSnapshotsInSync=function(t){return function(t,e){return function(t,e){var n=this,r=new oh(e);return t.asyncQueue.enqueueAndForget((function(){return dr(n,void 0,void 0,(function(){var e;return vr(this,(function(n){switch(n.label){case 0:return e=function(t,e){Ar(t).Gr.add(e),e.next()},[4,mh(t)];case 1:return[2,e.apply(void 0,[n.sent(),r])]}}))}))})),function(){r.Wo(),t.asyncQueue.enqueueAndForget((function(){return dr(n,void 0,void 0,(function(){var e;return vr(this,(function(n){switch(n.label){case 0:return e=function(t,e){Ar(t).Gr.delete(e)},[4,mh(t)];case 1:return[2,e.apply(void 0,[n.sent(),r])]}}))}))}))}}(Jh(t=Mh(t,Xh)),Qh(e)?e:{next:e})}(this._delegate,t)},Object.defineProperty(t.prototype,"app",{get:function(){if(!this.ea)throw new br(mr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.ea},enumerable:!1,configurable:!0}),t.prototype.collection=function(t){try{return new Ap(this,Kh(this._delegate,t))}catch(t){throw _p(t,"collection()","Firestore.collection()")}},t.prototype.doc=function(t){try{return new bp(this,Wh(this._delegate,t))}catch(t){throw _p(t,"doc()","Firestore.doc()")}},t.prototype.collectionGroup=function(t){try{return new Sp(this,function(t,e){if(t=Mh(t,jh),Ph("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new br(mr.INVALID_ARGUMENT,"Invalid collection ID '"+e+"' passed to function collectionGroup(). Collection IDs must not contain '/'.");return new Vh(t,null,function(t){return new Ui(qr.emptyPath(),t)}(e))}(this._delegate,t))}catch(t){throw _p(t,"collectionGroup()","Firestore.collectionGroup()")}},t.prototype.runTransaction=function(t){var e=this;return function(t,e){return function(t,e){var n=this,r=new hs;return t.asyncQueue.enqueueAndForget((function(){return dr(n,void 0,void 0,(function(){var n;return vr(this,(function(i){switch(i.label){case 0:return[4,function(t){return ph(t).then((function(t){return t.datastore}))}(t)];case 1:return n=i.sent(),new uh(t.asyncQueue,n,e,r).run(),[2]}}))}))})),r.promise}(Jh(t),(function(n){return e(new cp(t,n))}))}(this._delegate,(function(n){return t(new gp(e,n))}))},t.prototype.batch=function(){var t=this;return Jh(this._delegate),new yp(new np(this._delegate,(function(e){return sp(t._delegate,e)})))},t.prototype.loadBundle=function(t){throw new br(mr.FAILED_PRECONDITION,'"loadBundle()" does not exist, have you imported "firebase/firestore/bundle"?')},t.prototype.namedQuery=function(t){throw new br(mr.FAILED_PRECONDITION,'"namedQuery()" does not exist, have you imported "firebase/firestore/bundle"?')},t}(),vp=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return pr(e,t),e.prototype.convertBytes=function(t){return new fp(new nf(t))},e.prototype.convertReference=function(t){var e=this.convertDocumentKey(t,this.firestore._databaseId);return bp.na(e,this.firestore,null)},e}(Zf),gp=function(){function t(t,e){this._firestore=t,this._delegate=e,this._userDataWriter=new vp(t)}return t.prototype.get=function(t){var e=this,n=Np(t);return this._delegate.get(n).then((function(t){return new Tp(e._firestore,new Mf(e._firestore._delegate,e._userDataWriter,t._key,t._document,t.metadata,n.converter))}))},t.prototype.set=function(t,e,n){var r=Np(t);return n?(Oh("Transaction.set",n),this._delegate.set(r,e,n)):this._delegate.set(r,e),this},t.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var a=Np(t);return 2===arguments.length?this._delegate.update(a,e):(r=this._delegate).update.apply(r,gr([a,e,n],i)),this},t.prototype.delete=function(t){var e=Np(t);return this._delegate.delete(e),this},t}(),yp=function(){function t(t){this._delegate=t}return t.prototype.set=function(t,e,n){var r=Np(t);return n?(Oh("WriteBatch.set",n),this._delegate.set(r,e,n)):this._delegate.set(r,e),this},t.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var a=Np(t);return 2===arguments.length?this._delegate.update(a,e):(r=this._delegate).update.apply(r,gr([a,e,n],i)),this},t.prototype.delete=function(t){var e=Np(t);return this._delegate.delete(e),this},t.prototype.commit=function(){return this._delegate.commit()},t}(),mp=function(){function t(t,e,n){this._firestore=t,this._userDataWriter=e,this._delegate=n}return t.prototype.fromFirestore=function(t,e){var n=new Ff(this._firestore._delegate,this._userDataWriter,t._key,t._document,t.metadata,null);return this._delegate.fromFirestore(new Ep(this._firestore,n),null!=e?e:{})},t.prototype.toFirestore=function(t,e){return e?this._delegate.toFirestore(t,e):this._delegate.toFirestore(t)},t.sa=function(e,n){var r=t.ia,i=r.get(e);i||(i=new WeakMap,r.set(e,i));var o=i.get(n);return o||(o=new t(e,new vp(e),n),i.set(n,o)),o},t}();mp.ia=new WeakMap;var bp=function(){function t(t,e){this.firestore=t,this._delegate=e,this._userDataWriter=new vp(t)}return t.ra=function(e,n,r){if(e.length%2!=0)throw new br(mr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+e.canonicalString()+" has "+e.length);return new t(n,new qh(n._delegate,r,new ei(e)))},t.na=function(e,n,r){return new t(n,new qh(n._delegate,r,e))},Object.defineProperty(t.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new Ap(this.firestore,this._delegate.parent)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this._delegate.path},enumerable:!1,configurable:!0}),t.prototype.collection=function(t){try{return new Ap(this.firestore,Kh(this._delegate,t))}catch(t){throw _p(t,"collection()","DocumentReference.collection()")}},t.prototype.isEqual=function(t){return(t=(0,i.getModularInstance)(t))instanceof qh&&Gh(this._delegate,t)},t.prototype.set=function(t,e){e=Oh("DocumentReference.set",e);try{return function(t,e,n){t=Mh(t,qh);var r=Mh(t.firestore,Xh),i=tp(t.converter,e,n);return sp(r,[pf(ff(r),"setDoc",t._key,i,null!==t.converter,n).toMutation(t._key,bo.none())])}(this._delegate,t,e)}catch(t){throw _p(t,"setDoc()","DocumentReference.set()")}},t.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];try{return 1===arguments.length?op(this._delegate,t):op.apply(void 0,gr([this._delegate,t,e],n))}catch(t){throw _p(t,"updateDoc()","DocumentReference.update()")}},t.prototype.delete=function(){return sp(Mh((t=this._delegate).firestore,Xh),[new Do(t._key,bo.none())]);var t},t.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=wp(e),i=Ip(e,(function(e){return new Tp(t.firestore,new Mf(t.firestore._delegate,t._userDataWriter,e._key,e._document,e.metadata,t._delegate.converter))}));return ap(this._delegate,r,i)},t.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(t){t=Mh(t,qh);var e=Mh(t.firestore,Xh),n=Jh(e),r=new ip(e);return function(t,e){var n=this,r=new hs;return t.asyncQueue.enqueueAndForget((function(){return dr(n,void 0,void 0,(function(){var n;return vr(this,(function(i){switch(i.label){case 0:return n=function(t,e,n){return dr(this,void 0,void 0,(function(){var r,i;return vr(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,function(t,e){var n=Ar(t);return n.persistence.runTransaction("read document","readonly",(function(t){return n.Mn.mn(t,e)}))}(t,e)];case 1:return(i=o.sent()).isFoundDocument()?n.resolve(i):i.isNoDocument()?n.resolve(null):n.reject(new br(mr.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=o.sent(),i=tl(r,"Failed to get document '"+e+" from cache"),n.reject(i),[3,3];case 3:return[2]}}))}))},[4,vh(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}}))}))})),r.promise}(n,t._key).then((function(n){return new Mf(e,r,t._key,n,new Lf(null!==n&&n.hasLocalMutations,!0),t.converter)}))}(this._delegate):"server"===(null==t?void 0:t.source)?function(t){t=Mh(t,qh);var e=Mh(t.firestore,Xh);return bh(Jh(e),t._key,{source:"server"}).then((function(n){return up(e,t,n)}))}(this._delegate):function(t){t=Mh(t,qh);var e=Mh(t.firestore,Xh);return bh(Jh(e),t._key).then((function(n){return up(e,t,n)}))}(this._delegate)).then((function(t){return new Tp(e.firestore,new Mf(e.firestore._delegate,e._userDataWriter,t._key,t._document,t.metadata,e._delegate.converter))}))},t.prototype.withConverter=function(e){return new t(this.firestore,e?this._delegate.withConverter(mp.sa(this.firestore,e)):this._delegate.withConverter(null))},t}();function _p(t,e,n){return t.message=t.message.replace(e,n),t}function wp(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if("object"==typeof r&&!Qh(r))return r}return{}}function Ip(t,e){var n,r,i;return{next:function(t){i.next&&i.next(e(t))},error:null===(n=(i=Qh(t[0])?t[0]:Qh(t[1])?t[1]:"function"==typeof t[0]?{next:t[0],error:t[1],complete:t[2]}:{next:t[1],error:t[2],complete:t[3]}).error)||void 0===n?void 0:n.bind(i),complete:null===(r=i.complete)||void 0===r?void 0:r.bind(i)}}var Tp=function(){function t(t,e){this._firestore=t,this._delegate=e}return Object.defineProperty(t.prototype,"ref",{get:function(){return new bp(this._firestore,this._delegate.ref)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"metadata",{get:function(){return this._delegate.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"exists",{get:function(){return this._delegate.exists()},enumerable:!1,configurable:!0}),t.prototype.data=function(t){return this._delegate.data(t)},t.prototype.get=function(t,e){return this._delegate.get(t,e)},t.prototype.isEqual=function(t){return qf(this._delegate,t._delegate)},t}(),Ep=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return pr(e,t),e.prototype.data=function(t){return this._delegate.data(t)},e}(Tp),Sp=function(){function t(t,e){this.firestore=t,this._delegate=e,this._userDataWriter=new vp(t)}return t.prototype.where=function(e,n,r){try{return new t(this.firestore,Kf(this._delegate,function(t,e,n){var r=e,i=Df("where",t);return new Wf(i,r,n)}(e,n,r)))}catch(e){throw _p(e,/(orderBy|where)\(\)/,"Query.$1()")}},t.prototype.orderBy=function(e,n){try{return new t(this.firestore,Kf(this._delegate,function(t,e){void 0===e&&(e="asc");var n=e,r=Df("orderBy",t);return new Gf(r,n)}(e,n)))}catch(e){throw _p(e,/(orderBy|where)\(\)/,"Query.$1()")}},t.prototype.limit=function(e){try{return new t(this.firestore,Kf(this._delegate,function(t){return Fh("limit",t),new Hf("limit",t,"F")}(e)))}catch(e){throw _p(e,"limit()","Query.limit()")}},t.prototype.limitToLast=function(e){try{return new t(this.firestore,Kf(this._delegate,function(t){return Fh("limitToLast",t),new Hf("limitToLast",t,"L")}(e)))}catch(e){throw _p(e,"limitToLast()","Query.limitToLast()")}},t.prototype.startAt=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,Kf(this._delegate,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new zf("startAt",t,!0)}.apply(void 0,e)))}catch(e){throw _p(e,"startAt()","Query.startAt()")}},t.prototype.startAfter=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,Kf(this._delegate,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new zf("startAfter",t,!1)}.apply(void 0,e)))}catch(e){throw _p(e,"startAfter()","Query.startAfter()")}},t.prototype.endBefore=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,Kf(this._delegate,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Qf("endBefore",t,!0)}.apply(void 0,e)))}catch(e){throw _p(e,"endBefore()","Query.endBefore()")}},t.prototype.endAt=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,Kf(this._delegate,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Qf("endAt",t,!1)}.apply(void 0,e)))}catch(e){throw _p(e,"endAt()","Query.endAt()")}},t.prototype.isEqual=function(t){return Hh(this._delegate,t._delegate)},t.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(t){t=Mh(t,Vh);var e=Mh(t.firestore,Xh),n=Jh(e),r=new ip(e);return function(t,e){var n=this,r=new hs;return t.asyncQueue.enqueueAndForget((function(){return dr(n,void 0,void 0,(function(){var n;return vr(this,(function(i){switch(i.label){case 0:return n=function(t,e,n){return dr(this,void 0,void 0,(function(){var r,i,o,a,s;return vr(this,(function(u){switch(u.label){case 0:return u.trys.push([0,2,,3]),[4,qu(t,e,!0)];case 1:return s=u.sent(),r=new ml(e,s.Bn),i=r._o(s.documents),o=r.applyChanges(i,!1),n.resolve(o.snapshot),[3,3];case 2:return a=u.sent(),s=tl(a,"Failed to execute query '"+e+" against cache"),n.reject(s),[3,3];case 3:return[2]}}))}))},[4,vh(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}}))}))})),r.promise}(n,t._query).then((function(n){return new Uf(e,r,t,n)}))}(this._delegate):"server"===(null==t?void 0:t.source)?function(t){t=Mh(t,Vh);var e=Mh(t.firestore,Xh),n=Jh(e),r=new ip(e);return _h(n,t._query,{source:"server"}).then((function(n){return new Uf(e,r,t,n)}))}(this._delegate):function(t){t=Mh(t,Vh);var e=Mh(t.firestore,Xh),n=Jh(e),r=new ip(e);return Vf(t._query),_h(n,t._query).then((function(n){return new Uf(e,r,t,n)}))}(this._delegate)).then((function(t){return new kp(e.firestore,new Uf(e.firestore._delegate,e._userDataWriter,e._delegate,t._snapshot))}))},t.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=wp(e),i=Ip(e,(function(e){return new kp(t.firestore,new Uf(t.firestore._delegate,t._userDataWriter,t._delegate,e._snapshot))}));return ap(this._delegate,r,i)},t.prototype.withConverter=function(e){return new t(this.firestore,e?this._delegate.withConverter(mp.sa(this.firestore,e)):this._delegate.withConverter(null))},t}(),Cp=function(){function t(t,e){this._firestore=t,this._delegate=e}return Object.defineProperty(t.prototype,"type",{get:function(){return this._delegate.type},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"doc",{get:function(){return new Ep(this._firestore,this._delegate.doc)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"oldIndex",{get:function(){return this._delegate.oldIndex},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"newIndex",{get:function(){return this._delegate.newIndex},enumerable:!1,configurable:!0}),t}(),kp=function(){function t(t,e){this._firestore=t,this._delegate=e}return Object.defineProperty(t.prototype,"query",{get:function(){return new Sp(this._firestore,this._delegate.query)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"metadata",{get:function(){return this._delegate.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._delegate.size},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return this._delegate.empty},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"docs",{get:function(){var t=this;return this._delegate.docs.map((function(e){return new Ep(t._firestore,e)}))},enumerable:!1,configurable:!0}),t.prototype.docChanges=function(t){var e=this;return this._delegate.docChanges(t).map((function(t){return new Cp(e._firestore,t)}))},t.prototype.forEach=function(t,e){var n=this;this._delegate.forEach((function(r){t.call(e,new Ep(n._firestore,r))}))},t.prototype.isEqual=function(t){return qf(this._delegate,t._delegate)},t}(),Ap=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).firestore=e,r._delegate=n,r}return pr(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._delegate.path},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this._delegate.parent;return t?new bp(this.firestore,t):null},enumerable:!1,configurable:!0}),e.prototype.doc=function(t){try{return new bp(this.firestore,void 0===t?Wh(this._delegate):Wh(this._delegate,t))}catch(t){throw _p(t,"doc()","CollectionReference.doc()")}},e.prototype.add=function(t){var e=this;return function(t,e){var n=Mh(t.firestore,Xh),r=Wh(t),i=tp(t.converter,e);return sp(n,[pf(ff(t.firestore),"addDoc",r._key,i,null!==t.converter,{}).toMutation(r._key,bo.exists(!1))]).then((function(){return r}))}(this._delegate,t).then((function(t){return new bp(e.firestore,t)}))},e.prototype.isEqual=function(t){return Gh(this._delegate,t._delegate)},e.prototype.withConverter=function(t){return new e(this.firestore,t?this._delegate.withConverter(mp.sa(this.firestore,t)):this._delegate.withConverter(null))},e}(Sp);function Np(t){return Mh(t,qh)}var Pp=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._delegate=new(ef.bind.apply(ef,gr([void 0],t)))}return t.documentId=function(){return new t(Br.keyField().canonicalString())},t.prototype.isEqual=function(t){return(t=(0,i.getModularInstance)(t))instanceof ef&&this._delegate._internalPath.isEqual(t._internalPath)},t}(),Op=function(){function t(t){this._delegate=t}return t.serverTimestamp=function(){var e=new gf("serverTimestamp");return e._methodName="FieldValue.serverTimestamp",new t(e)},t.delete=function(){var e=new df("deleteField");return e._methodName="FieldValue.delete",new t(e)},t.arrayUnion=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new yf("arrayUnion",t)}.apply(void 0,e);return r._methodName="FieldValue.arrayUnion",new t(r)},t.arrayRemove=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new mf("arrayRemove",t)}.apply(void 0,e);return r._methodName="FieldValue.arrayRemove",new t(r)},t.increment=function(e){var n=function(t){return new bf("increment",t)}(e);return n._methodName="FieldValue.increment",new t(n)},t.prototype.isEqual=function(t){return this._delegate.isEqual(t._delegate)},t}();var Rp,xp,Dp=n(886),Lp={Firestore:dp,GeoPoint:of,Timestamp:Dr,Blob:fp,Transaction:gp,WriteBatch:yp,DocumentReference:bp,DocumentSnapshot:Tp,Query:Sp,QueryDocumentSnapshot:Ep,QuerySnapshot:kp,CollectionReference:Ap,FieldPath:Pp,FieldValue:Op,setLogLevel:function(t){var e;e=t,_r.setLogLevel(e)},CACHE_SIZE_UNLIMITED:-1};(function(t,e){t.INTERNAL.registerComponent(new Dp.Component("firestore",(function(t){return function(t,e){return new dp(t,new Xh(t,e),new pp)}(t.getProvider("app").getImmediate(),t.getProvider("auth-internal"))}),"PUBLIC").setServiceProps(Object.assign({},Lp)))})(Rp=r.default),Rp.registerVersion("@firebase/firestore","2.3.1"),(xp=dp).prototype.loadBundle=function(t){return function(t,e){var n=Jh(t=Mh(t,Xh)),r=new Yh;return function(t,e,n,r){var i=this,o=function(t,e){return function(t,e){return new ah(t,e)}(function(t,e){if(t instanceof Uint8Array)return ih(t,e);if(t instanceof ArrayBuffer)return ih(new Uint8Array(t),e);if(t instanceof ReadableStream)return t.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}("string"==typeof t?(new TextEncoder).encode(t):t),e)}(n,_c(e));t.asyncQueue.enqueueAndForget((function(){return dr(i,void 0,void 0,(function(){var e;return vr(this,(function(n){switch(n.label){case 0:return e=Zl,[4,yh(t)];case 1:return e.apply(void 0,[n.sent(),o,r]),[2]}}))}))}))}(n,t._databaseId,e,r),r}(this._delegate,t)},xp.prototype.namedQuery=function(t){var e,n,r=this;return(e=this._delegate,n=t,function(t,e){var n=this;return t.asyncQueue.enqueue((function(){return dr(n,void 0,void 0,(function(){var n;return vr(this,(function(r){switch(r.label){case 0:return n=function(t,e){var n=Ar(t);return n.persistence.runTransaction("Get named query","readonly",(function(t){return n.Qe.getNamedQuery(t,e)}))},[4,vh(t)];case 1:return[2,n.apply(void 0,[r.sent(),e])]}}))}))}))}(Jh(e=Mh(e,Xh)),n).then((function(t){return t?new Vh(e,null,t.query):null}))).then((function(t){return t?new Sp(r,t):null}))};var Mp=function(t,e){return(Mp=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function Fp(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))}function Up(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}Object.create,Object.create;var jp={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},qp=function(t){function e(n,r,i){var o=t.call(this,r)||this;return Object.setPrototypeOf(o,e.prototype),o.code=n,o.details=i,o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}Mp(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e}(Error),Vp=function(){function t(t,e){var n=this;this.auth=null,this.messaging=null,this.auth=t.getImmediate({optional:!0}),this.messaging=e.getImmediate({optional:!0}),this.auth||t.get().then((function(t){return n.auth=t}),(function(){})),this.messaging||e.get().then((function(t){return n.messaging=t}),(function(){}))}return t.prototype.getAuthToken=function(){return Fp(this,void 0,void 0,(function(){var t;return Up(this,(function(e){switch(e.label){case 0:if(!this.auth)return[2,void 0];e.label=1;case 1:return e.trys.push([1,3,,4]),[4,this.auth.getToken()];case 2:return(t=e.sent())?[2,t.accessToken]:[2,void 0];case 3:return e.sent(),[2,void 0];case 4:return[2]}}))}))},t.prototype.getInstanceIdToken=function(){return Fp(this,void 0,void 0,(function(){return Up(this,(function(t){switch(t.label){case 0:if(!this.messaging||!("Notification"in self)||"granted"!==Notification.permission)return[2,void 0];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.messaging.getToken()];case 2:return[2,t.sent()];case 3:return t.sent(),[2,void 0];case 4:return[2]}}))}))},t.prototype.getContext=function(){return Fp(this,void 0,void 0,(function(){var t,e;return Up(this,(function(n){switch(n.label){case 0:return[4,this.getAuthToken()];case 1:return t=n.sent(),[4,this.getInstanceIdToken()];case 2:return e=n.sent(),[2,{authToken:t,instanceIdToken:e}]}}))}))},t}();function Bp(t,e){var n={};for(var r in t)t.hasOwnProperty(r)&&(n[r]=e(t[r]));return n}var Kp,Wp,Gp,Hp=function(){function t(){}return t.prototype.encode=function(t){var e=this;if(null==t)return null;if(t instanceof Number&&(t=t.valueOf()),"number"==typeof t&&isFinite(t))return t;if(!0===t||!1===t)return t;if("[object String]"===Object.prototype.toString.call(t))return t;if(Array.isArray(t))return t.map((function(t){return e.encode(t)}));if("function"==typeof t||"object"==typeof t)return Bp(t,(function(t){return e.encode(t)}));throw new Error("Data cannot be encoded in JSON: "+t)},t.prototype.decode=function(t){var e=this;if(null==t)return t;if(t["@type"])switch(t["@type"]){case"type.googleapis.com/google.protobuf.Int64Value":case"type.googleapis.com/google.protobuf.UInt64Value":var n=Number(t.value);if(isNaN(n))throw new Error("Data cannot be decoded from JSON: "+t);return n;default:throw new Error("Data cannot be decoded from JSON: "+t)}return Array.isArray(t)?t.map((function(t){return e.decode(t)})):"function"==typeof t||"object"==typeof t?Bp(t,(function(t){return e.decode(t)})):t},t}(),zp=function(){function t(t,e,n,r,i,o){var a=this;void 0===i&&(i="us-central1"),this.app_=t,this.appCheckProvider=r,this.fetchImpl=o,this.serializer=new Hp,this.emulatorOrigin=null,this.INTERNAL={delete:function(){return Promise.resolve(a.deleteService())}},this.contextProvider=new Vp(e,n),this.cancelAllRequests=new Promise((function(t){a.deleteService=function(){return t()}}));try{var s=new URL(i);this.customDomain=s.origin,this.region="us-central1"}catch(t){this.customDomain=null,this.region=i}}return Object.defineProperty(t.prototype,"app",{get:function(){return this.app_},enumerable:!1,configurable:!0}),t.prototype._url=function(t){var e=this.app_.options.projectId;return null!==this.emulatorOrigin?this.emulatorOrigin+"/"+e+"/"+this.region+"/"+t:null!==this.customDomain?this.customDomain+"/"+t:"https://"+this.region+"-"+e+".cloudfunctions.net/"+t},t.prototype.useEmulator=function(t,e){this.emulatorOrigin="http://"+t+":"+e},t.prototype.useFunctionsEmulator=function(t){this.emulatorOrigin=t},t.prototype.httpsCallable=function(t,e){var n=this;return function(r){return n.call(t,r,e||{})}},t.prototype.postJSON=function(t,e,n){return Fp(this,void 0,void 0,(function(){var r,i,o;return Up(this,(function(a){switch(a.label){case 0:return n["Content-Type"]="application/json",[4,this.getAppCheckToken()];case 1:null!==(r=a.sent())&&(n["X-Firebase-AppCheck"]=r),a.label=2;case 2:return a.trys.push([2,4,,5]),[4,this.fetchImpl(t,{method:"POST",body:JSON.stringify(e),headers:n})];case 3:return i=a.sent(),[3,5];case 4:return a.sent(),[2,{status:0,json:null}];case 5:o=null,a.label=6;case 6:return a.trys.push([6,8,,9]),[4,i.json()];case 7:return o=a.sent(),[3,9];case 8:return a.sent(),[3,9];case 9:return[2,{status:i.status,json:o}]}}))}))},t.prototype.getAppCheckToken=function(){return Fp(this,void 0,void 0,(function(){var t;return Up(this,(function(e){switch(e.label){case 0:return(t=this.appCheckProvider.getImmediate({optional:!0}))?[4,t.getToken()]:[3,2];case 1:return[2,e.sent().token];case 2:return[2,null]}}))}))},t.prototype.call=function(t,e,n){return Fp(this,void 0,void 0,(function(){var r,i,o,a,s,u,c,l,h,f,p;return Up(this,(function(d){switch(d.label){case 0:return r=this._url(t),e=this.serializer.encode(e),i={data:e},o={},[4,this.contextProvider.getContext()];case 1:return(a=d.sent()).authToken&&(o.Authorization="Bearer "+a.authToken),a.instanceIdToken&&(o["Firebase-Instance-ID-Token"]=a.instanceIdToken),s=n.timeout||7e4,u=function(t){var e,n=new Promise((function(n,r){e=setTimeout((function(){r(new qp("deadline-exceeded","deadline-exceeded"))}),t)}));return{timer:e,promise:n}}(s),c=u.timer,l=u.promise,[4,Promise.race([Qp(c,this.postJSON(r,i,o)),l,Qp(c,this.cancelAllRequests)])];case 2:if(!(h=d.sent()))throw new qp("cancelled","Firebase Functions instance was deleted.");if(f=function(t,e,n){var r=function(t){if(t>=200&&t<300)return"ok";switch(t){case 0:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 500:return"internal";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}(t),i=r,o=void 0;try{var a=e&&e.error;if(a){var s=a.status;if("string"==typeof s){if(!jp[s])return new qp("internal","internal");r=jp[s],i=s}var u=a.message;"string"==typeof u&&(i=u),void 0!==(o=a.details)&&(o=n.decode(o))}}catch(t){}return"ok"===r?null:new qp(r,i,o)}(h.status,h.json,this.serializer))throw f;if(!h.json)throw new qp("internal","Response is not valid JSON object.");if(void 0===(p=h.json.data)&&(p=h.json.result),void 0===p)throw new qp("internal","Response is missing data field.");return[2,{data:this.serializer.decode(p)}]}}))}))},t}();function Qp(t,e){return Fp(this,void 0,void 0,(function(){var n;return Up(this,(function(r){switch(r.label){case 0:return[4,e];case 1:return n=r.sent(),clearTimeout(t),[2,n]}}))}))}Kp=r.default,Wp=fetch.bind(self),Gp={Functions:zp},Kp.INTERNAL.registerComponent(new Dp.Component("functions",(function(t,e){var n=e.instanceIdentifier,r=t.getProvider("app").getImmediate(),i=t.getProvider("auth-internal"),o=t.getProvider("app-check-internal"),a=t.getProvider("messaging");return new zp(r,i,a,o,n,Wp)}),"PUBLIC").setServiceProps(Gp).setMultipleInstances(!0)),r.default.registerVersion("@firebase/functions","0.6.9");var Yp=function(){return(Yp=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function Xp(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))}function Jp(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}function $p(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}Object.create,Object.create;var Zp,td=n(676),ed="w:0.4.26",nd=((Zp={})["missing-app-config-values"]='Missing App configuration value: "{$valueName}"',Zp["not-registered"]="Firebase Installation is not registered.",Zp["installation-not-found"]="Firebase Installation not found.",Zp["request-failed"]='{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',Zp["app-offline"]="Could not process request. Application offline.",Zp["delete-pending-registration"]="Can't delete installation while there is a pending registration request.",Zp),rd=new i.ErrorFactory("installations","Installations",nd);function id(t){return t instanceof i.FirebaseError&&t.code.includes("request-failed")}function od(t){return"https://firebaseinstallations.googleapis.com/v1/projects/"+t.projectId+"/installations"}function ad(t){return{token:t.token,requestStatus:2,expiresIn:(e=t.expiresIn,Number(e.replace("s","000"))),creationTime:Date.now()};var e}function sd(t,e){return Xp(this,void 0,void 0,(function(){var n,r;return Jp(this,(function(i){switch(i.label){case 0:return[4,e.json()];case 1:return n=i.sent(),r=n.error,[2,rd.create("request-failed",{requestName:t,serverCode:r.code,serverMessage:r.message,serverStatus:r.status})]}}))}))}function ud(t){var e=t.apiKey;return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":e})}function cd(t,e){var n=e.refreshToken,r=ud(t);return r.append("Authorization",function(t){return"FIS_v2 "+t}(n)),r}function ld(t){return Xp(this,void 0,void 0,(function(){var e;return Jp(this,(function(n){switch(n.label){case 0:return[4,t()];case 1:return(e=n.sent()).status>=500&&e.status<600?[2,t()]:[2,e]}}))}))}function hd(t,e){var n=e.fid;return Xp(this,void 0,void 0,(function(){var e,r,i,o,a,s;return Jp(this,(function(u){switch(u.label){case 0:return e=od(t),r=ud(t),i={fid:n,authVersion:"FIS_v2",appId:t.appId,sdkVersion:ed},o={method:"POST",headers:r,body:JSON.stringify(i)},[4,ld((function(){return fetch(e,o)}))];case 1:return(a=u.sent()).ok?[4,a.json()]:[3,3];case 2:return[2,{fid:(s=u.sent()).fid||n,registrationStatus:2,refreshToken:s.refreshToken,authToken:ad(s.authToken)}];case 3:return[4,sd("Create Installation",a)];case 4:throw u.sent()}}))}))}function fd(t){return new Promise((function(e){setTimeout(e,t)}))}var pd=/^[cdef][\w-]{21}$/;function dd(){try{var t=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(t),t[0]=112+t[0]%16;var e=function(t){return(e=t,btoa(String.fromCharCode.apply(String,function(t,e){for(var n=0,r=e.length,i=t.length;n<r;n++,i++)t[i]=e[n];return t}([],function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a}(e)))).replace(/\+/g,"-").replace(/\//g,"_")).substr(0,22);var e}(t);return pd.test(e)?e:""}catch(t){return""}}function vd(t){return t.appName+"!"+t.appId}var gd=new Map;function yd(t,e){var n=vd(t);md(n,e),function(t,e){var n=_d();n&&n.postMessage({key:t,fid:e}),wd()}(n,e)}function md(t,e){var n,r,i=gd.get(t);if(i)try{for(var o=$p(i),a=o.next();!a.done;a=o.next())(0,a.value)(e)}catch(t){n={error:t}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}}var bd=null;function _d(){return!bd&&"BroadcastChannel"in self&&((bd=new BroadcastChannel("[Firebase] FID Change")).onmessage=function(t){md(t.data.key,t.data.fid)}),bd}function wd(){0===gd.size&&bd&&(bd.close(),bd=null)}var Id="firebase-installations-store",Td=null;function Ed(){return Td||(Td=(0,td.openDb)("firebase-installations-database",1,(function(t){switch(t.oldVersion){case 0:t.createObjectStore(Id)}}))),Td}function Sd(t,e){return Xp(this,void 0,void 0,(function(){var n,r,i,o,a;return Jp(this,(function(s){switch(s.label){case 0:return n=vd(t),[4,Ed()];case 1:return r=s.sent(),i=r.transaction(Id,"readwrite"),[4,(o=i.objectStore(Id)).get(n)];case 2:return a=s.sent(),[4,o.put(e,n)];case 3:return s.sent(),[4,i.complete];case 4:return s.sent(),a&&a.fid===e.fid||yd(t,e.fid),[2,e]}}))}))}function Cd(t){return Xp(this,void 0,void 0,(function(){var e,n,r;return Jp(this,(function(i){switch(i.label){case 0:return e=vd(t),[4,Ed()];case 1:return n=i.sent(),[4,(r=n.transaction(Id,"readwrite")).objectStore(Id).delete(e)];case 2:return i.sent(),[4,r.complete];case 3:return i.sent(),[2]}}))}))}function kd(t,e){return Xp(this,void 0,void 0,(function(){var n,r,i,o,a,s;return Jp(this,(function(u){switch(u.label){case 0:return n=vd(t),[4,Ed()];case 1:return r=u.sent(),i=r.transaction(Id,"readwrite"),[4,(o=i.objectStore(Id)).get(n)];case 2:return a=u.sent(),void 0!==(s=e(a))?[3,4]:[4,o.delete(n)];case 3:return u.sent(),[3,6];case 4:return[4,o.put(s,n)];case 5:u.sent(),u.label=6;case 6:return[4,i.complete];case 7:return u.sent(),!s||a&&a.fid===s.fid||yd(t,s.fid),[2,s]}}))}))}function Ad(t){return Xp(this,void 0,void 0,(function(){var e,n,r;return Jp(this,(function(i){switch(i.label){case 0:return[4,kd(t,(function(n){var r=function(t){return Od(t||{fid:dd(),registrationStatus:0})}(n),i=function(t,e){if(0===e.registrationStatus){if(!navigator.onLine)return{installationEntry:e,registrationPromise:Promise.reject(rd.create("app-offline"))};var n={fid:e.fid,registrationStatus:1,registrationTime:Date.now()};return{installationEntry:n,registrationPromise:function(t,e){return Xp(this,void 0,void 0,(function(){var n,r;return Jp(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,7]),[4,hd(t,e)];case 1:return n=i.sent(),[2,Sd(t,n)];case 2:return id(r=i.sent())&&409===r.customData.serverCode?[4,Cd(t)]:[3,4];case 3:return i.sent(),[3,6];case 4:return[4,Sd(t,{fid:e.fid,registrationStatus:0})];case 5:i.sent(),i.label=6;case 6:throw r;case 7:return[2]}}))}))}(t,n)}}return 1===e.registrationStatus?{installationEntry:e,registrationPromise:Nd(t)}:{installationEntry:e}}(t,r);return e=i.registrationPromise,i.installationEntry}))];case 1:return""!==(n=i.sent()).fid?[3,3]:(r={},[4,e]);case 2:return[2,(r.installationEntry=i.sent(),r)];case 3:return[2,{installationEntry:n,registrationPromise:e}]}}))}))}function Nd(t){return Xp(this,void 0,void 0,(function(){var e,n,r,i;return Jp(this,(function(o){switch(o.label){case 0:return[4,Pd(t)];case 1:e=o.sent(),o.label=2;case 2:return 1!==e.registrationStatus?[3,5]:[4,fd(100)];case 3:return o.sent(),[4,Pd(t)];case 4:return e=o.sent(),[3,2];case 5:return 0!==e.registrationStatus?[3,7]:[4,Ad(t)];case 6:return n=o.sent(),r=n.installationEntry,(i=n.registrationPromise)?[2,i]:[2,r];case 7:return[2,e]}}))}))}function Pd(t){return kd(t,(function(t){if(!t)throw rd.create("installation-not-found");return Od(t)}))}function Od(t){return 1===(e=t).registrationStatus&&e.registrationTime+1e4<Date.now()?{fid:t.fid,registrationStatus:0}:t;var e}function Rd(t,e){var n=t.appConfig,r=t.platformLoggerProvider;return Xp(this,void 0,void 0,(function(){var t,i,o,a,s,u;return Jp(this,(function(c){switch(c.label){case 0:return t=function(t,e){var n=e.fid;return od(t)+"/"+n+"/authTokens:generate"}(n,e),i=cd(n,e),(o=r.getImmediate({optional:!0}))&&i.append("x-firebase-client",o.getPlatformInfoString()),a={installation:{sdkVersion:ed}},s={method:"POST",headers:i,body:JSON.stringify(a)},[4,ld((function(){return fetch(t,s)}))];case 1:return(u=c.sent()).ok?[4,u.json()]:[3,3];case 2:return[2,ad(c.sent())];case 3:return[4,sd("Generate Auth Token",u)];case 4:throw c.sent()}}))}))}function xd(t,e){return void 0===e&&(e=!1),Xp(this,void 0,void 0,(function(){var n,r,i;return Jp(this,(function(o){switch(o.label){case 0:return[4,kd(t.appConfig,(function(r){if(!Ld(r))throw rd.create("not-registered");var i,o=r.authToken;if(!e&&(2===(i=o).requestStatus&&!function(t){var e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+36e5}(i)))return r;if(1===o.requestStatus)return n=function(t,e){return Xp(this,void 0,void 0,(function(){var n,r;return Jp(this,(function(i){switch(i.label){case 0:return[4,Dd(t.appConfig)];case 1:n=i.sent(),i.label=2;case 2:return 1!==n.authToken.requestStatus?[3,5]:[4,fd(100)];case 3:return i.sent(),[4,Dd(t.appConfig)];case 4:return n=i.sent(),[3,2];case 5:return 0===(r=n.authToken).requestStatus?[2,xd(t,e)]:[2,r]}}))}))}(t,e),r;if(!navigator.onLine)throw rd.create("app-offline");var a=function(t){var e={requestStatus:1,requestTime:Date.now()};return Yp(Yp({},t),{authToken:e})}(r);return n=function(t,e){return Xp(this,void 0,void 0,(function(){var n,r,i;return Jp(this,(function(o){switch(o.label){case 0:return o.trys.push([0,3,,8]),[4,Rd(t,e)];case 1:return n=o.sent(),i=Yp(Yp({},e),{authToken:n}),[4,Sd(t.appConfig,i)];case 2:return o.sent(),[2,n];case 3:return!id(r=o.sent())||401!==r.customData.serverCode&&404!==r.customData.serverCode?[3,5]:[4,Cd(t.appConfig)];case 4:return o.sent(),[3,7];case 5:return i=Yp(Yp({},e),{authToken:{requestStatus:0}}),[4,Sd(t.appConfig,i)];case 6:o.sent(),o.label=7;case 7:throw r;case 8:return[2]}}))}))}(t,a),a}))];case 1:return r=o.sent(),n?[4,n]:[3,3];case 2:return i=o.sent(),[3,4];case 3:i=r.authToken,o.label=4;case 4:return[2,i]}}))}))}function Dd(t){return kd(t,(function(t){if(!Ld(t))throw rd.create("not-registered");var e;return 1===(e=t.authToken).requestStatus&&e.requestTime+1e4<Date.now()?Yp(Yp({},t),{authToken:{requestStatus:0}}):t}))}function Ld(t){return void 0!==t&&2===t.registrationStatus}function Md(t){return Xp(this,void 0,void 0,(function(){var e;return Jp(this,(function(n){switch(n.label){case 0:return[4,Ad(t)];case 1:return(e=n.sent().registrationPromise)?[4,e]:[3,3];case 2:n.sent(),n.label=3;case 3:return[2]}}))}))}function Fd(t,e){return Xp(this,void 0,void 0,(function(){var n,r,i,o;return Jp(this,(function(a){switch(a.label){case 0:return n=function(t,e){var n=e.fid;return od(t)+"/"+n}(t,e),r=cd(t,e),i={method:"DELETE",headers:r},[4,ld((function(){return fetch(n,i)}))];case 1:return(o=a.sent()).ok?[3,3]:[4,sd("Delete Installation",o)];case 2:throw a.sent();case 3:return[2]}}))}))}function Ud(t){return rd.create("missing-app-config-values",{valueName:t})}!function(t){t.INTERNAL.registerComponent(new Dp.Component("installations",(function(t){var e=t.getProvider("app").getImmediate(),n={appConfig:function(t){var e,n;if(!t||!t.options)throw Ud("App Configuration");if(!t.name)throw Ud("App Name");try{for(var r=$p(["projectId","apiKey","appId"]),i=r.next();!i.done;i=r.next()){var o=i.value;if(!t.options[o])throw Ud(o)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}(e),platformLoggerProvider:t.getProvider("platform-logger")};return{app:e,getId:function(){return function(t){return Xp(this,void 0,void 0,(function(){var e,n,r;return Jp(this,(function(i){switch(i.label){case 0:return[4,Ad(t.appConfig)];case 1:return e=i.sent(),n=e.installationEntry,(r=e.registrationPromise)?r.catch(console.error):xd(t).catch(console.error),[2,n.fid]}}))}))}(n)},getToken:function(t){return function(t,e){return void 0===e&&(e=!1),Xp(this,void 0,void 0,(function(){return Jp(this,(function(n){switch(n.label){case 0:return[4,Md(t.appConfig)];case 1:return n.sent(),[4,xd(t,e)];case 2:return[2,n.sent().token]}}))}))}(n,t)},delete:function(){return function(t){return Xp(this,void 0,void 0,(function(){var e,n;return Jp(this,(function(r){switch(r.label){case 0:return[4,kd(e=t.appConfig,(function(t){if(!t||0!==t.registrationStatus)return t}))];case 1:if(!(n=r.sent()))return[3,6];if(1!==n.registrationStatus)return[3,2];throw rd.create("delete-pending-registration");case 2:if(2!==n.registrationStatus)return[3,6];if(navigator.onLine)return[3,3];throw rd.create("app-offline");case 3:return[4,Fd(e,n)];case 4:return r.sent(),[4,Cd(e)];case 5:r.sent(),r.label=6;case 6:return[2]}}))}))}(n)},onIdChange:function(t){return function(t,e){var n=t.appConfig;return function(t,e){_d();var n=vd(t),r=gd.get(n);r||(r=new Set,gd.set(n,r)),r.add(e)}(n,e),function(){!function(t,e){var n=vd(t),r=gd.get(n);r&&(r.delete(e),0===r.size&&gd.delete(n),wd())}(n,e)}}(n,t)}}}),"PUBLIC")),t.registerVersion("@firebase/installations","0.4.26")}(r.default);var jd,qd=function(){return(qd=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function Vd(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))}function Bd(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}function Kd(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}Object.create,Object.create;var Wd,Gd=((jd={})["missing-app-config-values"]='Missing App configuration value: "{$valueName}"',jd["only-available-in-window"]="This method is available in a Window context.",jd["only-available-in-sw"]="This method is available in a service worker context.",jd["permission-default"]="The notification permission was not granted and dismissed instead.",jd["permission-blocked"]="The notification permission was not granted and blocked instead.",jd["unsupported-browser"]="This browser doesn't support the API's required to use the firebase SDK.",jd["failed-service-worker-registration"]="We are unable to register the default service worker. {$browserErrorMessage}",jd["token-subscribe-failed"]="A problem occurred while subscribing the user to FCM: {$errorInfo}",jd["token-subscribe-no-token"]="FCM returned no token when subscribing the user to push.",jd["token-unsubscribe-failed"]="A problem occurred while unsubscribing the user from FCM: {$errorInfo}",jd["token-update-failed"]="A problem occurred while updating the user from FCM: {$errorInfo}",jd["token-update-no-token"]="FCM returned no token when updating the user to push.",jd["use-sw-after-get-token"]="The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.",jd["invalid-sw-registration"]="The input to useServiceWorker() must be a ServiceWorkerRegistration.",jd["invalid-bg-handler"]="The input to setBackgroundMessageHandler() must be a function.",jd["invalid-vapid-key"]="The public VAPID key must be a string.",jd["use-vapid-key-after-get-token"]="The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used.",jd),Hd=new i.ErrorFactory("messaging","Messaging",Gd),zd="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4";function Qd(t){var e=new Uint8Array(t);return btoa(String.fromCharCode.apply(String,function(t,e){for(var n=0,r=e.length,i=t.length;n<r;n++,i++)t[i]=e[n];return t}([],function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a}(e)))).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function Yd(t){for(var e=(t+"=".repeat((4-t.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),n=atob(e),r=new Uint8Array(n.length),i=0;i<n.length;++i)r[i]=n.charCodeAt(i);return r}!function(t){t.PUSH_RECEIVED="push-received",t.NOTIFICATION_CLICKED="notification-clicked"}(Wd||(Wd={}));var Xd="fcm_token_details_db",Jd="fcm_token_object_Store";function $d(t){return Vd(this,void 0,void 0,(function(){var e,n=this;return Bd(this,(function(r){switch(r.label){case 0:return"databases"in indexedDB?[4,indexedDB.databases()]:[3,2];case 1:if(!r.sent().map((function(t){return t.name})).includes(Xd))return[2,null];r.label=2;case 2:return e=null,[4,(0,td.openDb)(Xd,5,(function(r){return Vd(n,void 0,void 0,(function(){var n,i,o,a;return Bd(this,(function(s){switch(s.label){case 0:return r.oldVersion<2?[2]:r.objectStoreNames.contains(Jd)?[4,(n=r.transaction.objectStore(Jd)).index("fcmSenderId").get(t)]:[2];case 1:return i=s.sent(),[4,n.clear()];case 2:if(s.sent(),!i)return[2];if(2===r.oldVersion){if(!(o=i).auth||!o.p256dh||!o.endpoint)return[2];e={token:o.fcmToken,createTime:null!==(a=o.createTime)&&void 0!==a?a:Date.now(),subscriptionOptions:{auth:o.auth,p256dh:o.p256dh,endpoint:o.endpoint,swScope:o.swScope,vapidKey:"string"==typeof o.vapidKey?o.vapidKey:Qd(o.vapidKey)}}}else(3===r.oldVersion||4===r.oldVersion)&&(e={token:(o=i).fcmToken,createTime:o.createTime,subscriptionOptions:{auth:Qd(o.auth),p256dh:Qd(o.p256dh),endpoint:o.endpoint,swScope:o.swScope,vapidKey:Qd(o.vapidKey)}});return[2]}}))}))}))];case 3:return r.sent().close(),[4,(0,td.deleteDb)(Xd)];case 4:return r.sent(),[4,(0,td.deleteDb)("fcm_vapid_details_db")];case 5:return r.sent(),[4,(0,td.deleteDb)("undefined")];case 6:return r.sent(),[2,Zd(e)?e:null]}}))}))}function Zd(t){if(!t||!t.subscriptionOptions)return!1;var e=t.subscriptionOptions;return"number"==typeof t.createTime&&t.createTime>0&&"string"==typeof t.token&&t.token.length>0&&"string"==typeof e.auth&&e.auth.length>0&&"string"==typeof e.p256dh&&e.p256dh.length>0&&"string"==typeof e.endpoint&&e.endpoint.length>0&&"string"==typeof e.swScope&&e.swScope.length>0&&"string"==typeof e.vapidKey&&e.vapidKey.length>0}var tv="firebase-messaging-store",ev=null;function nv(){return ev||(ev=(0,td.openDb)("firebase-messaging-database",1,(function(t){switch(t.oldVersion){case 0:t.createObjectStore(tv)}}))),ev}function rv(t){return Vd(this,void 0,void 0,(function(){var e,n,r;return Bd(this,(function(i){switch(i.label){case 0:return e=av(t),[4,nv()];case 1:return[4,i.sent().transaction(tv).objectStore(tv).get(e)];case 2:return(n=i.sent())?[2,n]:[3,3];case 3:return[4,$d(t.appConfig.senderId)];case 4:return(r=i.sent())?[4,iv(t,r)]:[3,6];case 5:return i.sent(),[2,r];case 6:return[2]}}))}))}function iv(t,e){return Vd(this,void 0,void 0,(function(){var n,r,i;return Bd(this,(function(o){switch(o.label){case 0:return n=av(t),[4,nv()];case 1:return r=o.sent(),[4,(i=r.transaction(tv,"readwrite")).objectStore(tv).put(e,n)];case 2:return o.sent(),[4,i.complete];case 3:return o.sent(),[2,e]}}))}))}function ov(t){return Vd(this,void 0,void 0,(function(){var e,n,r;return Bd(this,(function(i){switch(i.label){case 0:return e=av(t),[4,nv()];case 1:return n=i.sent(),[4,(r=n.transaction(tv,"readwrite")).objectStore(tv).delete(e)];case 2:return i.sent(),[4,r.complete];case 3:return i.sent(),[2]}}))}))}function av(t){return t.appConfig.appId}function sv(t,e){return Vd(this,void 0,void 0,(function(){var n,r,i,o,a,s;return Bd(this,(function(u){switch(u.label){case 0:return[4,hv(t)];case 1:n=u.sent(),r=fv(e),i={method:"POST",headers:n,body:JSON.stringify(r)},u.label=2;case 2:return u.trys.push([2,5,,6]),[4,fetch(lv(t.appConfig),i)];case 3:return[4,u.sent().json()];case 4:return o=u.sent(),[3,6];case 5:throw a=u.sent(),Hd.create("token-subscribe-failed",{errorInfo:a});case 6:if(o.error)throw s=o.error.message,Hd.create("token-subscribe-failed",{errorInfo:s});if(!o.token)throw Hd.create("token-subscribe-no-token");return[2,o.token]}}))}))}function uv(t,e){return Vd(this,void 0,void 0,(function(){var n,r,i,o,a,s;return Bd(this,(function(u){switch(u.label){case 0:return[4,hv(t)];case 1:n=u.sent(),r=fv(e.subscriptionOptions),i={method:"PATCH",headers:n,body:JSON.stringify(r)},u.label=2;case 2:return u.trys.push([2,5,,6]),[4,fetch(lv(t.appConfig)+"/"+e.token,i)];case 3:return[4,u.sent().json()];case 4:return o=u.sent(),[3,6];case 5:throw a=u.sent(),Hd.create("token-update-failed",{errorInfo:a});case 6:if(o.error)throw s=o.error.message,Hd.create("token-update-failed",{errorInfo:s});if(!o.token)throw Hd.create("token-update-no-token");return[2,o.token]}}))}))}function cv(t,e){return Vd(this,void 0,void 0,(function(){var n,r,i,o,a;return Bd(this,(function(s){switch(s.label){case 0:return[4,hv(t)];case 1:n=s.sent(),r={method:"DELETE",headers:n},s.label=2;case 2:return s.trys.push([2,5,,6]),[4,fetch(lv(t.appConfig)+"/"+e,r)];case 3:return[4,s.sent().json()];case 4:if((i=s.sent()).error)throw o=i.error.message,Hd.create("token-unsubscribe-failed",{errorInfo:o});return[3,6];case 5:throw a=s.sent(),Hd.create("token-unsubscribe-failed",{errorInfo:a});case 6:return[2]}}))}))}function lv(t){return"https://fcmregistrations.googleapis.com/v1/projects/"+t.projectId+"/registrations"}function hv(t){var e=t.appConfig,n=t.installations;return Vd(this,void 0,void 0,(function(){var t;return Bd(this,(function(r){switch(r.label){case 0:return[4,n.getToken()];case 1:return t=r.sent(),[2,new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":e.apiKey,"x-goog-firebase-installations-auth":"FIS "+t})]}}))}))}function fv(t){var e=t.p256dh,n=t.auth,r=t.endpoint,i=t.vapidKey,o={web:{endpoint:r,auth:n,p256dh:e}};return i!==zd&&(o.web.applicationPubKey=i),o}function pv(t,e,n){return Vd(this,void 0,void 0,(function(){var r,i,o,a;return Bd(this,(function(s){switch(s.label){case 0:if("granted"!==Notification.permission)throw Hd.create("permission-blocked");return[4,yv(e,n)];case 1:return r=s.sent(),[4,rv(t)];case 2:return i=s.sent(),o={vapidKey:n,swScope:e.scope,endpoint:r.endpoint,auth:Qd(r.getKey("auth")),p256dh:Qd(r.getKey("p256dh"))},i?[3,3]:[2,gv(t,o)];case 3:if(u=i.subscriptionOptions,l=(c=o).vapidKey===u.vapidKey,h=c.endpoint===u.endpoint,f=c.auth===u.auth,p=c.p256dh===u.p256dh,l&&h&&f&&p)return[3,8];s.label=4;case 4:return s.trys.push([4,6,,7]),[4,cv(t,i.token)];case 5:return s.sent(),[3,7];case 6:return a=s.sent(),console.warn(a),[3,7];case 7:return[2,gv(t,o)];case 8:return Date.now()>=i.createTime+6048e5?[2,vv({token:i.token,createTime:Date.now(),subscriptionOptions:o},t,e)]:[2,i.token];case 9:return[2]}var u,c,l,h,f,p}))}))}function dv(t,e){return Vd(this,void 0,void 0,(function(){var n,r;return Bd(this,(function(i){switch(i.label){case 0:return[4,rv(t)];case 1:return(n=i.sent())?[4,cv(t,n.token)]:[3,4];case 2:return i.sent(),[4,ov(t)];case 3:i.sent(),i.label=4;case 4:return[4,e.pushManager.getSubscription()];case 5:return(r=i.sent())?[2,r.unsubscribe()]:[2,!0]}}))}))}function vv(t,e,n){return Vd(this,void 0,void 0,(function(){var r,i,o;return Bd(this,(function(a){switch(a.label){case 0:return a.trys.push([0,3,,5]),[4,uv(e,t)];case 1:return r=a.sent(),i=qd(qd({},t),{token:r,createTime:Date.now()}),[4,iv(e,i)];case 2:return a.sent(),[2,r];case 3:return o=a.sent(),[4,dv(e,n)];case 4:throw a.sent(),o;case 5:return[2]}}))}))}function gv(t,e){return Vd(this,void 0,void 0,(function(){var n,r;return Bd(this,(function(i){switch(i.label){case 0:return[4,sv(t,e)];case 1:return n=i.sent(),r={token:n,createTime:Date.now(),subscriptionOptions:e},[4,iv(t,r)];case 2:return i.sent(),[2,r.token]}}))}))}function yv(t,e){return Vd(this,void 0,void 0,(function(){var n;return Bd(this,(function(r){switch(r.label){case 0:return[4,t.pushManager.getSubscription()];case 1:return(n=r.sent())?[2,n]:[2,t.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:Yd(e)})]}}))}))}function mv(t){return"object"==typeof t&&!!t&&"google.c.a.c_id"in t}function bv(t){return new Promise((function(e){setTimeout(e,t)}))}var _v=function(){function t(t){var e=this;this.firebaseDependencies=t,this.isOnBackgroundMessageUsed=null,this.vapidKey=null,this.bgMessageHandler=null,self.addEventListener("push",(function(t){t.waitUntil(e.onPush(t))})),self.addEventListener("pushsubscriptionchange",(function(t){t.waitUntil(e.onSubChange(t))})),self.addEventListener("notificationclick",(function(t){t.waitUntil(e.onNotificationClick(t))}))}return Object.defineProperty(t.prototype,"app",{get:function(){return this.firebaseDependencies.app},enumerable:!1,configurable:!0}),t.prototype.setBackgroundMessageHandler=function(t){if(this.isOnBackgroundMessageUsed=!1,!t||"function"!=typeof t)throw Hd.create("invalid-bg-handler");this.bgMessageHandler=t},t.prototype.onBackgroundMessage=function(t){var e=this;return this.isOnBackgroundMessageUsed=!0,this.bgMessageHandler=t,function(){e.bgMessageHandler=null}},t.prototype.getToken=function(){var t,e;return Vd(this,void 0,void 0,(function(){var n;return Bd(this,(function(r){switch(r.label){case 0:return this.vapidKey?[3,2]:[4,rv(this.firebaseDependencies)];case 1:n=r.sent(),this.vapidKey=null!==(e=null===(t=null==n?void 0:n.subscriptionOptions)||void 0===t?void 0:t.vapidKey)&&void 0!==e?e:zd,r.label=2;case 2:return[2,pv(this.firebaseDependencies,self.registration,this.vapidKey)]}}))}))},t.prototype.deleteToken=function(){return dv(this.firebaseDependencies,self.registration)},t.prototype.requestPermission=function(){throw Hd.create("only-available-in-window")},t.prototype.usePublicVapidKey=function(t){if(null!==this.vapidKey)throw Hd.create("use-vapid-key-after-get-token");if("string"!=typeof t||0===t.length)throw Hd.create("invalid-vapid-key");this.vapidKey=t},t.prototype.useServiceWorker=function(){throw Hd.create("only-available-in-window")},t.prototype.onMessage=function(){throw Hd.create("only-available-in-window")},t.prototype.onTokenRefresh=function(){throw Hd.create("only-available-in-window")},t.prototype.onPush=function(t){return Vd(this,void 0,void 0,(function(){var e,n,r,i;return Bd(this,(function(o){switch(o.label){case 0:return(e=function(t){var e=t.data;if(!e)return null;try{return e.json()}catch(t){return null}}(t))?[4,Ev()]:(console.debug("FirebaseMessaging: failed to get parsed MessagePayload from the PushEvent. Skip handling the push."),[2]);case 1:return function(t){return t.some((function(t){return"visible"===t.visibilityState&&!t.url.startsWith("chrome-extension://")}))}(n=o.sent())?[2,Tv(n,e)]:(r=!1,e.notification?[4,Sv(wv(e))]:[3,3]);case 2:o.sent(),r=!0,o.label=3;case 3:return!0===r&&!1===this.isOnBackgroundMessageUsed?[2]:(this.bgMessageHandler&&(i=function(t){var e={from:t.from,collapseKey:t.collapse_key};return function(t,e){if(e.notification){t.notification={};var n=e.notification.title;n&&(t.notification.title=n);var r=e.notification.body;r&&(t.notification.body=r);var i=e.notification.image;i&&(t.notification.image=i)}}(e,t),function(t,e){e.data&&(t.data=e.data)}(e,t),function(t,e){if(e.fcmOptions){t.fcmOptions={};var n=e.fcmOptions.link;n&&(t.fcmOptions.link=n);var r=e.fcmOptions.analytics_label;r&&(t.fcmOptions.analyticsLabel=r)}}(e,t),e}(e),"function"==typeof this.bgMessageHandler?this.bgMessageHandler(i):this.bgMessageHandler.next(i)),[4,bv(1e3)]);case 4:return o.sent(),[2]}}))}))},t.prototype.onSubChange=function(t){var e,n;return Vd(this,void 0,void 0,(function(){var r;return Bd(this,(function(i){switch(i.label){case 0:return t.newSubscription?[3,2]:[4,dv(this.firebaseDependencies,self.registration)];case 1:return i.sent(),[2];case 2:return[4,rv(this.firebaseDependencies)];case 3:return r=i.sent(),[4,dv(this.firebaseDependencies,self.registration)];case 4:return i.sent(),[4,pv(this.firebaseDependencies,self.registration,null!==(n=null===(e=null==r?void 0:r.subscriptionOptions)||void 0===e?void 0:e.vapidKey)&&void 0!==n?n:zd)];case 5:return i.sent(),[2]}}))}))},t.prototype.onNotificationClick=function(t){var e,n;return Vd(this,void 0,void 0,(function(){var r,i,o,a,s;return Bd(this,(function(u){switch(u.label){case 0:return(r=null===(n=null===(e=t.notification)||void 0===e?void 0:e.data)||void 0===n?void 0:n.FCM_MSG)?t.action?[2]:(t.stopImmediatePropagation(),t.notification.close(),(i=function(t){var e,n,r,i=null!==(n=null===(e=t.fcmOptions)||void 0===e?void 0:e.link)&&void 0!==n?n:null===(r=t.notification)||void 0===r?void 0:r.click_action;return i||(mv(t.data)?self.location.origin:null)}(r))?(o=new URL(i,self.location.href),a=new URL(self.location.origin),o.host!==a.host?[2]:[4,Iv(o)]):[2]):[2];case 1:return(s=u.sent())?[3,4]:[4,self.clients.openWindow(i)];case 2:return s=u.sent(),[4,bv(3e3)];case 3:return u.sent(),[3,6];case 4:return[4,s.focus()];case 5:s=u.sent(),u.label=6;case 6:return s?(r.messageType=Wd.NOTIFICATION_CLICKED,r.isFirebaseMessaging=!0,[2,s.postMessage(r)]):[2]}}))}))},t}();function wv(t){var e,n=qd({},t.notification);return n.data=((e={}).FCM_MSG=t,e),n}function Iv(t){return Vd(this,void 0,void 0,(function(){var e,n,r,i,o,a,s;return Bd(this,(function(u){switch(u.label){case 0:return[4,Ev()];case 1:e=u.sent();try{for(n=Kd(e),r=n.next();!r.done;r=n.next())if(i=r.value,o=new URL(i.url,self.location.href),t.host===o.host)return[2,i]}catch(t){a={error:t}}finally{try{r&&!r.done&&(s=n.return)&&s.call(n)}finally{if(a)throw a.error}}return[2,null]}}))}))}function Tv(t,e){var n,r;e.isFirebaseMessaging=!0,e.messageType=Wd.PUSH_RECEIVED;try{for(var i=Kd(t),o=i.next();!o.done;o=i.next())o.value.postMessage(e)}catch(t){n={error:t}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}}function Ev(){return self.clients.matchAll({type:"window",includeUncontrolled:!0})}function Sv(t){var e,n=t.actions,r=Notification.maxActions;return n&&r&&n.length>r&&console.warn("This browser only supports "+r+" actions. The remaining actions will not be displayed."),self.registration.showNotification(null!==(e=t.title)&&void 0!==e?e:"",t)}var Cv=function(){function t(t){var e=this;this.firebaseDependencies=t,this.vapidKey=null,this.onMessageCallback=null,navigator.serviceWorker.addEventListener("message",(function(t){return e.messageEventListener(t)}))}return Object.defineProperty(t.prototype,"app",{get:function(){return this.firebaseDependencies.app},enumerable:!1,configurable:!0}),t.prototype.messageEventListener=function(t){return Vd(this,void 0,void 0,(function(){var e,n;return Bd(this,(function(r){switch(r.label){case 0:return(e=t.data).isFirebaseMessaging?(this.onMessageCallback&&e.messageType===Wd.PUSH_RECEIVED&&("function"==typeof this.onMessageCallback?this.onMessageCallback(function(t){return delete t.messageType,delete t.isFirebaseMessaging,t}(Object.assign({},e))):this.onMessageCallback.next(Object.assign({},e))),mv(n=e.data)&&"1"===n["google.c.a.e"]?[4,this.logEvent(e.messageType,n)]:[3,2]):[2];case 1:r.sent(),r.label=2;case 2:return[2]}}))}))},t.prototype.getVapidKey=function(){return this.vapidKey},t.prototype.getSwReg=function(){return this.swRegistration},t.prototype.getToken=function(t){return Vd(this,void 0,void 0,(function(){return Bd(this,(function(e){switch(e.label){case 0:return"default"!==Notification.permission?[3,2]:[4,Notification.requestPermission()];case 1:e.sent(),e.label=2;case 2:if("granted"!==Notification.permission)throw Hd.create("permission-blocked");return[4,this.updateVapidKey(null==t?void 0:t.vapidKey)];case 3:return e.sent(),[4,this.updateSwReg(null==t?void 0:t.serviceWorkerRegistration)];case 4:return e.sent(),[2,pv(this.firebaseDependencies,this.swRegistration,this.vapidKey)]}}))}))},t.prototype.updateVapidKey=function(t){return Vd(this,void 0,void 0,(function(){return Bd(this,(function(e){return t?this.vapidKey=t:this.vapidKey||(this.vapidKey=zd),[2]}))}))},t.prototype.updateSwReg=function(t){return Vd(this,void 0,void 0,(function(){return Bd(this,(function(e){switch(e.label){case 0:return t||this.swRegistration?[3,2]:[4,this.registerDefaultSw()];case 1:e.sent(),e.label=2;case 2:if(!t&&this.swRegistration)return[2];if(!(t instanceof ServiceWorkerRegistration))throw Hd.create("invalid-sw-registration");return this.swRegistration=t,[2]}}))}))},t.prototype.registerDefaultSw=function(){return Vd(this,void 0,void 0,(function(){var t,e;return Bd(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),t=this,[4,navigator.serviceWorker.register("/firebase-messaging-sw.js",{scope:"/firebase-cloud-messaging-push-scope"})];case 1:return t.swRegistration=n.sent(),this.swRegistration.update().catch((function(){})),[3,3];case 2:throw e=n.sent(),Hd.create("failed-service-worker-registration",{browserErrorMessage:e.message});case 3:return[2]}}))}))},t.prototype.deleteToken=function(){return Vd(this,void 0,void 0,(function(){return Bd(this,(function(t){switch(t.label){case 0:return this.swRegistration?[3,2]:[4,this.registerDefaultSw()];case 1:t.sent(),t.label=2;case 2:return[2,dv(this.firebaseDependencies,this.swRegistration)]}}))}))},t.prototype.requestPermission=function(){return Vd(this,void 0,void 0,(function(){var t;return Bd(this,(function(e){switch(e.label){case 0:return"granted"===Notification.permission?[2]:[4,Notification.requestPermission()];case 1:if("granted"===(t=e.sent()))return[2];throw"denied"===t?Hd.create("permission-blocked"):Hd.create("permission-default")}}))}))},t.prototype.usePublicVapidKey=function(t){if(null!==this.vapidKey)throw Hd.create("use-vapid-key-after-get-token");if("string"!=typeof t||0===t.length)throw Hd.create("invalid-vapid-key");this.vapidKey=t},t.prototype.useServiceWorker=function(t){if(!(t instanceof ServiceWorkerRegistration))throw Hd.create("invalid-sw-registration");if(this.swRegistration)throw Hd.create("use-sw-after-get-token");this.swRegistration=t},t.prototype.onMessage=function(t){var e=this;return this.onMessageCallback=t,function(){e.onMessageCallback=null}},t.prototype.setBackgroundMessageHandler=function(){throw Hd.create("only-available-in-sw")},t.prototype.onBackgroundMessage=function(){throw Hd.create("only-available-in-sw")},t.prototype.onTokenRefresh=function(){return function(){}},t.prototype.logEvent=function(t,e){return Vd(this,void 0,void 0,(function(){var n;return Bd(this,(function(r){switch(r.label){case 0:return n=function(t){switch(t){case Wd.NOTIFICATION_CLICKED:return"notification_open";case Wd.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}(t),[4,this.firebaseDependencies.analyticsProvider.get()];case 1:return r.sent().logEvent(n,{message_id:e["google.c.a.c_id"],message_name:e["google.c.a.c_l"],message_time:e["google.c.a.ts"],message_device_time:Math.floor(Date.now()/1e3)}),[2]}}))}))},t}();function kv(t){return Hd.create("missing-app-config-values",{valueName:t})}var Av={isSupported:Nv};function Nv(){return self&&"ServiceWorkerGlobalScope"in self?"indexedDB"in self&&null!==indexedDB&&"PushManager"in self&&"Notification"in self&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey"):"indexedDB"in window&&null!==indexedDB&&navigator.cookieEnabled&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")}r.default.INTERNAL.registerComponent(new Dp.Component("messaging",(function(t){var e=t.getProvider("app").getImmediate(),n={app:e,appConfig:function(t){var e,n;if(!t||!t.options)throw kv("App Configuration Object");if(!t.name)throw kv("App Name");var r=t.options;try{for(var i=Kd(["projectId","apiKey","appId","messagingSenderId"]),o=i.next();!o.done;o=i.next()){var a=o.value;if(!r[a])throw kv(a)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return{appName:t.name,projectId:r.projectId,apiKey:r.apiKey,appId:r.appId,senderId:r.messagingSenderId}}(e),installations:t.getProvider("installations").getImmediate(),analyticsProvider:t.getProvider("analytics-internal")};if(!Nv())throw Hd.create("unsupported-browser");return self&&"ServiceWorkerGlobalScope"in self?new _v(n):new Cv(n)}),"PUBLIC").setServiceProps(Av));var Pv=function(t,e){return(Pv=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},Ov=function(){return(Ov=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function Rv(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))}function xv(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}function Dv(t,e){for(var n=0,r=e.length,i=t.length;n<r;n++,i++)t[i]=e[n];return t}Object.create,Object.create;var Lv="firebasestorage.googleapis.com",Mv=function(t){function e(n,r){var i=t.call(this,Fv(n),"Firebase Storage: "+r+" ("+Fv(n)+")")||this;return i.customData={serverResponse:null},i._baseMessage=i.message,Object.setPrototypeOf(i,e.prototype),i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}Pv(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e.prototype._codeEquals=function(t){return Fv(t)===this.code},Object.defineProperty(e.prototype,"serverResponse",{get:function(){return this.customData.serverResponse},set:function(t){this.customData.serverResponse=t,this.customData.serverResponse?this.message=this._baseMessage+"\n"+this.customData.serverResponse:this.message=this._baseMessage},enumerable:!1,configurable:!0}),e}(i.FirebaseError);function Fv(t){return"storage/"+t}function Uv(){return new Mv("unknown","An unknown error occurred, please check the error payload for server response.")}function jv(){return new Mv("canceled","User canceled the upload/download.")}function qv(){return new Mv("cannot-slice-blob","Cannot slice blob for upload. Please retry the upload.")}function Vv(t){return new Mv("invalid-argument",t)}function Bv(){return new Mv("app-deleted","The Firebase app was deleted.")}function Kv(t){return new Mv("invalid-root-operation","The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function Wv(t,e){return new Mv("invalid-format","String does not match format '"+t+"': "+e)}function Gv(t){throw new Mv("internal-error","Internal error: "+t)}var Hv={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"},zv=function(t,e){this.data=t,this.contentType=e||null};function Qv(t,e){switch(t){case Hv.RAW:return new zv(Yv(e));case Hv.BASE64:case Hv.BASE64URL:return new zv(Xv(t,e));case Hv.DATA_URL:return new zv((n=new $v(e)).base64?Xv(Hv.BASE64,n.rest):function(t){var e;try{e=decodeURIComponent(t)}catch(t){throw Wv(Hv.DATA_URL,"Malformed data URL.")}return Yv(e)}(n.rest),new $v(e).contentType)}var n;throw Uv()}function Yv(t){for(var e=[],n=0;n<t.length;n++){var r=t.charCodeAt(n);r<=127?e.push(r):r<=2047?e.push(192|r>>6,128|63&r):55296==(64512&r)?n<t.length-1&&56320==(64512&t.charCodeAt(n+1))?(r=65536|(1023&r)<<10|1023&t.charCodeAt(++n),e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|63&r)):e.push(239,191,189):56320==(64512&r)?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|63&r)}return new Uint8Array(e)}function Xv(t,e){switch(t){case Hv.BASE64:var n=-1!==e.indexOf("-"),r=-1!==e.indexOf("_");if(n||r)throw Wv(t,"Invalid character '"+(n?"-":"_")+"' found: is it base64url encoded?");break;case Hv.BASE64URL:var i=-1!==e.indexOf("+"),o=-1!==e.indexOf("/");if(i||o)throw Wv(t,"Invalid character '"+(i?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/")}var a;try{a=atob(e)}catch(e){throw Wv(t,"Invalid character found")}for(var s=new Uint8Array(a.length),u=0;u<a.length;u++)s[u]=a.charCodeAt(u);return s}var Jv,$v=function(t){this.base64=!1,this.contentType=null;var e=t.match(/^data:([^,]+)?,/);if(null===e)throw Wv(Hv.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");var n,r,i=e[1]||null;null!=i&&(this.base64=(r=";base64",(n=i).length>=r.length&&n.substring(n.length-r.length)===r),this.contentType=this.base64?i.substring(0,i.length-";base64".length):i),this.rest=t.substring(t.indexOf(",")+1)},Zv={STATE_CHANGED:"state_changed"},tg={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function eg(t){switch(t){case"running":case"pausing":case"canceling":return tg.RUNNING;case"paused":return tg.PAUSED;case"success":return tg.SUCCESS;case"canceled":return tg.CANCELED;case"error":default:return tg.ERROR}}!function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"}(Jv||(Jv={}));var ng=function(){function t(){var t=this;this.sent_=!1,this.xhr_=new XMLHttpRequest,this.errorCode_=Jv.NO_ERROR,this.sendPromise_=new Promise((function(e){t.xhr_.addEventListener("abort",(function(){t.errorCode_=Jv.ABORT,e(t)})),t.xhr_.addEventListener("error",(function(){t.errorCode_=Jv.NETWORK_ERROR,e(t)})),t.xhr_.addEventListener("load",(function(){e(t)}))}))}return t.prototype.send=function(t,e,n,r){if(this.sent_)throw Gv("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(e,t,!0),void 0!==r)for(var i in r)r.hasOwnProperty(i)&&this.xhr_.setRequestHeader(i,r[i].toString());return void 0!==n?this.xhr_.send(n):this.xhr_.send(),this.sendPromise_},t.prototype.getErrorCode=function(){if(!this.sent_)throw Gv("cannot .getErrorCode() before sending");return this.errorCode_},t.prototype.getStatus=function(){if(!this.sent_)throw Gv("cannot .getStatus() before sending");try{return this.xhr_.status}catch(t){return-1}},t.prototype.getResponseText=function(){if(!this.sent_)throw Gv("cannot .getResponseText() before sending");return this.xhr_.responseText},t.prototype.abort=function(){this.xhr_.abort()},t.prototype.getResponseHeader=function(t){return this.xhr_.getResponseHeader(t)},t.prototype.addUploadProgressListener=function(t){null!=this.xhr_.upload&&this.xhr_.upload.addEventListener("progress",t)},t.prototype.removeUploadProgressListener=function(t){null!=this.xhr_.upload&&this.xhr_.upload.removeEventListener("progress",t)},t}(),rg=function(){function t(){}return t.prototype.createXhrIo=function(){return new ng},t}(),ig=function(){function t(t,e){this.bucket=t,this.path_=e}return Object.defineProperty(t.prototype,"path",{get:function(){return this.path_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isRoot",{get:function(){return 0===this.path.length},enumerable:!1,configurable:!0}),t.prototype.fullServerUrl=function(){var t=encodeURIComponent;return"/b/"+t(this.bucket)+"/o/"+t(this.path)},t.prototype.bucketOnlyServerUrl=function(){return"/b/"+encodeURIComponent(this.bucket)+"/o"},t.makeFromBucketSpec=function(e,n){var r;try{r=t.makeFromUrl(e,n)}catch(n){return new t(e,"")}if(""===r.path)return r;throw new Mv("invalid-default-bucket","Invalid default bucket '"+e+"'.")},t.makeFromUrl=function(e,n){var r=null,i="([A-Za-z0-9.\\-_]+)",o=new RegExp("^gs://"+i+"(/(.*))?$","i");function a(t){t.path_=decodeURIComponent(t.path)}for(var s=n.replace(/[.]/g,"\\."),u=[{regex:o,indices:{bucket:1,path:3},postModify:function(t){"/"===t.path.charAt(t.path.length-1)&&(t.path_=t.path_.slice(0,-1))}},{regex:new RegExp("^https?://"+s+"/v[A-Za-z0-9_]+/b/"+i+"/o(/([^?#]*).*)?$","i"),indices:{bucket:1,path:3},postModify:a},{regex:new RegExp("^https?://"+(n===Lv?"(?:storage.googleapis.com|storage.cloud.google.com)":n)+"/"+i+"/([^?#]*)","i"),indices:{bucket:1,path:2},postModify:a}],c=0;c<u.length;c++){var l=u[c],h=l.regex.exec(e);if(h){var f=h[l.indices.bucket],p=h[l.indices.path];p||(p=""),r=new t(f,p),l.postModify(r);break}}if(null==r)throw function(t){return new Mv("invalid-url","Invalid URL '"+t+"'.")}(e);return r},t}(),og=function(){function t(t){this.promise_=Promise.reject(t)}return t.prototype.getPromise=function(){return this.promise_},t.prototype.cancel=function(t){},t}();function ag(t){return"string"==typeof t||t instanceof String}function sg(t){return ug()&&t instanceof Blob}function ug(){return"undefined"!=typeof Blob}function cg(t,e,n,r){if(r<e)throw Vv("Invalid value for '"+t+"'. Expected "+e+" or greater.");if(r>n)throw Vv("Invalid value for '"+t+"'. Expected "+n+" or less.")}function lg(t,e){var n=e.match(/^(\w+):\/\/.+/),r=e;return null==(null==n?void 0:n[1])&&(r="https://"+e),r+"/v0"+t}function hg(t){var e=encodeURIComponent,n="?";for(var r in t)t.hasOwnProperty(r)&&(n=n+(e(r)+"=")+e(t[r])+"&");return n.slice(0,-1)}var fg=function(){function t(t,e,n,r,i,o,a,s,u,c,l){var h=this;this.pendingXhr_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.url_=t,this.method_=e,this.headers_=n,this.body_=r,this.successCodes_=i.slice(),this.additionalRetryCodes_=o.slice(),this.callback_=a,this.errorCallback_=s,this.progressCallback_=c,this.timeout_=u,this.pool_=l,this.promise_=new Promise((function(t,e){h.resolve_=t,h.reject_=e,h.start_()}))}return t.prototype.start_=function(){var t=this;function e(e,n){var r,i=t.resolve_,o=t.reject_,a=n.xhr;if(n.wasSuccessCode)try{var s=t.callback_(a,a.getResponseText());!function(t){return void 0!==t}(s)?i():i(s)}catch(t){o(t)}else null!==a?((r=Uv()).serverResponse=a.getResponseText(),t.errorCallback_?o(t.errorCallback_(a,r)):o(r)):n.canceled?o(r=t.appDelete_?Bv():jv()):o(r=new Mv("retry-limit-exceeded","Max retry time for operation exceeded, please try again."))}this.canceled_?e(0,new pg(!1,null,!0)):this.backoffId_=function(e,n,r){var i=1,o=null,a=!1,s=0;function u(){return 2===s}var c=!1;function l(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];c||(c=!0,n.apply(null,t))}function h(e){o=setTimeout((function(){o=null,function(e,n){if(n)e(!1,new pg(!1,null,!0));else{var r=t.pool_.createXhrIo();t.pendingXhr_=r,null!==t.progressCallback_&&r.addUploadProgressListener(i),r.send(t.url_,t.method_,t.body_,t.headers_).then((function(n){null!==t.progressCallback_&&n.removeUploadProgressListener(i),t.pendingXhr_=null;var r=(n=n).getErrorCode()===Jv.NO_ERROR,o=n.getStatus();if(r&&!t.isRetryStatusCode_(o)){var a=-1!==t.successCodes_.indexOf(o);e(!0,new pg(a,n))}else{var s=n.getErrorCode()===Jv.ABORT;e(!1,new pg(!1,null,s))}}))}function i(e){var n=e.loaded,r=e.lengthComputable?e.total:-1;null!==t.progressCallback_&&t.progressCallback_(n,r)}}(f,u())}),e)}function f(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(!c)if(t)l.call.apply(l,Dv([null,t],e));else{var r;u()||a?l.call.apply(l,Dv([null,t],e)):(i<64&&(i*=2),1===s?(s=2,r=0):r=1e3*(i+Math.random()),h(r))}}var p=!1;function d(t){p||(p=!0,c||(null!==o?(t||(s=2),clearTimeout(o),h(0)):t||(s=1)))}return h(0),setTimeout((function(){a=!0,d(!0)}),r),d}(0,e,this.timeout_)},t.prototype.getPromise=function(){return this.promise_},t.prototype.cancel=function(t){this.canceled_=!0,this.appDelete_=t||!1,null!==this.backoffId_&&function(t){t(!1)}(this.backoffId_),null!==this.pendingXhr_&&this.pendingXhr_.abort()},t.prototype.isRetryStatusCode_=function(t){var e=t>=500&&t<600,n=-1!==[408,429].indexOf(t),r=-1!==this.additionalRetryCodes_.indexOf(t);return e||n||r},t}(),pg=function(t,e,n){this.wasSuccessCode=t,this.xhr=e,this.canceled=!!n};function dg(){return"undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof WebKitBlobBuilder?WebKitBlobBuilder:void 0}function vg(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=dg();if(void 0!==n){for(var r=new n,i=0;i<t.length;i++)r.append(t[i]);return r.getBlob()}if(ug())return new Blob(t);throw new Mv("unsupported-environment","This browser doesn't seem to support creating Blobs")}var gg=function(){function t(t,e){var n=0,r="";sg(t)?(this.data_=t,n=t.size,r=t.type):t instanceof ArrayBuffer?(e?this.data_=new Uint8Array(t):(this.data_=new Uint8Array(t.byteLength),this.data_.set(new Uint8Array(t))),n=this.data_.length):t instanceof Uint8Array&&(e?this.data_=t:(this.data_=new Uint8Array(t.length),this.data_.set(t)),n=t.length),this.size_=n,this.type_=r}return t.prototype.size=function(){return this.size_},t.prototype.type=function(){return this.type_},t.prototype.slice=function(e,n){if(sg(this.data_)){var r=(i=this.data_,o=e,a=n,i.webkitSlice?i.webkitSlice(o,a):i.mozSlice?i.mozSlice(o,a):i.slice?i.slice(o,a):null);return null===r?null:new t(r)}var i,o,a;return new t(new Uint8Array(this.data_.buffer,e,n-e),!0)},t.getBlob=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];if(ug()){var r=e.map((function(e){return e instanceof t?e.data_:e}));return new t(vg.apply(null,r))}var i=e.map((function(t){return ag(t)?Qv(Hv.RAW,t).data:t.data_})),o=0;i.forEach((function(t){o+=t.byteLength}));var a=new Uint8Array(o),s=0;return i.forEach((function(t){for(var e=0;e<t.length;e++)a[s++]=t[e]})),new t(a,!0)},t.prototype.uploadData=function(){return this.data_},t}();function yg(t){var e;try{e=JSON.parse(t)}catch(t){return null}return function(t){return"object"==typeof t&&!Array.isArray(t)}(e)?e:null}function mg(t){var e=t.lastIndexOf("/",t.length-2);return-1===e?t:t.slice(e+1)}function bg(t,e){return e}var _g=function(t,e,n,r){this.server=t,this.local=e||t,this.writable=!!n,this.xform=r||bg},wg=null;function Ig(){if(wg)return wg;var t=[];t.push(new _g("bucket")),t.push(new _g("generation")),t.push(new _g("metageneration")),t.push(new _g("name","fullPath",!0));var e=new _g("name");e.xform=function(t,e){return function(t){return!ag(t)||t.length<2?t:mg(t)}(e)},t.push(e);var n=new _g("size");return n.xform=function(t,e){return void 0!==e?Number(e):e},t.push(n),t.push(new _g("timeCreated")),t.push(new _g("updated")),t.push(new _g("md5Hash",null,!0)),t.push(new _g("cacheControl",null,!0)),t.push(new _g("contentDisposition",null,!0)),t.push(new _g("contentEncoding",null,!0)),t.push(new _g("contentLanguage",null,!0)),t.push(new _g("contentType",null,!0)),t.push(new _g("metadata","customMetadata",!0)),wg=t}function Tg(t,e,n){var r=yg(e);return null===r?null:function(t,e,n){for(var r={type:"file"},i=n.length,o=0;o<i;o++){var a=n[o];r[a.local]=a.xform(r,e[a.server])}return function(t,e){Object.defineProperty(t,"ref",{get:function(){var n=t.bucket,r=t.fullPath,i=new ig(n,r);return e._makeStorageReference(i)}})}(r,t),r}(t,r,n)}function Eg(t,e){for(var n={},r=e.length,i=0;i<r;i++){var o=e[i];o.writable&&(n[o.server]=t[o.local])}return JSON.stringify(n)}var Sg=function(t,e,n,r){this.url=t,this.method=e,this.handler=n,this.timeout=r,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]};function Cg(t){if(!t)throw Uv()}function kg(t,e){return function(n,r){var i=Tg(t,r,e);return Cg(null!==i),i}}function Ag(t){return function(e,n){var r,i,o;return 401===e.getStatus()?r=e.getResponseText().includes("Firebase App Check token is invalid")?new Mv("unauthorized-app","This app does not have permission to access Firebase Storage on this project."):new Mv("unauthenticated","User is not authenticated, please authenticate using Firebase Authentication and try again."):402===e.getStatus()?(o=t.bucket,r=new Mv("quota-exceeded","Quota for bucket '"+o+"' exceeded, please view quota on https://firebase.google.com/pricing/.")):403===e.getStatus()?(i=t.path,r=new Mv("unauthorized","User does not have permission to access '"+i+"'.")):r=n,r.serverResponse=n.serverResponse,r}}function Ng(t){var e=Ag(t);return function(n,r){var i,o=e(n,r);return 404===n.getStatus()&&(i=t.path,o=new Mv("object-not-found","Object '"+i+"' does not exist.")),o.serverResponse=r.serverResponse,o}}function Pg(t,e,n){var r=lg(e.fullServerUrl(),t.host),i=t.maxOperationRetryTime,o=new Sg(r,"GET",kg(t,n),i);return o.errorHandler=Ng(e),o}function Og(t,e,n,r,i){var o={};e.isRoot?o.prefix="":o.prefix=e.path+"/",n&&n.length>0&&(o.delimiter=n),r&&(o.pageToken=r),i&&(o.maxResults=i);var a=lg(e.bucketOnlyServerUrl(),t.host),s=t.maxOperationRetryTime,u=new Sg(a,"GET",function(t,e){return function(n,r){var i=function(t,e,n){var r=yg(n);return null===r?null:function(t,e,n){var r={prefixes:[],items:[],nextPageToken:n.nextPageToken};if(n.prefixes)for(var i=0,o=n.prefixes;i<o.length;i++){var a=o[i].replace(/\/$/,""),s=t._makeStorageReference(new ig(e,a));r.prefixes.push(s)}if(n.items)for(var u=0,c=n.items;u<c.length;u++){var l=c[u];s=t._makeStorageReference(new ig(e,l.name)),r.items.push(s)}return r}(t,e,r)}(t,e,r);return Cg(null!==i),i}}(t,e.bucket),s);return u.urlParams=o,u.errorHandler=Ag(e),u}function Rg(t,e,n){var r=Object.assign({},n);return r.fullPath=t.path,r.size=e.size(),r.contentType||(r.contentType=function(t,e){return e&&e.type()||"application/octet-stream"}(0,e)),r}var xg=function(t,e,n,r){this.current=t,this.total=e,this.finalized=!!n,this.metadata=r||null};function Dg(t,e){var n=null;try{n=t.getResponseHeader("X-Goog-Upload-Status")}catch(t){Cg(!1)}return Cg(!!n&&-1!==(e||["active"]).indexOf(n)),n}var Lg=262144;var Mg=function(t,e,n){if(function(t){return"function"==typeof t}(t)||null!=e||null!=n)this.next=t,this.error=e,this.complete=n;else{var r=t;this.next=r.next,this.error=r.error,this.complete=r.complete}};function Fg(t){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];Promise.resolve().then((function(){return t.apply(void 0,e)}))}}var Ug=function(){function t(t,e,n){var r=this;void 0===n&&(n=null),this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=t,this._blob=e,this._metadata=n,this._mappings=Ig(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=function(t){r._request=void 0,r._chunkMultiplier=1,t._codeEquals("canceled")?(r._needToFetchStatus=!0,r.completeTransitions_()):(r._error=t,r._transition("error"))},this._metadataErrorHandler=function(t){r._request=void 0,t._codeEquals("canceled")?r.completeTransitions_():(r._error=t,r._transition("error"))},this._promise=new Promise((function(t,e){r._resolve=t,r._reject=e,r._start()})),this._promise.then(null,(function(){}))}return t.prototype._makeProgressCallback=function(){var t=this,e=this._transferred;return function(n){return t._updateProgress(e+n)}},t.prototype._shouldDoResumable=function(t){return t.size()>262144},t.prototype._start=function(){"running"===this._state&&void 0===this._request&&(this._resumable?void 0===this._uploadUrl?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this._continueUpload():this._oneShotUpload())},t.prototype._resolveToken=function(t){var e=this;Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then((function(n){var r=n[0],i=n[1];switch(e._state){case"running":t(r,i);break;case"canceling":e._transition("canceled");break;case"pausing":e._transition("paused")}}))},t.prototype._createResumable=function(){var t=this;this._resolveToken((function(e,n){var r=function(t,e,n,r,i){var o=e.bucketOnlyServerUrl(),a=Rg(e,r,i),s={name:a.fullPath},u=lg(o,t.host),c={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":r.size(),"X-Goog-Upload-Header-Content-Type":a.contentType,"Content-Type":"application/json; charset=utf-8"},l=Eg(a,n),h=t.maxUploadRetryTime,f=new Sg(u,"POST",(function(t){var e;Dg(t);try{e=t.getResponseHeader("X-Goog-Upload-URL")}catch(t){Cg(!1)}return Cg(ag(e)),e}),h);return f.urlParams=s,f.headers=c,f.body=l,f.errorHandler=Ag(e),f}(t._ref.storage,t._ref._location,t._mappings,t._blob,t._metadata),i=t._ref.storage._makeRequest(r,e,n);t._request=i,i.getPromise().then((function(e){t._request=void 0,t._uploadUrl=e,t._needToFetchStatus=!1,t.completeTransitions_()}),t._errorHandler)}))},t.prototype._fetchStatus=function(){var t=this,e=this._uploadUrl;this._resolveToken((function(n,r){var i=function(t,e,n,r){var i=t.maxUploadRetryTime,o=new Sg(n,"POST",(function(t){var e=Dg(t,["active","final"]),n=null;try{n=t.getResponseHeader("X-Goog-Upload-Size-Received")}catch(t){Cg(!1)}n||Cg(!1);var i=Number(n);return Cg(!isNaN(i)),new xg(i,r.size(),"final"===e)}),i);return o.headers={"X-Goog-Upload-Command":"query"},o.errorHandler=Ag(e),o}(t._ref.storage,t._ref._location,e,t._blob),o=t._ref.storage._makeRequest(i,n,r);t._request=o,o.getPromise().then((function(e){e=e,t._request=void 0,t._updateProgress(e.current),t._needToFetchStatus=!1,e.finalized&&(t._needToFetchMetadata=!0),t.completeTransitions_()}),t._errorHandler)}))},t.prototype._continueUpload=function(){var t=this,e=Lg*this._chunkMultiplier,n=new xg(this._transferred,this._blob.size()),r=this._uploadUrl;this._resolveToken((function(i,o){var a;try{a=function(t,e,n,r,i,o,a,s){var u=new xg(0,0);if(a?(u.current=a.current,u.total=a.total):(u.current=0,u.total=r.size()),r.size()!==u.total)throw new Mv("server-file-wrong-size","Server recorded incorrect upload file size, please retry the upload.");var c=u.total-u.current,l=c;i>0&&(l=Math.min(l,i));var h=u.current,f=h+l,p={"X-Goog-Upload-Command":l===c?"upload, finalize":"upload","X-Goog-Upload-Offset":u.current},d=r.slice(h,f);if(null===d)throw qv();var v=e.maxUploadRetryTime,g=new Sg(n,"POST",(function(t,n){var i,a=Dg(t,["active","final"]),s=u.current+l,c=r.size();return i="final"===a?kg(e,o)(t,n):null,new xg(s,c,"final"===a,i)}),v);return g.headers=p,g.body=d.uploadData(),g.progressCallback=s||null,g.errorHandler=Ag(t),g}(t._ref._location,t._ref.storage,r,t._blob,e,t._mappings,n,t._makeProgressCallback())}catch(e){return t._error=e,void t._transition("error")}var s=t._ref.storage._makeRequest(a,i,o);t._request=s,s.getPromise().then((function(e){t._increaseMultiplier(),t._request=void 0,t._updateProgress(e.current),e.finalized?(t._metadata=e.metadata,t._transition("success")):t.completeTransitions_()}),t._errorHandler)}))},t.prototype._increaseMultiplier=function(){Lg*this._chunkMultiplier<33554432&&(this._chunkMultiplier*=2)},t.prototype._fetchMetadata=function(){var t=this;this._resolveToken((function(e,n){var r=Pg(t._ref.storage,t._ref._location,t._mappings),i=t._ref.storage._makeRequest(r,e,n);t._request=i,i.getPromise().then((function(e){t._request=void 0,t._metadata=e,t._transition("success")}),t._metadataErrorHandler)}))},t.prototype._oneShotUpload=function(){var t=this;this._resolveToken((function(e,n){var r=function(t,e,n,r,i){var o=e.bucketOnlyServerUrl(),a={"X-Goog-Upload-Protocol":"multipart"},s=function(){for(var t="",e=0;e<2;e++)t+=Math.random().toString().slice(2);return t}();a["Content-Type"]="multipart/related; boundary="+s;var u=Rg(e,r,i),c="--"+s+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+Eg(u,n)+"\r\n--"+s+"\r\nContent-Type: "+u.contentType+"\r\n\r\n",l="\r\n--"+s+"--",h=gg.getBlob(c,r,l);if(null===h)throw qv();var f={name:u.fullPath},p=lg(o,t.host),d=t.maxUploadRetryTime,v=new Sg(p,"POST",kg(t,n),d);return v.urlParams=f,v.headers=a,v.body=h.uploadData(),v.errorHandler=Ag(e),v}(t._ref.storage,t._ref._location,t._mappings,t._blob,t._metadata),i=t._ref.storage._makeRequest(r,e,n);t._request=i,i.getPromise().then((function(e){t._request=void 0,t._metadata=e,t._updateProgress(t._blob.size()),t._transition("success")}),t._errorHandler)}))},t.prototype._updateProgress=function(t){var e=this._transferred;this._transferred=t,this._transferred!==e&&this._notifyObservers()},t.prototype._transition=function(t){if(this._state!==t)switch(t){case"canceling":case"pausing":this._state=t,void 0!==this._request&&this._request.cancel();break;case"running":var e="paused"===this._state;this._state=t,e&&(this._notifyObservers(),this._start());break;case"paused":this._state=t,this._notifyObservers();break;case"canceled":this._error=jv(),this._state=t,this._notifyObservers();break;case"error":case"success":this._state=t,this._notifyObservers()}},t.prototype.completeTransitions_=function(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start()}},Object.defineProperty(t.prototype,"snapshot",{get:function(){var t=eg(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:t,metadata:this._metadata,task:this,ref:this._ref}},enumerable:!1,configurable:!0}),t.prototype.on=function(t,e,n,r){var i=this,o=new Mg(e,n,r);return this._addObserver(o),function(){i._removeObserver(o)}},t.prototype.then=function(t,e){return this._promise.then(t,e)},t.prototype.catch=function(t){return this.then(null,t)},t.prototype._addObserver=function(t){this._observers.push(t),this._notifyObserver(t)},t.prototype._removeObserver=function(t){var e=this._observers.indexOf(t);-1!==e&&this._observers.splice(e,1)},t.prototype._notifyObservers=function(){var t=this;this._finishPromise(),this._observers.slice().forEach((function(e){t._notifyObserver(e)}))},t.prototype._finishPromise=function(){if(void 0!==this._resolve){var t=!0;switch(eg(this._state)){case tg.SUCCESS:Fg(this._resolve.bind(null,this.snapshot))();break;case tg.CANCELED:case tg.ERROR:Fg(this._reject.bind(null,this._error))();break;default:t=!1}t&&(this._resolve=void 0,this._reject=void 0)}},t.prototype._notifyObserver=function(t){switch(eg(this._state)){case tg.RUNNING:case tg.PAUSED:t.next&&Fg(t.next.bind(t,this.snapshot))();break;case tg.SUCCESS:t.complete&&Fg(t.complete.bind(t))();break;case tg.CANCELED:case tg.ERROR:t.error&&Fg(t.error.bind(t,this._error))();break;default:t.error&&Fg(t.error.bind(t,this._error))()}},t.prototype.resume=function(){var t="paused"===this._state||"pausing"===this._state;return t&&this._transition("running"),t},t.prototype.pause=function(){var t="running"===this._state;return t&&this._transition("pausing"),t},t.prototype.cancel=function(){var t="running"===this._state||"pausing"===this._state;return t&&this._transition("canceling"),t},t}(),jg=function(){function t(t,e){this._service=t,this._location=e instanceof ig?e:ig.makeFromUrl(e,t.host)}return t.prototype.toString=function(){return"gs://"+this._location.bucket+"/"+this._location.path},t.prototype._newRef=function(e,n){return new t(e,n)},Object.defineProperty(t.prototype,"root",{get:function(){var t=new ig(this._location.bucket,"");return this._newRef(this._service,t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bucket",{get:function(){return this._location.bucket},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fullPath",{get:function(){return this._location.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return mg(this._location.path)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"storage",{get:function(){return this._service},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){var e=function(t){if(0===t.length)return null;var e=t.lastIndexOf("/");return-1===e?"":t.slice(0,e)}(this._location.path);if(null===e)return null;var n=new ig(this._location.bucket,e);return new t(this._service,n)},enumerable:!1,configurable:!0}),t.prototype._throwIfRoot=function(t){if(""===this._location.path)throw Kv(t)},t}();function qg(t){var e={prefixes:[],items:[]};return Vg(t,e).then((function(){return e}))}function Vg(t,e,n){return Rv(this,void 0,void 0,(function(){var r,i,o;return xv(this,(function(a){switch(a.label){case 0:return[4,Bg(t,{pageToken:n})];case 1:return r=a.sent(),(i=e.prefixes).push.apply(i,r.prefixes),(o=e.items).push.apply(o,r.items),null==r.nextPageToken?[3,3]:[4,Vg(t,e,r.nextPageToken)];case 2:a.sent(),a.label=3;case 3:return[2]}}))}))}function Bg(t,e){return Rv(this,void 0,void 0,(function(){var n,r;return xv(this,(function(i){switch(i.label){case 0:return null!=e&&"number"==typeof e.maxResults&&cg("options.maxResults",1,1e3,e.maxResults),n=e||{},r=Og(t.storage,t._location,"/",n.pageToken,n.maxResults),[4,t.storage.makeRequestWithTokens(r)];case 1:return[2,i.sent().getPromise()]}}))}))}function Kg(t){return Rv(this,void 0,void 0,(function(){var e;return xv(this,(function(n){switch(n.label){case 0:return t._throwIfRoot("getDownloadURL"),e=function(t,e,n){var r=lg(e.fullServerUrl(),t.host),i=t.maxOperationRetryTime,o=new Sg(r,"GET",function(t,e){return function(n,r){var i=Tg(t,r,e);return Cg(null!==i),function(t,e,n){var r=yg(e);if(null===r)return null;if(!ag(r.downloadTokens))return null;var i=r.downloadTokens;if(0===i.length)return null;var o=encodeURIComponent;return i.split(",").map((function(e){var r=t.bucket,i=t.fullPath;return lg("/b/"+o(r)+"/o/"+o(i),n)+hg({alt:"media",token:e})}))[0]}(i,r,t.host)}}(t,n),i);return o.errorHandler=Ng(e),o}(t.storage,t._location,Ig()),[4,t.storage.makeRequestWithTokens(e)];case 1:return[2,n.sent().getPromise().then((function(t){if(null===t)throw new Mv("no-download-url","The given file does not have any download URLs.");return t}))]}}))}))}function Wg(t,e){var n=function(t,e){var n=e.split("/").filter((function(t){return t.length>0})).join("/");return 0===t.length?n:t+"/"+n}(t._location.path,e),r=new ig(t._location.bucket,n);return new jg(t.storage,r)}function Gg(t){return/^[A-Za-z]+:\/\//.test(t)}function Hg(t,e){if(t instanceof Yg){var n=t;if(null==n._bucket)throw new Mv("no-default-bucket","No default bucket found. Did you set the 'storageBucket' property when initializing the app?");var r=new jg(n,n._bucket);return null!=e?Hg(r,e):r}if(void 0!==e){if(e.includes(".."))throw Vv('`path` param cannot contain ".."');return Wg(t,e)}return t}function zg(t,e){if(e&&Gg(e)){if(t instanceof Yg)return new jg(t,e);throw Vv("To use ref(service, url), the first argument must be a Storage instance.")}return Hg(t,e)}function Qg(t,e){var n=null==e?void 0:e.storageBucket;return null==n?null:ig.makeFromBucketSpec(n,t)}var Yg=function(){function t(t,e,n,r,i,o){this.app=t,this._authProvider=e,this._appCheckProvider=n,this._pool=r,this._url=i,this._firebaseVersion=o,this._bucket=null,this._host=Lv,this._appId=null,this._deleted=!1,this._maxOperationRetryTime=12e4,this._maxUploadRetryTime=6e5,this._requests=new Set,this._bucket=null!=i?ig.makeFromBucketSpec(i,this._host):Qg(this._host,this.app.options)}return Object.defineProperty(t.prototype,"host",{get:function(){return this._host},set:function(t){this._host=t,null!=this._url?this._bucket=ig.makeFromBucketSpec(this._url,t):this._bucket=Qg(t,this.app.options)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"maxUploadRetryTime",{get:function(){return this._maxUploadRetryTime},set:function(t){cg("time",0,Number.POSITIVE_INFINITY,t),this._maxUploadRetryTime=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"maxOperationRetryTime",{get:function(){return this._maxOperationRetryTime},set:function(t){cg("time",0,Number.POSITIVE_INFINITY,t),this._maxOperationRetryTime=t},enumerable:!1,configurable:!0}),t.prototype._getAuthToken=function(){return Rv(this,void 0,void 0,(function(){var t,e;return xv(this,(function(n){switch(n.label){case 0:return(t=this._authProvider.getImmediate({optional:!0}))?[4,t.getToken()]:[3,2];case 1:if(null!==(e=n.sent()))return[2,e.accessToken];n.label=2;case 2:return[2,null]}}))}))},t.prototype._getAppCheckToken=function(){return Rv(this,void 0,void 0,(function(){var t;return xv(this,(function(e){switch(e.label){case 0:return(t=this._appCheckProvider.getImmediate({optional:!0}))?[4,t.getToken()]:[3,2];case 1:return[2,e.sent().token];case 2:return[2,null]}}))}))},t.prototype._delete=function(){return this._deleted=!0,this._requests.forEach((function(t){return t.cancel()})),this._requests.clear(),Promise.resolve()},t.prototype._makeStorageReference=function(t){return new jg(this,t)},t.prototype._makeRequest=function(t,e,n){var r=this;if(this._deleted)return new og(Bv());var i=function(t,e,n,r,i,o){var a=hg(t.urlParams),s=t.url+a,u=Object.assign({},t.headers);return function(t,e){e&&(t["X-Firebase-GMPID"]=e)}(u,e),function(t,e){null!==e&&e.length>0&&(t.Authorization="Firebase "+e)}(u,n),function(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(null!=e?e:"AppManager")}(u,o),function(t,e){null!==e&&(t["X-Firebase-AppCheck"]=e)}(u,r),new fg(s,t.method,u,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,i)}(t,this._appId,e,n,this._pool,this._firebaseVersion);return this._requests.add(i),i.getPromise().then((function(){return r._requests.delete(i)}),(function(){return r._requests.delete(i)})),i},t.prototype.makeRequestWithTokens=function(t){return Rv(this,void 0,void 0,(function(){var e,n,r;return xv(this,(function(i){switch(i.label){case 0:return[4,Promise.all([this._getAuthToken(),this._getAppCheckToken()])];case 1:return e=i.sent(),n=e[0],r=e[1],[2,this._makeRequest(t,n,r)]}}))}))},t}();function Xg(t,e){return zg(t=(0,i.getModularInstance)(t),e)}var Jg=function(){function t(t,e,n){this._delegate=t,this.task=e,this.ref=n}return Object.defineProperty(t.prototype,"bytesTransferred",{get:function(){return this._delegate.bytesTransferred},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"metadata",{get:function(){return this._delegate.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"state",{get:function(){return this._delegate.state},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"totalBytes",{get:function(){return this._delegate.totalBytes},enumerable:!1,configurable:!0}),t}(),$g=function(){function t(t,e){this._delegate=t,this._ref=e,this.cancel=this._delegate.cancel.bind(this._delegate),this.catch=this._delegate.catch.bind(this._delegate),this.pause=this._delegate.pause.bind(this._delegate),this.resume=this._delegate.resume.bind(this._delegate)}return Object.defineProperty(t.prototype,"snapshot",{get:function(){return new Jg(this._delegate.snapshot,this,this._ref)},enumerable:!1,configurable:!0}),t.prototype.then=function(t,e){var n=this;return this._delegate.then((function(e){if(t)return t(new Jg(e,n,n._ref))}),e)},t.prototype.on=function(t,e,n,r){var i=this,o=void 0;return e&&(o="function"==typeof e?function(t){return e(new Jg(t,i,i._ref))}:{next:e.next?function(t){return e.next(new Jg(t,i,i._ref))}:void 0,complete:e.complete||void 0,error:e.error||void 0}),this._delegate.on(t,o,n||void 0,r||void 0)},t}(),Zg=function(){function t(t,e){this._delegate=t,this._service=e}return Object.defineProperty(t.prototype,"prefixes",{get:function(){var t=this;return this._delegate.prefixes.map((function(e){return new ty(e,t._service)}))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"items",{get:function(){var t=this;return this._delegate.items.map((function(e){return new ty(e,t._service)}))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"nextPageToken",{get:function(){return this._delegate.nextPageToken||null},enumerable:!1,configurable:!0}),t}(),ty=function(){function t(t,e){this._delegate=t,this.storage=e}return Object.defineProperty(t.prototype,"name",{get:function(){return this._delegate.name},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bucket",{get:function(){return this._delegate.bucket},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fullPath",{get:function(){return this._delegate.fullPath},enumerable:!1,configurable:!0}),t.prototype.toString=function(){return this._delegate.toString()},t.prototype.child=function(e){return new t(function(t,e){return Wg(t,e)}(this._delegate,e),this.storage)},Object.defineProperty(t.prototype,"root",{get:function(){return new t(this._delegate.root,this.storage)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){var e=this._delegate.parent;return null==e?null:new t(e,this.storage)},enumerable:!1,configurable:!0}),t.prototype.put=function(t,e){return this._throwIfRoot("put"),new $g(function(t,e,n){return function(t,e,n){return t._throwIfRoot("uploadBytesResumable"),new Ug(t,new gg(e),n)}(t=(0,i.getModularInstance)(t),e,n)}(this._delegate,t,e),this)},t.prototype.putString=function(t,e,n){void 0===e&&(e=Hv.RAW),this._throwIfRoot("putString");var r=Qv(e,t),i=Ov({},n);return null==i.contentType&&null!=r.contentType&&(i.contentType=r.contentType),new $g(new Ug(this._delegate,new gg(r.data,!0),i),this)},t.prototype.listAll=function(){var t=this;return function(t){return qg(t=(0,i.getModularInstance)(t))}(this._delegate).then((function(e){return new Zg(e,t.storage)}))},t.prototype.list=function(t){var e=this;return function(t,e){return Bg(t=(0,i.getModularInstance)(t),e)}(this._delegate,t||void 0).then((function(t){return new Zg(t,e.storage)}))},t.prototype.getMetadata=function(){return function(t){return function(t){return Rv(this,void 0,void 0,(function(){var e;return xv(this,(function(n){switch(n.label){case 0:return t._throwIfRoot("getMetadata"),e=Pg(t.storage,t._location,Ig()),[4,t.storage.makeRequestWithTokens(e)];case 1:return[2,n.sent().getPromise()]}}))}))}(t=(0,i.getModularInstance)(t))}(this._delegate)},t.prototype.updateMetadata=function(t){return function(t,e){return function(t,e){return Rv(this,void 0,void 0,(function(){var n;return xv(this,(function(r){switch(r.label){case 0:return t._throwIfRoot("updateMetadata"),n=function(t,e,n,r){var i=lg(e.fullServerUrl(),t.host),o=Eg(n,r),a=t.maxOperationRetryTime,s=new Sg(i,"PATCH",kg(t,r),a);return s.headers={"Content-Type":"application/json; charset=utf-8"},s.body=o,s.errorHandler=Ng(e),s}(t.storage,t._location,e,Ig()),[4,t.storage.makeRequestWithTokens(n)];case 1:return[2,r.sent().getPromise()]}}))}))}(t=(0,i.getModularInstance)(t),e)}(this._delegate,t)},t.prototype.getDownloadURL=function(){return function(t){return Kg(t=(0,i.getModularInstance)(t))}(this._delegate)},t.prototype.delete=function(){return this._throwIfRoot("delete"),function(t){return function(t){return Rv(this,void 0,void 0,(function(){var e;return xv(this,(function(n){switch(n.label){case 0:return t._throwIfRoot("deleteObject"),e=function(t,e){var n=lg(e.fullServerUrl(),t.host),r=t.maxOperationRetryTime,i=new Sg(n,"DELETE",(function(t,e){}),r);return i.successCodes=[200,204],i.errorHandler=Ng(e),i}(t.storage,t._location),[4,t.storage.makeRequestWithTokens(e)];case 1:return[2,n.sent().getPromise()]}}))}))}(t=(0,i.getModularInstance)(t))}(this._delegate)},t.prototype._throwIfRoot=function(t){if(""===this._delegate._location.path)throw Kv(t)},t}(),ey=function(){function t(t,e){var n=this;this.app=t,this._delegate=e,this.INTERNAL={delete:function(){return n._delegate._delete()}}}return Object.defineProperty(t.prototype,"maxOperationRetryTime",{get:function(){return this._delegate.maxOperationRetryTime},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"maxUploadRetryTime",{get:function(){return this._delegate.maxUploadRetryTime},enumerable:!1,configurable:!0}),t.prototype.ref=function(t){if(Gg(t))throw Vv("ref() expected a child path but got a URL, use refFromURL instead.");return new ty(Xg(this._delegate,t),this)},t.prototype.refFromURL=function(t){if(!Gg(t))throw Vv("refFromURL() expected a full URL but got a child path, use ref() instead.");try{ig.makeFromUrl(t,this._delegate.host)}catch(t){throw Vv("refFromUrl() expected a valid full URL but got an invalid one.")}return new ty(Xg(this._delegate,t),this)},t.prototype.setMaxUploadRetryTime=function(t){this._delegate.maxUploadRetryTime=t},t.prototype.setMaxOperationRetryTime=function(t){this._delegate.maxOperationRetryTime=t},t.prototype.useEmulator=function(t,e){!function(t,e,n){t.host="http://"+e+":"+n}(this._delegate,t,e)},t}();function ny(t,e){var n=e.instanceIdentifier,i=t.getProvider("app").getImmediate(),o=t.getProvider("auth-internal"),a=t.getProvider("app-check-internal");return new ey(i,new Yg(i,o,a,new rg,n,r.default.SDK_VERSION))}!function(t){var e={TaskState:tg,TaskEvent:Zv,StringFormat:Hv,Storage:Yg,Reference:ty};t.INTERNAL.registerComponent(new Dp.Component("storage",ny,"PUBLIC").setServiceProps(e).setMultipleInstances(!0)),t.registerVersion("@firebase/storage","0.5.2")}(r.default);var ry=function(){return(ry=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function iy(t,e){for(var n=0,r=e.length,i=t.length;n<r;n++,i++)t[i]=e[n];return t}Object.create,Object.create;var oy,ay,sy,uy="0.4.12",cy=uy,ly="FB-PERF-TRACE-MEASURE",hy="_wt_",fy="_fcp",py="_fid",dy="@firebase/performance/config",vy="@firebase/performance/configexpire",gy="Performance",yy=((oy={})["trace started"]="Trace {$traceName} was started before.",oy["trace stopped"]="Trace {$traceName} is not running.",oy["nonpositive trace startTime"]="Trace {$traceName} startTime should be positive.",oy["nonpositive trace duration"]="Trace {$traceName} duration should be positive.",oy["no window"]="Window is not available.",oy["no app id"]="App id is not available.",oy["no project id"]="Project id is not available.",oy["no api key"]="Api key is not available.",oy["invalid cc log"]="Attempted to queue invalid cc event",oy["FB not default"]="Performance can only start when Firebase app instance is the default one.",oy["RC response not ok"]="RC response is not ok",oy["invalid attribute name"]="Attribute name {$attributeName} is invalid.",oy["invalid attribute value"]="Attribute value {$attributeValue} is invalid.",oy["invalid custom metric name"]="Custom metric name {$customMetricName} is invalid",oy["invalid String merger input"]="Input for String merger is invalid, contact support team to resolve.",oy),my=new i.ErrorFactory("performance",gy,yy),by=new o.Logger(gy);by.logLevel=o.LogLevel.INFO;var _y,wy=function(){function t(t){if(this.window=t,!t)throw my.create("no window");this.performance=t.performance,this.PerformanceObserver=t.PerformanceObserver,this.windowLocation=t.location,this.navigator=t.navigator,this.document=t.document,this.navigator&&this.navigator.cookieEnabled&&(this.localStorage=t.localStorage),t.perfMetrics&&t.perfMetrics.onFirstInputDelay&&(this.onFirstInputDelay=t.perfMetrics.onFirstInputDelay)}return t.prototype.getUrl=function(){return this.windowLocation.href.split("?")[0]},t.prototype.mark=function(t){this.performance&&this.performance.mark&&this.performance.mark(t)},t.prototype.measure=function(t,e,n){this.performance&&this.performance.measure&&this.performance.measure(t,e,n)},t.prototype.getEntriesByType=function(t){return this.performance&&this.performance.getEntriesByType?this.performance.getEntriesByType(t):[]},t.prototype.getEntriesByName=function(t){return this.performance&&this.performance.getEntriesByName?this.performance.getEntriesByName(t):[]},t.prototype.getTimeOrigin=function(){return this.performance&&(this.performance.timeOrigin||this.performance.timing.navigationStart)},t.prototype.requiredApisAvailable=function(){return fetch&&Promise&&this.navigator&&this.navigator.cookieEnabled?!!(0,i.isIndexedDBAvailable)()||(by.info("IndexedDB is not supported by current browswer"),!1):(by.info("Firebase Performance cannot start if browser does not support fetch and Promise or cookie is disabled."),!1)},t.prototype.setupObserver=function(t,e){this.PerformanceObserver&&new this.PerformanceObserver((function(t){for(var n=0,r=t.getEntries();n<r.length;n++){var i=r[n];e(i)}})).observe({entryTypes:[t]})},t.getInstance=function(){return void 0===ay&&(ay=new t(sy)),ay},t}();function Iy(t,e){var n=t.length-e.length;if(n<0||n>1)throw my.create("invalid String merger input");for(var r=[],i=0;i<t.length;i++)r.push(t.charAt(i)),e.length>i&&r.push(e.charAt(i));return r.join("")}var Ty,Ey,Sy=function(){function t(){this.instrumentationEnabled=!0,this.dataCollectionEnabled=!0,this.loggingEnabled=!1,this.tracesSamplingRate=1,this.networkRequestsSamplingRate=1,this.logEndPointUrl="https://firebaselogging.googleapis.com/v0cc/log?format=json_proto",this.flTransportEndpointUrl=Iy("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),this.transportKey=Iy("AzSC8r6ReiGqFMyfvgow","Iayx0u-XT3vksVM-pIV"),this.logSource=462,this.logTraceAfterSampling=!1,this.logNetworkAfterSampling=!1,this.configTimeToLive=12}return t.prototype.getAppId=function(){var t=this.firebaseAppInstance&&this.firebaseAppInstance.options&&this.firebaseAppInstance.options.appId;if(!t)throw my.create("no app id");return t},t.prototype.getProjectId=function(){var t=this.firebaseAppInstance&&this.firebaseAppInstance.options&&this.firebaseAppInstance.options.projectId;if(!t)throw my.create("no project id");return t},t.prototype.getApiKey=function(){var t=this.firebaseAppInstance&&this.firebaseAppInstance.options&&this.firebaseAppInstance.options.apiKey;if(!t)throw my.create("no api key");return t},t.prototype.getFlTransportFullUrl=function(){return this.flTransportEndpointUrl.concat("?key=",this.transportKey)},t.getInstance=function(){return void 0===_y&&(_y=new t),_y},t}();function Cy(){return Ty}!function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.VISIBLE=1]="VISIBLE",t[t.HIDDEN=2]="HIDDEN"}(Ey||(Ey={}));var ky=["firebase_","google_","ga_"],Ay=new RegExp("^[a-zA-Z]\\w*$");function Ny(){var t=wy.getInstance().navigator;return"serviceWorker"in t?t.serviceWorker.controller?2:3:1}function Py(){switch(wy.getInstance().document.visibilityState){case"visible":return Ey.VISIBLE;case"hidden":return Ey.HIDDEN;default:return Ey.UNKNOWN}}function Oy(){var t=wy.getInstance().navigator.connection;switch(t&&t.effectiveType){case"slow-2g":return 1;case"2g":return 2;case"3g":return 3;case"4g":return 4;default:return 0}}var Ry="Could not fetch config, will use default configs";function xy(t){if(!t)return t;var e=Sy.getInstance(),n=t.entries||{};return void 0!==n.fpr_enabled?e.loggingEnabled="true"===String(n.fpr_enabled):e.loggingEnabled=true,n.fpr_log_source&&(e.logSource=Number(n.fpr_log_source)),n.fpr_log_endpoint_url&&(e.logEndPointUrl=n.fpr_log_endpoint_url),n.fpr_log_transport_key&&(e.transportKey=n.fpr_log_transport_key),void 0!==n.fpr_vc_network_request_sampling_rate&&(e.networkRequestsSamplingRate=Number(n.fpr_vc_network_request_sampling_rate)),void 0!==n.fpr_vc_trace_sampling_rate&&(e.tracesSamplingRate=Number(n.fpr_vc_trace_sampling_rate)),e.logTraceAfterSampling=Dy(e.tracesSamplingRate),e.logNetworkAfterSampling=Dy(e.networkRequestsSamplingRate),t}function Dy(t){return Math.random()<=t}var Ly,My=1;function Fy(){return My=2,Ly=Ly||function(){var t=wy.getInstance().document;return new Promise((function(e){if(t&&"complete"!==t.readyState){var n=function(){"complete"===t.readyState&&(t.removeEventListener("readystatechange",n),e())};t.addEventListener("readystatechange",n)}else e()}))}().then((function(){return(t=Sy.getInstance().installationsService.getId()).then((function(t){Ty=t})),t;var t})).then((function(t){return function(t){var e=function(){var t=wy.getInstance().localStorage;if(t){var e=t.getItem(vy);if(e&&Number(e)>Date.now()){var n=t.getItem(dy);if(n)try{return JSON.parse(n)}catch(t){return}}}}();return e?(xy(e),Promise.resolve()):function(t){return(e=Sy.getInstance().installationsService.getToken(),e.then((function(t){})),e).then((function(e){var n="https://firebaseremoteconfig.googleapis.com/v1/projects/"+Sy.getInstance().getProjectId()+"/namespaces/fireperf:fetch?key="+Sy.getInstance().getApiKey(),r=new Request(n,{method:"POST",headers:{Authorization:"FIREBASE_INSTALLATIONS_AUTH "+e},body:JSON.stringify({app_instance_id:t,app_instance_id_token:e,app_id:Sy.getInstance().getAppId(),app_version:cy,sdk_version:"0.0.1"})});return fetch(r).then((function(t){if(t.ok)return t.json();throw my.create("RC response not ok")}))})).catch((function(){by.info(Ry)}));var e}(t).then(xy).then((function(t){return function(t){var e=wy.getInstance().localStorage;t&&e&&(e.setItem(dy,JSON.stringify(t)),e.setItem(vy,String(Date.now()+60*Sy.getInstance().configTimeToLive*60*1e3)))}(t)}),(function(){}))}(t)})).then((function(){return Uy()}),(function(){return Uy()}))}function Uy(){My=3}var jy,qy=1e4,Vy=3,By=[],Ky=!1;function Wy(t){setTimeout((function(){var t,e;if(0!==Vy)return By.length?(e=(t=By.splice(0,1e3)).map((function(t){return{source_extension_json_proto3:t.message,event_time_ms:String(t.eventTime)}})),void function(t,e){return function(t){var e=Sy.getInstance().getFlTransportFullUrl();return fetch(e,{method:"POST",body:JSON.stringify(t)})}(t).then((function(t){return t.ok||by.info("Call to Firebase backend failed."),t.json()})).then((function(t){var n=Number(t.nextRequestWaitMillis),r=qy;isNaN(n)||(r=Math.max(n,r));var i=t.logResponseDetails;Array.isArray(i)&&i.length>0&&"RETRY_REQUEST_LATER"===i[0].responseAction&&(By=iy(iy([],e),By),by.info("Retry transport request later.")),Vy=3,Wy(r)}))}({request_time_ms:String(Date.now()),client_info:{client_type:1,js_client_info:{}},log_source:Sy.getInstance().logSource,log_event:e},t).catch((function(){By=iy(iy([],t),By),Vy--,by.info("Tries left: "+Vy+"."),Wy(qy)}))):Wy(qy)}),t)}function Gy(t){if(!t.eventTime||!t.message)throw my.create("invalid cc log");By=iy(iy([],By),[t])}function Hy(t,e){jy||(jy=function(t){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];Gy({message:t.apply(void 0,e),eventTime:Date.now()})}}(Yy)),jy(t,e)}function zy(t){var e=Sy.getInstance();!e.instrumentationEnabled&&t.isAuto||(e.dataCollectionEnabled||t.isAuto)&&wy.getInstance().requiredApisAvailable()&&(t.isAuto&&Py()!==Ey.VISIBLE||(3===My?Qy(t):Fy().then((function(){return Qy(t)}),(function(){return Qy(t)}))))}function Qy(t){if(Cy()){var e=Sy.getInstance();e.loggingEnabled&&e.logTraceAfterSampling&&setTimeout((function(){return Hy(t,1)}),0)}}function Yy(t,e){return 0===e?(r={url:(n=t).url,http_method:n.httpMethod||0,http_response_code:200,response_payload_bytes:n.responsePayloadBytes,client_start_time_us:n.startTimeUs,time_to_response_initiated_us:n.timeToResponseInitiatedUs,time_to_response_completed_us:n.timeToResponseCompletedUs},i={application_info:Xy(),network_request_metric:r},JSON.stringify(i)):function(t){var e={name:t.name,is_auto:t.isAuto,client_start_time_us:t.startTimeUs,duration_us:t.durationUs};0!==Object.keys(t.counters).length&&(e.counters=t.counters);var n=t.getAttributes();0!==Object.keys(n).length&&(e.custom_attributes=n);var r={application_info:Xy(),trace_metric:e};return JSON.stringify(r)}(t);var n,r,i}function Xy(){return{google_app_id:Sy.getInstance().getAppId(),app_instance_id:Cy(),web_app_info:{sdk_version:cy,page_url:wy.getInstance().getUrl(),service_worker_status:Ny(),visibility_state:Py(),effective_connection_type:Oy()},application_process_state:0}}var Jy=["_fp",fy,py],$y=function(){function t(t,e,n){void 0===e&&(e=!1),this.name=t,this.isAuto=e,this.state=1,this.customAttributes={},this.counters={},this.api=wy.getInstance(),this.randomId=Math.floor(1e6*Math.random()),this.isAuto||(this.traceStartMark="FB-PERF-TRACE-START-"+this.randomId+"-"+this.name,this.traceStopMark="FB-PERF-TRACE-STOP-"+this.randomId+"-"+this.name,this.traceMeasure=n||"FB-PERF-TRACE-MEASURE-"+this.randomId+"-"+this.name,n&&this.calculateTraceMetrics())}return t.prototype.start=function(){if(1!==this.state)throw my.create("trace started",{traceName:this.name});this.api.mark(this.traceStartMark),this.state=2},t.prototype.stop=function(){if(2!==this.state)throw my.create("trace stopped",{traceName:this.name});this.state=3,this.api.mark(this.traceStopMark),this.api.measure(this.traceMeasure,this.traceStartMark,this.traceStopMark),this.calculateTraceMetrics(),zy(this)},t.prototype.record=function(t,e,n){if(t<=0)throw my.create("nonpositive trace startTime",{traceName:this.name});if(e<=0)throw my.create("nonpositive trace duration",{traceName:this.name});if(this.durationUs=Math.floor(1e3*e),this.startTimeUs=Math.floor(1e3*t),n&&n.attributes&&(this.customAttributes=ry({},n.attributes)),n&&n.metrics)for(var r=0,i=Object.keys(n.metrics);r<i.length;r++){var o=i[r];isNaN(Number(n.metrics[o]))||(this.counters[o]=Number(Math.floor(n.metrics[o])))}zy(this)},t.prototype.incrementMetric=function(t,e){void 0===e&&(e=1),void 0===this.counters[t]?this.putMetric(t,e):this.putMetric(t,this.counters[t]+e)},t.prototype.putMetric=function(t,e){if(i=t,o=this.name,0===i.length||i.length>100||!(o&&o.startsWith(hy)&&Jy.indexOf(i)>-1)&&i.startsWith("_"))throw my.create("invalid custom metric name",{customMetricName:t});var n,r,i,o;this.counters[t]=(n=e,(r=Math.floor(n))<n&&by.info("Metric value should be an Integer, setting the value as : "+r+"."),r)},t.prototype.getMetric=function(t){return this.counters[t]||0},t.prototype.putAttribute=function(t,e){var n,r=!(0===(n=t).length||n.length>40||ky.some((function(t){return n.startsWith(t)}))||!n.match(Ay)),i=function(t){return 0!==t.length&&t.length<=100}(e);if(r&&i)this.customAttributes[t]=e;else{if(!r)throw my.create("invalid attribute name",{attributeName:t});if(!i)throw my.create("invalid attribute value",{attributeValue:e})}},t.prototype.getAttribute=function(t){return this.customAttributes[t]},t.prototype.removeAttribute=function(t){void 0!==this.customAttributes[t]&&delete this.customAttributes[t]},t.prototype.getAttributes=function(){return ry({},this.customAttributes)},t.prototype.setStartTime=function(t){this.startTimeUs=t},t.prototype.setDuration=function(t){this.durationUs=t},t.prototype.calculateTraceMetrics=function(){var t=this.api.getEntriesByName(this.traceMeasure),e=t&&t[0];e&&(this.durationUs=Math.floor(1e3*e.duration),this.startTimeUs=Math.floor(1e3*(e.startTime+this.api.getTimeOrigin())))},t.createOobTrace=function(e,n,r){var i=wy.getInstance().getUrl();if(i){var o=new t(hy+i,!0),a=Math.floor(1e3*wy.getInstance().getTimeOrigin());if(o.setStartTime(a),e&&e[0]&&(o.setDuration(Math.floor(1e3*e[0].duration)),o.putMetric("domInteractive",Math.floor(1e3*e[0].domInteractive)),o.putMetric("domContentLoadedEventEnd",Math.floor(1e3*e[0].domContentLoadedEventEnd)),o.putMetric("loadEventEnd",Math.floor(1e3*e[0].loadEventEnd))),n){var s=n.find((function(t){return"first-paint"===t.name}));s&&s.startTime&&o.putMetric("_fp",Math.floor(1e3*s.startTime));var u=n.find((function(t){return"first-contentful-paint"===t.name}));u&&u.startTime&&o.putMetric(fy,Math.floor(1e3*u.startTime)),r&&o.putMetric(py,Math.floor(1e3*r))}zy(o)}},t.createUserTimingTrace=function(e){zy(new t(e,!1,e))},t}();function Zy(t){var e=t;if(e&&void 0!==e.responseStart){var n=wy.getInstance().getTimeOrigin(),r=Math.floor(1e3*(e.startTime+n)),i=e.responseStart?Math.floor(1e3*(e.responseStart-e.startTime)):void 0,o=Math.floor(1e3*(e.responseEnd-e.startTime));!function(t){var e=Sy.getInstance();if(e.instrumentationEnabled){var n=t.url,r=e.logEndPointUrl.split("?")[0],i=e.flTransportEndpointUrl.split("?")[0];n!==r&&n!==i&&e.loggingEnabled&&e.logNetworkAfterSampling&&setTimeout((function(){return Hy(t,0)}),0)}}({url:e.name&&e.name.split("?")[0],responsePayloadBytes:e.transferSize,startTimeUs:r,timeToResponseInitiatedUs:i,timeToResponseCompletedUs:o})}}function tm(){Cy()&&(setTimeout((function(){return function(){var t=wy.getInstance(),e=t.getEntriesByType("navigation"),n=t.getEntriesByType("paint");if(t.onFirstInputDelay){var r=setTimeout((function(){$y.createOobTrace(e,n),r=void 0}),5e3);t.onFirstInputDelay((function(t){r&&(clearTimeout(r),$y.createOobTrace(e,n,t))}))}else $y.createOobTrace(e,n)}()}),0),setTimeout((function(){return function(){for(var t=wy.getInstance(),e=0,n=t.getEntriesByType("resource");e<n.length;e++)Zy(n[e]);t.setupObserver("resource",Zy)}()}),0),setTimeout((function(){return function(){for(var t=wy.getInstance(),e=0,n=t.getEntriesByType("measure");e<n.length;e++)em(n[e]);t.setupObserver("measure",em)}()}),0))}function em(t){var e=t.name;e.substring(0,ly.length)!==ly&&$y.createUserTimingTrace(e)}var nm=function(){function t(t){this.app=t,wy.getInstance().requiredApisAvailable()&&(0,i.validateIndexedDBOpenable)().then((function(t){t&&(Ky||(Wy(5500),Ky=!0),Fy().then(tm,tm))})).catch((function(t){by.info("Environment doesn't support IndexedDB: "+t)}))}return t.prototype.trace=function(t){return new $y(t)},Object.defineProperty(t.prototype,"instrumentationEnabled",{get:function(){return Sy.getInstance().instrumentationEnabled},set:function(t){Sy.getInstance().instrumentationEnabled=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dataCollectionEnabled",{get:function(){return Sy.getInstance().dataCollectionEnabled},set:function(t){Sy.getInstance().dataCollectionEnabled=t},enumerable:!1,configurable:!0}),t}();!function(t){t.INTERNAL.registerComponent(new Dp.Component("performance",(function(t){return function(t,e){if("[DEFAULT]"!==t.name)throw my.create("FB not default");if("undefined"==typeof window)throw my.create("no window");return function(t){sy=t}(window),Sy.getInstance().firebaseAppInstance=t,Sy.getInstance().installationsService=e,new nm(t)}(t.getProvider("app").getImmediate(),t.getProvider("installations").getImmediate())}),"PUBLIC")),t.registerVersion("@firebase/performance",uy)}(r.default);var rm=function(){return(rm=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function im(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))}function om(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}Object.create,Object.create;var am,sm,um="https://www.googletagmanager.com/gtag/js";!function(t){t.EVENT="event",t.SET="set",t.CONFIG="config"}(am||(am={})),function(t){t.ADD_SHIPPING_INFO="add_shipping_info",t.ADD_PAYMENT_INFO="add_payment_info",t.ADD_TO_CART="add_to_cart",t.ADD_TO_WISHLIST="add_to_wishlist",t.BEGIN_CHECKOUT="begin_checkout",t.CHECKOUT_PROGRESS="checkout_progress",t.EXCEPTION="exception",t.GENERATE_LEAD="generate_lead",t.LOGIN="login",t.PAGE_VIEW="page_view",t.PURCHASE="purchase",t.REFUND="refund",t.REMOVE_FROM_CART="remove_from_cart",t.SCREEN_VIEW="screen_view",t.SEARCH="search",t.SELECT_CONTENT="select_content",t.SELECT_ITEM="select_item",t.SELECT_PROMOTION="select_promotion",t.SET_CHECKOUT_OPTION="set_checkout_option",t.SHARE="share",t.SIGN_UP="sign_up",t.TIMING_COMPLETE="timing_complete",t.VIEW_CART="view_cart",t.VIEW_ITEM="view_item",t.VIEW_ITEM_LIST="view_item_list",t.VIEW_PROMOTION="view_promotion",t.VIEW_SEARCH_RESULTS="view_search_results"}(sm||(sm={}));var cm,lm=new o.Logger("@firebase/analytics");function hm(t,e,n,r,i,o){return im(this,void 0,void 0,(function(){var a,s,u,c;return om(this,(function(l){switch(l.label){case 0:a=r[i],l.label=1;case 1:return l.trys.push([1,7,,8]),a?[4,e[a]]:[3,3];case 2:return l.sent(),[3,6];case 3:return[4,Promise.all(n)];case 4:return s=l.sent(),(u=s.find((function(t){return t.measurementId===i})))?[4,e[u.appId]]:[3,6];case 5:l.sent(),l.label=6;case 6:return[3,8];case 7:return c=l.sent(),lm.error(c),[3,8];case 8:return t(am.CONFIG,i,o),[2]}}))}))}function fm(t,e,n,r,i){return im(this,void 0,void 0,(function(){var o,a,s,u,c,l,h,f;return om(this,(function(p){switch(p.label){case 0:return p.trys.push([0,4,,5]),o=[],i&&i.send_to?(a=i.send_to,Array.isArray(a)||(a=[a]),[4,Promise.all(n)]):[3,2];case 1:for(s=p.sent(),u=function(t){var n=s.find((function(e){return e.measurementId===t})),r=n&&e[n.appId];if(!r)return o=[],"break";o.push(r)},c=0,l=a;c<l.length&&(h=l[c],"break"!==u(h));c++);p.label=2;case 2:return 0===o.length&&(o=Object.values(e)),[4,Promise.all(o)];case 3:return p.sent(),t(am.EVENT,r,i||{}),[3,5];case 4:return f=p.sent(),lm.error(f),[3,5];case 5:return[2]}}))}))}var pm=((cm={})["already-exists"]="A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.",cm["already-initialized"]="Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.",cm["interop-component-reg-failed"]="Firebase Analytics Interop Component failed to instantiate: {$reason}",cm["invalid-analytics-context"]="Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}",cm["indexeddb-unavailable"]="IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}",cm["fetch-throttle"]="The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.",cm["config-fetch-failed"]="Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}",cm["no-api-key"]='The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',cm["no-app-id"]='The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',cm),dm=new i.ErrorFactory("analytics","Analytics",pm),vm=new(function(){function t(t,e){void 0===t&&(t={}),void 0===e&&(e=1e3),this.throttleMetadata=t,this.intervalMillis=e}return t.prototype.getThrottleMetadata=function(t){return this.throttleMetadata[t]},t.prototype.setThrottleMetadata=function(t,e){this.throttleMetadata[t]=e},t.prototype.deleteThrottleMetadata=function(t){delete this.throttleMetadata[t]},t}());function gm(t){return new Headers({Accept:"application/json","x-goog-api-key":t})}function ym(t){var e;return im(this,void 0,void 0,(function(){var n,r,i,o,a,s,u;return om(this,(function(c){switch(c.label){case 0:return n=t.appId,r=t.apiKey,i={method:"GET",headers:gm(r)},o="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig".replace("{app-id}",n),[4,fetch(o,i)];case 1:if(200===(a=c.sent()).status||304===a.status)return[3,6];s="",c.label=2;case 2:return c.trys.push([2,4,,5]),[4,a.json()];case 3:return u=c.sent(),(null===(e=u.error)||void 0===e?void 0:e.message)&&(s=u.error.message),[3,5];case 4:return c.sent(),[3,5];case 5:throw dm.create("config-fetch-failed",{httpStatus:a.status,responseMessage:s});case 6:return[2,a.json()]}}))}))}function mm(t,e,n,r){var o=e.throttleEndTimeMillis,a=e.backoffCount;return void 0===r&&(r=vm),im(this,void 0,void 0,(function(){var e,s,u,c,l,h,f;return om(this,(function(p){switch(p.label){case 0:e=t.appId,s=t.measurementId,p.label=1;case 1:return p.trys.push([1,3,,4]),[4,bm(n,o)];case 2:return p.sent(),[3,4];case 3:if(u=p.sent(),s)return lm.warn("Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID "+s+' provided in the "measurementId" field in the local Firebase config. ['+u.message+"]"),[2,{appId:e,measurementId:s}];throw u;case 4:return p.trys.push([4,6,,7]),[4,ym(t)];case 5:return c=p.sent(),r.deleteThrottleMetadata(e),[2,c];case 6:if(!function(t){if(!(t instanceof i.FirebaseError&&t.customData))return!1;var e=Number(t.customData.httpStatus);return 429===e||500===e||503===e||504===e}(l=p.sent())){if(r.deleteThrottleMetadata(e),s)return lm.warn("Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID "+s+' provided in the "measurementId" field in the local Firebase config. ['+l.message+"]"),[2,{appId:e,measurementId:s}];throw l}return h=503===Number(l.customData.httpStatus)?(0,i.calculateBackoffMillis)(a,r.intervalMillis,30):(0,i.calculateBackoffMillis)(a,r.intervalMillis),f={throttleEndTimeMillis:Date.now()+h,backoffCount:a+1},r.setThrottleMetadata(e,f),lm.debug("Calling attemptFetch again in "+h+" millis"),[2,mm(t,f,n,r)];case 7:return[2]}}))}))}function bm(t,e){return new Promise((function(n,r){var i=Math.max(e-Date.now(),0),o=setTimeout(n,i);t.addEventListener((function(){clearTimeout(o),r(dm.create("fetch-throttle",{throttleEndTimeMillis:e}))}))}))}var _m=function(){function t(){this.listeners=[]}return t.prototype.addEventListener=function(t){this.listeners.push(t)},t.prototype.abort=function(){this.listeners.forEach((function(t){return t()}))},t}();var wm,Im,Tm={},Em=[],Sm={},Cm="dataLayer",km="gtag",Am=!1;function Nm(t){if(Am)throw dm.create("already-initialized");t.dataLayerName&&(Cm=t.dataLayerName),t.gtagName&&(km=t.gtagName)}function Pm(t,e){!function(){var t=[];if((0,i.isBrowserExtension)()&&t.push("This is a browser extension environment."),(0,i.areCookiesEnabled)()||t.push("Cookies are not available."),t.length>0){var e=t.map((function(t,e){return"("+(e+1)+") "+t})).join(" "),n=dm.create("invalid-analytics-context",{errorInfo:e});lm.warn(n.message)}}();var n=t.options.appId;if(!n)throw dm.create("no-app-id");if(!t.options.apiKey){if(!t.options.measurementId)throw dm.create("no-api-key");lm.warn('The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID '+t.options.measurementId+' provided in the "measurementId" field in the local Firebase config.')}if(null!=Tm[n])throw dm.create("already-exists",{id:n});if(!Am){!function(t){var e=[];Array.isArray(window[t])?e=window[t]:window[t]=e}(Cm);var r=function(t,e,n,r,i){var o=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];window[r].push(arguments)};return window[i]&&"function"==typeof window[i]&&(o=window[i]),window[i]=function(t,e,n,r){return function(i,o,a){return im(this,void 0,void 0,(function(){var s;return om(this,(function(u){switch(u.label){case 0:return u.trys.push([0,6,,7]),i!==am.EVENT?[3,2]:[4,fm(t,e,n,o,a)];case 1:return u.sent(),[3,5];case 2:return i!==am.CONFIG?[3,4]:[4,hm(t,e,n,r,o,a)];case 3:return u.sent(),[3,5];case 4:t(am.SET,o),u.label=5;case 5:return[3,7];case 6:return s=u.sent(),lm.error(s),[3,7];case 7:return[2]}}))}))}}(o,t,e,n),{gtagCore:o,wrappedGtag:window[i]}}(Tm,Em,Sm,Cm,km),o=r.wrappedGtag,a=r.gtagCore;Im=o,wm=a,Am=!0}return Tm[n]=function(t,e,n,r,o,a){return im(this,void 0,void 0,(function(){var s,u,c,l,h,f,p;return om(this,(function(d){switch(d.label){case 0:return(s=function(t,e,n){return void 0===e&&(e=vm),im(this,void 0,void 0,(function(){var n,r,i,o,a,s,u=this;return om(this,(function(c){if(n=t.options,r=n.appId,i=n.apiKey,o=n.measurementId,!r)throw dm.create("no-app-id");if(!i){if(o)return[2,{measurementId:o,appId:r}];throw dm.create("no-api-key")}return a=e.getThrottleMetadata(r)||{backoffCount:0,throttleEndTimeMillis:Date.now()},s=new _m,setTimeout((function(){return im(u,void 0,void 0,(function(){return om(this,(function(t){return s.abort(),[2]}))}))}),6e4),[2,mm({appId:r,apiKey:i,measurementId:o},a,s,e)]}))}))}(t)).then((function(e){n[e.measurementId]=e.appId,t.options.measurementId&&e.measurementId!==t.options.measurementId&&lm.warn("The measurement ID in the local Firebase config ("+t.options.measurementId+") does not match the measurement ID fetched from the server ("+e.measurementId+"). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.")})).catch((function(t){return lm.error(t)})),e.push(s),u=function(){return im(this,void 0,void 0,(function(){var t;return om(this,(function(e){switch(e.label){case 0:return(0,i.isIndexedDBAvailable)()?[3,1]:(lm.warn(dm.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),[2,!1]);case 1:return e.trys.push([1,3,,4]),[4,(0,i.validateIndexedDBOpenable)()];case 2:return e.sent(),[3,4];case 3:return t=e.sent(),lm.warn(dm.create("indexeddb-unavailable",{errorInfo:t}).message),[2,!1];case 4:return[2,!0]}}))}))}().then((function(t){return t?r.getId():void 0})),[4,Promise.all([s,u])];case 1:return c=d.sent(),l=c[0],h=c[1],function(){for(var t=window.document.getElementsByTagName("script"),e=0,n=Object.values(t);e<n.length;e++){var r=n[e];if(r.src&&r.src.includes(um))return r}return null}()||function(t,e){var n=document.createElement("script");n.src=um+"?l="+t+"&id="+e,n.async=!0,document.head.appendChild(n)}(a,l.measurementId),o("js",new Date),(p={}).origin="firebase",p.update=!0,f=p,null!=h&&(f.firebase_id=h),o(am.CONFIG,l.measurementId,f),[2,l.measurementId]}}))}))}(t,Em,Sm,e,wm,Cm),{app:t,logEvent:function(t,e,r){(function(t,e,n,r,i){return im(this,void 0,void 0,(function(){var o,a;return om(this,(function(s){switch(s.label){case 0:return i&&i.global?(t(am.EVENT,n,r),[2]):[3,1];case 1:return[4,e];case 2:o=s.sent(),a=rm(rm({},r),{send_to:o}),t(am.EVENT,n,a),s.label=3;case 3:return[2]}}))}))})(Im,Tm[n],t,e,r).catch((function(t){return lm.error(t)}))},setCurrentScreen:function(t,e){(function(t,e,n,r){return im(this,void 0,void 0,(function(){var i;return om(this,(function(o){switch(o.label){case 0:return r&&r.global?(t(am.SET,{screen_name:n}),[2,Promise.resolve()]):[3,1];case 1:return[4,e];case 2:i=o.sent(),t(am.CONFIG,i,{update:!0,screen_name:n}),o.label=3;case 3:return[2]}}))}))})(Im,Tm[n],t,e).catch((function(t){return lm.error(t)}))},setUserId:function(t,e){(function(t,e,n,r){return im(this,void 0,void 0,(function(){var i;return om(this,(function(o){switch(o.label){case 0:return r&&r.global?(t(am.SET,{user_id:n}),[2,Promise.resolve()]):[3,1];case 1:return[4,e];case 2:i=o.sent(),t(am.CONFIG,i,{update:!0,user_id:n}),o.label=3;case 3:return[2]}}))}))})(Im,Tm[n],t,e).catch((function(t){return lm.error(t)}))},setUserProperties:function(t,e){(function(t,e,n,r){return im(this,void 0,void 0,(function(){var i,o,a,s,u;return om(this,(function(c){switch(c.label){case 0:if(!r||!r.global)return[3,1];for(i={},o=0,a=Object.keys(n);o<a.length;o++)s=a[o],i["user_properties."+s]=n[s];return t(am.SET,i),[2,Promise.resolve()];case 1:return[4,e];case 2:u=c.sent(),t(am.CONFIG,u,{update:!0,user_properties:n}),c.label=3;case 3:return[2]}}))}))})(Im,Tm[n],t,e).catch((function(t){return lm.error(t)}))},setAnalyticsCollectionEnabled:function(t){(function(t,e){return im(this,void 0,void 0,(function(){var n;return om(this,(function(r){switch(r.label){case 0:return[4,t];case 1:return n=r.sent(),window["ga-disable-"+n]=!e,[2]}}))}))})(Tm[n],t).catch((function(t){return lm.error(t)}))},INTERNAL:{delete:function(){return delete Tm[n],Promise.resolve()}}}}var Om="analytics";function Rm(){return im(this,void 0,void 0,(function(){return om(this,(function(t){switch(t.label){case 0:if((0,i.isBrowserExtension)())return[2,!1];if(!(0,i.areCookiesEnabled)())return[2,!1];if(!(0,i.isIndexedDBAvailable)())return[2,!1];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,(0,i.validateIndexedDBOpenable)()];case 2:return[2,t.sent()];case 3:return t.sent(),[2,!1];case 4:return[2]}}))}))}!function(t){t.INTERNAL.registerComponent(new Dp.Component(Om,(function(t){return Pm(t.getProvider("app").getImmediate(),t.getProvider("installations").getImmediate())}),"PUBLIC").setServiceProps({settings:Nm,EventName:sm,isSupported:Rm})),t.INTERNAL.registerComponent(new Dp.Component("analytics-internal",(function(t){try{return{logEvent:t.getProvider(Om).getImmediate().logEvent}}catch(t){throw dm.create("interop-component-reg-failed",{reason:t})}}),"PRIVATE")),t.registerVersion("@firebase/analytics","0.6.10")}(r.default);var xm=function(){return(xm=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function Dm(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))}function Lm(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}Object.create,Object.create;var Mm,Fm=function(){function t(t,e,n,r){this.client=t,this.storage=e,this.storageCache=n,this.logger=r}return t.prototype.isCachedDataFresh=function(t,e){if(!e)return this.logger.debug("Config fetch cache check. Cache unpopulated."),!1;var n=Date.now()-e,r=n<=t;return this.logger.debug("Config fetch cache check. Cache age millis: "+n+". Cache max age millis (minimumFetchIntervalMillis setting): "+t+". Is cache hit: "+r+"."),r},t.prototype.fetch=function(t){return Dm(this,void 0,void 0,(function(){var e,n,r,i,o;return Lm(this,(function(a){switch(a.label){case 0:return[4,Promise.all([this.storage.getLastSuccessfulFetchTimestampMillis(),this.storage.getLastSuccessfulFetchResponse()])];case 1:return e=a.sent(),n=e[0],(r=e[1])&&this.isCachedDataFresh(t.cacheMaxAgeMillis,n)?[2,r]:(t.eTag=r&&r.eTag,[4,this.client.fetch(t)]);case 2:return i=a.sent(),o=[this.storageCache.setLastSuccessfulFetchTimestampMillis(Date.now())],200===i.status&&o.push(this.storage.setLastSuccessfulFetchResponse(i)),[4,Promise.all(o)];case 3:return a.sent(),[2,i]}}))}))},t}(),Um=((Mm={})["registration-window"]="Undefined window object. This SDK only supports usage in a browser environment.",Mm["registration-project-id"]="Undefined project identifier. Check Firebase app initialization.",Mm["registration-api-key"]="Undefined API key. Check Firebase app initialization.",Mm["registration-app-id"]="Undefined app identifier. Check Firebase app initialization.",Mm["storage-open"]="Error thrown when opening storage. Original error: {$originalErrorMessage}.",Mm["storage-get"]="Error thrown when reading from storage. Original error: {$originalErrorMessage}.",Mm["storage-set"]="Error thrown when writing to storage. Original error: {$originalErrorMessage}.",Mm["storage-delete"]="Error thrown when deleting from storage. Original error: {$originalErrorMessage}.",Mm["fetch-client-network"]="Fetch client failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.",Mm["fetch-timeout"]='The config fetch request timed out.  Configure timeout using "fetchTimeoutMillis" SDK setting.',Mm["fetch-throttle"]='The config fetch request timed out while in an exponential backoff state. Configure timeout using "fetchTimeoutMillis" SDK setting. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.',Mm["fetch-client-parse"]="Fetch client could not parse response. Original error: {$originalErrorMessage}.",Mm["fetch-status"]="Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.",Mm),jm=new i.ErrorFactory("remoteconfig","Remote Config",Um),qm=function(){function t(t,e,n,r,i,o){this.firebaseInstallations=t,this.sdkVersion=e,this.namespace=n,this.projectId=r,this.apiKey=i,this.appId=o}return t.prototype.fetch=function(t){return Dm(this,void 0,void 0,(function(){var e,n,r,i,o,a,s,u,c,l,h,f,p,d,v,g,y,m,b;return Lm(this,(function(_){switch(_.label){case 0:return[4,Promise.all([this.firebaseInstallations.getId(),this.firebaseInstallations.getToken()])];case 1:e=_.sent(),n=e[0],r=e[1],i=window.FIREBASE_REMOTE_CONFIG_URL_BASE||"https://firebaseremoteconfig.googleapis.com",o=i+"/v1/projects/"+this.projectId+"/namespaces/"+this.namespace+":fetch?key="+this.apiKey,a={"Content-Type":"application/json","Content-Encoding":"gzip","If-None-Match":t.eTag||"*"},s={sdk_version:this.sdkVersion,app_instance_id:n,app_instance_id_token:r,app_id:this.appId,language_code:(void 0===w&&(w=navigator),w.languages&&w.languages[0]||w.language)},u={method:"POST",headers:a,body:JSON.stringify(s)},c=fetch(o,u),l=new Promise((function(e,n){t.signal.addEventListener((function(){var t=new Error("The operation was aborted.");t.name="AbortError",n(t)}))})),_.label=2;case 2:return _.trys.push([2,5,,6]),[4,Promise.race([c,l])];case 3:return _.sent(),[4,c];case 4:return h=_.sent(),[3,6];case 5:throw f=_.sent(),p="fetch-client-network","AbortError"===f.name&&(p="fetch-timeout"),jm.create(p,{originalErrorMessage:f.message});case 6:if(d=h.status,v=h.headers.get("ETag")||void 0,200!==h.status)return[3,11];m=void 0,_.label=7;case 7:return _.trys.push([7,9,,10]),[4,h.json()];case 8:return m=_.sent(),[3,10];case 9:throw b=_.sent(),jm.create("fetch-client-parse",{originalErrorMessage:b.message});case 10:g=m.entries,y=m.state,_.label=11;case 11:if("INSTANCE_STATE_UNSPECIFIED"===y?d=500:"NO_CHANGE"===y?d=304:"NO_TEMPLATE"!==y&&"EMPTY_CONFIG"!==y||(g={}),304!==d&&200!==d)throw jm.create("fetch-status",{httpStatus:d});return[2,{status:d,eTag:v,config:g}]}var w}))}))},t}(),Vm=function(){function t(){this.listeners=[]}return t.prototype.addEventListener=function(t){this.listeners.push(t)},t.prototype.abort=function(){this.listeners.forEach((function(t){return t()}))},t}(),Bm=["1","true","t","yes","y","on"],Km=function(){function t(t,e){void 0===e&&(e=""),this._source=t,this._value=e}return t.prototype.asString=function(){return this._value},t.prototype.asBoolean=function(){return"static"!==this._source&&Bm.indexOf(this._value.toLowerCase())>=0},t.prototype.asNumber=function(){if("static"===this._source)return 0;var t=Number(this._value);return isNaN(t)&&(t=0),t},t.prototype.getSource=function(){return this._source},t}(),Wm=function(){function t(t,e,n,r,i){this.app=t,this._client=e,this._storageCache=n,this._storage=r,this._logger=i,this._isInitializationComplete=!1,this.settings={fetchTimeoutMillis:6e4,minimumFetchIntervalMillis:432e5},this.defaultConfig={}}return t.prototype.setLogLevel=function(t){switch(t){case"debug":this._logger.logLevel=o.LogLevel.DEBUG;break;case"silent":this._logger.logLevel=o.LogLevel.SILENT;break;default:this._logger.logLevel=o.LogLevel.ERROR}},Object.defineProperty(t.prototype,"fetchTimeMillis",{get:function(){return this._storageCache.getLastSuccessfulFetchTimestampMillis()||-1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lastFetchStatus",{get:function(){return this._storageCache.getLastFetchStatus()||"no-fetch-yet"},enumerable:!1,configurable:!0}),t.prototype.activate=function(){return Dm(this,void 0,void 0,(function(){var t,e,n;return Lm(this,(function(r){switch(r.label){case 0:return[4,Promise.all([this._storage.getLastSuccessfulFetchResponse(),this._storage.getActiveConfigEtag()])];case 1:return t=r.sent(),e=t[0],n=t[1],e&&e.config&&e.eTag&&e.eTag!==n?[4,Promise.all([this._storageCache.setActiveConfig(e.config),this._storage.setActiveConfigEtag(e.eTag)])]:[2,!1];case 2:return r.sent(),[2,!0]}}))}))},t.prototype.ensureInitialized=function(){var t=this;return this._initializePromise||(this._initializePromise=this._storageCache.loadFromStorage().then((function(){t._isInitializationComplete=!0}))),this._initializePromise},t.prototype.fetch=function(){return Dm(this,void 0,void 0,(function(){var t,e,n,r=this;return Lm(this,(function(o){switch(o.label){case 0:t=new Vm,setTimeout((function(){return Dm(r,void 0,void 0,(function(){return Lm(this,(function(e){return t.abort(),[2]}))}))}),this.settings.fetchTimeoutMillis),o.label=1;case 1:return o.trys.push([1,4,,6]),[4,this._client.fetch({cacheMaxAgeMillis:this.settings.minimumFetchIntervalMillis,signal:t})];case 2:return o.sent(),[4,this._storageCache.setLastFetchStatus("success")];case 3:return o.sent(),[3,6];case 4:return e=o.sent(),n=function(t,e){return t instanceof i.FirebaseError&&-1!==t.code.indexOf("fetch-throttle")}(e)?"throttle":"failure",[4,this._storageCache.setLastFetchStatus(n)];case 5:throw o.sent(),e;case 6:return[2]}}))}))},t.prototype.fetchAndActivate=function(){return Dm(this,void 0,void 0,(function(){return Lm(this,(function(t){switch(t.label){case 0:return[4,this.fetch()];case 1:return t.sent(),[2,this.activate()]}}))}))},t.prototype.getAll=function(){var t,e,n=this;return(t=this._storageCache.getActiveConfig(),e=this.defaultConfig,void 0===t&&(t={}),void 0===e&&(e={}),Object.keys(xm(xm({},t),e))).reduce((function(t,e){return t[e]=n.getValue(e),t}),{})},t.prototype.getBoolean=function(t){return this.getValue(t).asBoolean()},t.prototype.getNumber=function(t){return this.getValue(t).asNumber()},t.prototype.getString=function(t){return this.getValue(t).asString()},t.prototype.getValue=function(t){this._isInitializationComplete||this._logger.debug('A value was requested for key "'+t+'" before SDK initialization completed. Await on ensureInitialized if the intent was to get a previously activated value.');var e=this._storageCache.getActiveConfig();return e&&void 0!==e[t]?new Km("remote",e[t]):this.defaultConfig&&void 0!==this.defaultConfig[t]?new Km("default",String(this.defaultConfig[t])):(this._logger.debug('Returning static value for key "'+t+'". Define a default or remote value if this is unintentional.'),new Km("static"))},t}();function Gm(t,e){var n=t.target.error||void 0;return jm.create(e,{originalErrorMessage:n&&n.message})}var Hm="app_namespace_store",zm=function(){function t(t,e,n,r){void 0===r&&(r=new Promise((function(t,e){var n=indexedDB.open("firebase_remote_config",1);n.onerror=function(t){e(Gm(t,"storage-open"))},n.onsuccess=function(e){t(e.target.result)},n.onupgradeneeded=function(t){var e=t.target.result;switch(t.oldVersion){case 0:e.createObjectStore(Hm,{keyPath:"compositeKey"})}}}))),this.appId=t,this.appName=e,this.namespace=n,this.openDbPromise=r}return t.prototype.getLastFetchStatus=function(){return this.get("last_fetch_status")},t.prototype.setLastFetchStatus=function(t){return this.set("last_fetch_status",t)},t.prototype.getLastSuccessfulFetchTimestampMillis=function(){return this.get("last_successful_fetch_timestamp_millis")},t.prototype.setLastSuccessfulFetchTimestampMillis=function(t){return this.set("last_successful_fetch_timestamp_millis",t)},t.prototype.getLastSuccessfulFetchResponse=function(){return this.get("last_successful_fetch_response")},t.prototype.setLastSuccessfulFetchResponse=function(t){return this.set("last_successful_fetch_response",t)},t.prototype.getActiveConfig=function(){return this.get("active_config")},t.prototype.setActiveConfig=function(t){return this.set("active_config",t)},t.prototype.getActiveConfigEtag=function(){return this.get("active_config_etag")},t.prototype.setActiveConfigEtag=function(t){return this.set("active_config_etag",t)},t.prototype.getThrottleMetadata=function(){return this.get("throttle_metadata")},t.prototype.setThrottleMetadata=function(t){return this.set("throttle_metadata",t)},t.prototype.deleteThrottleMetadata=function(){return this.delete("throttle_metadata")},t.prototype.get=function(t){return Dm(this,void 0,void 0,(function(){var e,n=this;return Lm(this,(function(r){switch(r.label){case 0:return[4,this.openDbPromise];case 1:return e=r.sent(),[2,new Promise((function(r,i){var o=e.transaction([Hm],"readonly").objectStore(Hm),a=n.createCompositeKey(t);try{var s=o.get(a);s.onerror=function(t){i(Gm(t,"storage-get"))},s.onsuccess=function(t){var e=t.target.result;r(e?e.value:void 0)}}catch(t){i(jm.create("storage-get",{originalErrorMessage:t&&t.message}))}}))]}}))}))},t.prototype.set=function(t,e){return Dm(this,void 0,void 0,(function(){var n,r=this;return Lm(this,(function(i){switch(i.label){case 0:return[4,this.openDbPromise];case 1:return n=i.sent(),[2,new Promise((function(i,o){var a=n.transaction([Hm],"readwrite").objectStore(Hm),s=r.createCompositeKey(t);try{var u=a.put({compositeKey:s,value:e});u.onerror=function(t){o(Gm(t,"storage-set"))},u.onsuccess=function(){i()}}catch(t){o(jm.create("storage-set",{originalErrorMessage:t&&t.message}))}}))]}}))}))},t.prototype.delete=function(t){return Dm(this,void 0,void 0,(function(){var e,n=this;return Lm(this,(function(r){switch(r.label){case 0:return[4,this.openDbPromise];case 1:return e=r.sent(),[2,new Promise((function(r,i){var o=e.transaction([Hm],"readwrite").objectStore(Hm),a=n.createCompositeKey(t);try{var s=o.delete(a);s.onerror=function(t){i(Gm(t,"storage-delete"))},s.onsuccess=function(){r()}}catch(t){i(jm.create("storage-delete",{originalErrorMessage:t&&t.message}))}}))]}}))}))},t.prototype.createCompositeKey=function(t){return[this.appId,this.appName,this.namespace,t].join()},t}(),Qm=function(){function t(t){this.storage=t}return t.prototype.getLastFetchStatus=function(){return this.lastFetchStatus},t.prototype.getLastSuccessfulFetchTimestampMillis=function(){return this.lastSuccessfulFetchTimestampMillis},t.prototype.getActiveConfig=function(){return this.activeConfig},t.prototype.loadFromStorage=function(){return Dm(this,void 0,void 0,(function(){var t,e,n,r,i,o;return Lm(this,(function(a){switch(a.label){case 0:return t=this.storage.getLastFetchStatus(),e=this.storage.getLastSuccessfulFetchTimestampMillis(),n=this.storage.getActiveConfig(),[4,t];case 1:return(r=a.sent())&&(this.lastFetchStatus=r),[4,e];case 2:return(i=a.sent())&&(this.lastSuccessfulFetchTimestampMillis=i),[4,n];case 3:return(o=a.sent())&&(this.activeConfig=o),[2]}}))}))},t.prototype.setLastFetchStatus=function(t){return this.lastFetchStatus=t,this.storage.setLastFetchStatus(t)},t.prototype.setLastSuccessfulFetchTimestampMillis=function(t){return this.lastSuccessfulFetchTimestampMillis=t,this.storage.setLastSuccessfulFetchTimestampMillis(t)},t.prototype.setActiveConfig=function(t){return this.activeConfig=t,this.storage.setActiveConfig(t)},t}();function Ym(t,e){return new Promise((function(n,r){var i=Math.max(e-Date.now(),0),o=setTimeout(n,i);t.addEventListener((function(){clearTimeout(o),r(jm.create("fetch-throttle",{throttleEndTimeMillis:e}))}))}))}var Xm,Jm=function(){function t(t,e){this.client=t,this.storage=e}return t.prototype.fetch=function(t){return Dm(this,void 0,void 0,(function(){var e;return Lm(this,(function(n){switch(n.label){case 0:return[4,this.storage.getThrottleMetadata()];case 1:return e=n.sent()||{backoffCount:0,throttleEndTimeMillis:Date.now()},[2,this.attemptFetch(t,e)]}}))}))},t.prototype.attemptFetch=function(t,e){var n=e.throttleEndTimeMillis,r=e.backoffCount;return Dm(this,void 0,void 0,(function(){var e,o,a;return Lm(this,(function(s){switch(s.label){case 0:return[4,Ym(t.signal,n)];case 1:s.sent(),s.label=2;case 2:return s.trys.push([2,5,,7]),[4,this.client.fetch(t)];case 3:return e=s.sent(),[4,this.storage.deleteThrottleMetadata()];case 4:return s.sent(),[2,e];case 5:if(!function(t){if(!(t instanceof i.FirebaseError&&t.customData))return!1;var e=Number(t.customData.httpStatus);return 429===e||500===e||503===e||504===e}(o=s.sent()))throw o;return a={throttleEndTimeMillis:Date.now()+(0,i.calculateBackoffMillis)(r),backoffCount:r+1},[4,this.storage.setThrottleMetadata(a)];case 6:return s.sent(),[2,this.attemptFetch(t,a)];case 7:return[2]}}))}))},t}(),$m="@firebase/remote-config";(Xm=r.default).INTERNAL.registerComponent(new Dp.Component("remoteConfig",(function(t,e){var n=e.instanceIdentifier,r=t.getProvider("app").getImmediate(),i=t.getProvider("installations").getImmediate();if("undefined"==typeof window)throw jm.create("registration-window");var a=r.options,s=a.projectId,u=a.apiKey,c=a.appId;if(!s)throw jm.create("registration-project-id");if(!u)throw jm.create("registration-api-key");if(!c)throw jm.create("registration-app-id");n=n||"firebase";var l=new zm(c,r.name,n),h=new Qm(l),f=new o.Logger($m);f.logLevel=o.LogLevel.ERROR;var p=new qm(i,Xm.SDK_VERSION,n,s,u,c),d=new Jm(p,l),v=new Fm(d,l,h,f),g=new Wm(r,v,h,l,f);return g.ensureInitialized(),g}),"PUBLIC").setMultipleInstances(!0)),Xm.registerVersion($m,"0.1.37"),n(224),r.default.registerVersion("firebase","8.6.2","app"),console.warn("\nIt looks like you're using the development build of the Firebase JS SDK.\nWhen deploying Firebase apps to production, it is advisable to only import\nthe individual SDK components you intend to use.\n\nFor the module builds, these are available in the following manner\n(replace <PACKAGE> with the name of a component - i.e. auth, database, etc):\n\nCommonJS Modules:\nconst firebase = require('firebase/app');\nrequire('firebase/<PACKAGE>');\n\nES Modules:\nimport firebase from 'firebase/app';\nimport 'firebase/<PACKAGE>';\n\nTypescript:\nimport firebase from 'firebase/app';\nimport 'firebase/<PACKAGE>';\n"),r.default.registerVersion("firebase","8.6.2")},676:function(t,e){!function(t){"use strict";function e(t){return Array.prototype.slice.call(t)}function n(t){return new Promise((function(e,n){t.onsuccess=function(){e(t.result)},t.onerror=function(){n(t.error)}}))}function r(t,e,r){var i,o=new Promise((function(o,a){n(i=t[e].apply(t,r)).then(o,a)}));return o.request=i,o}function i(t,e,n){var i=r(t,e,n);return i.then((function(t){if(t)return new l(t,i.request)}))}function o(t,e,n){n.forEach((function(n){Object.defineProperty(t.prototype,n,{get:function(){return this[e][n]},set:function(t){this[e][n]=t}})}))}function a(t,e,n,i){i.forEach((function(i){i in n.prototype&&(t.prototype[i]=function(){return r(this[e],i,arguments)})}))}function s(t,e,n,r){r.forEach((function(r){r in n.prototype&&(t.prototype[r]=function(){return this[e][r].apply(this[e],arguments)})}))}function u(t,e,n,r){r.forEach((function(r){r in n.prototype&&(t.prototype[r]=function(){return i(this[e],r,arguments)})}))}function c(t){this._index=t}function l(t,e){this._cursor=t,this._request=e}function h(t){this._store=t}function f(t){this._tx=t,this.complete=new Promise((function(e,n){t.oncomplete=function(){e()},t.onerror=function(){n(t.error)},t.onabort=function(){n(t.error)}}))}function p(t,e,n){this._db=t,this.oldVersion=e,this.transaction=new f(n)}function d(t){this._db=t}o(c,"_index",["name","keyPath","multiEntry","unique"]),a(c,"_index",IDBIndex,["get","getKey","getAll","getAllKeys","count"]),u(c,"_index",IDBIndex,["openCursor","openKeyCursor"]),o(l,"_cursor",["direction","key","primaryKey","value"]),a(l,"_cursor",IDBCursor,["update","delete"]),["advance","continue","continuePrimaryKey"].forEach((function(t){t in IDBCursor.prototype&&(l.prototype[t]=function(){var e=this,r=arguments;return Promise.resolve().then((function(){return e._cursor[t].apply(e._cursor,r),n(e._request).then((function(t){if(t)return new l(t,e._request)}))}))})})),h.prototype.createIndex=function(){return new c(this._store.createIndex.apply(this._store,arguments))},h.prototype.index=function(){return new c(this._store.index.apply(this._store,arguments))},o(h,"_store",["name","keyPath","indexNames","autoIncrement"]),a(h,"_store",IDBObjectStore,["put","add","delete","clear","get","getAll","getKey","getAllKeys","count"]),u(h,"_store",IDBObjectStore,["openCursor","openKeyCursor"]),s(h,"_store",IDBObjectStore,["deleteIndex"]),f.prototype.objectStore=function(){return new h(this._tx.objectStore.apply(this._tx,arguments))},o(f,"_tx",["objectStoreNames","mode"]),s(f,"_tx",IDBTransaction,["abort"]),p.prototype.createObjectStore=function(){return new h(this._db.createObjectStore.apply(this._db,arguments))},o(p,"_db",["name","version","objectStoreNames"]),s(p,"_db",IDBDatabase,["deleteObjectStore","close"]),d.prototype.transaction=function(){return new f(this._db.transaction.apply(this._db,arguments))},o(d,"_db",["name","version","objectStoreNames"]),s(d,"_db",IDBDatabase,["close"]),["openCursor","openKeyCursor"].forEach((function(t){[h,c].forEach((function(n){t in n.prototype&&(n.prototype[t.replace("open","iterate")]=function(){var n=e(arguments),r=n[n.length-1],i=this._store||this._index,o=i[t].apply(i,n.slice(0,-1));o.onsuccess=function(){r(o.result)}})}))})),[c,h].forEach((function(t){t.prototype.getAll||(t.prototype.getAll=function(t,e){var n=this,r=[];return new Promise((function(i){n.iterateCursor(t,(function(t){t?(r.push(t.value),void 0===e||r.length!=e?t.continue():i(r)):i(r)}))}))})})),t.openDb=function(t,e,n){var i=r(indexedDB,"open",[t,e]),o=i.request;return o&&(o.onupgradeneeded=function(t){n&&n(new p(o.result,t.oldVersion,o.transaction))}),i.then((function(t){return new d(t)}))},t.deleteDb=function(t){return r(indexedDB,"deleteDatabase",[t])},Object.defineProperty(t,"__esModule",{value:!0})}(e)}},e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={id:r,loaded:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.loaded=!0,i.exports}n.d=(t,e)=>{for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),n.hmd=t=>((t=Object.create(t)).children||(t.children=[]),Object.defineProperty(t,"exports",{enumerable:!0,set:()=>{throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+t.id)}}),t),n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},(()=>{const t=n(437);t.initializeApp({apiKey:"AIzaSyCcPq3J_Yeex39izUWyerDoNRPan9XWwJw",authDomain:"library-79cdb.firebaseapp.com",projectId:"library-79cdb",storageBucket:"library-79cdb.appspot.com",messagingSenderId:"603775734043",appId:"1:603775734043:web:47b551a4110cb35f2143be",measurementId:"G-CGHSMSDCVY"});let e=[];const r=document.querySelector(".library"),i=document.getElementById("bookTitle"),o=document.getElementById("author"),a=document.getElementById("pages"),s=document.getElementById("subBtn");function u(n,i,o){this.title=n,this.author=i,this.pages=o,e.push({title:n,author:i,pages:o});const a=document.createElement("div");r.appendChild(a),a.setAttribute("id","book"),a.setAttribute("data-i",e.length);const s=document.createElement("button");a.appendChild(s),s.textContent="X",s.setAttribute("id","delete"),s.setAttribute("data-i",e.length),s.addEventListener("click",(function(){const e=s.getAttribute("data-i");document.querySelector(`div[data-i="${e}"]`).remove(),async function(e){await t.firestore().collection(Books).doc(e).delete()}(n)}));const u=document.createElement("div");a.appendChild(u),u.setAttribute("id","title"),u.textContent=n;const c=document.createElement("div");a.appendChild(c),c.setAttribute("id","author"),c.textContent=i;const l=document.createElement("div");a.appendChild(l),l.setAttribute("id","pages"),l.textContent=`${o} Pages`;const h=document.createElement("input");a.appendChild(h),h.setAttribute("type","checkbox"),h.setAttribute("id","read");const f=document.createElement("label");a.appendChild(f),f.setAttribute("for","read"),f.textContent="Finished?"}i.addEventListener("input",(()=>{i.validity.tooShort?i.setCustomValidity("Do it right"):i.setCustomValidity("")})),o.addEventListener("input",(()=>{o.validity.tooShort?o.setCustomValidity("Do it right"):o.setCustomValidity("")})),a.addEventListener("input",(()=>{a.validity.rangeUnderflow?a.setCustomValidity("Do it right"):a.setCustomValidity("")})),s.addEventListener("click",(n=>{n.preventDefault(),i.validity.valid&&o.validity.valid&&a.validity.valid&&(new u(i.value,o.value,a.value),async function(){for(let n=0;n<e.length;n++){let r={title:e[n].title,author:e[n].author,pages:e[n].pages};await t.firestore().collection(Books).doc(r.title).set(r)}}())})),async function(){(await t.firestore().collection(Books).get()).forEach((t=>{new u(t.data().title,t.data().author,t.data().pages)}))}()})()})();