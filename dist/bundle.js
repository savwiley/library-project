(()=>{let t=[];const e=document.querySelector(".library"),i=document.querySelector(".loading"),n=document.getElementById("bookTitle"),a=document.getElementById("author"),o=document.getElementById("pages"),d=document.getElementById("subBtn");n.addEventListener("input",(()=>{n.validity.tooShort?n.setCustomValidity("Please input a title."):n.setCustomValidity("")})),a.addEventListener("input",(()=>{a.validity.tooShort?a.setCustomValidity("Please input an author."):a.setCustomValidity("")})),o.addEventListener("input",(()=>{o.validity.rangeUnderflow?o.setCustomValidity("Please input page numbers."):o.setCustomValidity("")})),d.addEventListener("click",(e=>{e.preventDefault(),n.validity.valid&&a.validity.valid&&o.validity.valid&&(new s(n.value,a.value,o.value),async function(){for(let e=0;e<t.length;e++){let i={title:t[e].title,author:t[e].author,pages:t[e].pages};await firebase.firestore().collection("Books").doc(i.title).set(i)}}(),n.value="",a.value="",o.value="")}));const l=()=>Math.floor(256*Math.random());function s(i,n,a){this.title=i,this.author=n,this.pages=a,t.push({title:i,author:n,pages:a});const o=document.createElement("div");o.style.background=`rgba(${l()}, ${l()}, ${l()})`,e.appendChild(o),o.setAttribute("id","book"),o.setAttribute("data-i",t.length);const d=document.createElement("button");o.appendChild(d),d.textContent="X",d.setAttribute("id","delete"),d.setAttribute("data-i",t.length),d.addEventListener("click",(function(){const t=d.getAttribute("data-i");document.querySelector(`div[data-i="${t}"]`).remove(),async function(t){await firebase.firestore().collection("Books").doc(t).delete()}(i)}));const s=i.split(" ").join("_"),r=document.createElement("a");r.setAttribute("href",`https://en.wikipedia.org/wiki/${s}_(novel)`),o.appendChild(r);const u=document.createElement("div");r.appendChild(u),u.setAttribute("id","title"),u.textContent=i;const c=document.createElement("div");o.appendChild(c),c.setAttribute("id","author"),c.textContent=n;const m=document.createElement("div");o.appendChild(m),m.setAttribute("id","pages"),m.textContent=`${a} Pages`;const p=document.createElement("input");o.appendChild(p),p.setAttribute("type","checkbox"),p.setAttribute("id","read");const h=document.createElement("label");o.appendChild(h),h.setAttribute("for","read"),h.textContent="Finished?"}!async function(){(await firebase.firestore().collection("Books").get()).forEach((t=>{new s(t.data().title,t.data().author,t.data().pages)})),i.remove()}()})();